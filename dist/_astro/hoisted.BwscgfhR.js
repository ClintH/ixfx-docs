import{l as f,s as p,b as h,S as O}from"./chunk-VFOO3T2I.BGqEI_wx.js";const o=f("#dataStream",{capacity:8,timestamp:!1});let i;const S={morningRoutine:{description:{sleep:"wakeup",wakeup:["coffee","breakfast"],coffee:"bike",breakfast:"bike",bike:null},initialState:"sleep"},loop:{description:{tideGoesIn:"tideGoesOut",tideGoesOut:"tideGoesIn"},initialState:"tideIn"},bread:{description:{plain:["toasted","buttered","eaten"],toasted:["buttered","eaten","diced"],buttered:["eaten","marmaladed"],marmaladed:"eaten",diced:"sprinkled-on-soup","sprinkled-on-soup":null,eaten:null},initialState:"plain"}},d=document.getElementById("btnChangeState"),c=document.getElementById("descrValidate"),a=document.getElementById("jsonDescr");a.addEventListener("input",()=>{console.log(a.innerText);let[e,t]=k(a.innerText);e?(t="âœ” OK",c.classList.remove("error")):(t=t,c.classList.add("error")),c.innerHTML=t});const m=document.getElementById("currentState"),b=p("#selDescrInitial"),n=p("#selPossibleNext",void 0,{placeholderOpt:"-- Auto --",autoSelectAfterChoice:0}),g=p("#selDemoMachines",e=>{let t=S[e];a.innerText=JSON.stringify(t.description,void 0,2),b.setOpts(Object.keys(t.description),t.initialState)},{shouldAddChoosePlaceholder:!0,autoSelectAfterChoice:0});g.setOpts(Object.keys(S));const k=e=>{try{const t=JSON.parse(e);return b.setOpts(Object.keys(t)),[!0,""]}catch(t){return[!1,t.message]}},v=h("#btnSetDescr",()=>{try{let e=a.innerText;const t=JSON.parse(e),l=b.value,s=x(l,t);i=s,u(s),o.clear()}catch(e){console.error(e),o.error(e.message),u(void 0)}}),u=e=>{if(e===void 0){d.disabled=!0,n.disabled=!0,m.innerText="(invalid JSON)",n.setOpts([]);return}m.innerText=`Current state: ${e.state}`,n.setOpts(e.statesPossible),d.disabled=e.isDone,n.disabled=e.isDone},x=(e,t)=>{let l={debug:!1,initial:e},s=new O(t,l);return s.addEventListener("change",r=>{o.log(`${r.priorState} -> ${r.newState}`),u(s)}),s.addEventListener("stop",r=>{o.log(`Done: ${r.state}`)}),s};d.addEventListener("click",()=>{if(i===void 0){o.log("No machine set");return}n.isSelectedPlaceholder?i.next():i.state=n.value});g.select(1,!0);v.click();
