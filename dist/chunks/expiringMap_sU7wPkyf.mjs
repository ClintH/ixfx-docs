import { c as createComponent, r as renderTemplate, m as maybeRenderHead, u as unescapeHTML } from './astro/server__cawITtY.mjs';
import 'kleur/colors';
import 'clsx';

const html = "<div class=\"tip\">\n<ul>\n<li>API Reference <a href=\"https://clinth.github.io/ixfx/classes/Collections.Maps.ExpiringMap.html\">ExpiringMap class</a></li>\n<li>Parent <a href=\"https://clinth.github.io/ixfx/modules/Collections.html\">Collections module</a></li>\n</ul></div>\n<p>The ixfx <a href=\"https://clinth.github.io/ixfx/classes/Collections.ExpiringMap.html\"><code>ExpiringMap</code></a> is a variant of the in-built Map. It can:</p>\n<ul>\n<li>Set a capacity limit of the map, deleting entries when the capacity is reached</li>\n<li>Delete entries that have not been set/get after some interval</li>\n</ul>\n<p>When is this kind of ‘forgetful’ map useful? One case is when we want to associate a key with a value (as we normally do with a map), but there isn’t a clear event for when a key should be removed.</p>\n<p>For example, perhaps we receive data from network sources, each of which has an id. When we receive data, we know the source is alive, and we can get/set associated data in a map. But if something goes wrong with the source or connection, there might not be an accompanying event to let us know. Rather, we’d want to remove associated data after some timeout.</p>\n<h2 id=\"basic-usage\">Basic Usage</h2>\n<p>Create with <code>Maps.expiringMap()</code>, using <code>set</code>, <code>get</code> and <code>delete</code> as usual with a map.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { Maps } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> \"https://unpkg.com/ixfx/dist/collections.js\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> map</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Maps.</span><span style=\"color:#B392F0\">expiringMap</span><span style=\"color:#E1E4E8\">();</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">map.</span><span style=\"color:#B392F0\">set</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">`fruit`</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">`apple`</span><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">map.</span><span style=\"color:#B392F0\">has</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">`fruit`</span><span style=\"color:#E1E4E8\">); </span><span style=\"color:#6A737D\">// Yields: true</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">map.</span><span style=\"color:#B392F0\">get</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">`fruit`</span><span style=\"color:#E1E4E8\">); </span><span style=\"color:#6A737D\">// Yields: `apple`</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">map.</span><span style=\"color:#B392F0\">delete</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">`fruit`</span><span style=\"color:#E1E4E8\">); </span><span style=\"color:#6A737D\">// Yields: true (because key existed)</span></span>\n<span class=\"line\"></span></code></pre>\n<p>To update the get/set time for an entry without actually updating it, use <code>touch</code>:</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">map.</span><span style=\"color:#B392F0\">touch</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">`fruit`</span><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"></span></code></pre>\n<p>The map has <em>expired</em>, <em>removed</em> and <em>newKey</em> events which are useful for taking action based on data coming and going. <em>expired</em> fires when an item is automatically removed, <em>remove</em> fires when an item is manually or automatically removed, and <em>newKey</em> fires when something is set with a key that does not currently exist.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">map.</span><span style=\"color:#B392F0\">addEventListener</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">`expired`</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">evt</span><span style=\"color:#F97583\"> =></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  const</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#79B8FF\">key</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#79B8FF\">value</span><span style=\"color:#E1E4E8\"> } </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> evt;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  console.</span><span style=\"color:#B392F0\">log</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">`Key ${</span><span style=\"color:#E1E4E8\">key</span><span style=\"color:#9ECBFF\">} removed.`</span><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">})</span></span>\n<span class=\"line\"></span></code></pre>\n<h2 id=\"automatically-removing\">Automatically removing</h2>\n<p>When creating the map, use the two <code>autoDelete</code>… <a href=\"https://clinth.github.io/ixfx/types/Collections.Maps.ExpiringMapOpts.html\">options</a>. <code>autoDeletePolicy</code> can be ‘get’, ‘set’ or ‘either’.</p>\n<p>In the below example, items that aren’t accessed for over one second are removed:</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> map</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Maps.</span><span style=\"color:#B392F0\">expiringMap</span><span style=\"color:#E1E4E8\">({</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> autoDeleteElapsed: </span><span style=\"color:#79B8FF\">1000</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> autoDeletePolicy: </span><span style=\"color:#9ECBFF\">`get`</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">});</span></span>\n<span class=\"line\"></span></code></pre>\n<p>Using a policy of ‘set’ instead will remove items which are not updated (via <code>map.set(key, value)</code>) past the interval. ‘either’ will remove items if the interval of get or set exceeds the interval.</p>\n<h2 id=\"capacity-limiting\">Capacity limiting</h2>\n<p>When creating the map, specify <code>capacity</code> and <code>evictPolicy</code> <a href=\"https://clinth.github.io/ixfx/types/Collections.ExpiringMapOpts.html\">options</a>. <code>capacity</code> is the total number of items the map can store. <code>evictPolicy</code> can be ‘none’, meaning that an error is thrown if the capacity is reached. This is the default. It can also be ‘oldestGet’, removing the entry that hasn’t been accessed the longest, or ‘oldestSet’, deleting the entry which has’t been updated the longest.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> map</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> new</span><span style=\"color:#B392F0\"> ExpiringMap</span><span style=\"color:#E1E4E8\">({</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> capacity: </span><span style=\"color:#79B8FF\">5</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\"> evictPolicy: </span><span style=\"color:#9ECBFF\">`oldestSet`</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">});</span></span>\n<span class=\"line\"></span></code></pre>\n<p>These capacity limiting settings can be combined with automatic removing based on time.</p>\n<h2 id=\"time-oriented-methods\">Time-oriented methods</h2>\n<p>Since the ExpiringMap tracks times for each item, there are a range of time-oriented ways of working with the map:</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#6A737D\">// Remove all entries that were set more than 100ms ago</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">map.</span><span style=\"color:#B392F0\">deleteWithElapsed</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">100</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">`set`</span><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Remove all entries that were last accessed more than 100ms ago</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">map.</span><span style=\"color:#B392F0\">deleteWithElapsed</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">100</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">`get`</span><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Returns the elapsed time since `fruit` was last accessed</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">map.</span><span style=\"color:#B392F0\">elapsedGet</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">`fruit`</span><span style=\"color:#E1E4E8\">); </span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Returns the elapsed time since `fruit` was last set</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">map.</span><span style=\"color:#B392F0\">elapsedSet</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">`fruit`</span><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"></span></code></pre>";

				const frontmatter = {"title":"Expiring Map","setup":"import {Markdown} from 'astro/components';\nimport Layout from '../../../layouts/MainLayout.astro';\n"};
				const file = "/Users/af4766/repos/ixfx-docs/src/pages/data/collections/expiringMap.md";
				const url = "/data/collections/expiringMap";
				function rawContent() {
					return "\n<div class=\"tip\">\n<ul>\n<li>API Reference <a href=\"https://clinth.github.io/ixfx/classes/Collections.Maps.ExpiringMap.html\">ExpiringMap class</a></li>\n<li>Parent <a href=\"https://clinth.github.io/ixfx/modules/Collections.html\">Collections module</a></li>\n</div>\n\nThe ixfx [`ExpiringMap`](https://clinth.github.io/ixfx/classes/Collections.ExpiringMap.html) is a variant of the in-built Map. It can:\n* Set a capacity limit of the map, deleting entries when the capacity is reached\n* Delete entries that have not been set/get after some interval\n\nWhen is this kind of 'forgetful' map useful? One case is when we want to associate a key with a value (as we normally do with a map), but there isn't a clear event for when a key should be removed.\n\nFor example, perhaps we receive data from network sources, each of which has an id. When we receive data, we know the source is alive, and we can get/set associated data in a map. But if something goes wrong with the source or connection, there might not be an accompanying event to let us know. Rather, we'd want to remove associated data after some timeout.\n\n## Basic Usage\n\nCreate with `Maps.expiringMap()`, using `set`, `get` and `delete` as usual with a map.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\n\nconst map = Maps.expiringMap();\nmap.set(`fruit`, `apple`);\nmap.has(`fruit`); // Yields: true\nmap.get(`fruit`); // Yields: `apple`\nmap.delete(`fruit`); // Yields: true (because key existed)\n```\n\nTo update the get/set time for an entry without actually updating it, use `touch`:\n\n```js\nmap.touch(`fruit`);\n```\n\nThe map has _expired_, _removed_ and _newKey_ events which are useful for taking action based on data coming and going. _expired_ fires when an item is automatically removed, _remove_ fires when an item is manually or automatically removed, and _newKey_ fires when something is set with a key that does not currently exist.\n\n```js\nmap.addEventListener(`expired`, evt => {\n  const { key, value } = evt;\n  console.log(`Key ${key} removed.`);\n})\n```\n\n## Automatically removing\n\nWhen creating the map, use the two `autoDelete`... [options](https://clinth.github.io/ixfx/types/Collections.Maps.ExpiringMapOpts.html). `autoDeletePolicy` can be 'get', 'set' or 'either'.\n\nIn the below example, items that aren't accessed for over one second are removed:\n\n```js\nconst map = Maps.expiringMap({\n autoDeleteElapsed: 1000,\n autoDeletePolicy: `get`\n});\n```\n\nUsing a policy of 'set' instead will remove items which are not updated (via `map.set(key, value)`) past the interval. 'either' will remove items if the interval of get or set exceeds the interval.\n\n## Capacity limiting\n\nWhen creating the map, specify `capacity` and `evictPolicy` [options](https://clinth.github.io/ixfx/types/Collections.ExpiringMapOpts.html). `capacity` is the total number of items the map can store. `evictPolicy` can be 'none', meaning that an error is thrown if the capacity is reached. This is the default. It can also be 'oldestGet', removing the entry that hasn't been accessed the longest, or 'oldestSet', deleting the entry which has't been updated the longest.\n\n```js\nconst map = new ExpiringMap({\n capacity: 5,\n evictPolicy: `oldestSet`\n});\n```\n\nThese capacity limiting settings can be combined with automatic removing based on time.\n\n## Time-oriented methods\n\nSince the ExpiringMap tracks times for each item, there are a range of time-oriented ways of working with the map:\n\n```js\n// Remove all entries that were set more than 100ms ago\nmap.deleteWithElapsed(100, `set`);\n// Remove all entries that were last accessed more than 100ms ago\nmap.deleteWithElapsed(100, `get`);\n// Returns the elapsed time since `fruit` was last accessed\nmap.elapsedGet(`fruit`); \n// Returns the elapsed time since `fruit` was last set\nmap.elapsedSet(`fruit`);\n```";
				}
				function compiledContent() {
					return html;
				}
				function getHeadings() {
					return [{"depth":2,"slug":"basic-usage","text":"Basic Usage"},{"depth":2,"slug":"automatically-removing","text":"Automatically removing"},{"depth":2,"slug":"capacity-limiting","text":"Capacity limiting"},{"depth":2,"slug":"time-oriented-methods","text":"Time-oriented methods"}];
				}

				const Content = createComponent((result, _props, slots) => {
					const { layout, ...content } = frontmatter;
					content.file = file;
					content.url = url;

					return renderTemplate`${maybeRenderHead()}${unescapeHTML(html)}`;
				});

export { Content, compiledContent, Content as default, file, frontmatter, getHeadings, rawContent, url };
