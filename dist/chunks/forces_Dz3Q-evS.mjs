import { c as createComponent, r as renderTemplate, a as renderComponent, u as unescapeHTML } from './astro/server__cawITtY.mjs';
import 'kleur/colors';
import { $ as $$MainLayout } from './MainLayout_BFrOPY-O.mjs';

const html = "<script type=\"module\" hoist=\"\">\n  import '/src/components/ReplPad';\n</script>\n<div class=\"tip\">\n<ul>\n<li>API Reference <a href=\"https://clinth.github.io/ixfx/modules/Modulation.Forces.html\">Modulation.Forces module</a></li>\n<li><a href=\"https://clinth.github.io/ixfx-demos/modulation/\">Demos</a></li>\n<li>Related: <a href=\"../oscillator/#springs\">Oscillator.spring</a>: spring force</li>\n</ul>\n</div>\n<p>The Forces module is a bit of an adaptation of Daniel Shiffman’s <a href=\"https://natureofcode.com/book/\">Nature of Code</a> examples. If you’re interested in learning the math, please see that excellent resource.</p>\n<p>This demo below shows basic movement of gravity, drag, wind and friction. <a href=\"https://clinth.github.io/ixfx-demos/modulation/forces-basic/\">See it online</a> (<a href=\"https://github.com/ClintH/ixfx-demos/tree/main/modulation/forces-basic\">source</a>). It also demonstrates selectively applying forces, in this case, based on the position of the thing.</p>\n<demo-element style=\"height:40vh\" title=\"Basic forces\" src=\"/modulation/forces-basic/\">\n<p>ixfx has a functional approach to forces. There are a range of pre-defined ‘force functions’ which can be combined together to manipulate data.</p>\n<p>First, a thing that can be affected by a force has the type <a href=\"https://clinth.github.io/ixfx/types/Modulation.Forces.ForceAffected.html\"><code>ForceAffected</code></a>. That means it has some of these properties:</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"typescript\"><code><span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> ForceAffected</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  position</span><span style=\"color:#F97583\">?:</span><span style=\"color:#B392F0\">Point</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  velocity</span><span style=\"color:#F97583\">?:</span><span style=\"color:#B392F0\">Point</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  acceleration</span><span style=\"color:#F97583\">?:</span><span style=\"color:#B392F0\">Point</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  mass</span><span style=\"color:#F97583\">?:</span><span style=\"color:#79B8FF\">number</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  angularAcceleration</span><span style=\"color:#F97583\">?:</span><span style=\"color:#79B8FF\">number</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  angularVelocity</span><span style=\"color:#F97583\">?:</span><span style=\"color:#79B8FF\">number</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  angle</span><span style=\"color:#F97583\">?:</span><span style=\"color:#79B8FF\">number</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">};</span></span>\n<span class=\"line\"></span></code></pre>\n<p>A basic thing, able to be force-affected can be as simple as:</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> thing</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  position: { x: </span><span style=\"color:#79B8FF\">0.5</span><span style=\"color:#E1E4E8\">, y: </span><span style=\"color:#79B8FF\">0.5</span><span style=\"color:#E1E4E8\"> },</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  mass: </span><span style=\"color:#79B8FF\">1</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span>\n<span class=\"line\"></span></code></pre>\n<p>Velocity and acceleration are <em>vectors</em>, capturing movement in both <em>x</em> &#x26; <em>y</em> directions. They are also signed. A negative <em>x</em> value will mean that the thing is moving left, while a positive <em>x</em> value will mean it is moving to the right.</p>\n<p>Now, rather than changing the position or velocity yourself, update it with the supplied ‘force functions’. These return a function which in turn apply the force to a thing.</p>\n<p>We first create the forces we want to use.</p>\n<p>For example, to give our thing some acceleration we might create an <a href=\"https://clinth.github.io/ixfx/functions/Modulation.Forces.accelerationForce.html\">acceleration force</a>, and to slow it down, some friction based on <a href=\"https://clinth.github.io/ixfx/functions/Modulation.Forces.velocityForce.html\">velocity</a>.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { Forces } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> \"https://unpkg.com/ixfx/dist/modulation.js\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Accelerate to right with a force of { x:0.1, y:0 }</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> accelForce</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">accelerationForce</span><span style=\"color:#E1E4E8\">({</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  x: </span><span style=\"color:#79B8FF\">0.1</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  y: </span><span style=\"color:#79B8FF\">0</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">})</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Reduce velocity due to friction</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> frictionForce</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">velocityForce</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">0.00001</span><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"></span></code></pre>\n<p>Now that the forces have been created, they can be used. Typically, you do this in an animation loop, so the thing gets updated over time.</p>\n<p><a href=\"https://clinth.github.io/ixfx/functions/Modulation.Forces.apply.html\"><code>Forces.apply</code></a> takes an input ‘thing’ (ie. a <a href=\"https://clinth.github.io/ixfx/types/Modulation.Forces.ForceAffected.html\"><code>ForceAffected</code></a> object) and applies a list of forces in order, returning a copy of the input after all the changes have been made.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#6A737D\">// Initialise thing</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">let</span><span style=\"color:#E1E4E8\"> thing </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> { position: { x: </span><span style=\"color:#79B8FF\">0.5</span><span style=\"color:#E1E4E8\">, y: </span><span style=\"color:#79B8FF\">0.5</span><span style=\"color:#E1E4E8\"> }, mass: </span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#B392F0\"> loop</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> () </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Apply accelForce and frictionForce on to thing,</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // setting it back again to the same variable</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  thing </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">apply</span><span style=\"color:#E1E4E8\">(thing,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    accelForce, </span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    frictionForce);</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  </span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // eg. use newly calculated position</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  moveElement</span><span style=\"color:#E1E4E8\">(el, thing.position);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Keep loop running</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  window.</span><span style=\"color:#B392F0\">requestAnimationFrame</span><span style=\"color:#E1E4E8\">(loop);</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">loop</span><span style=\"color:#E1E4E8\">();</span></span>\n<span class=\"line\"></span></code></pre>\n<p>After applying a force, properties will be updated - typically its <code>position</code> and <code>velocity</code>. It’s up to you to use these values somehow, for example moving a HTML element or rendering on the canvas.</p>\n<p>Once initialised, you probably don’t want to modify the thing directly, but rather do so through the application of forces.</p>\n<p>The object you pass in to <code>Forces.apply</code> could have additional properties, these are preserved.</p>\n<h2 id=\"force-settings\">Force settings</h2>\n<p>When working with forces, keep in mind that the scaling of the numbers is interdependent. Values are very much ‘set to taste’, and while experimenting, try orders of magnitude up and down in order to figure out its effect.</p>\n<p>For coordinates, it’s best to keep them relative (ie. <em>x</em> and <em>y</em> on a 0..1 scale), and map them to screen coordinates at only when necessary.</p>\n<h2 id=\"force-functions\">Force functions</h2>\n<h3 id=\"velocity--acceleration\">Velocity &#x26; acceleration</h3>\n<p>Before getting too fancy, a good place to start is moving something around. Rather than set the velocity directly, it’s better to affect the acceleration via <a href=\"https://clinth.github.io/ixfx/functions/Modulation.Forces.accelerationForce.html\"><code>accelerationForce</code></a> and let <code>Forces.apply</code> integrate that into an updated velocity and position.</p>\n<demo-element style=\"height:40vh\" title=\"Acceleration\" src=\"/modulation/forces-accel/\">\n<p>This demo computes an acceleration based on the movement of the pointer (via <a href=\"../../data/trackers/#point\">point tracker</a>). Since we want to apply a dynamic acceleration force depending on the pointer movement, it’s not possible to initialise the force function and re-use it. Rather, we call <code>Forces.accelerationForce</code> each time we apply.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">thing </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">apply</span><span style=\"color:#E1E4E8\">(thing, </span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">        Forces.</span><span style=\"color:#B392F0\">accelerationForce</span><span style=\"color:#E1E4E8\">(avg, </span><span style=\"color:#9ECBFF\">`dampen`</span><span style=\"color:#E1E4E8\">));</span></span>\n<span class=\"line\"></span></code></pre>\n<p>(don’t forget you can click the ‘Source’ button in the demo titlebar to see the full code)</p>\n<p>Note how the acceleration force has the ‘dampen’ parameter. A few different forces use the thing’s ‘mass’ field. With this parameter, we can choose for the mass to ‘dampen’ (ie reduce), ‘multiply’ (ie. increase) or be ‘ignored’.</p>\n<p>Along with the basic demo of acceleration above, there’s a more complicated example that applies the force to an arbitary number of things</p>\n<demo-element style=\"height:40vh\" title=\"Acceleration of particles\" src=\"/modulation/forces-accel-particles/\">\n<h3 id=\"wind-and-gravity\">Wind and gravity</h3>\n<p>Wind and gravity can be modelled as affecting the acceleration of a thing with <a href=\"https://clinth.github.io/ixfx/functions/Modulation.Forces.accelerationForce.html\"><code>accelerationForce</code></a></p>\n<p>For wind, we might make it push something to the right, with its power being dampened (ie. reduced) with greater mass of a thing:</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> windForce</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">accelerationForce</span><span style=\"color:#E1E4E8\">({</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   x: </span><span style=\"color:#79B8FF\">0.00001</span><span style=\"color:#E1E4E8\">, </span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   y: </span><span style=\"color:#79B8FF\">0</span><span style=\"color:#E1E4E8\"> </span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">   }, </span><span style=\"color:#9ECBFF\">`dampen`</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"></span></code></pre>\n<p>Gravity won’t affect the <em>x</em> value, but rather <em>y</em>, and in this case the force is multiplied with the mass (heavier will fall faster):</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> gravityForce</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">accelerationForce</span><span style=\"color:#E1E4E8\">({ </span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  x: </span><span style=\"color:#79B8FF\">0</span><span style=\"color:#E1E4E8\">, </span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  y: </span><span style=\"color:#79B8FF\">0.0001</span><span style=\"color:#E1E4E8\"> </span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  }, </span><span style=\"color:#9ECBFF\">`multiply`</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"></span></code></pre>\n<h3 id=\"friction--drag\">Friction &#x26; drag</h3>\n<p>Friction reduces speed with the <a href=\"https://clinth.github.io/ixfx/functions/Modulation.Forces.velocityForce.html\"><code>velocityForce</code></a>. This force essentially scales the current speed by the force value. By passing <code>multiply</code> as the second parameter, we can enhance the force with mass - heavier object, more friction.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> friction</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">velocityForce</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">0.00001</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">`multiply`</span><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"></span></code></pre>\n<p>Drag also reduces speed, and is based on the the <em>square</em> of the current velocity. We can use <a href=\"https://clinth.github.io/ixfx/functions/Modulation.Forces.magnitudeForce.html\"><code>magnitudeForce</code></a>. This produces a non-linear relation, compared with <code>velocityForce</code>. By passing <code>dampen</code> as the second parameter, we could reduce the force according the greater the mass - heavier object, less drag. Whether that makes any sense depends ont the dynamics you are creating.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> drag</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">magnitudeForce</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">0.1</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">`dampen`</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"></span></code></pre>\n<h3 id=\"pendulum\">Pendulum</h3>\n<p>The <a href=\"https://clinth.github.io/ixfx/functions/Modulation.Forces.pendulumForce.html\"><code>pendulumForce</code></a> works with angular velocity and angle of a thing.</p>\n<demo-element style=\"height:40vh\" title=\"Pendulm force\" src=\"/modulation/forces-pendulum/\">\n<p>To use, we have to define a point by which the thing is pinned, and its distance.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> thing</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  position: { x: </span><span style=\"color:#79B8FF\">0.5</span><span style=\"color:#E1E4E8\">, y: </span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\"> }</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> pinnedAt</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> { x: </span><span style=\"color:#79B8FF\">0.5</span><span style=\"color:#E1E4E8\">, y: </span><span style=\"color:#79B8FF\">0.5</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> pendulumForce</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">pendulumForce</span><span style=\"color:#E1E4E8\">(pinnedAt, { length: </span><span style=\"color:#79B8FF\">0.4</span><span style=\"color:#E1E4E8\"> });</span></span>\n<span class=\"line\"></span></code></pre>\n<p>The other options for the pendulum force are: <em>damping</em>, an amount to reduce velocity by, and <em>speed</em>, which is the maximum swing speed.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> pendulumForce</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">pendulumForce</span><span style=\"color:#E1E4E8\">(pinnedAt, { </span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  length: </span><span style=\"color:#79B8FF\">0.4</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  damping: </span><span style=\"color:#79B8FF\">0.5</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#6A737D\">// default 0.995, ie 0.5% loss</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  speed: </span><span style=\"color:#79B8FF\">0.1</span><span style=\"color:#6A737D\">    // default 0.001</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">});</span></span>\n<span class=\"line\"></span></code></pre>\n<p>If <em>length</em> is not defined, the force will use the current distance between the target and thing.</p>\n<h3 id=\"targeting\">Targeting</h3>\n<p><a href=\"https://clinth.github.io/ixfx/functions/Modulation.Forces.targetForce.html\"><code>targetForce</code></a> is a composite force which pushes a thing toward a target position.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#6A737D\">// Target the relative position of x:0.2, y:0.4</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> targetForce</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">targetForce</span><span style=\"color:#E1E4E8\">({x: </span><span style=\"color:#79B8FF\">0.2</span><span style=\"color:#E1E4E8\">, y: </span><span style=\"color:#79B8FF\">0.4</span><span style=\"color:#E1E4E8\"> });</span></span>\n<span class=\"line\"></span></code></pre>\n<p>It has some options. <code>diminishBy</code> scales the acceleration speed (default 0.0001). <code>range</code> allows you to skip moving if the thing is within this x/y to the target. Without range, it can easily ‘overshoot’ and end up bouncing back and forth around the target but never stopping.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> targetForce</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">targetForce</span><span style=\"color:#E1E4E8\">(targetPos, {</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  diminishBy: </span><span style=\"color:#79B8FF\">0.1</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  range: { x: </span><span style=\"color:#79B8FF\">0.01</span><span style=\"color:#E1E4E8\">, y: </span><span style=\"color:#79B8FF\">0.01</span><span style=\"color:#E1E4E8\">} </span><span style=\"color:#6A737D\">// If we're within 1% of target, that's good enough</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">});</span></span>\n<span class=\"line\"></span></code></pre>\n<demo-element style=\"height:40vh\" title=\"Target force\" src=\"/modulation/forces-target/\">\n<h3 id=\"attraction\">Attraction</h3>\n<p>The <a href=\"https://clinth.github.io/ixfx/functions/Modulation.Forces.attractionForce.html\"><code>attractionForce</code></a> attracts (or repels) a thing based on a list of attractors.</p>\n<demo-element style=\"height:40vh\" title=\"Attraction force\" src=\"/modulation/forces-attractor/\">\n<p>For example, lets say we have earth and sun</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> sun</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> { mass: </span><span style=\"color:#79B8FF\">1000</span><span style=\"color:#E1E4E8\">, position: Math.</span><span style=\"color:#B392F0\">random</span><span style=\"color:#E1E4E8\">() };</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> earth</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> { mass: </span><span style=\"color:#79B8FF\">0.01</span><span style=\"color:#E1E4E8\">, position: Math.</span><span style=\"color:#B392F0\">random</span><span style=\"color:#E1E4E8\">() };</span></span>\n<span class=\"line\"></span></code></pre>\n<p>The sun should be the thing that attracts the earth, so it is setup in the force, along with a gravity value of 0.1:</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#6A737D\">// Init the sun's attractive force</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> sunAttractionForce</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">attractionForce</span><span style=\"color:#E1E4E8\">(sun, </span><span style=\"color:#79B8FF\">0.1</span><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Apply the force to earth</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">earth </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">apply</span><span style=\"color:#E1E4E8\">(earth, sunAttractionForce);</span></span>\n<span class=\"line\"></span></code></pre>\n<p>The force can take a third parameter for the range at which the force is applied:</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#6A737D\">// Only apply force when distance between sun and thing is between 1-10%</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> sunAttractionForce</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">attractionForce</span><span style=\"color:#E1E4E8\">(sun, </span><span style=\"color:#79B8FF\">0.1</span><span style=\"color:#E1E4E8\">, { max: </span><span style=\"color:#79B8FF\">0.1</span><span style=\"color:#E1E4E8\">, min: </span><span style=\"color:#79B8FF\">0.01</span><span style=\"color:#E1E4E8\">});</span></span>\n<span class=\"line\"></span></code></pre>\n<h3 id=\"orientation\">Orientation</h3>\n<p>To make objects orient in the direction of travel, use <a href=\"https://clinth.github.io/ixfx/functions/Modulation.Forces.orientationForce.html\"><code>orientationForce</code></a>. This is also demonstrated in the attraction force demo above.</p>\n<p>The parameter given to the force is the ‘interpolation amount’, which determines how quickly rotation happens.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> orientationForce</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">orientationForce</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"></span></code></pre>\n<p>The orientation force is a handy composite which applies the following forces in order:</p>\n<ul>\n<li><a href=\"https://clinth.github.io/ixfx/functions/Modulation.Forces.angularForce.html\"><code>angularForce</code></a>: updates angle and velocity based on angular acceleration &#x26; velocity</li>\n<li><a href=\"https://clinth.github.io/ixfx/functions/Modulation.Forces.angleFromAccelerationForce.html\"><code>angleFromAccelerationForce</code></a>: update angularAcceleration based on acceleration’s vector,  and</li>\n<li><a href=\"https://clinth.github.io/ixfx/functions/Modulation.Forces.angleFromVelocityForce.html\"><code>angleFromVelocityForce</code></a>: update angle based on velocity, to point in direction of travel</li>\n</ul>\n<h2 id=\"applying-forces-to-many-things\">Applying forces to many things</h2>\n<p>Use the regular Javascript constructs to apply forces to many objects.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#6A737D\">// Initial things</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">let</span><span style=\"color:#E1E4E8\"> things </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> [ </span><span style=\"color:#6A737D\">/* lots of things */</span><span style=\"color:#E1E4E8\"> ]</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Things now contains a set of things after force has been applied</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">things </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> things.</span><span style=\"color:#B392F0\">map</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">t</span><span style=\"color:#F97583\"> =></span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">apply</span><span style=\"color:#E1E4E8\">(t, gravityForce));</span></span>\n<span class=\"line\"></span></code></pre>\n<h2 id=\"dynamic-forces\">Dynamic forces</h2>\n<p>At times the pattern of initialising a force once and then reusing it repeatedly isn’t appropriate. For example, if you want friction to be affected by a ‘smoothness’ property you have defined, this won’t work:</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> thing</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> { </span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  position: Points.</span><span style=\"color:#B392F0\">random</span><span style=\"color:#E1E4E8\">(),</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  smoothness: Math.</span><span style=\"color:#B392F0\">random</span><span style=\"color:#E1E4E8\">(),</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  mass: </span><span style=\"color:#79B8FF\">1</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Init force</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> friction</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">velocityForce</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">0.00001</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">`multiply`</span><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> loop</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // When applying force it will use the static values</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  thing </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">apply</span><span style=\"color:#E1E4E8\">(thing, friction);</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  ...</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span>\n<span class=\"line\"></span></code></pre>\n<p>Instead, create the force function when we call <code>apply</code>:</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> loop</span><span style=\"color:#E1E4E8\">() </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  thing </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> Forces.</span><span style=\"color:#B392F0\">apply</span><span style=\"color:#E1E4E8\">(thing, </span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    Force.</span><span style=\"color:#B392F0\">velocityForce</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#79B8FF\">0.00001</span><span style=\"color:#F97583\"> *</span><span style=\"color:#E1E4E8\"> thing.smoothness)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  );</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  ...</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span>\n<span class=\"line\"></span></code></pre>\n<p>We can also opt to dynamically apply a force or not, based on some state.</p>\n<p>In this example, we assume <code>gravityApplies</code> is a property of the thing. If the value is <em>true</em>, we apply a gravity force, if not a ‘null’ force which does nothing:</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"js\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">Forces.</span><span style=\"color:#B392F0\">apply</span><span style=\"color:#E1E4E8\">(thing,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  dragForce,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  thing.gravityApplies </span><span style=\"color:#F97583\">?</span><span style=\"color:#E1E4E8\"> gravityForce </span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> Forces.nullForce,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  windForce</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"></span></code></pre>\n<p>This technique is used in the <a href=\"https://github.com/ClintH/ixfx-demos/tree/main/modulation/forces-basic\">basic forces demo</a> to selectively apply forces depending on whether the thing is in ‘air’ or ‘water’</p>\n<h3 id=\"demos\">Demos</h3>\n<ul>\n<li><a href=\"https://clinth.github.io/ixfx-demos/modulation/forces-attractor/\">Attractor force</a> (<a href=\"https://github.com/ClintH/ixfx-demos/tree/main/modulation/forces-attractor\">source</a>)</li>\n<li><a href=\"https://clinth.github.io/ixfx-demos/modulation/forces-basic/\">Basic forces</a> (<a href=\"https://github.com/ClintH/ixfx-demos/tree/main/modulation/forces-basic\">source</a>): wind, gravity, drag, friction</li>\n<li><a href=\"https://clinth.github.io/ixfx-demos/modulation/forces-pendulum/\">Pendulum demo</a>\n(<a href=\"https://github.com/ClintH/ixfx-demos/tree/main/modulation/forces-pendulum\">source</a>)</li>\n<li><a href=\"https://clinth.github.io/ixfx-demos/modulation/forces-target/\">Target force</a> (<a href=\"https://github.com/ClintH/ixfx-demos/tree/main/modulation/forces-target\">source</a>)</li>\n</ul></demo-element></demo-element></demo-element></demo-element></demo-element></demo-element>";

				const frontmatter = {"title":"Forces","layout":"../../layouts/MainLayout.astro"};
				const file = "/Users/af4766/repos/ixfx-docs/src/pages/modulation/forces.md";
				const url = "/modulation/forces";
				function rawContent() {
					return "\n<script type=\"module\" hoist>\n  import '/src/components/ReplPad';\n</script>\n\n<div class=\"tip\">\n<ul>\n<li>API Reference <a href=\"https://clinth.github.io/ixfx/modules/Modulation.Forces.html\">Modulation.Forces module</a></li>\n<li><a href=\"https://clinth.github.io/ixfx-demos/modulation/\">Demos</a></li>\n<li>Related: <a href=\"../oscillator/#springs\">Oscillator.spring</a>: spring force</li>\n</ul>\n</div>\n\nThe Forces module is a bit of an adaptation of Daniel Shiffman's [Nature of Code](https://natureofcode.com/book/) examples. If you're interested in learning the math, please see that excellent resource.\n\nThis demo below shows basic movement of gravity, drag, wind and friction. [See it online](https://clinth.github.io/ixfx-demos/modulation/forces-basic/) ([source](https://github.com/ClintH/ixfx-demos/tree/main/modulation/forces-basic)). It also demonstrates selectively applying forces, in this case, based on the position of the thing.\n\n<demo-element style=\"height:40vh\" title=\"Basic forces\" src=\"/modulation/forces-basic/\" />\n\nixfx has a functional approach to forces. There are a range of pre-defined 'force functions' which can be combined together to manipulate data.\n\nFirst, a thing that can be affected by a force has the type [`ForceAffected`](https://clinth.github.io/ixfx/types/Modulation.Forces.ForceAffected.html). That means it has some of these properties:\n\n```typescript\ntype ForceAffected = {\n  position?:Point\n  velocity?:Point\n  acceleration?:Point\n  mass?:number\n  angularAcceleration?:number;\n  angularVelocity?:number;\n  angle?:number;\n};\n```\n\nA basic thing, able to be force-affected can be as simple as:\n\n```js\nconst thing = {\n  position: { x: 0.5, y: 0.5 },\n  mass: 1\n}\n```\n\nVelocity and acceleration are _vectors_, capturing movement in both _x_ & _y_ directions. They are also signed. A negative _x_ value will mean that the thing is moving left, while a positive _x_ value will mean it is moving to the right.\n\nNow, rather than changing the position or velocity yourself, update it with the supplied 'force functions'. These return a function which in turn apply the force to a thing.\n\nWe first create the forces we want to use.\n\nFor example, to give our thing some acceleration we might create an [acceleration force](https://clinth.github.io/ixfx/functions/Modulation.Forces.accelerationForce.html), and to slow it down, some friction based on [velocity](https://clinth.github.io/ixfx/functions/Modulation.Forces.velocityForce.html).\n\n```js\nimport { Forces } from \"https://unpkg.com/ixfx/dist/modulation.js\"\n\n// Accelerate to right with a force of { x:0.1, y:0 }\nconst accelForce = Forces.accelerationForce({\n  x: 0.1,\n  y: 0\n})\n\n// Reduce velocity due to friction\nconst frictionForce = Forces.velocityForce(0.00001);\n```\n\nNow that the forces have been created, they can be used. Typically, you do this in an animation loop, so the thing gets updated over time. \n\n[`Forces.apply`](https://clinth.github.io/ixfx/functions/Modulation.Forces.apply.html) takes an input 'thing' (ie. a [`ForceAffected`](https://clinth.github.io/ixfx/types/Modulation.Forces.ForceAffected.html) object) and applies a list of forces in order, returning a copy of the input after all the changes have been made.\n\n```js\n// Initialise thing\nlet thing = { position: { x: 0.5, y: 0.5 }, mass: 1 };\n\nconst loop = () => {\n  // Apply accelForce and frictionForce on to thing,\n  // setting it back again to the same variable\n  thing = Forces.apply(thing,\n    accelForce, \n    frictionForce);\n  \n  // eg. use newly calculated position\n  moveElement(el, thing.position);\n\n  // Keep loop running\n  window.requestAnimationFrame(loop);\n}\nloop();\n```\n\nAfter applying a force, properties will be updated - typically its `position` and `velocity`. It's up to you to use these values somehow, for example moving a HTML element or rendering on the canvas.\n\nOnce initialised, you probably don't want to modify the thing directly, but rather do so through the application of forces.\n\nThe object you pass in to `Forces.apply` could have additional properties, these are preserved.\n\n## Force settings\n\nWhen working with forces, keep in mind that the scaling of the numbers is interdependent. Values are very much 'set to taste', and while experimenting, try orders of magnitude up and down in order to figure out its effect.\n\nFor coordinates, it's best to keep them relative (ie. _x_ and _y_ on a 0..1 scale), and map them to screen coordinates at only when necessary.\n\n\n## Force functions\n\n\n### Velocity & acceleration\n\nBefore getting too fancy, a good place to start is moving something around. Rather than set the velocity directly, it's better to affect the acceleration via [`accelerationForce`](https://clinth.github.io/ixfx/functions/Modulation.Forces.accelerationForce.html) and let `Forces.apply` integrate that into an updated velocity and position.\n\n<demo-element style=\"height:40vh\" title=\"Acceleration\" src=\"/modulation/forces-accel/\" />\n\n\nThis demo computes an acceleration based on the movement of the pointer (via [point tracker](../../data/trackers/#point)). Since we want to apply a dynamic acceleration force depending on the pointer movement, it's not possible to initialise the force function and re-use it. Rather, we call `Forces.accelerationForce` each time we apply.\n\n```js\nthing = Forces.apply(thing, \n        Forces.accelerationForce(avg, `dampen`));\n```\n\n(don't forget you can click the 'Source' button in the demo titlebar to see the full code)\n\nNote how the acceleration force has the 'dampen' parameter. A few different forces use the thing's 'mass' field. With this parameter, we can choose for the mass to 'dampen' (ie reduce), 'multiply' (ie. increase) or be 'ignored'.\n\nAlong with the basic demo of acceleration above, there's a more complicated example that applies the force to an arbitary number of things\n\n<demo-element style=\"height:40vh\" title=\"Acceleration of particles\" src=\"/modulation/forces-accel-particles/\" />\n\n\n### Wind and gravity\n\nWind and gravity can be modelled as affecting the acceleration of a thing with [`accelerationForce`](https://clinth.github.io/ixfx/functions/Modulation.Forces.accelerationForce.html)\n\nFor wind, we might make it push something to the right, with its power being dampened (ie. reduced) with greater mass of a thing:\n\n```js\nconst windForce = Forces.accelerationForce({\n   x: 0.00001, \n   y: 0 \n   }, `dampen`\n);\n```\n\nGravity won't affect the _x_ value, but rather _y_, and in this case the force is multiplied with the mass (heavier will fall faster):\n\n```js\nconst gravityForce = Forces.accelerationForce({ \n  x: 0, \n  y: 0.0001 \n  }, `multiply`\n);\n```\n\n### Friction & drag\n\nFriction reduces speed with the [`velocityForce`](https://clinth.github.io/ixfx/functions/Modulation.Forces.velocityForce.html). This force essentially scales the current speed by the force value. By passing `multiply` as the second parameter, we can enhance the force with mass - heavier object, more friction.\n\n```js\nconst friction = Forces.velocityForce(0.00001, `multiply`);\n```\n\nDrag also reduces speed, and is based on the the _square_ of the current velocity. We can use [`magnitudeForce`](https://clinth.github.io/ixfx/functions/Modulation.Forces.magnitudeForce.html). This produces a non-linear relation, compared with `velocityForce`. By passing `dampen` as the second parameter, we could reduce the force according the greater the mass - heavier object, less drag. Whether that makes any sense depends ont the dynamics you are creating.\n\n```js\nconst drag = Forces.magnitudeForce(0.1, `dampen`)\n```\n\n### Pendulum\n\nThe [`pendulumForce`](https://clinth.github.io/ixfx/functions/Modulation.Forces.pendulumForce.html) works with angular velocity and angle of a thing.\n\n<demo-element style=\"height:40vh\" title=\"Pendulm force\" src=\"/modulation/forces-pendulum/\" />\n\nTo use, we have to define a point by which the thing is pinned, and its distance.\n\n```js\nconst thing = {\n  position: { x: 0.5, y: 1 }\n}\nconst pinnedAt = { x: 0.5, y: 0.5 };\nconst pendulumForce = Forces.pendulumForce(pinnedAt, { length: 0.4 });\n```\n\nThe other options for the pendulum force are: _damping_, an amount to reduce velocity by, and _speed_, which is the maximum swing speed.\n\n```js\nconst pendulumForce = Forces.pendulumForce(pinnedAt, { \n  length: 0.4,\n  damping: 0.5, // default 0.995, ie 0.5% loss\n  speed: 0.1    // default 0.001\n});\n```\n\nIf _length_ is not defined, the force will use the current distance between the target and thing.\n\n### Targeting\n\n[`targetForce`](https://clinth.github.io/ixfx/functions/Modulation.Forces.targetForce.html) is a composite force which pushes a thing toward a target position.\n\n```js\n// Target the relative position of x:0.2, y:0.4\nconst targetForce = Forces.targetForce({x: 0.2, y: 0.4 });\n```\n\nIt has some options. `diminishBy` scales the acceleration speed (default 0.0001). `range` allows you to skip moving if the thing is within this x/y to the target. Without range, it can easily 'overshoot' and end up bouncing back and forth around the target but never stopping.\n\n```js\nconst targetForce = Forces.targetForce(targetPos, {\n  diminishBy: 0.1,\n  range: { x: 0.01, y: 0.01} // If we're within 1% of target, that's good enough\n});\n```\n\n<demo-element style=\"height:40vh\" title=\"Target force\" src=\"/modulation/forces-target/\" />\n\n### Attraction\n\nThe [`attractionForce`](https://clinth.github.io/ixfx/functions/Modulation.Forces.attractionForce.html) attracts (or repels) a thing based on a list of attractors.\n\n<demo-element style=\"height:40vh\" title=\"Attraction force\" src=\"/modulation/forces-attractor/\" />\n\nFor example, lets say we have earth and sun\n\n```js\nconst sun = { mass: 1000, position: Math.random() };\nconst earth = { mass: 0.01, position: Math.random() };\n```\n\nThe sun should be the thing that attracts the earth, so it is setup in the force, along with a gravity value of 0.1:\n\n```js\n// Init the sun's attractive force\nconst sunAttractionForce = Forces.attractionForce(sun, 0.1);\n\n// Apply the force to earth\nearth = Forces.apply(earth, sunAttractionForce);\n```\n\nThe force can take a third parameter for the range at which the force is applied:\n\n```js\n// Only apply force when distance between sun and thing is between 1-10%\nconst sunAttractionForce = Forces.attractionForce(sun, 0.1, { max: 0.1, min: 0.01});\n```\n\n### Orientation\n\nTo make objects orient in the direction of travel, use [`orientationForce`](https://clinth.github.io/ixfx/functions/Modulation.Forces.orientationForce.html). This is also demonstrated in the attraction force demo above.\n\nThe parameter given to the force is the 'interpolation amount', which determines how quickly rotation happens.\n\n```js\nconst orientationForce = Forces.orientationForce(1);\n```\n\nThe orientation force is a handy composite which applies the following forces in order:\n* [`angularForce`](https://clinth.github.io/ixfx/functions/Modulation.Forces.angularForce.html): updates angle and velocity based on angular acceleration & velocity\n* [`angleFromAccelerationForce`](https://clinth.github.io/ixfx/functions/Modulation.Forces.angleFromAccelerationForce.html): update angularAcceleration based on acceleration's vector,  and\n*  [`angleFromVelocityForce`](https://clinth.github.io/ixfx/functions/Modulation.Forces.angleFromVelocityForce.html): update angle based on velocity, to point in direction of travel\n\n## Applying forces to many things\n\nUse the regular Javascript constructs to apply forces to many objects.\n\n```js\n// Initial things\nlet things = [ /* lots of things */ ]\n// Things now contains a set of things after force has been applied\nthings = things.map(t => Forces.apply(t, gravityForce));\n```\n\n## Dynamic forces\n\nAt times the pattern of initialising a force once and then reusing it repeatedly isn't appropriate. For example, if you want friction to be affected by a 'smoothness' property you have defined, this won't work:\n\n```js\nconst thing = { \n  position: Points.random(),\n  smoothness: Math.random(),\n  mass: 1\n};\n\n// Init force\nconst friction = Forces.velocityForce(0.00001, `multiply`);\nconst loop() => {\n  // When applying force it will use the static values\n  thing = Forces.apply(thing, friction);\n  ...\n}\n```\n\nInstead, create the force function when we call `apply`:\n\n```js\nconst loop() => {\n  thing = Forces.apply(thing, \n    Force.velocityForce(0.00001 * thing.smoothness)\n  );\n  ...\n}\n```\n\nWe can also opt to dynamically apply a force or not, based on some state.\n\nIn this example, we assume `gravityApplies` is a property of the thing. If the value is _true_, we apply a gravity force, if not a 'null' force which does nothing:\n\n```js\nForces.apply(thing,\n  dragForce,\n  thing.gravityApplies ? gravityForce : Forces.nullForce,\n  windForce\n);\n```\n\nThis technique is used in the [basic forces demo](https://github.com/ClintH/ixfx-demos/tree/main/modulation/forces-basic) to selectively apply forces depending on whether the thing is in 'air' or 'water'\n\n\n### Demos\n\n* [Attractor force](https://clinth.github.io/ixfx-demos/modulation/forces-attractor/) ([source](https://github.com/ClintH/ixfx-demos/tree/main/modulation/forces-attractor))\n* [Basic forces](https://clinth.github.io/ixfx-demos/modulation/forces-basic/) ([source](https://github.com/ClintH/ixfx-demos/tree/main/modulation/forces-basic)): wind, gravity, drag, friction\n* [Pendulum demo](https://clinth.github.io/ixfx-demos/modulation/forces-pendulum/)\n([source](https://github.com/ClintH/ixfx-demos/tree/main/modulation/forces-pendulum))\n* [Target force](https://clinth.github.io/ixfx-demos/modulation/forces-target/) ([source](https://github.com/ClintH/ixfx-demos/tree/main/modulation/forces-target))\n";
				}
				function compiledContent() {
					return html;
				}
				function getHeadings() {
					return [{"depth":2,"slug":"force-settings","text":"Force settings"},{"depth":2,"slug":"force-functions","text":"Force functions"},{"depth":3,"slug":"velocity--acceleration","text":"Velocity & acceleration"},{"depth":3,"slug":"wind-and-gravity","text":"Wind and gravity"},{"depth":3,"slug":"friction--drag","text":"Friction & drag"},{"depth":3,"slug":"pendulum","text":"Pendulum"},{"depth":3,"slug":"targeting","text":"Targeting"},{"depth":3,"slug":"attraction","text":"Attraction"},{"depth":3,"slug":"orientation","text":"Orientation"},{"depth":2,"slug":"applying-forces-to-many-things","text":"Applying forces to many things"},{"depth":2,"slug":"dynamic-forces","text":"Dynamic forces"},{"depth":3,"slug":"demos","text":"Demos"}];
				}

				const Content = createComponent((result, _props, slots) => {
					const { layout, ...content } = frontmatter;
					content.file = file;
					content.url = url;

					return renderTemplate`${renderComponent(result, 'Layout', $$MainLayout, {
								file,
								url,
								content,
								frontmatter: content,
								headings: getHeadings(),
								rawContent,
								compiledContent,
								'server:root': true,
							}, {
								'default': () => renderTemplate`${unescapeHTML(html)}`
							})}`;
				});

export { Content, compiledContent, Content as default, file, frontmatter, getHeadings, rawContent, url };
