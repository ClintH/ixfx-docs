var u0=Object.create,fi=Object.defineProperty,Us=Object.getOwnPropertyDescriptor,Vs=Object.getOwnPropertyNames,o0=Object.getPrototypeOf,s0=Object.prototype.hasOwnProperty,c0=(e,r,n)=>r in e?fi(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n,Ze=(e,r)=>function(){return r||(0,e[Vs(e)[0]])((r={exports:{}}).exports,r),r.exports},ie=(e,r)=>{for(var n in r)fi(e,n,{get:r[n],enumerable:!0})},l0=(e,r,n,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of Vs(r))!s0.call(e,a)&&a!==n&&fi(e,a,{get:()=>r[a],enumerable:!(i=Us(r,a))||i.enumerable});return e},un=(e,r,n)=>(n=e!=null?u0(o0(e)):{},l0(r||!e||!e.__esModule?fi(n,"default",{value:e,enumerable:!0}):n,e)),Ib=(e,r,n,i)=>{for(var a=i>1?void 0:i?Us(r,n):r,u=e.length-1,o;u>=0;u--)(o=e[u])&&(a=(i?o(r,n,a):o(a))||a);return i&&a&&fi(r,n,a),a},F=(e,r,n)=>(c0(e,typeof r!="symbol"?r+"":r,n),n),ku=(e,r,n)=>{if(!r.has(e))throw TypeError("Cannot "+n)},J=(e,r,n)=>(ku(e,r,"read from private field"),n?n.call(e):r.get(e)),Oe=(e,r,n)=>{if(r.has(e))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(e):r.set(e,n)},Ce=(e,r,n,i)=>(ku(e,r,"write to private field"),i?i.call(e,n):r.set(e,n),n),f0=(e,r,n,i)=>({set _(a){Ce(e,r,a,n)},get _(){return J(e,r,i)}}),h0=(e,r,n)=>(ku(e,r,"access private method"),n),d0={};ie(d0,{SimpleEventEmitter:()=>lr});var Vt,v0=class{constructor(){Oe(this,Vt,new Map)}add(e,...r){const n=J(this,Vt).get(e);n===void 0?J(this,Vt).set(e,r):J(this,Vt).set(e,[...n,...r])}keys(){return J(this,Vt).keys()}debugString(){let e="";return Array.from(J(this,Vt).keys()).every(n=>{const i=J(this,Vt).get(n);i!==void 0&&(e+=n+` (${i.length}) = ${JSON.stringify(i)}\r
`)}),e}get(e){return J(this,Vt).get(e)}delete(e,r){const n=J(this,Vt).get(e);if(n===void 0)return!1;const i=n.filter(a=>a!==r);return J(this,Vt).set(e,i),i.length<n.length}clear(){J(this,Vt).clear()}};Vt=new WeakMap;var Hs=()=>new v0,dn,lr=class{constructor(){Oe(this,dn,Hs())}fireEvent(e,r){const n=J(this,dn).get(e);n!==void 0&&n.forEach(i=>{try{i(r,this)}catch(a){console.debug("Event listener error: ",a)}})}addEventListener(e,r){J(this,dn).add(e,r)}removeEventListener(e,r){J(this,dn).delete(e,r)}clearEventListeners(){J(this,dn).clear()}};dn=new WeakMap;var Gs={};ie(Gs,{set:()=>y0,setMutable:()=>Lu});var iu=class{constructor(e,r){F(this,"store"),F(this,"keyString"),this.store=r??new Map,this.keyString=e??Ks}add(...e){const r=new Map(this.store);for(const n of e){const i=this.keyString(n);r.set(i,n)}return new iu(this.keyString,r)}delete(e){const r=new Map(this.store),n=this.keyString(e);return r.delete(n)?new iu(this.keyString,r):this}has(e){const r=this.keyString(e);return this.store.has(r)}toArray(){return[...this.store.values()]}*values(){yield*this.store.values()}},y0=e=>new iu(e),Lu=(e=void 0)=>new m0(e),Ks=e=>typeof e=="string"?e:JSON.stringify(e),m0=class extends lr{constructor(e=void 0){super();F(this,"store",new Map),F(this,"keyString"),this.keyString=e??Ks}add(...e){e.forEach(r=>{const n=this.has(r);this.store.set(this.keyString(r),r),super.fireEvent("add",{value:r,updated:n})})}values(){return this.store.values()}clear(){this.store.clear(),super.fireEvent("clear",!0)}delete(e){const r=this.store.delete(this.keyString(e));return r&&super.fireEvent("delete",e),r}has(e){return this.store.has(this.keyString(e))}toArray(){return Array.from(this.store.values())}},ae=(e,r="",n="?")=>{if(typeof e>"u")throw new Error(`Parameter ${n} is undefined`);if(Number.isNaN(e))throw new Error(`Parameter '${n}' is NaN`);if(typeof e!="number")throw new Error(`Parameter '${n}' is not a number (${e})`);switch(r){case"positive":if(e<0)throw new Error(`Parameter '${n}' must be at least zero (${e})`);break;case"negative":if(e>0)throw new Error(`Parameter '${n}' must be zero or lower (${e})`);break;case"aboveZero":if(e<=0)throw new Error(`Parameter '${n}' must be above zero (${e})`);break;case"belowZero":if(e>=0)throw new Error(`Parameter '${n}' must be below zero (${e})`);break;case"percentage":if(e>1||e<0)throw new Error(`Parameter '${n}' must be in percentage range (0 to 1). (${e})`);break;case"nonZero":if(e===0)throw new Error(`Parameter '${n}' must non-zero. (${e})`);break;case"bipolar":if(e>1||e<-1)throw new Error(`Parameter '${n}' must be in bipolar percentage range (-1 to 1). (${e})`);break}return!0},g0=(e,r="?")=>ae(e,"percentage",r),ke=(e,r="",n="?")=>{if(ae(e,r,n),!Number.isInteger(e))throw new Error(`Parameter ${n} is not an integer`)},p0=e=>Array.isArray(e)?e.find(r=>typeof r!="string")===void 0:!1,w0=(e,r="?")=>{if(!Array.isArray(e))throw new Error(`Parameter '${r}' is expected to be an array'`)},tn=(e,r)=>(ke(e,"positive","timeoutMs"),e===0?new Promise(n=>requestAnimationFrame(i=>{n(r)})):new Promise(n=>setTimeout(()=>n(r),e))),Js=async function*(e,r){let n=!1;try{for(;!n;){if(await tn(r),n)return;if(typeof e=="function")yield await e();else if(typeof e=="object")if("next"in e&&"return"in e&&"throw"in e){const i=await e.next();if(i.done)return;yield i.value}else throw new Error("interval: produce param does not seem to be a generator?");else throw new Error("produce param does not seem to return a value/Promise and is not a generator?")}}finally{n=!0}},D0=async(e,r)=>(await tn(r),Promise.resolve(await e()));async function*E0(){let e,r=new Promise(a=>e=a),n=0;const i=()=>{e(),r=new Promise(a=>e=a)};try{for(;;)n=window.requestAnimationFrame(i),yield await r}finally{e(),window.cancelAnimationFrame(n)}}async function*$u(e){if(e===0)return yield*E0();let r,n=new Promise(u=>r=u),i=0;const a=()=>{r(),n=new Promise(u=>r=u)};try{for(;;)i=window.setTimeout(a,e),yield await n}finally{r(),window.clearTimeout(i)}}var b0={};ie(b0,{Async:()=>qu,Sync:()=>xs,count:()=>hv,delayLoop:()=>$u,interval:()=>Js,numericPercent:()=>dv,numericRange:()=>Zs,numericRangeRaw:()=>fv,pingPong:()=>Tu,pingPongPercent:()=>Ys});var Ys=function(e=.1,r,n,i,a){return r===void 0&&(r=0),n===void 0&&(n=1),i===void 0&&(i=r),ae(e,"bipolar","interval"),ae(n,"bipolar","end"),ae(i,"bipolar","offset"),ae(r,"bipolar","start"),Tu(e,r,n,i,a)},Tu=function*(e,r,n,i,a){if(r===void 0)throw new Error("Parameter 'lower' is undefined");if(e===void 0)throw new Error("Parameter 'interval' is undefined");if(n===void 0)throw new Error("Parameter 'upper' is undefined");if(a===void 0&&e<=1&&e>=0?a=10/e:a===void 0&&(a=1234),Number.isNaN(e))throw new Error("interval parameter is NaN");if(Number.isNaN(r))throw new Error("lower parameter is NaN");if(Number.isNaN(n))throw new Error("upper parameter is NaN");if(Number.isNaN(i))throw new Error("upper parameter is NaN");if(r>=n)throw new Error("lower must be less than upper");if(e===0)throw new Error("Interval cannot be zero");const u=n-r;if(Math.abs(e)>=u)throw new Error(`Interval should be between -${u} and ${u}`);let o=e>0;if(n=Math.floor(n*a),r=Math.floor(r*a),e=Math.floor(Math.abs(e*a)),e===0)throw new Error(`Interval is zero (rounding: ${a})`);if(i===void 0?i=r:i=Math.floor(i*a),i>n||i<r)throw new Error(`Start (${i/a}) must be within lower (${r/a}) and upper (${n/a})`);let s=i;yield s/a;let c=!0;for(;;)s=s+(o?e:-e),o&&s>=n?(o=!1,s=n,s===n&&c&&(s=r,o=!0)):!o&&s<=r&&(o=!0,s=r,s===r&&c&&(s=n,o=!1)),yield s/a,c=!1},qu={};ie(qu,{chunks:()=>A0,concat:()=>C0,dropWhile:()=>F0,equals:()=>S0,every:()=>_0,fill:()=>M0,filter:()=>I0,find:()=>R0,flatten:()=>B0,forEach:()=>P0,map:()=>N0,max:()=>z0,min:()=>W0,range:()=>O0,reduce:()=>k0,slice:()=>L0,some:()=>$0,takeWhile:()=>T0,toArray:()=>q0,unique:()=>j0,zip:()=>U0});async function*A0(e,r){let n=[];for await(const i of e)n.push(i),n.length===r&&(yield n,n=[]);n.length>0&&(yield n)}async function*C0(...e){for await(const r of e)yield*r}async function*F0(e,r){for await(const n of e)if(!r(n)){yield n;break}yield*e}async function S0(e,r,n){const i=e[Symbol.iterator](),a=r[Symbol.iterator]();for(;;){const u=await i.next(),o=await a.next();if(n!==void 0){if(!n(u.value,o.value))return!1}else if(u.value!==o.value)return!1;if(u.done||o.done)return u.done&&o.done}}async function _0(e,r){let n=!0;for await(const i of e)n=n&&r(i);return n}async function*M0(e,r){for await(const n of e)yield r}async function*I0(e,r){for await(const n of e)!r(n)||(yield n)}async function R0(e,r){for await(const n of e)if(r(n))return n}async function*B0(e){for await(const r of e)Symbol.asyncIterator in r?yield*r:yield r}async function P0(e,r){for await(const n of e)r(n)}async function*N0(e,r){for await(const n of e)yield r(n)}async function z0(e,r=(n,i)=>n>i){let n;for await(const i of e){if(!n){n=i;continue}n=r(n,i)?n:i}return n}async function W0(e,r=(n,i)=>n>i){let n;for await(const i of e){if(!n){n=i;continue}n=r(n,i)?i:n}return n}async function*O0(e,r){for(let n=0;n<r;n++)yield e++}async function k0(e,r,n){for await(const i of e)n=r(n,i);return n}async function*L0(e,r=0,n=Number.POSITIVE_INFINITY){const i=e[Symbol.asyncIterator]();for(;r>0;r--,n--)await i.next();for await(const a of e)if(n-- >0)yield a;else break}async function $0(e,r){for await(const n of e)if(r(n))return!0;return!1}async function*T0(e,r){for await(const n of e){if(!r(n))return;yield n}}async function q0(e,r=1/0){const n=[],i=e[Symbol.asyncIterator]();for(;n.length<r;){const{value:a,done:u}=await i.next();if(u)break;n.push(a)}return n}async function*j0(e,r=n=>n){const n=[];for await(const i of e){const a=r(i);n.indexOf(a)===-1&&(n.push(a),yield i)}}async function*U0(...e){const r=e.map(n=>n[Symbol.asyncIterator]());for(;;){const n=await Promise.all(r.map(i=>i.next()));if(n.some(i=>i.done))return;yield n.map(i=>i.value)}}var xs={};ie(xs,{chunks:()=>H0,chunksOverlapping:()=>V0,concat:()=>G0,dropWhile:()=>K0,equals:()=>J0,every:()=>Y0,fill:()=>x0,filter:()=>X0,find:()=>Q0,flatten:()=>ev,forEach:()=>Z0,map:()=>tv,max:()=>rv,min:()=>nv,range:()=>iv,reduce:()=>av,slice:()=>uv,some:()=>ov,takeWhile:()=>sv,unique:()=>cv,zip:()=>lv});function*V0(e,r){if(r<=1)throw new Error("Size should be at least 2");let n=[];for(const i of e)n.push(i),n.length===r&&(yield n,n=[n.at(-1)]);n.length<=1||n.length>0&&(yield n)}function*H0(e,r){let n=[];for(const i of e)n.push(i),n.length===r&&(yield n,n=[]);n.length>0&&(yield n)}function*G0(...e){for(const r of e)yield*r}function*K0(e,r){for(const n of e)if(!r(n)){yield n;break}yield*e}function J0(e,r,n){for(;;){const i=e.next(),a=r.next();if(n!==void 0){if(!n(i.value,a.value))return!1}else if(i.value!==a.value)return!1;if(i.done||a.done)return i.done&&a.done}}function Y0(e,r){let n=!0;for(const i of e)n=n&&r(i);return n}function*x0(e,r){for(const n of e)yield r}function Z0(e,r){for(const n of e)r(n)}function*X0(e,r){for(const n of e)!r(n)||(yield n)}function Q0(e,r){for(const n of e)if(r(n))return n}function*ev(e){for(const r of e)Symbol.iterator in r?yield*r:yield r}function*tv(e,r){for(const n of e)yield r(n)}function rv(e,r=(n,i)=>n>i){let n;for(const i of e){if(!n){n=i;continue}n=r(n,i)?n:i}return n}function nv(e,r=(n,i)=>n>i){let n;for(const i of e){if(!n){n=i;continue}n=r(n,i)?i:n}return n}function*iv(e,r){for(let n=0;n<r;n++)yield e++}function av(e,r,n){for(const i of e)n=r(n,i);return n}function*uv(e,r=0,n=Number.POSITIVE_INFINITY){const i=e[Symbol.iterator]();for(;r>0;r--,n--)i.next();for(const a of e)if(n-- >0)yield a;else break}function ov(e,r){for(const n of e)if(r(n))return!0;return!1}function*sv(e,r){for(const n of e){if(!r(n))return;yield n}}function*cv(e,r=n=>n){const n=[];for(const i of e){const a=r(i);n.indexOf(a)===-1&&(n.push(a),yield i)}}function*lv(...e){const r=e.map(n=>n[Symbol.iterator]());for(;;){const n=r.map(i=>i.next());if(n.some(i=>i.done))return;yield n.map(i=>i.value)}}var fv=function*(e,r=0,n,i=!1){if(e<=0)throw new Error("Interval is expected to be above zero");n===void 0&&(n=Number.MAX_SAFE_INTEGER);let a=r;do for(;a<n;)yield a,a+=e;while(i)},Zs=function*(e,r=0,n,i=!1,a){ae(e,"nonZero");const u=e<0;if(n!==void 0){if(u&&r<n)throw new Error(`Interval of ${e} will never go from ${r} to ${n}`);if(!u&&r>n)throw new Error(`Interval of ${e} will never go from ${r} to ${n}`)}a=a??1e3,n===void 0?n=Number.MAX_SAFE_INTEGER:n*=a,e=e*a;do{let o=r*a;for(;!u&&o<=n||u&&o>=n;)yield o/a,o+=e}while(i)},hv=function*(e,r=0){if(ke(e,"","amount"),ke(r,"","offset"),e===0)return;let n=0;do e<0?yield-n+r:yield n+r;while(n++<Math.abs(e)-1)},dv=function(e=.01,r=!1,n=0,i=1){return ae(e,"percentage","interval"),ae(n,"percentage","start"),ae(i,"percentage","end"),Zs(e,n,i,r)},ju={};ie(ju,{StateMachine:()=>on,create:()=>pv,descriptionFromList:()=>Xs,drive:()=>Dv,fromList:()=>mv,fromListBidirectional:()=>gv});var vv=e=>Array.isArray(e)?!1:typeof e.expressions<"u",Xs=(...e)=>{const r={};for(let n=0;n<e.length;n++)n===e.length-1?r[e[n]]=null:r[e[n]]=e[n+1];return r},yv=(...e)=>{const r={};for(let n=0;n<e.length;n++)r[e[n]]=[];for(let n=0;n<e.length;n++){const i=r[e[n]];n===e.length-1?e.length>1?i.push(e[n-1]):r[e[n]]=null:(i.push(e[n+1]),n>0&&i.push(e[n-1]))}return r},mv=(...e)=>new on(e[0],Xs(...e)),gv=(...e)=>new on(e[0],yv(...e)),pv=(e,r,n={debug:!1})=>new on(e,r,n),Br,Ii,Pr,vn,Ri,Hr,Bi=class extends lr{constructor(e,r,n={debug:!1}){super();Oe(this,Br,void 0),Oe(this,Ii,void 0),Oe(this,Pr,void 0),Oe(this,vn,void 0),Oe(this,Ri,void 0),Oe(this,Hr,void 0);const[i,a]=Bi.validate(e,r);if(!i)throw new Error(a);Ce(this,Ri,e),Ce(this,Pr,r),Ce(this,Ii,n.debug??!1),Ce(this,Br,e),Ce(this,vn,!1),Ce(this,Hr,0)}get states(){return Object.keys(J(this,Pr))}static validate(e,r){const n=Object.keys(r),i=new Set,a=new Set;for(let s=0;s<n.length;s++){const c=n[s];if(i.has(c))return[!1,`Key ${c} is already used`];if(i.add(c),typeof n[s]!="string")return[!1,`Key[${s}] is not a string`];const l=r[c];if(l===void 0)return[!1,`Key ${c} value is undefined`];if(typeof l=="string"){if(a.add(l),l===c)return[!1,`Loop present for ${c}`]}else if(Array.isArray(l)){if(!p0(l))return[!1,`Key ${c} value is not an array of strings`];if(l.forEach(f=>a.add(f)),l.find(f=>f===c))return[!1,`Loop present for ${c}`]}else if(l!==null)return[!1,`Key ${c} has a value that is neither null, string or array`]}const o=Array.from(a).find(s=>!i.has(s));return o?[!1,`Potential state '${o}' does not exist as a top-level state`]:r[e]===void 0?[!1,`Initial state ${e} not present`]:[!0,""]}next(){const e=J(this,Pr)[J(this,Br)];if(e===null)return null;if(Array.isArray(e))if(typeof e[0]=="string")this.state=e[0];else throw new Error("Error in machine description. Potential state array does not contain strings");else if(typeof e=="string")this.state=e;else throw new Error("Error in machine description. Potential state is neither array nor string");return this.state}get isDone(){return J(this,vn)}reset(){Ce(this,vn,!1),Ce(this,Br,J(this,Ri)),Ce(this,Hr,Date.now())}static isValid(e,r,n){if(n[r]===void 0)return[!1,`Machine cannot change to non-existent state ${r}`];const i=n[e];if(Array.isArray(i)){if(!i.includes(r))return[!1,`Machine cannot change '${e} -> ${r}'. Allowed transitions: ${i.join(", ")}`]}else if(r!==i&&i!=="*")return[!1,`Machine cannot '${e} -> ${r}'. Allowed transition: ${i}`];return[!0,"ok"]}isValid(e){return Bi.isValid(this.state,e,J(this,Pr))}set state(e){const r=J(this,Br);if(e===r)return;const[n,i]=Bi.isValid(r,e,J(this,Pr));if(!n)throw new Error(i);J(this,Ii)&&console.log(`StateMachine: ${r} -> ${e}`),Ce(this,Br,e),J(this,Pr)[e]===null&&Ce(this,vn,!0),Ce(this,Hr,Date.now()),setTimeout(()=>{this.fireEvent("change",{newState:e,priorState:r}),this.isDone&&this.fireEvent("stop",{state:e})},1)}get state(){return J(this,Br)}get changedAt(){return J(this,Hr)}get elapsed(){return Date.now()-J(this,Hr)}},on=Bi;Br=new WeakMap;Ii=new WeakMap;Pr=new WeakMap;vn=new WeakMap;Ri=new WeakMap;Hr=new WeakMap;var wv=e=>{const r=e.select??"first",n=Array.isArray(e.expressions)?e.expressions:[e.expressions];return{select:r,expressions:n,tryAll:e.tryAll??!0}},vs=(e=[])=>{const r=e.filter(n=>n!==void 0);return r.sort((n,i)=>{const a=n.score??0,u=i.score??0;return a===u?0:a>u?-1:1}),r},Dv=(e,r)=>{const n="first",i={};for(const c of Object.keys(r)){const l=r[c];vv(l)?i[c]=wv(l):Array.isArray(l)?i[c]={select:n,expressions:l,tryAll:!0}:i[c]={select:n,tryAll:!0,expressions:[l]}}const a=c=>{try{if(typeof c.next!==void 0&&c.next)e.next();else if(typeof c.state!==void 0)e.state=c.state;else if(typeof c.reset!==void 0&&c.reset)e.reset();else throw new Error("Result has neither 'reset', 'next' nor 'state' properties needed to drive state machine");return!0}catch(l){return console.warn(l),!1}},u=(c,l)=>{for(const f of l){if(a(f))return!0;if(!c.tryAll)break}return!1},o=(c,l)=>{if(!c)return!1;let f=!1;switch(c.select){case"first":for(const h of c.expressions){const g=h(l);if(!!g&&a(g)){f=!0;break}}break;case"highest":f=u(c,[...vs(c.expressions.map(h=>h(l)))]);break;case"lowest":f=u(c,[...vs(c.expressions.map(h=>h(l)))].reverse());break;default:throw new Error(`Unknown select type: ${c.select}. Expected first, highest or lowest`)}return f};return c=>{let l=i[e.state];!l&&e.isDone,l||(l=i.__default);let f=o(l,c);f||(l=i.__fallback,f=o(l,c))}},Ev={};ie(Ev,{StateMachine:()=>ju,completionMs:()=>tc,continuously:()=>Uu,debounce:()=>Cv,delay:()=>D0,delayLoop:()=>$u,everyNth:()=>Sv,forEach:()=>uc,forEachAsync:()=>oc,frequencyTimer:()=>Fr,frequencyTimerSource:()=>rc,hasElapsedMs:()=>ec,interval:()=>Js,msElapsedTimer:()=>fr,relativeTimer:()=>sn,relativeTimerMs:()=>nc,relativeTimerTicks:()=>ic,repeat:()=>Hu,repeatReduce:()=>_v,sleep:()=>tn,throttle:()=>Fv,ticksElapsedTimer:()=>oa,timeout:()=>ac,updateOutdated:()=>bv,waitFor:()=>Vu});var Qs={};ie(Qs,{completionMs:()=>tc,frequencyTimer:()=>Fr,frequencyTimerSource:()=>rc,hasElapsedMs:()=>ec,msElapsedTimer:()=>fr,relativeTimer:()=>sn,relativeTimerMs:()=>nc,relativeTimerTicks:()=>ic,ticksElapsedTimer:()=>oa});var Gt=(e,r=0,n=1)=>{if(Number.isNaN(e))throw new Error("v parameter is NaN");if(Number.isNaN(r))throw new Error("min parameter is NaN");if(Number.isNaN(n))throw new Error("max parameter is NaN");return e<r?r:e>n?n:e},au=(e,r)=>{if(!Number.isInteger(e))throw new Error(`v parameter must be an integer (${e})`);const n=Array.isArray(r)?r.length:r;if(!Number.isInteger(n))throw new Error(`length parameter must be an integer (${n}, ${typeof n})`);return e=Math.round(e),e<0?0:e>=n?n-1:e};function ec(e){const r=sn(e,fr());return()=>r.isDone}function tc(e){const r=sn(e,fr());return()=>r.elapsed}var rc=e=>()=>Fr(e,fr()),sn=(e,r,n=!0)=>{let i=!1,a=1;return{mod(u){a=u},get isDone(){return i},reset:()=>{i=!1,r.reset()},get elapsed(){let u=r.elapsed/(e*a);return n&&(u=Gt(u)),u>=1&&(i=!0),u}}},nc=(e,r=!0)=>sn(e,fr(),r),ic=(e,r=!0)=>sn(e,oa(),r),Fr=(e,r=fr())=>{const n=e/1e3;let i=1;return{mod:a=>{i=a},reset:()=>{r.reset()},get elapsed(){const a=r.elapsed*(n*i),u=a-Math.floor(a);if(u<0)throw new Error(`Unexpected cycle fraction less than 0. Elapsed: ${a} f: ${u}`);if(u>1)throw new Error(`Unexpected cycle fraction more than 1. Elapsed: ${a} f: ${u}`);return u}}},fr=()=>{let e=performance.now();return{reset:()=>{e=performance.now()},get elapsed(){return performance.now()-e}}},oa=()=>{let e=0;return{reset:()=>{e=0},get elapsed(){return++e}}},ac=(e,r)=>{if(e===void 0)throw new Error("callback parameter is undefined");ke(r,"aboveZero","timeoutMs");let n=0,i=0;const a=async(o=r,s)=>new Promise((l,f)=>{i=performance.now();try{ke(o,"aboveZero","altTimeoutMs")}catch(h){f(h);return}n!==0&&u(),n=window.setTimeout(async()=>{await e(performance.now()-i,...s),n=0,l(void 0)},o)}),u=()=>{n!==0&&(i=0,window.clearTimeout(n))};return{start:a,cancel:u,get isDone(){return n!==0}}},bv=(e,r,n="slow")=>{let i=0,a,u=r;return()=>new Promise(async(o,s)=>{const c=performance.now()-i;if(a===void 0||c>u)try{i=performance.now(),a=await e(c),u=r}catch(l){n==="fast"?(a=void 0,i=0):n==="backoff"&&(u=Math.floor(u*1.2)),s(l);return}o(a)})},Av=typeof window<"u"?e=>window.requestAnimationFrame(e):e=>setTimeout(e,1),Uu=(e,r,n)=>{r!==void 0&&ke(r,"positive","intervalMs");let i=!1,a=0,u=performance.now(),o=r===void 0?0:r;const s=o===0?Av:h=>setTimeout(h,o),c=()=>{!i||(i=!1,a=0)},l=async()=>{if(!i)return;const h=e(a++,performance.now()-u);let g;if(typeof h=="object"?g=await h:g=h,g!==void 0&&!g){c();return}s(l)};return{start:()=>{if(i&&n!==void 0){const h=n(a,performance.now()-u);if(u=performance.now(),h!==void 0&&!h){c();return}}else if(i)return;i=!0,s(l)},get intervalMs(){return o},set intervalMs(h){ke(h,"positive","ms"),o=h},get isDone(){return!i},get ticks(){return a},get elapsedMs(){return performance.now()-u},cancel:c}},Cv=(e,r)=>{const n=ac(e,r);return(...i)=>n.start(void 0,i)},Fv=(e,r)=>{let n=0;return async(...i)=>{const a=performance.now()-n;if(a>=r){const u=e(a,...i);typeof u=="object"&&await u,n=performance.now()}}},Vu=(e,r,n)=>{let i=!1;const a=o=>{u!==0&&(window.clearTimeout(u),u=0),o?r(o):i=!0,n!==void 0&&n(i)};let u=window.setTimeout(()=>{u=0;try{r(`Timeout after ${e}ms`)}finally{n!==void 0&&n(i)}},e);return a},Sv=(e,r)=>{ke(e,"positive","nth");let n=0;return(...i)=>++n===e?(n=0,r&&r(...i),!0):!1},uc=(e,r)=>{for(const n of e){const i=r(n);if(typeof i=="boolean"&&!i)break}},oc=async function(e,r,n){if(Array.isArray(e))for(const i of e){const a=await r(i);if(n&&await tn(n),typeof a=="boolean"&&!a)break}else for await(const i of e){const a=await r(i);if(n&&await tn(n),typeof a=="boolean"&&!a)break}},Hu=(e,r)=>{let n,i;n=i=0;const a=[];if(typeof e=="number")for(ae(e,"positive","countOrPredicate");e-- >0;){n++;const u=r();u!==void 0&&(a.push(u),i++)}else for(;e(n,i);){n++;const u=r();u!==void 0&&(a.push(u),i++)}return a},_v=(e,r,n,i)=>{if(typeof e=="number")for(ae(e,"positive","countOrPredicate");e-- >0;){const a=r();a!==void 0&&(n=i(n,a))}else{let a,u;for(a=u=0;e(a,u);){a++;const o=r();o!==void 0&&(n=i(n,o),u++)}}return n};try{typeof window<"u"&&(window.ixfx={...window.ixfx,Flow:{StateMachine:ju,Timer:Qs,forEach:uc,forEachAsync:oc,repeat:Hu}})}catch{}var Jt=Ze({"node_modules/fp-ts/lib/function.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getEndomorphismMonoid=e.not=e.SK=e.hole=e.pipe=e.untupled=e.tupled=e.absurd=e.decrement=e.increment=e.tuple=e.flow=e.flip=e.constVoid=e.constUndefined=e.constNull=e.constFalse=e.constTrue=e.constant=e.unsafeCoerce=e.identity=e.apply=e.getRing=e.getSemiring=e.getMonoid=e.getSemigroup=e.getBooleanAlgebra=void 0;var r=function(_){return function(){return{meet:function(I,P){return function(V){return _.meet(I(V),P(V))}},join:function(I,P){return function(V){return _.join(I(V),P(V))}},zero:function(){return _.zero},one:function(){return _.one},implies:function(I,P){return function(V){return _.implies(I(V),P(V))}},not:function(I){return function(P){return _.not(I(P))}}}}};e.getBooleanAlgebra=r;var n=function(_){return function(){return{concat:function(I,P){return function(V){return _.concat(I(V),P(V))}}}}};e.getSemigroup=n;var i=function(_){var I=(0,e.getSemigroup)(_);return function(){return{concat:I().concat,empty:function(){return _.empty}}}};e.getMonoid=i;var a=function(_){return{add:function(I,P){return function(V){return _.add(I(V),P(V))}},zero:function(){return _.zero},mul:function(I,P){return function(V){return _.mul(I(V),P(V))}},one:function(){return _.one}}};e.getSemiring=a;var u=function(_){var I=(0,e.getSemiring)(_);return{add:I.add,mul:I.mul,one:I.one,zero:I.zero,sub:function(P,V){return function(ue){return _.sub(P(ue),V(ue))}}}};e.getRing=u;var o=function(_){return function(I){return I(_)}};e.apply=o;function s(_){return _}e.identity=s,e.unsafeCoerce=s;function c(_){return function(){return _}}e.constant=c,e.constTrue=c(!0),e.constFalse=c(!1),e.constNull=c(null),e.constUndefined=c(void 0),e.constVoid=e.constUndefined;function l(_){return function(I,P){return _(P,I)}}e.flip=l;function f(_,I,P,V,ue,ee,pe,be,T){switch(arguments.length){case 1:return _;case 2:return function(){return I(_.apply(this,arguments))};case 3:return function(){return P(I(_.apply(this,arguments)))};case 4:return function(){return V(P(I(_.apply(this,arguments))))};case 5:return function(){return ue(V(P(I(_.apply(this,arguments)))))};case 6:return function(){return ee(ue(V(P(I(_.apply(this,arguments))))))};case 7:return function(){return pe(ee(ue(V(P(I(_.apply(this,arguments)))))))};case 8:return function(){return be(pe(ee(ue(V(P(I(_.apply(this,arguments))))))))};case 9:return function(){return T(be(pe(ee(ue(V(P(I(_.apply(this,arguments)))))))))}}}e.flow=f;function h(){for(var _=[],I=0;I<arguments.length;I++)_[I]=arguments[I];return _}e.tuple=h;function g(_){return _+1}e.increment=g;function C(_){return _-1}e.decrement=C;function R(_){throw new Error("Called `absurd` function which should be uncallable")}e.absurd=R;function k(_){return function(I){return _.apply(void 0,I)}}e.tupled=k;function z(_){return function(){for(var I=[],P=0;P<arguments.length;P++)I[P]=arguments[P];return _(I)}}e.untupled=z;function A(_,I,P,V,ue,ee,pe,be,T){switch(arguments.length){case 1:return _;case 2:return I(_);case 3:return P(I(_));case 4:return V(P(I(_)));case 5:return ue(V(P(I(_))));case 6:return ee(ue(V(P(I(_)))));case 7:return pe(ee(ue(V(P(I(_))))));case 8:return be(pe(ee(ue(V(P(I(_)))))));case 9:return T(be(pe(ee(ue(V(P(I(_))))))));default:{for(var q=arguments[0],G=1;G<arguments.length;G++)q=arguments[G](q);return q}}}e.pipe=A,e.hole=R;var S=function(_,I){return I};e.SK=S;function O(_){return function(I){return!_(I)}}e.not=O;var $=function(){return{concat:function(_,I){return f(_,I)},empty:s}};e.getEndomorphismMonoid=$}}),kr=Ze({"node_modules/fp-ts/lib/internal.js"(e){var r=e&&e.__spreadArray||function(R,k,z){if(z||arguments.length===2)for(var A=0,S=k.length,O;A<S;A++)(O||!(A in k))&&(O||(O=Array.prototype.slice.call(k,0,A)),O[A]=k[A]);return R.concat(O||Array.prototype.slice.call(k))};Object.defineProperty(e,"__esModule",{value:!0}),e.fromReadonlyNonEmptyArray=e.has=e.emptyRecord=e.emptyReadonlyArray=e.tail=e.head=e.isNonEmpty=e.singleton=e.right=e.left=e.isRight=e.isLeft=e.some=e.none=e.isSome=e.isNone=void 0;var n=function(R){return R._tag==="None"};e.isNone=n;var i=function(R){return R._tag==="Some"};e.isSome=i,e.none={_tag:"None"};var a=function(R){return{_tag:"Some",value:R}};e.some=a;var u=function(R){return R._tag==="Left"};e.isLeft=u;var o=function(R){return R._tag==="Right"};e.isRight=o;var s=function(R){return{_tag:"Left",left:R}};e.left=s;var c=function(R){return{_tag:"Right",right:R}};e.right=c;var l=function(R){return[R]};e.singleton=l;var f=function(R){return R.length>0};e.isNonEmpty=f;var h=function(R){return R[0]};e.head=h;var g=function(R){return R.slice(1)};e.tail=g,e.emptyReadonlyArray=[],e.emptyRecord={},e.has=Object.prototype.hasOwnProperty;var C=function(R){return r([R[0]],R.slice(1),!0)};e.fromReadonlyNonEmptyArray=C}}),sa=Ze({"node_modules/fp-ts/lib/Apply.js"(e){var r=e&&e.__createBinding||(Object.create?function(A,S,O,$){$===void 0&&($=O);var _=Object.getOwnPropertyDescriptor(S,O);(!_||("get"in _?!S.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return S[O]}}),Object.defineProperty(A,$,_)}:function(A,S,O,$){$===void 0&&($=O),A[$]=S[O]}),n=e&&e.__setModuleDefault||(Object.create?function(A,S){Object.defineProperty(A,"default",{enumerable:!0,value:S})}:function(A,S){A.default=S}),i=e&&e.__importStar||function(A){if(A&&A.__esModule)return A;var S={};if(A!=null)for(var O in A)O!=="default"&&Object.prototype.hasOwnProperty.call(A,O)&&r(S,A,O);return n(S,A),S};Object.defineProperty(e,"__esModule",{value:!0}),e.sequenceS=e.sequenceT=e.getApplySemigroup=e.apS=e.apSecond=e.apFirst=e.ap=void 0;var a=Jt(),u=i(kr());function o(A,S){return function(O){return function($){return A.ap(A.map($,function(_){return function(I){return S.ap(_,I)}}),O)}}}e.ap=o;function s(A){return function(S){return function(O){return A.ap(A.map(O,function($){return function(){return $}}),S)}}}e.apFirst=s;function c(A){return function(S){return function(O){return A.ap(A.map(O,function(){return function($){return $}}),S)}}}e.apSecond=c;function l(A){return function(S,O){return function($){return A.ap(A.map($,function(_){return function(I){var P;return Object.assign({},_,(P={},P[S]=I,P))}}),O)}}}e.apS=l;function f(A){return function(S){return{concat:function(O,$){return A.ap(A.map(O,function(_){return function(I){return S.concat(_,I)}}),$)}}}}e.getApplySemigroup=f;function h(A,S,O){return function($){for(var _=Array(O.length+1),I=0;I<O.length;I++)_[I]=O[I];return _[O.length]=$,S===0?A.apply(null,_):h(A,S-1,_)}}var g={1:function(A){return[A]},2:function(A){return function(S){return[A,S]}},3:function(A){return function(S){return function(O){return[A,S,O]}}},4:function(A){return function(S){return function(O){return function($){return[A,S,O,$]}}}},5:function(A){return function(S){return function(O){return function($){return function(_){return[A,S,O,$,_]}}}}}};function C(A){return u.has.call(g,A)||(g[A]=h(a.tuple,A-1,[])),g[A]}function R(A){return function(){for(var S=[],O=0;O<arguments.length;O++)S[O]=arguments[O];for(var $=S.length,_=C($),I=A.map(S[0],_),P=1;P<$;P++)I=A.ap(I,S[P]);return I}}e.sequenceT=R;function k(A){var S=A.length;switch(S){case 1:return function(O){var $;return $={},$[A[0]]=O,$};case 2:return function(O){return function($){var _;return _={},_[A[0]]=O,_[A[1]]=$,_}};case 3:return function(O){return function($){return function(_){var I;return I={},I[A[0]]=O,I[A[1]]=$,I[A[2]]=_,I}}};case 4:return function(O){return function($){return function(_){return function(I){var P;return P={},P[A[0]]=O,P[A[1]]=$,P[A[2]]=_,P[A[3]]=I,P}}}};case 5:return function(O){return function($){return function(_){return function(I){return function(P){var V;return V={},V[A[0]]=O,V[A[1]]=$,V[A[2]]=_,V[A[3]]=I,V[A[4]]=P,V}}}}};default:return h(function(){for(var O=[],$=0;$<arguments.length;$++)O[$]=arguments[$];for(var _={},I=0;I<S;I++)_[A[I]]=O[I];return _},S-1,[])}}function z(A){return function(S){for(var O=Object.keys(S),$=O.length,_=k(O),I=A.map(S[O[0]],_),P=1;P<$;P++)I=A.ap(I,S[O[P]]);return I}}e.sequenceS=z}}),hi=Ze({"node_modules/fp-ts/lib/Chain.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.bind=e.chainFirst=void 0;function r(i){return function(a){return function(u){return i.chain(u,function(o){return i.map(a(o),function(){return o})})}}}e.chainFirst=r;function n(i){return function(a,u){return function(o){return i.chain(o,function(s){return i.map(u(s),function(c){var l;return Object.assign({},s,(l={},l[a]=c,l))})})}}}e.bind=n}}),sc=Ze({"node_modules/fp-ts/lib/FromEither.js"(e){var r=e&&e.__createBinding||(Object.create?function(k,z,A,S){S===void 0&&(S=A);var O=Object.getOwnPropertyDescriptor(z,A);(!O||("get"in O?!z.__esModule:O.writable||O.configurable))&&(O={enumerable:!0,get:function(){return z[A]}}),Object.defineProperty(k,S,O)}:function(k,z,A,S){S===void 0&&(S=A),k[S]=z[A]}),n=e&&e.__setModuleDefault||(Object.create?function(k,z){Object.defineProperty(k,"default",{enumerable:!0,value:z})}:function(k,z){k.default=z}),i=e&&e.__importStar||function(k){if(k&&k.__esModule)return k;var z={};if(k!=null)for(var A in k)A!=="default"&&Object.prototype.hasOwnProperty.call(k,A)&&r(z,k,A);return n(z,k),z};Object.defineProperty(e,"__esModule",{value:!0}),e.filterOrElse=e.chainFirstEitherK=e.chainEitherK=e.fromEitherK=e.chainOptionK=e.fromOptionK=e.fromPredicate=e.fromOption=void 0;var a=hi(),u=Jt(),o=i(kr());function s(k){return function(z){return function(A){return k.fromEither(o.isNone(A)?o.left(z()):o.right(A.value))}}}e.fromOption=s;function c(k){return function(z,A){return function(S){return k.fromEither(z(S)?o.right(S):o.left(A(S)))}}}e.fromPredicate=c;function l(k){var z=s(k);return function(A){var S=z(A);return function(O){return(0,u.flow)(O,S)}}}e.fromOptionK=l;function f(k,z){var A=l(k);return function(S){var O=A(S);return function($){return function(_){return z.chain(_,O($))}}}}e.chainOptionK=f;function h(k){return function(z){return(0,u.flow)(z,k.fromEither)}}e.fromEitherK=h;function g(k,z){var A=h(k);return function(S){return function(O){return z.chain(O,A(S))}}}e.chainEitherK=g;function C(k,z){return(0,u.flow)(h(k),(0,a.chainFirst)(z))}e.chainFirstEitherK=C;function R(k,z){return function(A,S){return function(O){return z.chain(O,function($){return k.fromEither(A($)?o.right($):o.left(S($)))})}}}e.filterOrElse=R}}),di=Ze({"node_modules/fp-ts/lib/Functor.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getFunctorComposition=e.bindTo=e.flap=e.map=void 0;var r=Jt();function n(o,s){return function(c){return function(l){return o.map(l,function(f){return s.map(f,c)})}}}e.map=n;function i(o){return function(s){return function(c){return o.map(c,function(l){return l(s)})}}}e.flap=i;function a(o){return function(s){return function(c){return o.map(c,function(l){var f;return f={},f[s]=l,f})}}}e.bindTo=a;function u(o,s){var c=n(o,s);return{map:function(l,f){return(0,r.pipe)(l,c(f))}}}e.getFunctorComposition=u}}),Gu=Ze({"node_modules/fp-ts/lib/Eq.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.eqDate=e.eqNumber=e.eqString=e.eqBoolean=e.eq=e.strictEqual=e.getStructEq=e.getTupleEq=e.Contravariant=e.getMonoid=e.getSemigroup=e.eqStrict=e.URI=e.contramap=e.tuple=e.struct=e.fromEquals=void 0;var r=Jt(),n=function(f){return{equals:function(h,g){return h===g||f(h,g)}}};e.fromEquals=n;var i=function(f){return(0,e.fromEquals)(function(h,g){for(var C in f)if(!f[C].equals(h[C],g[C]))return!1;return!0})};e.struct=i;var a=function(){for(var f=[],h=0;h<arguments.length;h++)f[h]=arguments[h];return(0,e.fromEquals)(function(g,C){return f.every(function(R,k){return R.equals(g[k],C[k])})})};e.tuple=a;var u=function(f,h){return(0,r.pipe)(f,(0,e.contramap)(h))},o=function(f){return function(h){return(0,e.fromEquals)(function(g,C){return h.equals(f(g),f(C))})}};e.contramap=o,e.URI="Eq",e.eqStrict={equals:function(f,h){return f===h}};var s={equals:function(){return!0}},c=function(){return{concat:function(f,h){return(0,e.fromEquals)(function(g,C){return f.equals(g,C)&&h.equals(g,C)})}}};e.getSemigroup=c;var l=function(){return{concat:(0,e.getSemigroup)().concat,empty:s}};e.getMonoid=l,e.Contravariant={URI:e.URI,contramap:u},e.getTupleEq=e.tuple,e.getStructEq=e.struct,e.strictEqual=e.eqStrict.equals,e.eq=e.Contravariant,e.eqBoolean=e.eqStrict,e.eqString=e.eqStrict,e.eqNumber=e.eqStrict,e.eqDate={equals:function(f,h){return f.valueOf()===h.valueOf()}}}}),vi=Ze({"node_modules/fp-ts/lib/Ord.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ordDate=e.ordNumber=e.ordString=e.ordBoolean=e.ord=e.getDualOrd=e.getTupleOrd=e.between=e.clamp=e.max=e.min=e.geq=e.leq=e.gt=e.lt=e.equals=e.trivial=e.Contravariant=e.getMonoid=e.getSemigroup=e.URI=e.contramap=e.reverse=e.tuple=e.fromCompare=e.equalsDefault=void 0;var r=Gu(),n=Jt(),i=function(I){return function(P,V){return P===V||I(P,V)===0}};e.equalsDefault=i;var a=function(I){return{equals:(0,e.equalsDefault)(I),compare:function(P,V){return P===V?0:I(P,V)}}};e.fromCompare=a;var u=function(){for(var I=[],P=0;P<arguments.length;P++)I[P]=arguments[P];return(0,e.fromCompare)(function(V,ue){for(var ee=0;ee<I.length-1;ee++){var pe=I[ee].compare(V[ee],ue[ee]);if(pe!==0)return pe}return I[ee].compare(V[ee],ue[ee])})};e.tuple=u;var o=function(I){return(0,e.fromCompare)(function(P,V){return I.compare(V,P)})};e.reverse=o;var s=function(I,P){return(0,n.pipe)(I,(0,e.contramap)(P))},c=function(I){return function(P){return(0,e.fromCompare)(function(V,ue){return P.compare(I(V),I(ue))})}};e.contramap=c,e.URI="Ord";var l=function(){return{concat:function(I,P){return(0,e.fromCompare)(function(V,ue){var ee=I.compare(V,ue);return ee!==0?ee:P.compare(V,ue)})}}};e.getSemigroup=l;var f=function(){return{concat:(0,e.getSemigroup)().concat,empty:(0,e.fromCompare)(function(){return 0})}};e.getMonoid=f,e.Contravariant={URI:e.URI,contramap:s},e.trivial={equals:n.constTrue,compare:(0,n.constant)(0)};var h=function(I){return function(P){return function(V){return V===P||I.compare(V,P)===0}}};e.equals=h;var g=function(I){return function(P,V){return I.compare(P,V)===-1}};e.lt=g;var C=function(I){return function(P,V){return I.compare(P,V)===1}};e.gt=C;var R=function(I){return function(P,V){return I.compare(P,V)!==1}};e.leq=R;var k=function(I){return function(P,V){return I.compare(P,V)!==-1}};e.geq=k;var z=function(I){return function(P,V){return P===V||I.compare(P,V)<1?P:V}};e.min=z;var A=function(I){return function(P,V){return P===V||I.compare(P,V)>-1?P:V}};e.max=A;var S=function(I){var P=(0,e.min)(I),V=(0,e.max)(I);return function(ue,ee){return function(pe){return V(P(pe,ee),ue)}}};e.clamp=S;var O=function(I){var P=(0,e.lt)(I),V=(0,e.gt)(I);return function(ue,ee){return function(pe){return!(P(pe,ue)||V(pe,ee))}}};e.between=O,e.getTupleOrd=e.tuple,e.getDualOrd=e.reverse,e.ord=e.Contravariant;function $(I,P){return I<P?-1:I>P?1:0}var _={equals:r.eqStrict.equals,compare:$};e.ordBoolean=_,e.ordString=_,e.ordNumber=_,e.ordDate=(0,n.pipe)(e.ordNumber,(0,e.contramap)(function(I){return I.valueOf()}))}}),Mv=Ze({"node_modules/fp-ts/lib/Magma.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.concatAll=e.endo=e.filterSecond=e.filterFirst=e.reverse=void 0;var r=function(o){return{concat:function(s,c){return o.concat(c,s)}}};e.reverse=r;var n=function(o){return function(s){return{concat:function(c,l){return o(c)?s.concat(c,l):l}}}};e.filterFirst=n;var i=function(o){return function(s){return{concat:function(c,l){return o(l)?s.concat(c,l):c}}}};e.filterSecond=i;var a=function(o){return function(s){return{concat:function(c,l){return s.concat(o(c),o(l))}}}};e.endo=a;var u=function(o){return function(s){return function(c){return c.reduce(function(l,f){return o.concat(l,f)},s)}}};e.concatAll=u}}),Iv=Ze({"node_modules/fp-ts/lib/Semigroup.js"(e){var r=e&&e.__createBinding||(Object.create?function(S,O,$,_){_===void 0&&(_=$);var I=Object.getOwnPropertyDescriptor(O,$);(!I||("get"in I?!O.__esModule:I.writable||I.configurable))&&(I={enumerable:!0,get:function(){return O[$]}}),Object.defineProperty(S,_,I)}:function(S,O,$,_){_===void 0&&(_=$),S[_]=O[$]}),n=e&&e.__setModuleDefault||(Object.create?function(S,O){Object.defineProperty(S,"default",{enumerable:!0,value:O})}:function(S,O){S.default=O}),i=e&&e.__importStar||function(S){if(S&&S.__esModule)return S;var O={};if(S!=null)for(var $ in S)$!=="default"&&Object.prototype.hasOwnProperty.call(S,$)&&r(O,S,$);return n(O,S),O};Object.defineProperty(e,"__esModule",{value:!0}),e.semigroupProduct=e.semigroupSum=e.semigroupString=e.getFunctionSemigroup=e.semigroupAny=e.semigroupAll=e.fold=e.getIntercalateSemigroup=e.getMeetSemigroup=e.getJoinSemigroup=e.getDualSemigroup=e.getStructSemigroup=e.getTupleSemigroup=e.getFirstSemigroup=e.getLastSemigroup=e.getObjectSemigroup=e.semigroupVoid=e.concatAll=e.last=e.first=e.intercalate=e.tuple=e.struct=e.reverse=e.constant=e.max=e.min=void 0;var a=Jt(),u=i(kr()),o=i(Mv()),s=i(vi()),c=function(S){return{concat:s.min(S)}};e.min=c;var l=function(S){return{concat:s.max(S)}};e.max=l;var f=function(S){return{concat:function(){return S}}};e.constant=f,e.reverse=o.reverse;var h=function(S){return{concat:function(O,$){var _={};for(var I in S)u.has.call(S,I)&&(_[I]=S[I].concat(O[I],$[I]));return _}}};e.struct=h;var g=function(){for(var S=[],O=0;O<arguments.length;O++)S[O]=arguments[O];return{concat:function($,_){return S.map(function(I,P){return I.concat($[P],_[P])})}}};e.tuple=g;var C=function(S){return function(O){return{concat:function($,_){return O.concat($,O.concat(S,_))}}}};e.intercalate=C;var R=function(){return{concat:a.identity}};e.first=R;var k=function(){return{concat:function(S,O){return O}}};e.last=k,e.concatAll=o.concatAll,e.semigroupVoid=(0,e.constant)(void 0);var z=function(){return{concat:function(S,O){return Object.assign({},S,O)}}};e.getObjectSemigroup=z,e.getLastSemigroup=e.last,e.getFirstSemigroup=e.first,e.getTupleSemigroup=e.tuple,e.getStructSemigroup=e.struct,e.getDualSemigroup=e.reverse,e.getJoinSemigroup=e.max,e.getMeetSemigroup=e.min,e.getIntercalateSemigroup=e.intercalate;function A(S){var O=(0,e.concatAll)(S);return function($,_){return _===void 0?O($):O($)(_)}}e.fold=A,e.semigroupAll={concat:function(S,O){return S&&O}},e.semigroupAny={concat:function(S,O){return S||O}},e.getFunctionSemigroup=a.getSemigroup,e.semigroupString={concat:function(S,O){return S+O}},e.semigroupSum={concat:function(S,O){return S+O}},e.semigroupProduct={concat:function(S,O){return S*O}}}}),Ku=Ze({"node_modules/fp-ts/lib/ReadonlyNonEmptyArray.js"(e){var r=e&&e.__createBinding||(Object.create?function(D,b,W,H){H===void 0&&(H=W);var ce=Object.getOwnPropertyDescriptor(b,W);(!ce||("get"in ce?!b.__esModule:ce.writable||ce.configurable))&&(ce={enumerable:!0,get:function(){return b[W]}}),Object.defineProperty(D,H,ce)}:function(D,b,W,H){H===void 0&&(H=W),D[H]=b[W]}),n=e&&e.__setModuleDefault||(Object.create?function(D,b){Object.defineProperty(D,"default",{enumerable:!0,value:b})}:function(D,b){D.default=b}),i=e&&e.__importStar||function(D){if(D&&D.__esModule)return D;var b={};if(D!=null)for(var W in D)W!=="default"&&Object.prototype.hasOwnProperty.call(D,W)&&r(b,D,W);return n(b,D),b},a=e&&e.__spreadArray||function(D,b,W){if(W||arguments.length===2)for(var H=0,ce=b.length,we;H<ce;H++)(we||!(H in b))&&(we||(we=Array.prototype.slice.call(b,0,H)),we[H]=b[H]);return D.concat(we||Array.prototype.slice.call(b))};Object.defineProperty(e,"__esModule",{value:!0}),e.reduceRight=e.foldMap=e.reduce=e.mapWithIndex=e.map=e.flatten=e.duplicate=e.extend=e.chain=e.ap=e.alt=e.altW=e.of=e.chunksOf=e.splitAt=e.chop=e.chainWithIndex=e.intersperse=e.prependAll=e.unzip=e.zip=e.zipWith=e.modifyAt=e.updateAt=e.sort=e.groupBy=e.group=e.reverse=e.concat=e.concatW=e.fromArray=e.unappend=e.unprepend=e.range=e.replicate=e.makeBy=e.fromReadonlyArray=e.rotate=e.union=e.sortBy=e.uniq=e.unsafeUpdateAt=e.unsafeInsertAt=e.append=e.appendW=e.prepend=e.prependW=e.isOutOfBound=e.isNonEmpty=e.empty=void 0,e.filterWithIndex=e.filter=e.groupSort=e.intercalate=e.updateLast=e.modifyLast=e.updateHead=e.modifyHead=e.matchRight=e.matchLeft=e.concatAll=e.max=e.min=e.init=e.last=e.tail=e.head=e.apS=e.bind=e.bindTo=e.Do=e.Comonad=e.Alt=e.TraversableWithIndex=e.Traversable=e.FoldableWithIndex=e.Foldable=e.Monad=e.chainFirst=e.Chain=e.Applicative=e.apSecond=e.apFirst=e.Apply=e.FunctorWithIndex=e.Pointed=e.flap=e.Functor=e.getUnionSemigroup=e.getEq=e.getSemigroup=e.getShow=e.URI=e.extract=e.traverseWithIndex=e.sequence=e.traverse=e.reduceRightWithIndex=e.foldMapWithIndex=e.reduceWithIndex=void 0,e.readonlyNonEmptyArray=e.fold=e.prependToAll=e.insertAt=e.snoc=e.cons=e.unsnoc=e.uncons=void 0;var u=sa(),o=hi(),s=Gu(),c=Jt(),l=di(),f=i(kr()),h=vi(),g=i(Iv());e.empty=f.emptyReadonlyArray,e.isNonEmpty=f.isNonEmpty;var C=function(D,b){return D<0||D>=b.length};e.isOutOfBound=C;var R=function(D){return function(b){return a([D],b,!0)}};e.prependW=R,e.prepend=e.prependW;var k=function(D){return function(b){return a(a([],b,!0),[D],!1)}};e.appendW=k,e.append=e.appendW;var z=function(D,b,W){if((0,e.isNonEmpty)(W)){var H=f.fromReadonlyNonEmptyArray(W);return H.splice(D,0,b),H}return[b]};e.unsafeInsertAt=z;var A=function(D,b,W){if(W[D]===b)return W;var H=f.fromReadonlyNonEmptyArray(W);return H[D]=b,H};e.unsafeUpdateAt=A;var S=function(D){return function(b){if(b.length===1)return b;for(var W=[(0,e.head)(b)],H=(0,e.tail)(b),ce=function(Ae){W.every(function(je){return!D.equals(je,Ae)})&&W.push(Ae)},we=0,qe=H;we<qe.length;we++){var Rt=qe[we];ce(Rt)}return W}};e.uniq=S;var O=function(D){if((0,e.isNonEmpty)(D)){var b=(0,h.getMonoid)();return(0,e.sort)(D.reduce(b.concat,b.empty))}return c.identity};e.sortBy=O;var $=function(D){var b=(0,e.uniq)(D);return function(W){return function(H){return b((0,c.pipe)(H,q(W)))}}};e.union=$;var _=function(D){return function(b){var W=b.length,H=Math.round(D)%W;if((0,e.isOutOfBound)(Math.abs(H),b)||H===0)return b;if(H<0){var ce=(0,e.splitAt)(-H)(b),we=ce[0],qe=ce[1];return(0,c.pipe)(qe,q(we))}else return(0,e.rotate)(H-W)(b)}};e.rotate=_;var I=function(D){return(0,e.isNonEmpty)(D)?f.some(D):f.none};e.fromReadonlyArray=I;var P=function(D){return function(b){for(var W=Math.max(0,Math.floor(b)),H=[D(0)],ce=1;ce<W;ce++)H.push(D(ce));return H}};e.makeBy=P;var V=function(D){return(0,e.makeBy)(function(){return D})};e.replicate=V;var ue=function(D,b){return D<=b?(0,e.makeBy)(function(W){return D+W})(b-D+1):[D]};e.range=ue;var ee=function(D){return[(0,e.head)(D),(0,e.tail)(D)]};e.unprepend=ee;var pe=function(D){return[(0,e.init)(D),(0,e.last)(D)]};e.unappend=pe;var be=function(D){return(0,e.fromReadonlyArray)(D.slice())};e.fromArray=be;function T(D){return function(b){return b.concat(D)}}e.concatW=T;function q(D,b){return b?D.concat(b):function(W){return W.concat(D)}}e.concat=q;var G=function(D){return D.length===1?D:a([(0,e.last)(D)],D.slice(0,-1).reverse(),!0)};e.reverse=G;function x(D){return function(b){var W=b.length;if(W===0)return e.empty;for(var H=[],ce=b[0],we=[ce],qe=1;qe<W;qe++){var Rt=b[qe];D.equals(Rt,ce)?we.push(Rt):(H.push(we),ce=Rt,we=[ce])}return H.push(we),H}}e.group=x;var ne=function(D){return function(b){for(var W={},H=0,ce=b;H<ce.length;H++){var we=ce[H],qe=D(we);f.has.call(W,qe)?W[qe].push(we):W[qe]=[we]}return W}};e.groupBy=ne;var Q=function(D){return function(b){return b.length===1?b:b.slice().sort(D.compare)}};e.sort=Q;var ye=function(D,b){return(0,e.modifyAt)(D,function(){return b})};e.updateAt=ye;var Fe=function(D,b){return function(W){return(0,e.isOutOfBound)(D,W)?f.none:f.some((0,e.unsafeUpdateAt)(D,b(W[D]),W))}};e.modifyAt=Fe;var Qe=function(D,b,W){for(var H=[W(D[0],b[0])],ce=Math.min(D.length,b.length),we=1;we<ce;we++)H[we]=W(D[we],b[we]);return H};e.zipWith=Qe;function ve(D,b){return b===void 0?function(W){return ve(W,D)}:(0,e.zipWith)(D,b,function(W,H){return[W,H]})}e.zip=ve;var ze=function(D){for(var b=[D[0][0]],W=[D[0][1]],H=1;H<D.length;H++)b[H]=D[H][0],W[H]=D[H][1];return[b,W]};e.unzip=ze;var vt=function(D){return function(b){for(var W=[D,b[0]],H=1;H<b.length;H++)W.push(D,b[H]);return W}};e.prependAll=vt;var Be=function(D){return function(b){var W=(0,e.tail)(b);return(0,e.isNonEmpty)(W)?(0,c.pipe)(W,(0,e.prependAll)(D),(0,e.prepend)((0,e.head)(b))):b}};e.intersperse=Be;var st=function(D){return function(b){for(var W=f.fromReadonlyNonEmptyArray(D(0,(0,e.head)(b))),H=1;H<b.length;H++)W.push.apply(W,D(H,b[H]));return W}};e.chainWithIndex=st;var Pt=function(D){return function(b){for(var W=D(b),H=W[0],ce=W[1],we=[H],qe=ce;(0,e.isNonEmpty)(qe);){var Rt=D(qe),Ae=Rt[0],je=Rt[1];we.push(Ae),qe=je}return we}};e.chop=Pt;var Xt=function(D){return function(b){var W=Math.max(1,D);return W>=b.length?[b,e.empty]:[(0,c.pipe)(b.slice(1,W),(0,e.prepend)((0,e.head)(b))),b.slice(W)]}};e.splitAt=Xt;var dr=function(D){return(0,e.chop)((0,e.splitAt)(D))};e.chunksOf=dr;var Ke=function(D,b){return(0,c.pipe)(D,(0,e.map)(b))},De=function(D,b){return(0,c.pipe)(D,(0,e.mapWithIndex)(b))},ct=function(D,b){return(0,c.pipe)(D,(0,e.ap)(b))},Me=function(D,b){return(0,c.pipe)(D,(0,e.chain)(b))},Je=function(D,b){return(0,c.pipe)(D,(0,e.extend)(b))},lt=function(D,b,W){return(0,c.pipe)(D,(0,e.reduce)(b,W))},$e=function(D){var b=(0,e.foldMap)(D);return function(W,H){return(0,c.pipe)(W,b(H))}},Pe=function(D,b,W){return(0,c.pipe)(D,(0,e.reduceRight)(b,W))},Se=function(D){var b=(0,e.traverse)(D);return function(W,H){return(0,c.pipe)(W,b(H))}},At=function(D,b){return(0,c.pipe)(D,(0,e.alt)(b))},yt=function(D,b,W){return(0,c.pipe)(D,(0,e.reduceWithIndex)(b,W))},Nt=function(D){var b=(0,e.foldMapWithIndex)(D);return function(W,H){return(0,c.pipe)(W,b(H))}},Ct=function(D,b,W){return(0,c.pipe)(D,(0,e.reduceRightWithIndex)(b,W))},fe=function(D){var b=(0,e.traverseWithIndex)(D);return function(W,H){return(0,c.pipe)(W,b(H))}};e.of=f.singleton;var he=function(D){return function(b){return(0,c.pipe)(b,T(D()))}};e.altW=he,e.alt=e.altW;var zt=function(D){return(0,e.chain)(function(b){return(0,c.pipe)(D,(0,e.map)(b))})};e.ap=zt;var ft=function(D){return(0,e.chainWithIndex)(function(b,W){return D(W)})};e.chain=ft;var me=function(D){return function(b){for(var W=(0,e.tail)(b),H=[D(b)];(0,e.isNonEmpty)(W);)H.push(D(W)),W=(0,e.tail)(W);return H}};e.extend=me,e.duplicate=(0,e.extend)(c.identity),e.flatten=(0,e.chain)(c.identity);var Ft=function(D){return(0,e.mapWithIndex)(function(b,W){return D(W)})};e.map=Ft;var et=function(D){return function(b){for(var W=[D(0,(0,e.head)(b))],H=1;H<b.length;H++)W.push(D(H,b[H]));return W}};e.mapWithIndex=et;var j=function(D,b){return(0,e.reduceWithIndex)(D,function(W,H,ce){return b(H,ce)})};e.reduce=j;var Wt=function(D){return function(b){return function(W){return W.slice(1).reduce(function(H,ce){return D.concat(H,b(ce))},b(W[0]))}}};e.foldMap=Wt;var Ee=function(D,b){return(0,e.reduceRightWithIndex)(D,function(W,H,ce){return b(H,ce)})};e.reduceRight=Ee;var tt=function(D,b){return function(W){return W.reduce(function(H,ce,we){return b(we,H,ce)},D)}};e.reduceWithIndex=tt;var qt=function(D){return function(b){return function(W){return W.slice(1).reduce(function(H,ce,we){return D.concat(H,b(we+1,ce))},b(0,W[0]))}}};e.foldMapWithIndex=qt;var jt=function(D,b){return function(W){return W.reduceRight(function(H,ce,we){return b(we,ce,H)},D)}};e.reduceRightWithIndex=jt;var St=function(D){var b=(0,e.traverseWithIndex)(D);return function(W){return b(function(H,ce){return W(ce)})}};e.traverse=St;var _t=function(D){return(0,e.traverseWithIndex)(D)(c.SK)};e.sequence=_t;var Mt=function(D){return function(b){return function(W){for(var H=D.map(b(0,(0,e.head)(W)),e.of),ce=1;ce<W.length;ce++)H=D.ap(D.map(H,function(we){return function(qe){return(0,c.pipe)(we,(0,e.append)(qe))}}),b(ce,W[ce]));return H}}};e.traverseWithIndex=Mt,e.extract=f.head,e.URI="ReadonlyNonEmptyArray";var mt=function(D){return{show:function(b){return"[".concat(b.map(D.show).join(", "),"]")}}};e.getShow=mt;var de=function(){return{concat:q}};e.getSemigroup=de;var Te=function(D){return(0,s.fromEquals)(function(b,W){return b.length===W.length&&b.every(function(H,ce){return D.equals(H,W[ce])})})};e.getEq=Te;var Ve=function(D){var b=(0,e.union)(D);return{concat:function(W,H){return b(H)(W)}}};e.getUnionSemigroup=Ve,e.Functor={URI:e.URI,map:Ke},e.flap=(0,l.flap)(e.Functor),e.Pointed={URI:e.URI,of:e.of},e.FunctorWithIndex={URI:e.URI,map:Ke,mapWithIndex:De},e.Apply={URI:e.URI,map:Ke,ap:ct},e.apFirst=(0,u.apFirst)(e.Apply),e.apSecond=(0,u.apSecond)(e.Apply),e.Applicative={URI:e.URI,map:Ke,ap:ct,of:e.of},e.Chain={URI:e.URI,map:Ke,ap:ct,chain:Me},e.chainFirst=(0,o.chainFirst)(e.Chain),e.Monad={URI:e.URI,map:Ke,ap:ct,of:e.of,chain:Me},e.Foldable={URI:e.URI,reduce:lt,foldMap:$e,reduceRight:Pe},e.FoldableWithIndex={URI:e.URI,reduce:lt,foldMap:$e,reduceRight:Pe,reduceWithIndex:yt,foldMapWithIndex:Nt,reduceRightWithIndex:Ct},e.Traversable={URI:e.URI,map:Ke,reduce:lt,foldMap:$e,reduceRight:Pe,traverse:Se,sequence:e.sequence},e.TraversableWithIndex={URI:e.URI,map:Ke,mapWithIndex:De,reduce:lt,foldMap:$e,reduceRight:Pe,traverse:Se,sequence:e.sequence,reduceWithIndex:yt,foldMapWithIndex:Nt,reduceRightWithIndex:Ct,traverseWithIndex:fe},e.Alt={URI:e.URI,map:Ke,alt:At},e.Comonad={URI:e.URI,map:Ke,extend:Je,extract:e.extract},e.Do=(0,e.of)(f.emptyRecord),e.bindTo=(0,l.bindTo)(e.Functor),e.bind=(0,o.bind)(e.Chain),e.apS=(0,u.apS)(e.Apply),e.head=e.extract,e.tail=f.tail;var rt=function(D){return D[D.length-1]};e.last=rt;var gt=function(D){return D.slice(0,-1)};e.init=gt;var ht=function(D){var b=g.min(D);return function(W){return W.reduce(b.concat)}};e.min=ht;var It=function(D){var b=g.max(D);return function(W){return W.reduce(b.concat)}};e.max=It;var Ot=function(D){return function(b){return b.reduce(D.concat)}};e.concatAll=Ot;var Qt=function(D){return function(b){return D((0,e.head)(b),(0,e.tail)(b))}};e.matchLeft=Qt;var er=function(D){return function(b){return D((0,e.init)(b),(0,e.last)(b))}};e.matchRight=er;var d=function(D){return function(b){return a([D((0,e.head)(b))],(0,e.tail)(b),!0)}};e.modifyHead=d;var y=function(D){return(0,e.modifyHead)(function(){return D})};e.updateHead=y;var M=function(D){return function(b){return(0,c.pipe)((0,e.init)(b),(0,e.append)(D((0,e.last)(b))))}};e.modifyLast=M;var N=function(D){return(0,e.modifyLast)(function(){return D})};e.updateLast=N;var Y=function(D){var b=(0,e.concatAll)(D);return function(W){return(0,c.flow)((0,e.intersperse)(W),b)}};e.intercalate=Y;function te(D){var b=(0,e.sort)(D),W=x(D);return function(H){return(0,e.isNonEmpty)(H)?W(b(H)):e.empty}}e.groupSort=te;function oe(D){return(0,e.filterWithIndex)(function(b,W){return D(W)})}e.filter=oe;var Ne=function(D){return function(b){return(0,e.fromReadonlyArray)(b.filter(function(W,H){return D(H,W)}))}};e.filterWithIndex=Ne,e.uncons=e.unprepend,e.unsnoc=e.unappend;function Re(D,b){return b===void 0?(0,e.prepend)(D):(0,c.pipe)(b,(0,e.prepend)(D))}e.cons=Re;var nt=function(D,b){return(0,c.pipe)(D,q([b]))};e.snoc=nt;var pt=function(D,b){return function(W){return D<0||D>W.length?f.none:f.some((0,e.unsafeInsertAt)(D,b,W))}};e.insertAt=pt,e.prependToAll=e.prependAll,e.fold=e.concatAll,e.readonlyNonEmptyArray={URI:e.URI,of:e.of,map:Ke,mapWithIndex:De,ap:ct,chain:Me,extend:Je,extract:e.extract,reduce:lt,foldMap:$e,reduceRight:Pe,traverse:Se,sequence:e.sequence,reduceWithIndex:yt,foldMapWithIndex:Nt,reduceRightWithIndex:Ct,traverseWithIndex:fe,alt:At}}}),Rv=Ze({"node_modules/fp-ts/lib/NonEmptyArray.js"(e){var r=e&&e.__createBinding||(Object.create?function(d,y,M,N){N===void 0&&(N=M);var Y=Object.getOwnPropertyDescriptor(y,M);(!Y||("get"in Y?!y.__esModule:Y.writable||Y.configurable))&&(Y={enumerable:!0,get:function(){return y[M]}}),Object.defineProperty(d,N,Y)}:function(d,y,M,N){N===void 0&&(N=M),d[N]=y[M]}),n=e&&e.__setModuleDefault||(Object.create?function(d,y){Object.defineProperty(d,"default",{enumerable:!0,value:y})}:function(d,y){d.default=y}),i=e&&e.__importStar||function(d){if(d&&d.__esModule)return d;var y={};if(d!=null)for(var M in d)M!=="default"&&Object.prototype.hasOwnProperty.call(d,M)&&r(y,d,M);return n(y,d),y},a=e&&e.__spreadArray||function(d,y,M){if(M||arguments.length===2)for(var N=0,Y=y.length,te;N<Y;N++)(te||!(N in y))&&(te||(te=Array.prototype.slice.call(y,0,N)),te[N]=y[N]);return d.concat(te||Array.prototype.slice.call(y))};Object.defineProperty(e,"__esModule",{value:!0}),e.mapWithIndex=e.map=e.flatten=e.duplicate=e.extend=e.chain=e.ap=e.alt=e.altW=e.chunksOf=e.splitAt=e.chop=e.chainWithIndex=e.foldMap=e.foldMapWithIndex=e.intersperse=e.prependAll=e.unzip=e.zip=e.zipWith=e.of=e.copy=e.modifyAt=e.updateAt=e.insertAt=e.sort=e.groupBy=e.group=e.reverse=e.concat=e.concatW=e.unappend=e.unprepend=e.range=e.replicate=e.makeBy=e.fromArray=e.fromReadonlyNonEmptyArray=e.rotate=e.union=e.sortBy=e.uniq=e.unsafeUpdateAt=e.unsafeInsertAt=e.append=e.appendW=e.prepend=e.prependW=e.isOutOfBound=e.isNonEmpty=void 0,e.filter=e.groupSort=e.intercalate=e.updateLast=e.modifyLast=e.updateHead=e.modifyHead=e.matchRight=e.matchLeft=e.concatAll=e.max=e.min=e.init=e.last=e.tail=e.head=e.apS=e.bind=e.bindTo=e.Do=e.Comonad=e.Alt=e.TraversableWithIndex=e.Traversable=e.FoldableWithIndex=e.Foldable=e.Monad=e.chainFirst=e.Chain=e.Applicative=e.apSecond=e.apFirst=e.Apply=e.FunctorWithIndex=e.Pointed=e.flap=e.Functor=e.getUnionSemigroup=e.getEq=e.getSemigroup=e.getShow=e.URI=e.extract=e.traverseWithIndex=e.sequence=e.traverse=e.reduceRightWithIndex=e.reduceRight=e.reduceWithIndex=e.reduce=void 0,e.nonEmptyArray=e.fold=e.prependToAll=e.snoc=e.cons=e.unsnoc=e.uncons=e.filterWithIndex=void 0;var u=sa(),o=hi(),s=Jt(),c=di(),l=i(kr()),f=vi(),h=i(Ku()),g=function(d){return d.length>0};e.isNonEmpty=g;var C=function(d,y){return d<0||d>=y.length};e.isOutOfBound=C;var R=function(d){return function(y){return a([d],y,!0)}};e.prependW=R,e.prepend=e.prependW;var k=function(d){return function(y){return a(a([],y,!0),[d],!1)}};e.appendW=k,e.append=e.appendW;var z=function(d,y,M){if((0,e.isNonEmpty)(M)){var N=(0,e.fromReadonlyNonEmptyArray)(M);return N.splice(d,0,y),N}return[y]};e.unsafeInsertAt=z;var A=function(d,y,M){var N=(0,e.fromReadonlyNonEmptyArray)(M);return N[d]=y,N};e.unsafeUpdateAt=A;var S=function(d){return function(y){if(y.length===1)return(0,e.copy)(y);for(var M=[(0,e.head)(y)],N=(0,e.tail)(y),Y=function(Re){M.every(function(nt){return!d.equals(nt,Re)})&&M.push(Re)},te=0,oe=N;te<oe.length;te++){var Ne=oe[te];Y(Ne)}return M}};e.uniq=S;var O=function(d){if((0,e.isNonEmpty)(d)){var y=(0,f.getMonoid)();return(0,e.sort)(d.reduce(y.concat,y.empty))}return e.copy};e.sortBy=O;var $=function(d){var y=(0,e.uniq)(d);return function(M){return function(N){return y((0,s.pipe)(N,T(M)))}}};e.union=$;var _=function(d){return function(y){var M=y.length,N=Math.round(d)%M;if((0,e.isOutOfBound)(Math.abs(N),y)||N===0)return(0,e.copy)(y);if(N<0){var Y=(0,e.splitAt)(-N)(y),te=Y[0],oe=Y[1];return(0,s.pipe)(oe,T(te))}else return(0,e.rotate)(N-M)(y)}};e.rotate=_,e.fromReadonlyNonEmptyArray=l.fromReadonlyNonEmptyArray;var I=function(d){return(0,e.isNonEmpty)(d)?l.some(d):l.none};e.fromArray=I;var P=function(d){return function(y){for(var M=Math.max(0,Math.floor(y)),N=[d(0)],Y=1;Y<M;Y++)N.push(d(Y));return N}};e.makeBy=P;var V=function(d){return(0,e.makeBy)(function(){return d})};e.replicate=V;var ue=function(d,y){return d<=y?(0,e.makeBy)(function(M){return d+M})(y-d+1):[d]};e.range=ue;var ee=function(d){return[(0,e.head)(d),(0,e.tail)(d)]};e.unprepend=ee;var pe=function(d){return[(0,e.init)(d),(0,e.last)(d)]};e.unappend=pe;function be(d){return function(y){return y.concat(d)}}e.concatW=be;function T(d,y){return y?d.concat(y):function(M){return M.concat(d)}}e.concat=T;var q=function(d){return a([(0,e.last)(d)],d.slice(0,-1).reverse(),!0)};e.reverse=q;function G(d){return function(y){var M=y.length;if(M===0)return[];for(var N=[],Y=y[0],te=[Y],oe=1;oe<M;oe++){var Ne=y[oe];d.equals(Ne,Y)?te.push(Ne):(N.push(te),Y=Ne,te=[Y])}return N.push(te),N}}e.group=G;var x=function(d){return function(y){for(var M={},N=0,Y=y;N<Y.length;N++){var te=Y[N],oe=d(te);l.has.call(M,oe)?M[oe].push(te):M[oe]=[te]}return M}};e.groupBy=x;var ne=function(d){return function(y){return y.slice().sort(d.compare)}};e.sort=ne;var Q=function(d,y){return function(M){return d<0||d>M.length?l.none:l.some((0,e.unsafeInsertAt)(d,y,M))}};e.insertAt=Q;var ye=function(d,y){return(0,e.modifyAt)(d,function(){return y})};e.updateAt=ye;var Fe=function(d,y){return function(M){return(0,e.isOutOfBound)(d,M)?l.none:l.some((0,e.unsafeUpdateAt)(d,y(M[d]),M))}};e.modifyAt=Fe,e.copy=e.fromReadonlyNonEmptyArray;var Qe=function(d){return[d]};e.of=Qe;var ve=function(d,y,M){for(var N=[M(d[0],y[0])],Y=Math.min(d.length,y.length),te=1;te<Y;te++)N[te]=M(d[te],y[te]);return N};e.zipWith=ve;function ze(d,y){return y===void 0?function(M){return ze(M,d)}:(0,e.zipWith)(d,y,function(M,N){return[M,N]})}e.zip=ze;var vt=function(d){for(var y=[d[0][0]],M=[d[0][1]],N=1;N<d.length;N++)y[N]=d[N][0],M[N]=d[N][1];return[y,M]};e.unzip=vt;var Be=function(d){return function(y){for(var M=[d,y[0]],N=1;N<y.length;N++)M.push(d,y[N]);return M}};e.prependAll=Be;var st=function(d){return function(y){var M=(0,e.tail)(y);return(0,e.isNonEmpty)(M)?(0,s.pipe)(M,(0,e.prependAll)(d),(0,e.prepend)((0,e.head)(y))):(0,e.copy)(y)}};e.intersperse=st,e.foldMapWithIndex=h.foldMapWithIndex,e.foldMap=h.foldMap;var Pt=function(d){return function(y){for(var M=(0,e.fromReadonlyNonEmptyArray)(d(0,(0,e.head)(y))),N=1;N<y.length;N++)M.push.apply(M,d(N,y[N]));return M}};e.chainWithIndex=Pt;var Xt=function(d){return function(y){for(var M=d(y),N=M[0],Y=M[1],te=[N],oe=Y;(0,e.isNonEmpty)(oe);){var Ne=d(oe),Re=Ne[0],nt=Ne[1];te.push(Re),oe=nt}return te}};e.chop=Xt;var dr=function(d){return function(y){var M=Math.max(1,d);return M>=y.length?[(0,e.copy)(y),[]]:[(0,s.pipe)(y.slice(1,M),(0,e.prepend)((0,e.head)(y))),y.slice(M)]}};e.splitAt=dr;var Ke=function(d){return(0,e.chop)((0,e.splitAt)(d))};e.chunksOf=Ke;var De=function(d,y){return(0,s.pipe)(d,(0,e.map)(y))},ct=function(d,y){return(0,s.pipe)(d,(0,e.mapWithIndex)(y))},Me=function(d,y){return(0,s.pipe)(d,(0,e.ap)(y))},Je=function(d,y){return(0,s.pipe)(d,(0,e.chain)(y))},lt=function(d,y){return(0,s.pipe)(d,(0,e.extend)(y))},$e=function(d,y,M){return(0,s.pipe)(d,(0,e.reduce)(y,M))},Pe=function(d){var y=(0,e.foldMap)(d);return function(M,N){return(0,s.pipe)(M,y(N))}},Se=function(d,y,M){return(0,s.pipe)(d,(0,e.reduceRight)(y,M))},At=function(d){var y=(0,e.traverse)(d);return function(M,N){return(0,s.pipe)(M,y(N))}},yt=function(d,y){return(0,s.pipe)(d,(0,e.alt)(y))},Nt=function(d,y,M){return(0,s.pipe)(d,(0,e.reduceWithIndex)(y,M))},Ct=function(d){var y=(0,e.foldMapWithIndex)(d);return function(M,N){return(0,s.pipe)(M,y(N))}},fe=function(d,y,M){return(0,s.pipe)(d,(0,e.reduceRightWithIndex)(y,M))},he=function(d){var y=(0,e.traverseWithIndex)(d);return function(M,N){return(0,s.pipe)(M,y(N))}},zt=function(d){return function(y){return(0,s.pipe)(y,be(d()))}};e.altW=zt,e.alt=e.altW;var ft=function(d){return(0,e.chain)(function(y){return(0,s.pipe)(d,(0,e.map)(y))})};e.ap=ft;var me=function(d){return(0,e.chainWithIndex)(function(y,M){return d(M)})};e.chain=me;var Ft=function(d){return function(y){for(var M=(0,e.tail)(y),N=[d(y)];(0,e.isNonEmpty)(M);)N.push(d(M)),M=(0,e.tail)(M);return N}};e.extend=Ft,e.duplicate=(0,e.extend)(s.identity),e.flatten=(0,e.chain)(s.identity);var et=function(d){return(0,e.mapWithIndex)(function(y,M){return d(M)})};e.map=et;var j=function(d){return function(y){for(var M=[d(0,(0,e.head)(y))],N=1;N<y.length;N++)M.push(d(N,y[N]));return M}};e.mapWithIndex=j,e.reduce=h.reduce,e.reduceWithIndex=h.reduceWithIndex,e.reduceRight=h.reduceRight,e.reduceRightWithIndex=h.reduceRightWithIndex;var Wt=function(d){var y=(0,e.traverseWithIndex)(d);return function(M){return y(function(N,Y){return M(Y)})}};e.traverse=Wt;var Ee=function(d){return(0,e.traverseWithIndex)(d)(function(y,M){return M})};e.sequence=Ee;var tt=function(d){return function(y){return function(M){for(var N=d.map(y(0,(0,e.head)(M)),e.of),Y=1;Y<M.length;Y++)N=d.ap(d.map(N,function(te){return function(oe){return(0,s.pipe)(te,(0,e.append)(oe))}}),y(Y,M[Y]));return N}}};e.traverseWithIndex=tt,e.extract=h.head,e.URI="NonEmptyArray",e.getShow=h.getShow;var qt=function(){return{concat:T}};e.getSemigroup=qt,e.getEq=h.getEq;var jt=function(d){var y=(0,e.union)(d);return{concat:function(M,N){return y(N)(M)}}};e.getUnionSemigroup=jt,e.Functor={URI:e.URI,map:De},e.flap=(0,c.flap)(e.Functor),e.Pointed={URI:e.URI,of:e.of},e.FunctorWithIndex={URI:e.URI,map:De,mapWithIndex:ct},e.Apply={URI:e.URI,map:De,ap:Me},e.apFirst=(0,u.apFirst)(e.Apply),e.apSecond=(0,u.apSecond)(e.Apply),e.Applicative={URI:e.URI,map:De,ap:Me,of:e.of},e.Chain={URI:e.URI,map:De,ap:Me,chain:Je},e.chainFirst=(0,o.chainFirst)(e.Chain),e.Monad={URI:e.URI,map:De,ap:Me,of:e.of,chain:Je},e.Foldable={URI:e.URI,reduce:$e,foldMap:Pe,reduceRight:Se},e.FoldableWithIndex={URI:e.URI,reduce:$e,foldMap:Pe,reduceRight:Se,reduceWithIndex:Nt,foldMapWithIndex:Ct,reduceRightWithIndex:fe},e.Traversable={URI:e.URI,map:De,reduce:$e,foldMap:Pe,reduceRight:Se,traverse:At,sequence:e.sequence},e.TraversableWithIndex={URI:e.URI,map:De,mapWithIndex:ct,reduce:$e,foldMap:Pe,reduceRight:Se,traverse:At,sequence:e.sequence,reduceWithIndex:Nt,foldMapWithIndex:Ct,reduceRightWithIndex:fe,traverseWithIndex:he},e.Alt={URI:e.URI,map:De,alt:yt},e.Comonad={URI:e.URI,map:De,extend:lt,extract:e.extract},e.Do=(0,e.of)(l.emptyRecord),e.bindTo=(0,c.bindTo)(e.Functor),e.bind=(0,o.bind)(e.Chain),e.apS=(0,u.apS)(e.Apply),e.head=h.head;var St=function(d){return d.slice(1)};e.tail=St,e.last=h.last;var _t=function(d){return d.slice(0,-1)};e.init=_t,e.min=h.min,e.max=h.max;var Mt=function(d){return function(y){return y.reduce(d.concat)}};e.concatAll=Mt;var mt=function(d){return function(y){return d((0,e.head)(y),(0,e.tail)(y))}};e.matchLeft=mt;var de=function(d){return function(y){return d((0,e.init)(y),(0,e.last)(y))}};e.matchRight=de;var Te=function(d){return function(y){return a([d((0,e.head)(y))],(0,e.tail)(y),!0)}};e.modifyHead=Te;var Ve=function(d){return(0,e.modifyHead)(function(){return d})};e.updateHead=Ve;var rt=function(d){return function(y){return(0,s.pipe)((0,e.init)(y),(0,e.append)(d((0,e.last)(y))))}};e.modifyLast=rt;var gt=function(d){return(0,e.modifyLast)(function(){return d})};e.updateLast=gt,e.intercalate=h.intercalate;function ht(d){var y=(0,e.sort)(d),M=G(d);return function(N){return(0,e.isNonEmpty)(N)?M(y(N)):[]}}e.groupSort=ht;function It(d){return(0,e.filterWithIndex)(function(y,M){return d(M)})}e.filter=It;var Ot=function(d){return function(y){return(0,e.fromArray)(y.filter(function(M,N){return d(N,M)}))}};e.filterWithIndex=Ot,e.uncons=e.unprepend,e.unsnoc=e.unappend;function Qt(d,y){return y===void 0?(0,e.prepend)(d):(0,s.pipe)(y,(0,e.prepend)(d))}e.cons=Qt;var er=function(d,y){return(0,s.pipe)(d,(0,e.append)(y))};e.snoc=er,e.prependToAll=e.prependAll,e.fold=h.concatAll,e.nonEmptyArray={URI:e.URI,of:e.of,map:De,mapWithIndex:ct,ap:Me,chain:Je,extend:lt,extract:e.extract,reduce:$e,foldMap:Pe,reduceRight:Se,traverse:At,sequence:e.sequence,reduceWithIndex:Nt,foldMapWithIndex:Ct,reduceRightWithIndex:fe,traverseWithIndex:he,alt:yt}}}),cc=Ze({"node_modules/fp-ts/lib/number.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Field=e.MonoidProduct=e.MonoidSum=e.SemigroupProduct=e.SemigroupSum=e.MagmaSub=e.Show=e.Bounded=e.Ord=e.Eq=e.isNumber=void 0;var r=function(n){return typeof n=="number"};e.isNumber=r,e.Eq={equals:function(n,i){return n===i}},e.Ord={equals:e.Eq.equals,compare:function(n,i){return n<i?-1:n>i?1:0}},e.Bounded={equals:e.Eq.equals,compare:e.Ord.compare,top:1/0,bottom:-1/0},e.Show={show:function(n){return JSON.stringify(n)}},e.MagmaSub={concat:function(n,i){return n-i}},e.SemigroupSum={concat:function(n,i){return n+i}},e.SemigroupProduct={concat:function(n,i){return n*i}},e.MonoidSum={concat:e.SemigroupSum.concat,empty:0},e.MonoidProduct={concat:e.SemigroupProduct.concat,empty:1},e.Field={add:e.SemigroupSum.concat,zero:0,mul:e.SemigroupProduct.concat,one:1,sub:e.MagmaSub.concat,degree:function(n){return 1},div:function(n,i){return n/i},mod:function(n,i){return n%i}}}}),lc=Ze({"node_modules/fp-ts/lib/Separated.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.right=e.left=e.flap=e.Functor=e.Bifunctor=e.URI=e.bimap=e.mapLeft=e.map=e.separated=void 0;var r=Jt(),n=di(),i=function(g,C){return{left:g,right:C}};e.separated=i;var a=function(g,C){return(0,r.pipe)(g,(0,e.map)(C))},u=function(g,C){return(0,r.pipe)(g,(0,e.mapLeft)(C))},o=function(g,C,R){return(0,r.pipe)(g,(0,e.bimap)(C,R))},s=function(g){return function(C){return(0,e.separated)((0,e.left)(C),g((0,e.right)(C)))}};e.map=s;var c=function(g){return function(C){return(0,e.separated)(g((0,e.left)(C)),(0,e.right)(C))}};e.mapLeft=c;var l=function(g,C){return function(R){return(0,e.separated)(g((0,e.left)(R)),C((0,e.right)(R)))}};e.bimap=l,e.URI="Separated",e.Bifunctor={URI:e.URI,mapLeft:u,bimap:o},e.Functor={URI:e.URI,map:a},e.flap=(0,n.flap)(e.Functor);var f=function(g){return g.left};e.left=f;var h=function(g){return g.right};e.right=h}}),fc=Ze({"node_modules/fp-ts/lib/Witherable.js"(e){var r=e&&e.__createBinding||(Object.create?function(c,l,f,h){h===void 0&&(h=f);var g=Object.getOwnPropertyDescriptor(l,f);(!g||("get"in g?!l.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return l[f]}}),Object.defineProperty(c,h,g)}:function(c,l,f,h){h===void 0&&(h=f),c[h]=l[f]}),n=e&&e.__setModuleDefault||(Object.create?function(c,l){Object.defineProperty(c,"default",{enumerable:!0,value:l})}:function(c,l){c.default=l}),i=e&&e.__importStar||function(c){if(c&&c.__esModule)return c;var l={};if(c!=null)for(var f in c)f!=="default"&&Object.prototype.hasOwnProperty.call(c,f)&&r(l,c,f);return n(l,c),l};Object.defineProperty(e,"__esModule",{value:!0}),e.filterE=e.witherDefault=e.wiltDefault=void 0;var a=i(kr());function u(c,l){return function(f){var h=c.traverse(f);return function(g,C){return f.map(h(g,C),l.separate)}}}e.wiltDefault=u;function o(c,l){return function(f){var h=c.traverse(f);return function(g,C){return f.map(h(g,C),l.compact)}}}e.witherDefault=o;function s(c){return function(l){var f=c.wither(l);return function(h){return function(g){return f(g,function(C){return l.map(h(C),function(R){return R?a.some(C):a.none})})}}}}e.filterE=s}}),hc=Ze({"node_modules/fp-ts/lib/Zero.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.guard=void 0;function r(n,i){return function(a){return a?i.of(void 0):n.zero()}}e.guard=r}}),Bv=Ze({"node_modules/fp-ts/lib/ReadonlyArray.js"(e){var r=e&&e.__createBinding||(Object.create?function(v,m,w,L){L===void 0&&(L=w);var X=Object.getOwnPropertyDescriptor(m,w);(!X||("get"in X?!m.__esModule:X.writable||X.configurable))&&(X={enumerable:!0,get:function(){return m[w]}}),Object.defineProperty(v,L,X)}:function(v,m,w,L){L===void 0&&(L=w),v[L]=m[w]}),n=e&&e.__setModuleDefault||(Object.create?function(v,m){Object.defineProperty(v,"default",{enumerable:!0,value:m})}:function(v,m){v.default=m}),i=e&&e.__importStar||function(v){if(v&&v.__esModule)return v;var m={};if(v!=null)for(var w in v)w!=="default"&&Object.prototype.hasOwnProperty.call(v,w)&&r(m,v,w);return n(m,v),m},a=e&&e.__spreadArray||function(v,m,w){if(w||arguments.length===2)for(var L=0,X=m.length,re;L<X;L++)(re||!(L in m))&&(re||(re=Array.prototype.slice.call(m,0,L)),re[L]=m[L]);return v.concat(re||Array.prototype.slice.call(m))};Object.defineProperty(e,"__esModule",{value:!0}),e.sort=e.lefts=e.rights=e.reverse=e.modifyAt=e.deleteAt=e.updateAt=e.insertAt=e.findLastIndex=e.findLastMap=e.findLast=e.findFirstMap=e.findFirst=e.findIndex=e.dropLeftWhile=e.dropRight=e.dropLeft=e.spanLeft=e.takeLeftWhile=e.takeRight=e.takeLeft=e.init=e.tail=e.last=e.head=e.lookup=e.isOutOfBound=e.size=e.scanRight=e.scanLeft=e.chainWithIndex=e.foldRight=e.matchRight=e.matchRightW=e.foldLeft=e.matchLeft=e.matchLeftW=e.match=e.matchW=e.fromEither=e.fromOption=e.fromPredicate=e.replicate=e.makeBy=e.appendW=e.append=e.prependW=e.prepend=e.isNonEmpty=e.isEmpty=void 0,e.sequence=e.traverse=e.reduceRightWithIndex=e.reduceRight=e.reduceWithIndex=e.foldMap=e.reduce=e.foldMapWithIndex=e.duplicate=e.extend=e.filterWithIndex=e.partitionMapWithIndex=e.partitionMap=e.partitionWithIndex=e.partition=e.compact=e.filterMap=e.filterMapWithIndex=e.filter=e.separate=e.mapWithIndex=e.map=e.flatten=e.chain=e.ap=e.alt=e.altW=e.zero=e.of=e._chainRecBreadthFirst=e._chainRecDepthFirst=e.difference=e.intersection=e.union=e.concat=e.concatW=e.comprehension=e.fromOptionK=e.chunksOf=e.splitAt=e.chop=e.sortBy=e.uniq=e.elem=e.rotate=e.intersperse=e.prependAll=e.unzip=e.zip=e.zipWith=void 0,e.toArray=e.unsafeDeleteAt=e.unsafeUpdateAt=e.unsafeInsertAt=e.fromEitherK=e.FromEither=e.filterE=e.Witherable=e.ChainRecBreadthFirst=e.chainRecBreadthFirst=e.ChainRecDepthFirst=e.chainRecDepthFirst=e.TraversableWithIndex=e.Traversable=e.FoldableWithIndex=e.Foldable=e.FilterableWithIndex=e.Filterable=e.Compactable=e.Extend=e.Alternative=e.guard=e.Zero=e.Alt=e.Unfoldable=e.chainFirst=e.Monad=e.Chain=e.Applicative=e.apSecond=e.apFirst=e.Apply=e.FunctorWithIndex=e.Pointed=e.flap=e.Functor=e.getDifferenceMagma=e.getIntersectionSemigroup=e.getUnionMonoid=e.getUnionSemigroup=e.getOrd=e.getEq=e.getMonoid=e.getSemigroup=e.getShow=e.URI=e.unfold=e.wilt=e.wither=e.traverseWithIndex=void 0,e.readonlyArray=e.prependToAll=e.snoc=e.cons=e.range=e.apS=e.bind=e.bindTo=e.Do=e.intercalate=e.exists=e.some=e.every=e.empty=e.fromArray=void 0;var u=sa(),o=hi(),s=Gu(),c=sc(),l=Jt(),f=di(),h=i(kr()),g=i(cc()),C=vi(),R=i(Ku()),k=lc(),z=fc(),A=hc(),S=function(v){return v.length===0};e.isEmpty=S,e.isNonEmpty=R.isNonEmpty,e.prepend=R.prepend,e.prependW=R.prependW,e.append=R.append,e.appendW=R.appendW;var O=function(v,m){return v<=0?e.empty:R.makeBy(m)(v)};e.makeBy=O;var $=function(v,m){return(0,e.makeBy)(v,function(){return m})};e.replicate=$;function _(v){return function(m){return v(m)?[m]:e.empty}}e.fromPredicate=_;var I=function(v){return h.isNone(v)?e.empty:[v.value]};e.fromOption=I;var P=function(v){return h.isLeft(v)?e.empty:[v.right]};e.fromEither=P;var V=function(v,m){return function(w){return(0,e.isNonEmpty)(w)?m(w):v()}};e.matchW=V,e.match=e.matchW;var ue=function(v,m){return function(w){return(0,e.isNonEmpty)(w)?m(R.head(w),R.tail(w)):v()}};e.matchLeftW=ue,e.matchLeft=e.matchLeftW,e.foldLeft=e.matchLeft;var ee=function(v,m){return function(w){return(0,e.isNonEmpty)(w)?m(R.init(w),R.last(w)):v()}};e.matchRightW=ee,e.matchRight=e.matchRightW,e.foldRight=e.matchRight;var pe=function(v){return function(m){if((0,e.isEmpty)(m))return e.empty;for(var w=[],L=0;L<m.length;L++)w.push.apply(w,v(L,m[L]));return w}};e.chainWithIndex=pe;var be=function(v,m){return function(w){var L=w.length,X=new Array(L+1);X[0]=v;for(var re=0;re<L;re++)X[re+1]=m(X[re],w[re]);return X}};e.scanLeft=be;var T=function(v,m){return function(w){var L=w.length,X=new Array(L+1);X[L]=v;for(var re=L-1;re>=0;re--)X[re]=m(w[re],X[re+1]);return X}};e.scanRight=T;var q=function(v){return v.length};e.size=q,e.isOutOfBound=R.isOutOfBound;function G(v,m){return m===void 0?function(w){return G(v,w)}:(0,e.isOutOfBound)(v,m)?h.none:h.some(m[v])}e.lookup=G;var x=function(v){return(0,e.isNonEmpty)(v)?h.some(R.head(v)):h.none};e.head=x;var ne=function(v){return(0,e.isNonEmpty)(v)?h.some(R.last(v)):h.none};e.last=ne;var Q=function(v){return(0,e.isNonEmpty)(v)?h.some(R.tail(v)):h.none};e.tail=Q;var ye=function(v){return(0,e.isNonEmpty)(v)?h.some(R.init(v)):h.none};e.init=ye;var Fe=function(v){return function(m){return(0,e.isOutOfBound)(v,m)?m:v===0?e.empty:m.slice(0,v)}};e.takeLeft=Fe;var Qe=function(v){return function(m){return(0,e.isOutOfBound)(v,m)?m:v===0?e.empty:m.slice(-v)}};e.takeRight=Qe;function ve(v){return function(m){for(var w=[],L=0,X=m;L<X.length;L++){var re=X[L];if(!v(re))break;w.push(re)}var xe=w.length;return xe===m.length?m:xe===0?e.empty:w}}e.takeLeftWhile=ve;var ze=function(v,m){for(var w=v.length,L=0;L<w&&m(v[L]);L++);return L};function vt(v){return function(m){var w=(0,e.splitAt)(ze(m,v))(m),L=w[0],X=w[1];return{init:L,rest:X}}}e.spanLeft=vt;var Be=function(v){return function(m){return v<=0||(0,e.isEmpty)(m)?m:v>=m.length?e.empty:m.slice(v,m.length)}};e.dropLeft=Be;var st=function(v){return function(m){return v<=0||(0,e.isEmpty)(m)?m:v>=m.length?e.empty:m.slice(0,m.length-v)}};e.dropRight=st;function Pt(v){return function(m){var w=ze(m,v);return w===0?m:w===m.length?e.empty:m.slice(w)}}e.dropLeftWhile=Pt;var Xt=function(v){return function(m){for(var w=0;w<m.length;w++)if(v(m[w]))return h.some(w);return h.none}};e.findIndex=Xt;function dr(v){return function(m){for(var w=0;w<m.length;w++)if(v(m[w]))return h.some(m[w]);return h.none}}e.findFirst=dr;var Ke=function(v){return function(m){for(var w=0;w<m.length;w++){var L=v(m[w]);if(h.isSome(L))return L}return h.none}};e.findFirstMap=Ke;function De(v){return function(m){for(var w=m.length-1;w>=0;w--)if(v(m[w]))return h.some(m[w]);return h.none}}e.findLast=De;var ct=function(v){return function(m){for(var w=m.length-1;w>=0;w--){var L=v(m[w]);if(h.isSome(L))return L}return h.none}};e.findLastMap=ct;var Me=function(v){return function(m){for(var w=m.length-1;w>=0;w--)if(v(m[w]))return h.some(w);return h.none}};e.findLastIndex=Me;var Je=function(v,m){return function(w){return v<0||v>w.length?h.none:h.some(R.unsafeInsertAt(v,m,w))}};e.insertAt=Je;var lt=function(v,m){return(0,e.modifyAt)(v,function(){return m})};e.updateAt=lt;var $e=function(v){return function(m){return(0,e.isOutOfBound)(v,m)?h.none:h.some((0,e.unsafeDeleteAt)(v,m))}};e.deleteAt=$e;var Pe=function(v,m){return function(w){return(0,e.isOutOfBound)(v,w)?h.none:h.some((0,e.unsafeUpdateAt)(v,m(w[v]),w))}};e.modifyAt=Pe;var Se=function(v){return v.length<=1?v:v.slice().reverse()};e.reverse=Se;var At=function(v){for(var m=[],w=0;w<v.length;w++){var L=v[w];L._tag==="Right"&&m.push(L.right)}return m};e.rights=At;var yt=function(v){for(var m=[],w=0;w<v.length;w++){var L=v[w];L._tag==="Left"&&m.push(L.left)}return m};e.lefts=yt;var Nt=function(v){return function(m){return m.length<=1?m:m.slice().sort(v.compare)}};e.sort=Nt;var Ct=function(v,m,w){for(var L=[],X=Math.min(v.length,m.length),re=0;re<X;re++)L[re]=w(v[re],m[re]);return L};e.zipWith=Ct;function fe(v,m){return m===void 0?function(w){return fe(w,v)}:(0,e.zipWith)(v,m,function(w,L){return[w,L]})}e.zip=fe;var he=function(v){for(var m=[],w=[],L=0;L<v.length;L++)m[L]=v[L][0],w[L]=v[L][1];return[m,w]};e.unzip=he;var zt=function(v){var m=R.prependAll(v);return function(w){return(0,e.isNonEmpty)(w)?m(w):w}};e.prependAll=zt;var ft=function(v){var m=R.intersperse(v);return function(w){return(0,e.isNonEmpty)(w)?m(w):w}};e.intersperse=ft;var me=function(v){var m=R.rotate(v);return function(w){return(0,e.isNonEmpty)(w)?m(w):w}};e.rotate=me;function Ft(v){return function(m,w){if(w===void 0){var L=Ft(v);return function(xe){return L(m,xe)}}for(var X=function(xe){return v.equals(xe,m)},re=0;re<w.length;re++)if(X(w[re]))return!0;return!1}}e.elem=Ft;var et=function(v){var m=R.uniq(v);return function(w){return(0,e.isNonEmpty)(w)?m(w):w}};e.uniq=et;var j=function(v){var m=R.sortBy(v);return function(w){return(0,e.isNonEmpty)(w)?m(w):w}};e.sortBy=j;var Wt=function(v){var m=R.chop(v);return function(w){return(0,e.isNonEmpty)(w)?m(w):e.empty}};e.chop=Wt;var Ee=function(v){return function(m){return v>=1&&(0,e.isNonEmpty)(m)?R.splitAt(v)(m):(0,e.isEmpty)(m)?[m,e.empty]:[e.empty,m]}};e.splitAt=Ee;var tt=function(v){var m=R.chunksOf(v);return function(w){return(0,e.isNonEmpty)(w)?m(w):e.empty}};e.chunksOf=tt;var qt=function(v){return function(){for(var m=[],w=0;w<arguments.length;w++)m[w]=arguments[w];return(0,e.fromOption)(v.apply(void 0,m))}};e.fromOptionK=qt;function jt(v,m,w){w===void 0&&(w=function(){return!0});var L=function(X,re){return(0,e.isNonEmpty)(re)?(0,l.pipe)(R.head(re),(0,e.chain)(function(xe){return L((0,l.pipe)(X,(0,e.append)(xe)),R.tail(re))})):w.apply(void 0,X)?[m.apply(void 0,X)]:e.empty};return L(e.empty,v)}e.comprehension=jt;var St=function(v){return function(m){return(0,e.isEmpty)(m)?v:(0,e.isEmpty)(v)?m:m.concat(v)}};e.concatW=St,e.concat=e.concatW;function _t(v){var m=R.union(v);return function(w,L){if(L===void 0){var X=_t(v);return function(re){return X(re,w)}}return(0,e.isNonEmpty)(w)&&(0,e.isNonEmpty)(L)?m(L)(w):(0,e.isNonEmpty)(w)?w:L}}e.union=_t;function Mt(v){var m=Ft(v);return function(w,L){if(L===void 0){var X=Mt(v);return function(re){return X(re,w)}}return w.filter(function(re){return m(re,L)})}}e.intersection=Mt;function mt(v){var m=Ft(v);return function(w,L){if(L===void 0){var X=mt(v);return function(re){return X(re,w)}}return w.filter(function(re){return!m(re,L)})}}e.difference=mt;var de=function(v,m){return(0,l.pipe)(v,(0,e.map)(m))},Te=function(v,m){return(0,l.pipe)(v,(0,e.mapWithIndex)(m))},Ve=function(v,m){return(0,l.pipe)(v,(0,e.ap)(m))},rt=function(v,m){return(0,l.pipe)(v,(0,e.chain)(m))},gt=function(v,m){return(0,l.pipe)(v,(0,e.filter)(m))},ht=function(v,m){return(0,l.pipe)(v,(0,e.filterMap)(m))},It=function(v,m){return(0,l.pipe)(v,(0,e.partition)(m))},Ot=function(v,m){return(0,l.pipe)(v,(0,e.partitionMap)(m))},Qt=function(v,m){return(0,l.pipe)(v,(0,e.partitionWithIndex)(m))},er=function(v,m){return(0,l.pipe)(v,(0,e.partitionMapWithIndex)(m))},d=function(v,m){return(0,l.pipe)(v,(0,e.alt)(m))},y=function(v,m,w){return(0,l.pipe)(v,(0,e.reduce)(m,w))},M=function(v){var m=(0,e.foldMap)(v);return function(w,L){return(0,l.pipe)(w,m(L))}},N=function(v,m,w){return(0,l.pipe)(v,(0,e.reduceRight)(m,w))},Y=function(v,m,w){return(0,l.pipe)(v,(0,e.reduceWithIndex)(m,w))},te=function(v){var m=(0,e.foldMapWithIndex)(v);return function(w,L){return(0,l.pipe)(w,m(L))}},oe=function(v,m,w){return(0,l.pipe)(v,(0,e.reduceRightWithIndex)(m,w))},Ne=function(v,m){return(0,l.pipe)(v,(0,e.filterMapWithIndex)(m))},Re=function(v,m){return(0,l.pipe)(v,(0,e.filterWithIndex)(m))},nt=function(v,m){return(0,l.pipe)(v,(0,e.extend)(m))},pt=function(v){var m=(0,e.traverse)(v);return function(w,L){return(0,l.pipe)(w,m(L))}},D=function(v){var m=(0,e.traverseWithIndex)(v);return function(w,L){return(0,l.pipe)(w,m(L))}},b=function(v,m){return(0,l.pipe)(v,(0,e.chainRecDepthFirst)(m))};e._chainRecDepthFirst=b;var W=function(v,m){return(0,l.pipe)(v,(0,e.chainRecBreadthFirst)(m))};e._chainRecBreadthFirst=W,e.of=R.of;var H=function(){return e.empty};e.zero=H;var ce=function(v){return function(m){return m.concat(v())}};e.altW=ce,e.alt=e.altW;var we=function(v){return(0,e.chain)(function(m){return(0,l.pipe)(v,(0,e.map)(m))})};e.ap=we;var qe=function(v){return function(m){return(0,l.pipe)(m,(0,e.chainWithIndex)(function(w,L){return v(L)}))}};e.chain=qe,e.flatten=(0,e.chain)(l.identity);var Rt=function(v){return function(m){return m.map(function(w){return v(w)})}};e.map=Rt;var Ae=function(v){return function(m){return m.map(function(w,L){return v(L,w)})}};e.mapWithIndex=Ae;var je=function(v){for(var m=[],w=[],L=0,X=v;L<X.length;L++){var re=X[L];re._tag==="Left"?m.push(re.left):w.push(re.right)}return(0,k.separated)(m,w)};e.separate=je;var ge=function(v){return function(m){return m.filter(v)}};e.filter=ge;var Ye=function(v){return function(m){for(var w=[],L=0;L<m.length;L++){var X=v(L,m[L]);h.isSome(X)&&w.push(X.value)}return w}};e.filterMapWithIndex=Ye;var wt=function(v){return(0,e.filterMapWithIndex)(function(m,w){return v(w)})};e.filterMap=wt,e.compact=(0,e.filterMap)(l.identity);var Xe=function(v){return(0,e.partitionWithIndex)(function(m,w){return v(w)})};e.partition=Xe;var tr=function(v){return function(m){for(var w=[],L=[],X=0;X<m.length;X++){var re=m[X];v(X,re)?L.push(re):w.push(re)}return(0,k.separated)(w,L)}};e.partitionWithIndex=tr;var kt=function(v){return(0,e.partitionMapWithIndex)(function(m,w){return v(w)})};e.partitionMap=kt;var Ut=function(v){return function(m){for(var w=[],L=[],X=0;X<m.length;X++){var re=v(X,m[X]);re._tag==="Left"?w.push(re.left):L.push(re.right)}return(0,k.separated)(w,L)}};e.partitionMapWithIndex=Ut;var rr=function(v){return function(m){return m.filter(function(w,L){return v(L,w)})}};e.filterWithIndex=rr;var Mr=function(v){return function(m){return m.map(function(w,L){return v(m.slice(L))})}};e.extend=Mr,e.duplicate=(0,e.extend)(l.identity);var qn=function(v){return function(m){return function(w){return w.reduce(function(L,X,re){return v.concat(L,m(re,X))},v.empty)}}};e.foldMapWithIndex=qn;var Oa=function(v,m){return(0,e.reduceWithIndex)(v,function(w,L,X){return m(L,X)})};e.reduce=Oa;var jn=function(v){var m=(0,e.foldMapWithIndex)(v);return function(w){return m(function(L,X){return w(X)})}};e.foldMap=jn;var Un=function(v,m){return function(w){for(var L=w.length,X=v,re=0;re<L;re++)X=m(re,X,w[re]);return X}};e.reduceWithIndex=Un;var ka=function(v,m){return(0,e.reduceRightWithIndex)(v,function(w,L,X){return m(L,X)})};e.reduceRight=ka;var La=function(v,m){return function(w){return w.reduceRight(function(L,X,re){return m(re,X,L)},v)}};e.reduceRightWithIndex=La;var $a=function(v){var m=(0,e.traverseWithIndex)(v);return function(w){return m(function(L,X){return w(X)})}};e.traverse=$a;var p=function(v){return function(m){return y(m,v.of((0,e.zero)()),function(w,L){return v.ap(v.map(w,function(X){return function(re){return(0,l.pipe)(X,(0,e.append)(re))}}),L)})}};e.sequence=p;var E=function(v){return function(m){return(0,e.reduceWithIndex)(v.of((0,e.zero)()),function(w,L,X){return v.ap(v.map(L,function(re){return function(xe){return(0,l.pipe)(re,(0,e.append)(xe))}}),m(w,X))})}};e.traverseWithIndex=E;var B=function(v){var m=qa(v);return function(w){return function(L){return m(L,w)}}};e.wither=B;var K=function(v){var m=ja(v);return function(w){return function(L){return m(L,w)}}};e.wilt=K;var se=function(v,m){for(var w=[],L=v;;){var X=m(L);if(h.isSome(X)){var re=X.value,xe=re[0],Vr=re[1];w.push(xe),L=Vr}else break}return w};e.unfold=se,e.URI="ReadonlyArray";var le=function(v){return{show:function(m){return"[".concat(m.map(v.show).join(", "),"]")}}};e.getShow=le;var Ur=function(){return{concat:function(v,m){return(0,e.isEmpty)(v)?m:(0,e.isEmpty)(m)?v:v.concat(m)}}};e.getSemigroup=Ur;var Ta=function(){return{concat:(0,e.getSemigroup)().concat,empty:e.empty}};e.getMonoid=Ta;var Ud=function(v){return(0,s.fromEquals)(function(m,w){return m.length===w.length&&m.every(function(L,X){return v.equals(L,w[X])})})};e.getEq=Ud;var Vd=function(v){return(0,C.fromCompare)(function(m,w){for(var L=m.length,X=w.length,re=Math.min(L,X),xe=0;xe<re;xe++){var Vr=v.compare(m[xe],w[xe]);if(Vr!==0)return Vr}return g.Ord.compare(L,X)})};e.getOrd=Vd;var Hd=function(v){var m=_t(v);return{concat:function(w,L){return m(L)(w)}}};e.getUnionSemigroup=Hd;var Gd=function(v){return{concat:(0,e.getUnionSemigroup)(v).concat,empty:e.empty}};e.getUnionMonoid=Gd;var Kd=function(v){var m=Mt(v);return{concat:function(w,L){return m(L)(w)}}};e.getIntersectionSemigroup=Kd;var Jd=function(v){var m=mt(v);return{concat:function(w,L){return m(L)(w)}}};e.getDifferenceMagma=Jd,e.Functor={URI:e.URI,map:de},e.flap=(0,f.flap)(e.Functor),e.Pointed={URI:e.URI,of:e.of},e.FunctorWithIndex={URI:e.URI,map:de,mapWithIndex:Te},e.Apply={URI:e.URI,map:de,ap:Ve},e.apFirst=(0,u.apFirst)(e.Apply),e.apSecond=(0,u.apSecond)(e.Apply),e.Applicative={URI:e.URI,map:de,ap:Ve,of:e.of},e.Chain={URI:e.URI,map:de,ap:Ve,chain:rt},e.Monad={URI:e.URI,map:de,ap:Ve,of:e.of,chain:rt},e.chainFirst=(0,o.chainFirst)(e.Chain),e.Unfoldable={URI:e.URI,unfold:e.unfold},e.Alt={URI:e.URI,map:de,alt:d},e.Zero={URI:e.URI,zero:e.zero},e.guard=(0,A.guard)(e.Zero,e.Pointed),e.Alternative={URI:e.URI,map:de,ap:Ve,of:e.of,alt:d,zero:e.zero},e.Extend={URI:e.URI,map:de,extend:nt},e.Compactable={URI:e.URI,compact:e.compact,separate:e.separate},e.Filterable={URI:e.URI,map:de,compact:e.compact,separate:e.separate,filter:gt,filterMap:ht,partition:It,partitionMap:Ot},e.FilterableWithIndex={URI:e.URI,map:de,mapWithIndex:Te,compact:e.compact,separate:e.separate,filter:gt,filterMap:ht,partition:It,partitionMap:Ot,partitionMapWithIndex:er,partitionWithIndex:Qt,filterMapWithIndex:Ne,filterWithIndex:Re},e.Foldable={URI:e.URI,reduce:y,foldMap:M,reduceRight:N},e.FoldableWithIndex={URI:e.URI,reduce:y,foldMap:M,reduceRight:N,reduceWithIndex:Y,foldMapWithIndex:te,reduceRightWithIndex:oe},e.Traversable={URI:e.URI,map:de,reduce:y,foldMap:M,reduceRight:N,traverse:pt,sequence:e.sequence},e.TraversableWithIndex={URI:e.URI,map:de,mapWithIndex:Te,reduce:y,foldMap:M,reduceRight:N,reduceWithIndex:Y,foldMapWithIndex:te,reduceRightWithIndex:oe,traverse:pt,sequence:e.sequence,traverseWithIndex:D};var Yd=function(v){return function(m){for(var w=a([],v(m),!0),L=[];w.length>0;){var X=w.shift();h.isLeft(X)?w.unshift.apply(w,v(X.left)):L.push(X.right)}return L}};e.chainRecDepthFirst=Yd,e.ChainRecDepthFirst={URI:e.URI,map:de,ap:Ve,chain:rt,chainRec:e._chainRecDepthFirst};var xd=function(v){return function(m){var w=v(m),L=[],X=[];function re(Ua){h.isLeft(Ua)?v(Ua.left).forEach(function(a0){return L.push(a0)}):X.push(Ua.right)}for(var xe=0,Vr=w;xe<Vr.length;xe++){var i0=Vr[xe];re(i0)}for(;L.length>0;)re(L.shift());return X}};e.chainRecBreadthFirst=xd,e.ChainRecBreadthFirst={URI:e.URI,map:de,ap:Ve,chain:rt,chainRec:e._chainRecBreadthFirst};var qa=(0,z.witherDefault)(e.Traversable,e.Compactable),ja=(0,z.wiltDefault)(e.Traversable,e.Compactable);e.Witherable={URI:e.URI,map:de,compact:e.compact,separate:e.separate,filter:gt,filterMap:ht,partition:It,partitionMap:Ot,reduce:y,foldMap:M,reduceRight:N,traverse:pt,sequence:e.sequence,wither:qa,wilt:ja},e.filterE=(0,z.filterE)(e.Witherable),e.FromEither={URI:e.URI,fromEither:e.fromEither},e.fromEitherK=(0,c.fromEitherK)(e.FromEither),e.unsafeInsertAt=R.unsafeInsertAt;var Zd=function(v,m,w){return(0,e.isNonEmpty)(w)?R.unsafeUpdateAt(v,m,w):w};e.unsafeUpdateAt=Zd;var Xd=function(v,m){var w=m.slice();return w.splice(v,1),w};e.unsafeDeleteAt=Xd;var Qd=function(v){return v.slice()};e.toArray=Qd;var e0=function(v){return(0,e.isEmpty)(v)?e.empty:v.slice()};e.fromArray=e0,e.empty=R.empty;function t0(v){return function(m){return m.every(v)}}e.every=t0;var r0=function(v){return function(m){return m.some(v)}};e.some=r0,e.exists=e.some;var n0=function(v){var m=R.intercalate(v);return function(w){return(0,e.match)(function(){return v.empty},m(w))}};e.intercalate=n0,e.Do=(0,e.of)(h.emptyRecord),e.bindTo=(0,f.bindTo)(e.Functor),e.bind=(0,o.bind)(e.Chain),e.apS=(0,u.apS)(e.Apply),e.range=R.range,e.cons=R.cons,e.snoc=R.snoc,e.prependToAll=e.prependAll,e.readonlyArray={URI:e.URI,compact:e.compact,separate:e.separate,map:de,ap:Ve,of:e.of,chain:rt,filter:gt,filterMap:ht,partition:It,partitionMap:Ot,mapWithIndex:Te,partitionMapWithIndex:er,partitionWithIndex:Qt,filterMapWithIndex:Ne,filterWithIndex:Re,alt:d,zero:e.zero,unfold:e.unfold,reduce:y,foldMap:M,reduceRight:N,traverse:pt,sequence:e.sequence,reduceWithIndex:Y,foldMapWithIndex:te,reduceRightWithIndex:oe,traverseWithIndex:D,extend:nt,wither:qa,wilt:ja}}}),Pv=Ze({"node_modules/fp-ts/lib/Array.js"(e){var r=e&&e.__createBinding||(Object.create?function(p,E,B,K){K===void 0&&(K=B);var se=Object.getOwnPropertyDescriptor(E,B);(!se||("get"in se?!E.__esModule:se.writable||se.configurable))&&(se={enumerable:!0,get:function(){return E[B]}}),Object.defineProperty(p,K,se)}:function(p,E,B,K){K===void 0&&(K=B),p[K]=E[B]}),n=e&&e.__setModuleDefault||(Object.create?function(p,E){Object.defineProperty(p,"default",{enumerable:!0,value:E})}:function(p,E){p.default=E}),i=e&&e.__importStar||function(p){if(p&&p.__esModule)return p;var E={};if(p!=null)for(var B in p)B!=="default"&&Object.prototype.hasOwnProperty.call(p,B)&&r(E,p,B);return n(E,p),E};Object.defineProperty(e,"__esModule",{value:!0}),e.lefts=e.rights=e.reverse=e.modifyAt=e.deleteAt=e.updateAt=e.insertAt=e.copy=e.findLastIndex=e.findLastMap=e.findLast=e.findFirstMap=e.findFirst=e.findIndex=e.dropLeftWhile=e.dropRight=e.dropLeft=e.spanLeft=e.takeLeftWhile=e.takeRight=e.takeLeft=e.init=e.tail=e.last=e.head=e.lookup=e.isOutOfBound=e.size=e.scanRight=e.scanLeft=e.chainWithIndex=e.foldRight=e.matchRight=e.matchRightW=e.foldLeft=e.matchLeft=e.matchLeftW=e.match=e.matchW=e.fromEither=e.fromOption=e.fromPredicate=e.replicate=e.makeBy=e.appendW=e.append=e.prependW=e.prepend=e.isNonEmpty=e.isEmpty=void 0,e.traverseWithIndex=e.sequence=e.traverse=e.reduceRightWithIndex=e.reduceRight=e.reduceWithIndex=e.reduce=e.foldMapWithIndex=e.foldMap=e.duplicate=e.extend=e.filterWithIndex=e.alt=e.altW=e.partitionMapWithIndex=e.partitionMap=e.partitionWithIndex=e.partition=e.filter=e.separate=e.compact=e.filterMap=e.filterMapWithIndex=e.mapWithIndex=e.flatten=e.chain=e.ap=e.map=e.zero=e.of=e.difference=e.intersection=e.union=e.concat=e.concatW=e.comprehension=e.fromOptionK=e.chunksOf=e.splitAt=e.chop=e.sortBy=e.uniq=e.elem=e.rotate=e.intersperse=e.prependAll=e.unzip=e.zip=e.zipWith=e.sort=void 0,e.some=e.every=e.unsafeDeleteAt=e.unsafeUpdateAt=e.unsafeInsertAt=e.fromEitherK=e.FromEither=e.filterE=e.ChainRecBreadthFirst=e.chainRecBreadthFirst=e.ChainRecDepthFirst=e.chainRecDepthFirst=e.Witherable=e.TraversableWithIndex=e.Traversable=e.FoldableWithIndex=e.Foldable=e.FilterableWithIndex=e.Filterable=e.Compactable=e.Extend=e.Alternative=e.guard=e.Zero=e.Alt=e.Unfoldable=e.Monad=e.chainFirst=e.Chain=e.Applicative=e.apSecond=e.apFirst=e.Apply=e.FunctorWithIndex=e.Pointed=e.flap=e.Functor=e.getDifferenceMagma=e.getIntersectionSemigroup=e.getUnionMonoid=e.getUnionSemigroup=e.getOrd=e.getEq=e.getMonoid=e.getSemigroup=e.getShow=e.URI=e.unfold=e.wilt=e.wither=void 0,e.array=e.prependToAll=e.snoc=e.cons=e.empty=e.range=e.apS=e.bind=e.bindTo=e.Do=e.intercalate=e.exists=void 0;var a=sa(),u=hi(),o=sc(),s=Jt(),c=di(),l=i(kr()),f=i(Rv()),h=i(Bv()),g=lc(),C=fc(),R=hc(),k=function(p){return p.length===0};e.isEmpty=k,e.isNonEmpty=f.isNonEmpty,e.prepend=f.prepend,e.prependW=f.prependW,e.append=f.append,e.appendW=f.appendW;var z=function(p,E){return p<=0?[]:f.makeBy(E)(p)};e.makeBy=z;var A=function(p,E){return(0,e.makeBy)(p,function(){return E})};e.replicate=A;function S(p){return function(E){return p(E)?[E]:[]}}e.fromPredicate=S;var O=function(p){return l.isNone(p)?[]:[p.value]};e.fromOption=O;var $=function(p){return l.isLeft(p)?[]:[p.right]};e.fromEither=$;var _=function(p,E){return function(B){return(0,e.isNonEmpty)(B)?E(B):p()}};e.matchW=_,e.match=e.matchW;var I=function(p,E){return function(B){return(0,e.isNonEmpty)(B)?E(f.head(B),f.tail(B)):p()}};e.matchLeftW=I,e.matchLeft=e.matchLeftW,e.foldLeft=e.matchLeft;var P=function(p,E){return function(B){return(0,e.isNonEmpty)(B)?E(f.init(B),f.last(B)):p()}};e.matchRightW=P,e.matchRight=e.matchRightW,e.foldRight=e.matchRight;var V=function(p){return function(E){for(var B=[],K=0;K<E.length;K++)B.push.apply(B,p(K,E[K]));return B}};e.chainWithIndex=V;var ue=function(p,E){return function(B){var K=B.length,se=new Array(K+1);se[0]=p;for(var le=0;le<K;le++)se[le+1]=E(se[le],B[le]);return se}};e.scanLeft=ue;var ee=function(p,E){return function(B){var K=B.length,se=new Array(K+1);se[K]=p;for(var le=K-1;le>=0;le--)se[le]=E(B[le],se[le+1]);return se}};e.scanRight=ee;var pe=function(p){return p.length};e.size=pe,e.isOutOfBound=f.isOutOfBound,e.lookup=h.lookup,e.head=h.head,e.last=h.last;var be=function(p){return(0,e.isNonEmpty)(p)?l.some(f.tail(p)):l.none};e.tail=be;var T=function(p){return(0,e.isNonEmpty)(p)?l.some(f.init(p)):l.none};e.init=T;var q=function(p){return function(E){return(0,e.isOutOfBound)(p,E)?(0,e.copy)(E):E.slice(0,p)}};e.takeLeft=q;var G=function(p){return function(E){return(0,e.isOutOfBound)(p,E)?(0,e.copy)(E):p===0?[]:E.slice(-p)}};e.takeRight=G;function x(p){return function(E){for(var B=[],K=0,se=E;K<se.length;K++){var le=se[K];if(!p(le))break;B.push(le)}return B}}e.takeLeftWhile=x;var ne=function(p,E){for(var B=p.length,K=0;K<B&&E(p[K]);K++);return K};function Q(p){return function(E){var B=(0,e.splitAt)(ne(E,p))(E),K=B[0],se=B[1];return{init:K,rest:se}}}e.spanLeft=Q;var ye=function(p){return function(E){return p<=0||(0,e.isEmpty)(E)?(0,e.copy)(E):p>=E.length?[]:E.slice(p,E.length)}};e.dropLeft=ye;var Fe=function(p){return function(E){return p<=0||(0,e.isEmpty)(E)?(0,e.copy)(E):p>=E.length?[]:E.slice(0,E.length-p)}};e.dropRight=Fe;function Qe(p){return function(E){return E.slice(ne(E,p))}}e.dropLeftWhile=Qe,e.findIndex=h.findIndex;function ve(p){return h.findFirst(p)}e.findFirst=ve,e.findFirstMap=h.findFirstMap;function ze(p){return h.findLast(p)}e.findLast=ze,e.findLastMap=h.findLastMap,e.findLastIndex=h.findLastIndex;var vt=function(p){return p.slice()};e.copy=vt;var Be=function(p,E){return function(B){return p<0||p>B.length?l.none:l.some((0,e.unsafeInsertAt)(p,E,B))}};e.insertAt=Be;var st=function(p,E){return(0,e.modifyAt)(p,function(){return E})};e.updateAt=st;var Pt=function(p){return function(E){return(0,e.isOutOfBound)(p,E)?l.none:l.some((0,e.unsafeDeleteAt)(p,E))}};e.deleteAt=Pt;var Xt=function(p,E){return function(B){return(0,e.isOutOfBound)(p,B)?l.none:l.some((0,e.unsafeUpdateAt)(p,E(B[p]),B))}};e.modifyAt=Xt;var dr=function(p){return(0,e.isEmpty)(p)?[]:p.slice().reverse()};e.reverse=dr;var Ke=function(p){for(var E=[],B=0;B<p.length;B++){var K=p[B];K._tag==="Right"&&E.push(K.right)}return E};e.rights=Ke;var De=function(p){for(var E=[],B=0;B<p.length;B++){var K=p[B];K._tag==="Left"&&E.push(K.left)}return E};e.lefts=De;var ct=function(p){return function(E){return E.length<=1?(0,e.copy)(E):E.slice().sort(p.compare)}};e.sort=ct;var Me=function(p,E,B){for(var K=[],se=Math.min(p.length,E.length),le=0;le<se;le++)K[le]=B(p[le],E[le]);return K};e.zipWith=Me;function Je(p,E){return E===void 0?function(B){return Je(B,p)}:(0,e.zipWith)(p,E,function(B,K){return[B,K]})}e.zip=Je;var lt=function(p){for(var E=[],B=[],K=0;K<p.length;K++)E[K]=p[K][0],B[K]=p[K][1];return[E,B]};e.unzip=lt;var $e=function(p){var E=f.prependAll(p);return function(B){return(0,e.isNonEmpty)(B)?E(B):[]}};e.prependAll=$e;var Pe=function(p){var E=f.intersperse(p);return function(B){return(0,e.isNonEmpty)(B)?E(B):(0,e.copy)(B)}};e.intersperse=Pe;var Se=function(p){var E=f.rotate(p);return function(B){return(0,e.isNonEmpty)(B)?E(B):(0,e.copy)(B)}};e.rotate=Se,e.elem=h.elem;var At=function(p){var E=f.uniq(p);return function(B){return(0,e.isNonEmpty)(B)?E(B):(0,e.copy)(B)}};e.uniq=At;var yt=function(p){var E=f.sortBy(p);return function(B){return(0,e.isNonEmpty)(B)?E(B):(0,e.copy)(B)}};e.sortBy=yt;var Nt=function(p){var E=f.chop(p);return function(B){return(0,e.isNonEmpty)(B)?E(B):[]}};e.chop=Nt;var Ct=function(p){return function(E){return p>=1&&(0,e.isNonEmpty)(E)?f.splitAt(p)(E):(0,e.isEmpty)(E)?[(0,e.copy)(E),[]]:[[],(0,e.copy)(E)]}};e.splitAt=Ct;var fe=function(p){var E=f.chunksOf(p);return function(B){return(0,e.isNonEmpty)(B)?E(B):[]}};e.chunksOf=fe;var he=function(p){return function(){for(var E=[],B=0;B<arguments.length;B++)E[B]=arguments[B];return(0,e.fromOption)(p.apply(void 0,E))}};e.fromOptionK=he;function zt(p,E,B){B===void 0&&(B=function(){return!0});var K=function(se,le){return(0,e.isNonEmpty)(le)?(0,s.pipe)(f.head(le),(0,e.chain)(function(Ur){return K((0,s.pipe)(se,(0,e.append)(Ur)),f.tail(le))})):B.apply(void 0,se)?[E.apply(void 0,se)]:[]};return K([],p)}e.comprehension=zt;var ft=function(p){return function(E){return(0,e.isEmpty)(E)?(0,e.copy)(p):(0,e.isEmpty)(p)?(0,e.copy)(E):E.concat(p)}};e.concatW=ft,e.concat=e.concatW;function me(p){var E=f.union(p);return function(B,K){if(K===void 0){var se=me(p);return function(le){return se(le,B)}}return(0,e.isNonEmpty)(B)&&(0,e.isNonEmpty)(K)?E(K)(B):(0,e.isNonEmpty)(B)?(0,e.copy)(B):(0,e.copy)(K)}}e.union=me;function Ft(p){var E=(0,e.elem)(p);return function(B,K){if(K===void 0){var se=Ft(p);return function(le){return se(le,B)}}return B.filter(function(le){return E(le,K)})}}e.intersection=Ft;function et(p){var E=(0,e.elem)(p);return function(B,K){if(K===void 0){var se=et(p);return function(le){return se(le,B)}}return B.filter(function(le){return!E(le,K)})}}e.difference=et;var j=function(p,E){return(0,s.pipe)(p,(0,e.map)(E))},Wt=function(p,E){return(0,s.pipe)(p,(0,e.mapWithIndex)(E))},Ee=function(p,E){return(0,s.pipe)(p,(0,e.ap)(E))},tt=function(p,E){return(0,s.pipe)(p,(0,e.chain)(E))},qt=function(p,E){return(0,s.pipe)(p,(0,e.filter)(E))},jt=function(p,E){return(0,s.pipe)(p,(0,e.filterMap)(E))},St=function(p,E){return(0,s.pipe)(p,(0,e.partition)(E))},_t=function(p,E){return(0,s.pipe)(p,(0,e.partitionMap)(E))},Mt=function(p,E){return(0,s.pipe)(p,(0,e.partitionWithIndex)(E))},mt=function(p,E){return(0,s.pipe)(p,(0,e.partitionMapWithIndex)(E))},de=function(p,E){return(0,s.pipe)(p,(0,e.alt)(E))},Te=function(p,E,B){return(0,s.pipe)(p,(0,e.reduce)(E,B))},Ve=function(p){var E=(0,e.foldMap)(p);return function(B,K){return(0,s.pipe)(B,E(K))}},rt=function(p,E,B){return(0,s.pipe)(p,(0,e.reduceRight)(E,B))},gt=function(p,E,B){return(0,s.pipe)(p,(0,e.reduceWithIndex)(E,B))},ht=function(p){var E=(0,e.foldMapWithIndex)(p);return function(B,K){return(0,s.pipe)(B,E(K))}},It=function(p,E,B){return(0,s.pipe)(p,(0,e.reduceRightWithIndex)(E,B))},Ot=function(p,E){return(0,s.pipe)(p,(0,e.filterMapWithIndex)(E))},Qt=function(p,E){return(0,s.pipe)(p,(0,e.filterWithIndex)(E))},er=function(p,E){return(0,s.pipe)(p,(0,e.extend)(E))},d=function(p){var E=(0,e.traverse)(p);return function(B,K){return(0,s.pipe)(B,E(K))}},y=function(p){var E=(0,e.traverseWithIndex)(p);return function(B,K){return(0,s.pipe)(B,E(K))}},M=h._chainRecDepthFirst,N=h._chainRecBreadthFirst;e.of=f.of;var Y=function(){return[]};e.zero=Y;var te=function(p){return function(E){return E.map(function(B){return p(B)})}};e.map=te;var oe=function(p){return(0,e.chain)(function(E){return(0,s.pipe)(p,(0,e.map)(E))})};e.ap=oe;var Ne=function(p){return function(E){return(0,s.pipe)(E,(0,e.chainWithIndex)(function(B,K){return p(K)}))}};e.chain=Ne,e.flatten=(0,e.chain)(s.identity);var Re=function(p){return function(E){return E.map(function(B,K){return p(K,B)})}};e.mapWithIndex=Re;var nt=function(p){return function(E){for(var B=[],K=0;K<E.length;K++){var se=p(K,E[K]);l.isSome(se)&&B.push(se.value)}return B}};e.filterMapWithIndex=nt;var pt=function(p){return(0,e.filterMapWithIndex)(function(E,B){return p(B)})};e.filterMap=pt,e.compact=(0,e.filterMap)(s.identity);var D=function(p){for(var E=[],B=[],K=0,se=p;K<se.length;K++){var le=se[K];le._tag==="Left"?E.push(le.left):B.push(le.right)}return(0,g.separated)(E,B)};e.separate=D;var b=function(p){return function(E){return E.filter(p)}};e.filter=b;var W=function(p){return(0,e.partitionWithIndex)(function(E,B){return p(B)})};e.partition=W;var H=function(p){return function(E){for(var B=[],K=[],se=0;se<E.length;se++){var le=E[se];p(se,le)?K.push(le):B.push(le)}return(0,g.separated)(B,K)}};e.partitionWithIndex=H;var ce=function(p){return(0,e.partitionMapWithIndex)(function(E,B){return p(B)})};e.partitionMap=ce;var we=function(p){return function(E){for(var B=[],K=[],se=0;se<E.length;se++){var le=p(se,E[se]);le._tag==="Left"?B.push(le.left):K.push(le.right)}return(0,g.separated)(B,K)}};e.partitionMapWithIndex=we;var qe=function(p){return function(E){return E.concat(p())}};e.altW=qe,e.alt=e.altW;var Rt=function(p){return function(E){return E.filter(function(B,K){return p(K,B)})}};e.filterWithIndex=Rt;var Ae=function(p){return function(E){return E.map(function(B,K){return p(E.slice(K))})}};e.extend=Ae,e.duplicate=(0,e.extend)(s.identity),e.foldMap=h.foldMap,e.foldMapWithIndex=h.foldMapWithIndex,e.reduce=h.reduce,e.reduceWithIndex=h.reduceWithIndex,e.reduceRight=h.reduceRight,e.reduceRightWithIndex=h.reduceRightWithIndex;var je=function(p){var E=(0,e.traverseWithIndex)(p);return function(B){return E(function(K,se){return B(se)})}};e.traverse=je;var ge=function(p){return function(E){return Te(E,p.of((0,e.zero)()),function(B,K){return p.ap(p.map(B,function(se){return function(le){return(0,s.pipe)(se,(0,e.append)(le))}}),K)})}};e.sequence=ge;var Ye=function(p){return function(E){return(0,e.reduceWithIndex)(p.of((0,e.zero)()),function(B,K,se){return p.ap(p.map(K,function(le){return function(Ur){return(0,s.pipe)(le,(0,e.append)(Ur))}}),E(B,se))})}};e.traverseWithIndex=Ye;var wt=function(p){var E=jn(p);return function(B){return function(K){return E(K,B)}}};e.wither=wt;var Xe=function(p){var E=Un(p);return function(B){return function(K){return E(K,B)}}};e.wilt=Xe;var tr=function(p,E){for(var B=[],K=p;;){var se=E(K);if(l.isSome(se)){var le=se.value,Ur=le[0],Ta=le[1];B.push(Ur),K=Ta}else break}return B};e.unfold=tr,e.URI="Array",e.getShow=h.getShow;var kt=function(){return{concat:function(p,E){return p.concat(E)}}};e.getSemigroup=kt;var Ut=function(){return{concat:(0,e.getSemigroup)().concat,empty:[]}};e.getMonoid=Ut,e.getEq=h.getEq,e.getOrd=h.getOrd;var rr=function(p){var E=me(p);return{concat:function(B,K){return E(K)(B)}}};e.getUnionSemigroup=rr;var Mr=function(p){return{concat:(0,e.getUnionSemigroup)(p).concat,empty:[]}};e.getUnionMonoid=Mr;var qn=function(p){var E=Ft(p);return{concat:function(B,K){return E(K)(B)}}};e.getIntersectionSemigroup=qn;var Oa=function(p){var E=et(p);return{concat:function(B,K){return E(K)(B)}}};e.getDifferenceMagma=Oa,e.Functor={URI:e.URI,map:j},e.flap=(0,c.flap)(e.Functor),e.Pointed={URI:e.URI,of:e.of},e.FunctorWithIndex={URI:e.URI,map:j,mapWithIndex:Wt},e.Apply={URI:e.URI,map:j,ap:Ee},e.apFirst=(0,a.apFirst)(e.Apply),e.apSecond=(0,a.apSecond)(e.Apply),e.Applicative={URI:e.URI,map:j,ap:Ee,of:e.of},e.Chain={URI:e.URI,map:j,ap:Ee,chain:tt},e.chainFirst=(0,u.chainFirst)(e.Chain),e.Monad={URI:e.URI,map:j,ap:Ee,of:e.of,chain:tt},e.Unfoldable={URI:e.URI,unfold:e.unfold},e.Alt={URI:e.URI,map:j,alt:de},e.Zero={URI:e.URI,zero:e.zero},e.guard=(0,R.guard)(e.Zero,e.Pointed),e.Alternative={URI:e.URI,map:j,ap:Ee,of:e.of,alt:de,zero:e.zero},e.Extend={URI:e.URI,map:j,extend:er},e.Compactable={URI:e.URI,compact:e.compact,separate:e.separate},e.Filterable={URI:e.URI,map:j,compact:e.compact,separate:e.separate,filter:qt,filterMap:jt,partition:St,partitionMap:_t},e.FilterableWithIndex={URI:e.URI,map:j,mapWithIndex:Wt,compact:e.compact,separate:e.separate,filter:qt,filterMap:jt,partition:St,partitionMap:_t,partitionMapWithIndex:mt,partitionWithIndex:Mt,filterMapWithIndex:Ot,filterWithIndex:Qt},e.Foldable={URI:e.URI,reduce:Te,foldMap:Ve,reduceRight:rt},e.FoldableWithIndex={URI:e.URI,reduce:Te,foldMap:Ve,reduceRight:rt,reduceWithIndex:gt,foldMapWithIndex:ht,reduceRightWithIndex:It},e.Traversable={URI:e.URI,map:j,reduce:Te,foldMap:Ve,reduceRight:rt,traverse:d,sequence:e.sequence},e.TraversableWithIndex={URI:e.URI,map:j,mapWithIndex:Wt,reduce:Te,foldMap:Ve,reduceRight:rt,reduceWithIndex:gt,foldMapWithIndex:ht,reduceRightWithIndex:It,traverse:d,sequence:e.sequence,traverseWithIndex:y};var jn=(0,C.witherDefault)(e.Traversable,e.Compactable),Un=(0,C.wiltDefault)(e.Traversable,e.Compactable);e.Witherable={URI:e.URI,map:j,compact:e.compact,separate:e.separate,filter:qt,filterMap:jt,partition:St,partitionMap:_t,reduce:Te,foldMap:Ve,reduceRight:rt,traverse:d,sequence:e.sequence,wither:jn,wilt:Un},e.chainRecDepthFirst=h.chainRecDepthFirst,e.ChainRecDepthFirst={URI:e.URI,map:j,ap:Ee,chain:tt,chainRec:M},e.chainRecBreadthFirst=h.chainRecBreadthFirst,e.ChainRecBreadthFirst={URI:e.URI,map:j,ap:Ee,chain:tt,chainRec:N},e.filterE=(0,C.filterE)(e.Witherable),e.FromEither={URI:e.URI,fromEither:e.fromEither},e.fromEitherK=(0,o.fromEitherK)(e.FromEither),e.unsafeInsertAt=f.unsafeInsertAt;var ka=function(p,E,B){return(0,e.isNonEmpty)(B)?f.unsafeUpdateAt(p,E,B):[]};e.unsafeUpdateAt=ka;var La=function(p,E){var B=E.slice();return B.splice(p,1),B};e.unsafeDeleteAt=La,e.every=h.every;var $a=function(p){return function(E){return E.some(p)}};e.some=$a,e.exists=e.some,e.intercalate=h.intercalate,e.Do=(0,e.of)(l.emptyRecord),e.bindTo=(0,c.bindTo)(e.Functor),e.bind=(0,u.bind)(e.Chain),e.apS=(0,a.apS)(e.Apply),e.range=f.range,e.empty=[],e.cons=f.cons,e.snoc=f.snoc,e.prependToAll=e.prependAll,e.array={URI:e.URI,compact:e.compact,separate:e.separate,map:j,ap:Ee,of:e.of,chain:tt,filter:qt,filterMap:jt,partition:St,partitionMap:_t,mapWithIndex:Wt,partitionMapWithIndex:mt,partitionWithIndex:Mt,filterMapWithIndex:Ot,filterWithIndex:Qt,alt:de,zero:e.zero,unfold:e.unfold,reduce:Te,foldMap:Ve,reduceRight:rt,traverse:d,sequence:e.sequence,reduceWithIndex:gt,foldMapWithIndex:ht,reduceRightWithIndex:It,traverseWithIndex:y,extend:er,wither:jn,wilt:Un}}}),Nv=Ze({"node_modules/fp-ts/lib/string.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.endsWith=e.startsWith=e.includes=e.split=e.size=e.isEmpty=e.slice=e.trimRight=e.trimLeft=e.trim=e.replace=e.toLowerCase=e.toUpperCase=e.isString=e.Show=e.Ord=e.Monoid=e.empty=e.Semigroup=e.Eq=void 0;var r=Ku();e.Eq={equals:function(z,A){return z===A}},e.Semigroup={concat:function(z,A){return z+A}},e.empty="",e.Monoid={concat:e.Semigroup.concat,empty:e.empty},e.Ord={equals:e.Eq.equals,compare:function(z,A){return z<A?-1:z>A?1:0}},e.Show={show:function(z){return JSON.stringify(z)}};var n=function(z){return typeof z=="string"};e.isString=n;var i=function(z){return z.toUpperCase()};e.toUpperCase=i;var a=function(z){return z.toLowerCase()};e.toLowerCase=a;var u=function(z,A){return function(S){return S.replace(z,A)}};e.replace=u;var o=function(z){return z.trim()};e.trim=o;var s=function(z){return z.trimLeft()};e.trimLeft=s;var c=function(z){return z.trimRight()};e.trimRight=c;var l=function(z,A){return function(S){return S.slice(z,A)}};e.slice=l;var f=function(z){return z.length===0};e.isEmpty=f;var h=function(z){return z.length};e.size=h;var g=function(z){return function(A){var S=A.split(z);return(0,r.isNonEmpty)(S)?S:[A]}};e.split=g;var C=function(z,A){return function(S){return S.includes(z,A)}};e.includes=C;var R=function(z,A){return function(S){return S.startsWith(z,A)}};e.startsWith=R;var k=function(z,A){return function(S){return S.endsWith(z,A)}};e.endsWith=k}}),zv=Ze({"node_modules/rxjs/node_modules/tslib/tslib.js"(e,r){var n,i,a,u,o,s,c,l,f,h,g,C,R,k,z,A,S,O,$,_,I,P,V,ue;(function(ee){var pe=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&define.amd?define("tslib",["exports"],function(T){ee(be(pe,be(T)))}):typeof r=="object"&&typeof r.exports=="object"?ee(be(pe,be(r.exports))):ee(be(pe));function be(T,q){return T!==pe&&(typeof Object.create=="function"?Object.defineProperty(T,"__esModule",{value:!0}):T.__esModule=!0),function(G,x){return T[G]=q?q(G,x):x}}})(function(ee){var pe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,q){T.__proto__=q}||function(T,q){for(var G in q)Object.prototype.hasOwnProperty.call(q,G)&&(T[G]=q[G])};n=function(T,q){if(typeof q!="function"&&q!==null)throw new TypeError("Class extends value "+String(q)+" is not a constructor or null");pe(T,q);function G(){this.constructor=T}T.prototype=q===null?Object.create(q):(G.prototype=q.prototype,new G)},i=Object.assign||function(T){for(var q,G=1,x=arguments.length;G<x;G++){q=arguments[G];for(var ne in q)Object.prototype.hasOwnProperty.call(q,ne)&&(T[ne]=q[ne])}return T},a=function(T,q){var G={};for(var x in T)Object.prototype.hasOwnProperty.call(T,x)&&q.indexOf(x)<0&&(G[x]=T[x]);if(T!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ne=0,x=Object.getOwnPropertySymbols(T);ne<x.length;ne++)q.indexOf(x[ne])<0&&Object.prototype.propertyIsEnumerable.call(T,x[ne])&&(G[x[ne]]=T[x[ne]]);return G},u=function(T,q,G,x){var ne=arguments.length,Q=ne<3?q:x===null?x=Object.getOwnPropertyDescriptor(q,G):x,ye;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Q=Reflect.decorate(T,q,G,x);else for(var Fe=T.length-1;Fe>=0;Fe--)(ye=T[Fe])&&(Q=(ne<3?ye(Q):ne>3?ye(q,G,Q):ye(q,G))||Q);return ne>3&&Q&&Object.defineProperty(q,G,Q),Q},o=function(T,q){return function(G,x){q(G,x,T)}},s=function(T,q){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(T,q)},c=function(T,q,G,x){function ne(Q){return Q instanceof G?Q:new G(function(ye){ye(Q)})}return new(G||(G=Promise))(function(Q,ye){function Fe(ze){try{ve(x.next(ze))}catch(vt){ye(vt)}}function Qe(ze){try{ve(x.throw(ze))}catch(vt){ye(vt)}}function ve(ze){ze.done?Q(ze.value):ne(ze.value).then(Fe,Qe)}ve((x=x.apply(T,q||[])).next())})},l=function(T,q){var G={label:0,sent:function(){if(Q[0]&1)throw Q[1];return Q[1]},trys:[],ops:[]},x,ne,Q,ye;return ye={next:Fe(0),throw:Fe(1),return:Fe(2)},typeof Symbol=="function"&&(ye[Symbol.iterator]=function(){return this}),ye;function Fe(ve){return function(ze){return Qe([ve,ze])}}function Qe(ve){if(x)throw new TypeError("Generator is already executing.");for(;G;)try{if(x=1,ne&&(Q=ve[0]&2?ne.return:ve[0]?ne.throw||((Q=ne.return)&&Q.call(ne),0):ne.next)&&!(Q=Q.call(ne,ve[1])).done)return Q;switch(ne=0,Q&&(ve=[ve[0]&2,Q.value]),ve[0]){case 0:case 1:Q=ve;break;case 4:return G.label++,{value:ve[1],done:!1};case 5:G.label++,ne=ve[1],ve=[0];continue;case 7:ve=G.ops.pop(),G.trys.pop();continue;default:if(Q=G.trys,!(Q=Q.length>0&&Q[Q.length-1])&&(ve[0]===6||ve[0]===2)){G=0;continue}if(ve[0]===3&&(!Q||ve[1]>Q[0]&&ve[1]<Q[3])){G.label=ve[1];break}if(ve[0]===6&&G.label<Q[1]){G.label=Q[1],Q=ve;break}if(Q&&G.label<Q[2]){G.label=Q[2],G.ops.push(ve);break}Q[2]&&G.ops.pop(),G.trys.pop();continue}ve=q.call(T,G)}catch(ze){ve=[6,ze],ne=0}finally{x=Q=0}if(ve[0]&5)throw ve[1];return{value:ve[0]?ve[1]:void 0,done:!0}}},f=function(T,q){for(var G in T)G!=="default"&&!Object.prototype.hasOwnProperty.call(q,G)&&ue(q,T,G)},ue=Object.create?function(T,q,G,x){x===void 0&&(x=G),Object.defineProperty(T,x,{enumerable:!0,get:function(){return q[G]}})}:function(T,q,G,x){x===void 0&&(x=G),T[x]=q[G]},h=function(T){var q=typeof Symbol=="function"&&Symbol.iterator,G=q&&T[q],x=0;if(G)return G.call(T);if(T&&typeof T.length=="number")return{next:function(){return T&&x>=T.length&&(T=void 0),{value:T&&T[x++],done:!T}}};throw new TypeError(q?"Object is not iterable.":"Symbol.iterator is not defined.")},g=function(T,q){var G=typeof Symbol=="function"&&T[Symbol.iterator];if(!G)return T;var x=G.call(T),ne,Q=[],ye;try{for(;(q===void 0||q-- >0)&&!(ne=x.next()).done;)Q.push(ne.value)}catch(Fe){ye={error:Fe}}finally{try{ne&&!ne.done&&(G=x.return)&&G.call(x)}finally{if(ye)throw ye.error}}return Q},C=function(){for(var T=[],q=0;q<arguments.length;q++)T=T.concat(g(arguments[q]));return T},R=function(){for(var T=0,q=0,G=arguments.length;q<G;q++)T+=arguments[q].length;for(var x=Array(T),ne=0,q=0;q<G;q++)for(var Q=arguments[q],ye=0,Fe=Q.length;ye<Fe;ye++,ne++)x[ne]=Q[ye];return x},k=function(T,q,G){if(G||arguments.length===2)for(var x=0,ne=q.length,Q;x<ne;x++)(Q||!(x in q))&&(Q||(Q=Array.prototype.slice.call(q,0,x)),Q[x]=q[x]);return T.concat(Q||Array.prototype.slice.call(q))},z=function(T){return this instanceof z?(this.v=T,this):new z(T)},A=function(T,q,G){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var x=G.apply(T,q||[]),ne,Q=[];return ne={},ye("next"),ye("throw"),ye("return"),ne[Symbol.asyncIterator]=function(){return this},ne;function ye(Be){x[Be]&&(ne[Be]=function(st){return new Promise(function(Pt,Xt){Q.push([Be,st,Pt,Xt])>1||Fe(Be,st)})})}function Fe(Be,st){try{Qe(x[Be](st))}catch(Pt){vt(Q[0][3],Pt)}}function Qe(Be){Be.value instanceof z?Promise.resolve(Be.value.v).then(ve,ze):vt(Q[0][2],Be)}function ve(Be){Fe("next",Be)}function ze(Be){Fe("throw",Be)}function vt(Be,st){Be(st),Q.shift(),Q.length&&Fe(Q[0][0],Q[0][1])}},S=function(T){var q,G;return q={},x("next"),x("throw",function(ne){throw ne}),x("return"),q[Symbol.iterator]=function(){return this},q;function x(ne,Q){q[ne]=T[ne]?function(ye){return(G=!G)?{value:z(T[ne](ye)),done:ne==="return"}:Q?Q(ye):ye}:Q}},O=function(T){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var q=T[Symbol.asyncIterator],G;return q?q.call(T):(T=typeof h=="function"?h(T):T[Symbol.iterator](),G={},x("next"),x("throw"),x("return"),G[Symbol.asyncIterator]=function(){return this},G);function x(Q){G[Q]=T[Q]&&function(ye){return new Promise(function(Fe,Qe){ye=T[Q](ye),ne(Fe,Qe,ye.done,ye.value)})}}function ne(Q,ye,Fe,Qe){Promise.resolve(Qe).then(function(ve){Q({value:ve,done:Fe})},ye)}},$=function(T,q){return Object.defineProperty?Object.defineProperty(T,"raw",{value:q}):T.raw=q,T};var be=Object.create?function(T,q){Object.defineProperty(T,"default",{enumerable:!0,value:q})}:function(T,q){T.default=q};_=function(T){if(T&&T.__esModule)return T;var q={};if(T!=null)for(var G in T)G!=="default"&&Object.prototype.hasOwnProperty.call(T,G)&&ue(q,T,G);return be(q,T),q},I=function(T){return T&&T.__esModule?T:{default:T}},P=function(T,q,G,x){if(G==="a"&&!x)throw new TypeError("Private accessor was defined without a getter");if(typeof q=="function"?T!==q||!x:!q.has(T))throw new TypeError("Cannot read private member from an object whose class did not declare it");return G==="m"?x:G==="a"?x.call(T):x?x.value:q.get(T)},V=function(T,q,G,x,ne){if(x==="m")throw new TypeError("Private method is not writable");if(x==="a"&&!ne)throw new TypeError("Private accessor was defined without a setter");if(typeof q=="function"?T!==q||!ne:!q.has(T))throw new TypeError("Cannot write private member to an object whose class did not declare it");return x==="a"?ne.call(T,G):ne?ne.value=G:q.set(T,G),G},ee("__extends",n),ee("__assign",i),ee("__rest",a),ee("__decorate",u),ee("__param",o),ee("__metadata",s),ee("__awaiter",c),ee("__generator",l),ee("__exportStar",f),ee("__createBinding",ue),ee("__values",h),ee("__read",g),ee("__spread",C),ee("__spreadArrays",R),ee("__spreadArray",k),ee("__await",z),ee("__asyncGenerator",A),ee("__asyncDelegator",S),ee("__asyncValues",O),ee("__makeTemplateObject",$),ee("__importStar",_),ee("__importDefault",I),ee("__classPrivateFieldGet",P),ee("__classPrivateFieldSet",V)})}}),Wv=Ze({"node_modules/json5/dist/index.js"(e,r){(function(n,i){typeof e=="object"&&typeof r<"u"?r.exports=i():typeof define=="function"&&define.amd?define(i):n.JSON5=i()})(e,function(){function n(d,y){return y={exports:{}},d(y,y.exports),y.exports}var i=n(function(d){var y=d.exports=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=y)}),a=n(function(d){var y=d.exports={version:"2.6.5"};typeof __e=="number"&&(__e=y)});a.version;var u=function(d){return typeof d=="object"?d!==null:typeof d=="function"},o=function(d){if(!u(d))throw TypeError(d+" is not an object!");return d},s=function(d){try{return!!d()}catch{return!0}},c=!s(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),l=i.document,f=u(l)&&u(l.createElement),h=function(d){return f?l.createElement(d):{}},g=!c&&!s(function(){return Object.defineProperty(h("div"),"a",{get:function(){return 7}}).a!=7}),C=function(d,y){if(!u(d))return d;var M,N;if(y&&typeof(M=d.toString)=="function"&&!u(N=M.call(d))||typeof(M=d.valueOf)=="function"&&!u(N=M.call(d))||!y&&typeof(M=d.toString)=="function"&&!u(N=M.call(d)))return N;throw TypeError("Can't convert object to primitive value")},R=Object.defineProperty,k=c?Object.defineProperty:function(y,M,N){if(o(y),M=C(M,!0),o(N),g)try{return R(y,M,N)}catch{}if("get"in N||"set"in N)throw TypeError("Accessors not supported!");return"value"in N&&(y[M]=N.value),y},z={f:k},A=function(d,y){return{enumerable:!(d&1),configurable:!(d&2),writable:!(d&4),value:y}},S=c?function(d,y,M){return z.f(d,y,A(1,M))}:function(d,y,M){return d[y]=M,d},O={}.hasOwnProperty,$=function(d,y){return O.call(d,y)},_=0,I=Math.random(),P=function(d){return"Symbol(".concat(d===void 0?"":d,")_",(++_+I).toString(36))},V=n(function(d){var y="__core-js_shared__",M=i[y]||(i[y]={});(d.exports=function(N,Y){return M[N]||(M[N]=Y!==void 0?Y:{})})("versions",[]).push({version:a.version,mode:"global",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})}),ue=V("native-function-to-string",Function.toString),ee=n(function(d){var y=P("src"),M="toString",N=(""+ue).split(M);a.inspectSource=function(Y){return ue.call(Y)},(d.exports=function(Y,te,oe,Ne){var Re=typeof oe=="function";Re&&($(oe,"name")||S(oe,"name",te)),Y[te]!==oe&&(Re&&($(oe,y)||S(oe,y,Y[te]?""+Y[te]:N.join(String(te)))),Y===i?Y[te]=oe:Ne?Y[te]?Y[te]=oe:S(Y,te,oe):(delete Y[te],S(Y,te,oe)))})(Function.prototype,M,function(){return typeof this=="function"&&this[y]||ue.call(this)})}),pe=function(d){if(typeof d!="function")throw TypeError(d+" is not a function!");return d},be=function(d,y,M){if(pe(d),y===void 0)return d;switch(M){case 1:return function(N){return d.call(y,N)};case 2:return function(N,Y){return d.call(y,N,Y)};case 3:return function(N,Y,te){return d.call(y,N,Y,te)}}return function(){return d.apply(y,arguments)}},T="prototype",q=function(d,y,M){var N=d&q.F,Y=d&q.G,te=d&q.S,oe=d&q.P,Ne=d&q.B,Re=Y?i:te?i[y]||(i[y]={}):(i[y]||{})[T],nt=Y?a:a[y]||(a[y]={}),pt=nt[T]||(nt[T]={}),D,b,W,H;Y&&(M=y);for(D in M)b=!N&&Re&&Re[D]!==void 0,W=(b?Re:M)[D],H=Ne&&b?be(W,i):oe&&typeof W=="function"?be(Function.call,W):W,Re&&ee(Re,D,W,d&q.U),nt[D]!=W&&S(nt,D,H),oe&&pt[D]!=W&&(pt[D]=W)};i.core=a,q.F=1,q.G=2,q.S=4,q.P=8,q.B=16,q.W=32,q.U=64,q.R=128;var G=q,x=Math.ceil,ne=Math.floor,Q=function(d){return isNaN(d=+d)?0:(d>0?ne:x)(d)},ye=function(d){if(d==null)throw TypeError("Can't call method on  "+d);return d},Fe=function(d){return function(y,M){var N=String(ye(y)),Y=Q(M),te=N.length,oe,Ne;return Y<0||Y>=te?d?"":void 0:(oe=N.charCodeAt(Y),oe<55296||oe>56319||Y+1===te||(Ne=N.charCodeAt(Y+1))<56320||Ne>57343?d?N.charAt(Y):oe:d?N.slice(Y,Y+2):(oe-55296<<10)+(Ne-56320)+65536)}},Qe=Fe(!1);G(G.P,"String",{codePointAt:function(y){return Qe(this,y)}}),a.String.codePointAt;var ve=Math.max,ze=Math.min,vt=function(d,y){return d=Q(d),d<0?ve(d+y,0):ze(d,y)},Be=String.fromCharCode,st=String.fromCodePoint;G(G.S+G.F*(!!st&&st.length!=1),"String",{fromCodePoint:function(y){for(var M=arguments,N=[],Y=arguments.length,te=0,oe;Y>te;){if(oe=+M[te++],vt(oe,1114111)!==oe)throw RangeError(oe+" is not a valid code point");N.push(oe<65536?Be(oe):Be(((oe-=65536)>>10)+55296,oe%1024+56320))}return N.join("")}}),a.String.fromCodePoint;var Pt=/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,Xt=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,dr=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/,Ke={Space_Separator:Pt,ID_Start:Xt,ID_Continue:dr},De={isSpaceSeparator:function(y){return typeof y=="string"&&Ke.Space_Separator.test(y)},isIdStartChar:function(y){return typeof y=="string"&&(y>="a"&&y<="z"||y>="A"&&y<="Z"||y==="$"||y==="_"||Ke.ID_Start.test(y))},isIdContinueChar:function(y){return typeof y=="string"&&(y>="a"&&y<="z"||y>="A"&&y<="Z"||y>="0"&&y<="9"||y==="$"||y==="_"||y==="\u200C"||y==="\u200D"||Ke.ID_Continue.test(y))},isDigit:function(y){return typeof y=="string"&&/[0-9]/.test(y)},isHexDigit:function(y){return typeof y=="string"&&/[0-9A-Fa-f]/.test(y)}},ct,Me,Je,lt,$e,Pe,Se,At,yt,Nt=function(y,M){ct=String(y),Me="start",Je=[],lt=0,$e=1,Pe=0,Se=void 0,At=void 0,yt=void 0;do Se=Ft(),_t[Me]();while(Se.type!=="eof");return typeof M=="function"?Ct({"":yt},"",M):yt};function Ct(d,y,M){var N=d[y];if(N!=null&&typeof N=="object")for(var Y in N){var te=Ct(N,Y,M);te===void 0?delete N[Y]:N[Y]=te}return M.call(d,y,N)}var fe,he,zt,ft,me;function Ft(){for(fe="default",he="",zt=!1,ft=1;;){me=et();var d=Wt[fe]();if(d)return d}}function et(){if(ct[lt])return String.fromCodePoint(ct.codePointAt(lt))}function j(){var d=et();return d===`
`?($e++,Pe=0):d?Pe+=d.length:Pe++,d&&(lt+=d.length),d}var Wt={default:function(){switch(me){case"	":case"\v":case"\f":case" ":case"\xA0":case"\uFEFF":case`
`:case"\r":case"\u2028":case"\u2029":j();return;case"/":j(),fe="comment";return;case void 0:return j(),Ee("eof")}if(De.isSpaceSeparator(me)){j();return}return Wt[Me]()},comment:function(){switch(me){case"*":j(),fe="multiLineComment";return;case"/":j(),fe="singleLineComment";return}throw de(j())},multiLineComment:function(){switch(me){case"*":j(),fe="multiLineCommentAsterisk";return;case void 0:throw de(j())}j()},multiLineCommentAsterisk:function(){switch(me){case"*":j();return;case"/":j(),fe="default";return;case void 0:throw de(j())}j(),fe="multiLineComment"},singleLineComment:function(){switch(me){case`
`:case"\r":case"\u2028":case"\u2029":j(),fe="default";return;case void 0:return j(),Ee("eof")}j()},value:function(){switch(me){case"{":case"[":return Ee("punctuator",j());case"n":return j(),tt("ull"),Ee("null",null);case"t":return j(),tt("rue"),Ee("boolean",!0);case"f":return j(),tt("alse"),Ee("boolean",!1);case"-":case"+":j()==="-"&&(ft=-1),fe="sign";return;case".":he=j(),fe="decimalPointLeading";return;case"0":he=j(),fe="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":he=j(),fe="decimalInteger";return;case"I":return j(),tt("nfinity"),Ee("numeric",1/0);case"N":return j(),tt("aN"),Ee("numeric",NaN);case'"':case"'":zt=j()==='"',he="",fe="string";return}throw de(j())},identifierNameStartEscape:function(){if(me!=="u")throw de(j());j();var y=St();switch(y){case"$":case"_":break;default:if(!De.isIdStartChar(y))throw Ve();break}he+=y,fe="identifierName"},identifierName:function(){switch(me){case"$":case"_":case"\u200C":case"\u200D":he+=j();return;case"\\":j(),fe="identifierNameEscape";return}if(De.isIdContinueChar(me)){he+=j();return}return Ee("identifier",he)},identifierNameEscape:function(){if(me!=="u")throw de(j());j();var y=St();switch(y){case"$":case"_":case"\u200C":case"\u200D":break;default:if(!De.isIdContinueChar(y))throw Ve();break}he+=y,fe="identifierName"},sign:function(){switch(me){case".":he=j(),fe="decimalPointLeading";return;case"0":he=j(),fe="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":he=j(),fe="decimalInteger";return;case"I":return j(),tt("nfinity"),Ee("numeric",ft*(1/0));case"N":return j(),tt("aN"),Ee("numeric",NaN)}throw de(j())},zero:function(){switch(me){case".":he+=j(),fe="decimalPoint";return;case"e":case"E":he+=j(),fe="decimalExponent";return;case"x":case"X":he+=j(),fe="hexadecimal";return}return Ee("numeric",ft*0)},decimalInteger:function(){switch(me){case".":he+=j(),fe="decimalPoint";return;case"e":case"E":he+=j(),fe="decimalExponent";return}if(De.isDigit(me)){he+=j();return}return Ee("numeric",ft*Number(he))},decimalPointLeading:function(){if(De.isDigit(me)){he+=j(),fe="decimalFraction";return}throw de(j())},decimalPoint:function(){switch(me){case"e":case"E":he+=j(),fe="decimalExponent";return}if(De.isDigit(me)){he+=j(),fe="decimalFraction";return}return Ee("numeric",ft*Number(he))},decimalFraction:function(){switch(me){case"e":case"E":he+=j(),fe="decimalExponent";return}if(De.isDigit(me)){he+=j();return}return Ee("numeric",ft*Number(he))},decimalExponent:function(){switch(me){case"+":case"-":he+=j(),fe="decimalExponentSign";return}if(De.isDigit(me)){he+=j(),fe="decimalExponentInteger";return}throw de(j())},decimalExponentSign:function(){if(De.isDigit(me)){he+=j(),fe="decimalExponentInteger";return}throw de(j())},decimalExponentInteger:function(){if(De.isDigit(me)){he+=j();return}return Ee("numeric",ft*Number(he))},hexadecimal:function(){if(De.isHexDigit(me)){he+=j(),fe="hexadecimalInteger";return}throw de(j())},hexadecimalInteger:function(){if(De.isHexDigit(me)){he+=j();return}return Ee("numeric",ft*Number(he))},string:function(){switch(me){case"\\":j(),he+=qt();return;case'"':if(zt)return j(),Ee("string",he);he+=j();return;case"'":if(!zt)return j(),Ee("string",he);he+=j();return;case`
`:case"\r":throw de(j());case"\u2028":case"\u2029":rt(me);break;case void 0:throw de(j())}he+=j()},start:function(){switch(me){case"{":case"[":return Ee("punctuator",j())}fe="value"},beforePropertyName:function(){switch(me){case"$":case"_":he=j(),fe="identifierName";return;case"\\":j(),fe="identifierNameStartEscape";return;case"}":return Ee("punctuator",j());case'"':case"'":zt=j()==='"',fe="string";return}if(De.isIdStartChar(me)){he+=j(),fe="identifierName";return}throw de(j())},afterPropertyName:function(){if(me===":")return Ee("punctuator",j());throw de(j())},beforePropertyValue:function(){fe="value"},afterPropertyValue:function(){switch(me){case",":case"}":return Ee("punctuator",j())}throw de(j())},beforeArrayValue:function(){if(me==="]")return Ee("punctuator",j());fe="value"},afterArrayValue:function(){switch(me){case",":case"]":return Ee("punctuator",j())}throw de(j())},end:function(){throw de(j())}};function Ee(d,y){return{type:d,value:y,line:$e,column:Pe}}function tt(d){for(var y=0,M=d;y<M.length;y+=1){var N=M[y],Y=et();if(Y!==N)throw de(j());j()}}function qt(){var d=et();switch(d){case"b":return j(),"\b";case"f":return j(),"\f";case"n":return j(),`
`;case"r":return j(),"\r";case"t":return j(),"	";case"v":return j(),"\v";case"0":if(j(),De.isDigit(et()))throw de(j());return"\0";case"x":return j(),jt();case"u":return j(),St();case`
`:case"\u2028":case"\u2029":return j(),"";case"\r":return j(),et()===`
`&&j(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":throw de(j());case void 0:throw de(j())}return j()}function jt(){var d="",y=et();if(!De.isHexDigit(y)||(d+=j(),y=et(),!De.isHexDigit(y)))throw de(j());return d+=j(),String.fromCodePoint(parseInt(d,16))}function St(){for(var d="",y=4;y-- >0;){var M=et();if(!De.isHexDigit(M))throw de(j());d+=j()}return String.fromCodePoint(parseInt(d,16))}var _t={start:function(){if(Se.type==="eof")throw Te();Mt()},beforePropertyName:function(){switch(Se.type){case"identifier":case"string":At=Se.value,Me="afterPropertyName";return;case"punctuator":mt();return;case"eof":throw Te()}},afterPropertyName:function(){if(Se.type==="eof")throw Te();Me="beforePropertyValue"},beforePropertyValue:function(){if(Se.type==="eof")throw Te();Mt()},beforeArrayValue:function(){if(Se.type==="eof")throw Te();if(Se.type==="punctuator"&&Se.value==="]"){mt();return}Mt()},afterPropertyValue:function(){if(Se.type==="eof")throw Te();switch(Se.value){case",":Me="beforePropertyName";return;case"}":mt()}},afterArrayValue:function(){if(Se.type==="eof")throw Te();switch(Se.value){case",":Me="beforeArrayValue";return;case"]":mt()}},end:function(){}};function Mt(){var d;switch(Se.type){case"punctuator":switch(Se.value){case"{":d={};break;case"[":d=[];break}break;case"null":case"boolean":case"numeric":case"string":d=Se.value;break}if(yt===void 0)yt=d;else{var y=Je[Je.length-1];Array.isArray(y)?y.push(d):y[At]=d}if(d!==null&&typeof d=="object")Je.push(d),Array.isArray(d)?Me="beforeArrayValue":Me="beforePropertyName";else{var M=Je[Je.length-1];M==null?Me="end":Array.isArray(M)?Me="afterArrayValue":Me="afterPropertyValue"}}function mt(){Je.pop();var d=Je[Je.length-1];d==null?Me="end":Array.isArray(d)?Me="afterArrayValue":Me="afterPropertyValue"}function de(d){return ht(d===void 0?"JSON5: invalid end of input at "+$e+":"+Pe:"JSON5: invalid character '"+gt(d)+"' at "+$e+":"+Pe)}function Te(){return ht("JSON5: invalid end of input at "+$e+":"+Pe)}function Ve(){return Pe-=5,ht("JSON5: invalid identifier character at "+$e+":"+Pe)}function rt(d){console.warn("JSON5: '"+gt(d)+"' in strings is not valid ECMAScript; consider escaping")}function gt(d){var y={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(y[d])return y[d];if(d<" "){var M=d.charCodeAt(0).toString(16);return"\\x"+("00"+M).substring(M.length)}return d}function ht(d){var y=new SyntaxError(d);return y.lineNumber=$e,y.columnNumber=Pe,y}var It=function(y,M,N){var Y=[],te="",oe,Ne,Re="",nt;if(M!=null&&typeof M=="object"&&!Array.isArray(M)&&(N=M.space,nt=M.quote,M=M.replacer),typeof M=="function")Ne=M;else if(Array.isArray(M)){oe=[];for(var pt=0,D=M;pt<D.length;pt+=1){var b=D[pt],W=void 0;typeof b=="string"?W=b:(typeof b=="number"||b instanceof String||b instanceof Number)&&(W=String(b)),W!==void 0&&oe.indexOf(W)<0&&oe.push(W)}}return N instanceof Number?N=Number(N):N instanceof String&&(N=String(N)),typeof N=="number"?N>0&&(N=Math.min(10,Math.floor(N)),Re="          ".substr(0,N)):typeof N=="string"&&(Re=N.substr(0,10)),H("",{"":y});function H(Ae,je){var ge=je[Ae];switch(ge!=null&&(typeof ge.toJSON5=="function"?ge=ge.toJSON5(Ae):typeof ge.toJSON=="function"&&(ge=ge.toJSON(Ae))),Ne&&(ge=Ne.call(je,Ae,ge)),ge instanceof Number?ge=Number(ge):ge instanceof String?ge=String(ge):ge instanceof Boolean&&(ge=ge.valueOf()),ge){case null:return"null";case!0:return"true";case!1:return"false"}if(typeof ge=="string")return ce(ge);if(typeof ge=="number")return String(ge);if(typeof ge=="object")return Array.isArray(ge)?Rt(ge):we(ge)}function ce(Ae){for(var je={"'":.1,'"':.2},ge={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"},Ye="",wt=0;wt<Ae.length;wt++){var Xe=Ae[wt];switch(Xe){case"'":case'"':je[Xe]++,Ye+=Xe;continue;case"\0":if(De.isDigit(Ae[wt+1])){Ye+="\\x00";continue}}if(ge[Xe]){Ye+=ge[Xe];continue}if(Xe<" "){var tr=Xe.charCodeAt(0).toString(16);Ye+="\\x"+("00"+tr).substring(tr.length);continue}Ye+=Xe}var kt=nt||Object.keys(je).reduce(function(Ut,rr){return je[Ut]<je[rr]?Ut:rr});return Ye=Ye.replace(new RegExp(kt,"g"),ge[kt]),kt+Ye+kt}function we(Ae){if(Y.indexOf(Ae)>=0)throw TypeError("Converting circular structure to JSON5");Y.push(Ae);var je=te;te=te+Re;for(var ge=oe||Object.keys(Ae),Ye=[],wt=0,Xe=ge;wt<Xe.length;wt+=1){var tr=Xe[wt],kt=H(tr,Ae);if(kt!==void 0){var Ut=qe(tr)+":";Re!==""&&(Ut+=" "),Ut+=kt,Ye.push(Ut)}}var rr;if(Ye.length===0)rr="{}";else{var Mr;if(Re==="")Mr=Ye.join(","),rr="{"+Mr+"}";else{var qn=`,
`+te;Mr=Ye.join(qn),rr=`{
`+te+Mr+`,
`+je+"}"}}return Y.pop(),te=je,rr}function qe(Ae){if(Ae.length===0)return ce(Ae);var je=String.fromCodePoint(Ae.codePointAt(0));if(!De.isIdStartChar(je))return ce(Ae);for(var ge=je.length;ge<Ae.length;ge++)if(!De.isIdContinueChar(String.fromCodePoint(Ae.codePointAt(ge))))return ce(Ae);return Ae}function Rt(Ae){if(Y.indexOf(Ae)>=0)throw TypeError("Converting circular structure to JSON5");Y.push(Ae);var je=te;te=te+Re;for(var ge=[],Ye=0;Ye<Ae.length;Ye++){var wt=H(String(Ye),Ae);ge.push(wt!==void 0?wt:"null")}var Xe;if(ge.length===0)Xe="[]";else if(Re===""){var tr=ge.join(",");Xe="["+tr+"]"}else{var kt=`,
`+te,Ut=ge.join(kt);Xe=`[
`+te+Ut+`,
`+je+"]"}return Y.pop(),te=je,Xe}},Ot={parse:Nt,stringify:It},Qt=Ot,er=Qt;return er})}}),dc={};ie(dc,{byValueString:()=>qd,getSorter:()=>jd,minMaxAvg:()=>Mb,sortByKey:()=>Wu,sortByValueNumber:()=>Ou,sortByValueString:()=>_b});var Ju=un(Pv(),1),Yu=un(Jt(),1),qi=un(Nv(),1),ys=un(cc(),1),Mn=un(vi(),1),$t={};ie($t,{areValuesIdentical:()=>fs,average:()=>mc,averageWeighted:()=>gc,chunks:()=>Eb,dotProduct:()=>Lv,ensureLength:()=>db,filterBetween:()=>$d,flatten:()=>fb,groupBy:()=>wb,guardArray:()=>Tn,guardIndex:()=>ua,interleave:()=>hb,intersection:()=>lb,max:()=>Dc,maxFast:()=>bc,maxIndex:()=>$v,mergeByKey:()=>bb,min:()=>pc,minFast:()=>Zu,minIndex:()=>wc,minMaxAvg:()=>ca,pushUnique:()=>Cb,randomElement:()=>ds,randomIndex:()=>hs,randomPluck:()=>vb,reducePairwise:()=>Ab,remove:()=>pb,sample:()=>Db,shuffle:()=>yb,sortByNumericProperty:()=>mb,total:()=>Ec,totalFast:()=>Ac,until:()=>gb,validNumbers:()=>In,weight:()=>yc,without:()=>Td,zip:()=>Ld});var Ov={};ie(Ov,{arrayElement:()=>ds,arrayIndex:()=>hs,defaultRandom:()=>Zt,float:()=>sb,gaussian:()=>cs,gaussianSkewed:()=>ub,hue:()=>ao,integer:()=>ob,shortGuid:()=>cb,string:()=>ls,weighted:()=>kd,weightedInteger:()=>ab,weightedSkewed:()=>ib});var xu={};ie(xu,{crossfade:()=>QE,fromCubicBezier:()=>XE,functions:()=>ss,gaussian:()=>Od,get:()=>Wa,getEasings:()=>eb,mix:()=>Wd,tick:()=>ZE,time:()=>xE});var kv={};ie(kv,{Correlate:()=>_d,FrequencyMutable:()=>Ad,IntervalTracker:()=>Fd,Normalise:()=>vc,NumberTracker:()=>ho,PointTracker:()=>ts,Pool:()=>Id,TrackedPointMap:()=>cd,TrackedValueMap:()=>sd,TrackerBase:()=>fo,clamp:()=>Gt,clampIndex:()=>au,flip:()=>Ti,frequencyMutable:()=>jE,interpolate:()=>os,interpolateAngle:()=>Nd,intervalTracker:()=>HE,movingAverage:()=>VE,movingAverageLight:()=>Cd,movingAverageTimed:()=>UE,numberTracker:()=>ti,piPi:()=>zu,pointTracker:()=>vE,pointsTracker:()=>ld,scale:()=>Er,scaleClamped:()=>Tv,scalePercent:()=>jv,scalePercentages:()=>qv,wrap:()=>aa,wrapInteger:()=>Sd,wrapRange:()=>GE});var vc={};ie(vc,{array:()=>Vv,stream:()=>Uv});var yc=(e,r)=>{const n=r===void 0?i=>i:r;return In(e).map((i,a)=>i*n(a/(In.length-1)))},In=e=>e.filter(r=>typeof r=="number"&&!Number.isNaN(r)),Lv=e=>{let r=0;const n=e[0].length;for(let i=0;i<n;i++){let a=0;for(let u=0;u<e.length;u++)u===0?a=e[u][i]:a*=e[u][i];r+=a}return r},mc=e=>{if(e===void 0)throw new Error("data parameter is undefined");const r=In(e);return r.reduce((i,a)=>i+a,0)/r.length},gc=(e,r)=>{typeof r=="function"&&(r=yc(e,r));const n=Ld(e,r),[i,a]=n.reduce((u,o)=>[u[0]+o[0]*o[1],u[1]+o[1]],[0,0]);return i/a},pc=e=>Math.min(...In(e)),$v=e=>e.reduce((r,n,i,a)=>n>a[r]?i:r,0),wc=(...e)=>e.reduce((r,n,i,a)=>n<a[r]?i:r,0),Dc=e=>Math.max(...In(e)),Ec=e=>e.reduce((r,n)=>typeof n!="number"||Number.isNaN(n)||Number.isFinite(n)?r:r+n,0),bc=e=>{let r=Number.MIN_SAFE_INTEGER;for(let n=0;n<e.length;n++)r=Math.max(r,e[n]);return r},Ac=e=>{let r=0;for(let n=0;n<e.length;n++)r+=e[n];return r},Zu=e=>{let r=Number.MIN_SAFE_INTEGER;for(let n=0;n<e.length;n++)r=Math.min(r,e[n]);return r},ca=(e,r,n)=>{if(e===void 0)throw new Error("'data' is undefined");if(!Array.isArray(e))throw new Error("'data' parameter is not an array");if(e.length===0)return{total:0,min:0,max:0,avg:0};r===void 0&&(r=0),n===void 0&&(n=e.length-1);const i=$d(e,u=>typeof u=="number"&&!Number.isNaN(u),r,n),a=i.reduce((u,o)=>u+o,0);return{total:a,max:Math.max(...i),min:Math.min(...i),avg:a/i.length}},Er=(e,r,n,i,a,u)=>{if(a===void 0&&(a=1),i===void 0&&(i=0),r===n)return a;let o=(e-r)/(n-r);return u!==void 0&&(o=u(o)),o*(a-i)+i},Tv=(e,r,n,i,a,u)=>{if(a===void 0&&(a=1),i===void 0&&(i=0),r===n)return a;const o=Er(e,r,n,i,a,u);return Gt(o,i,a)},qv=(e,r,n=1)=>(ae(e,"percentage","v"),ae(r,"percentage","outMin"),ae(n,"percentage","outMax"),Er(e,0,1,r,n)),jv=(e,r,n)=>(ae(e,"percentage","v"),Er(e,0,1,r,n)),Uv=(e,r)=>{let n=e??Number.MAX_SAFE_INTEGER,i=r??Number.MIN_SAFE_INTEGER;return ae(e),ae(r),a=>(ae(a),n=Math.min(n,a),i=Math.max(i,a),Er(a,n,i))},Vv=(e,r,n)=>{if(!Array.isArray(e))throw new Error("values param should be an array");const i=ca(e),a=r??i.min,u=n??i.max;return e.map(o=>Gt(Er(o,a,u)))},Hv={};ie(Hv,{Arcs:()=>Xu,Beziers:()=>gi,Circles:()=>br,Compound:()=>Do,Ellipses:()=>Io,Grids:()=>bo,Lines:()=>it,Paths:()=>Sn,Points:()=>U,Polar:()=>dt,Rects:()=>Ie,Scaler:()=>Qi,Shapes:()=>Ro,Triangles:()=>Qr,Vectors:()=>Zi,Waypoints:()=>jf,degreeToRadian:()=>Wr,radianToDegree:()=>Fa,radiansFromAxisX:()=>eh});var Xu={};ie(Xu,{bbox:()=>of,distanceCenter:()=>lg,fromDegrees:()=>sg,guard:()=>yo,interpolate:()=>mo,isArc:()=>nf,isEqual:()=>fg,isPositioned:()=>wr,length:()=>uf,point:()=>Yi,toLine:()=>af,toPath:()=>cg,toSvg:()=>sf});var U={};ie(U,{Empty:()=>Nn,Placeholder:()=>Hl,abs:()=>qm,angle:()=>Cn,apply:()=>Km,bbox:()=>jm,centroid:()=>Kl,clamp:()=>ug,clampMagnitude:()=>rf,compare:()=>Xm,compareByX:()=>ef,convexHull:()=>Zm,distance:()=>Kt,distanceToCenter:()=>Tm,distanceToExterior:()=>$m,divide:()=>Ql,dotProduct:()=>Vl,findMinimum:()=>Yr,from:()=>Gm,fromNumbers:()=>Yl,getPointParam:()=>nn,guard:()=>_e,guardNonZeroPoint:()=>Gl,interpolate:()=>Hm,invert:()=>ig,isEmpty:()=>Pi,isEqual:()=>ri,isNaN:()=>Om,isNull:()=>Wm,isPlaceholder:()=>Ni,isPoint:()=>Le,isPoint3d:()=>zn,leftmost:()=>km,multiply:()=>vo,multiplyScalar:()=>Ym,normalise:()=>tf,normaliseByRect:()=>tg,pipeline:()=>xl,pipelineApply:()=>Jm,progressBetween:()=>og,project:()=>Eu,quantiseEvery:()=>xm,random:()=>rg,reduce:()=>Zl,relation:()=>bu,rightmost:()=>Lm,rotate:()=>Xr,rotatePointArray:()=>Qm,subtract:()=>ln,sum:()=>Xl,toArray:()=>Um,toIntegerValues:()=>ag,toString:()=>Jl,withinRange:()=>Vm,wrap:()=>ng});var it={};ie(it,{Empty:()=>dm,Placeholder:()=>vm,angleRadian:()=>gm,apply:()=>Fl,asPoints:()=>Am,bbox:()=>ql,distance:()=>Ol,divide:()=>_l,extendFromA:()=>Em,fromFlatArray:()=>Cm,fromNumbers:()=>Ji,fromPoints:()=>ma,fromPointsToPath:()=>Fm,getPointsParam:()=>ya,guard:()=>va,interpolate:()=>Or,isEmpty:()=>ym,isEqual:()=>Cl,isLine:()=>$r,isPlaceholder:()=>mm,isPolyLine:()=>Al,joinPointsToLines:()=>Tl,length:()=>Dr,midpoint:()=>Bl,multiply:()=>Sl,nearest:()=>co,normaliseByRect:()=>pm,parallel:()=>Wl,perpendicularPoint:()=>zl,pointAtX:()=>Dm,pointsOf:()=>bm,rotate:()=>jl,scaleFromMidpoint:()=>wm,slope:()=>lo,subtract:()=>Il,sum:()=>Ml,toFlatArray:()=>Ll,toPath:()=>gr,toString:()=>kl,toSvgString:()=>$l,withinRange:()=>Rl});var Gv={};ie(Gv,{Arrays:()=>$t,MapOfMutableImpl:()=>da,Maps:()=>_c,Queues:()=>ml,Sets:()=>Gs,Stacks:()=>ll,circularArray:()=>ol,map:()=>mn,mapArray:()=>sl,mapCircularMutable:()=>cl,mapMutable:()=>hm,mapSet:()=>nm,queue:()=>El,queueMutable:()=>Pn,setMutable:()=>Lu,simpleMapArrayMutable:()=>Hs,stack:()=>Ki,stackMutable:()=>yl});var Kv={};ie(Kv,{Debug:()=>Sc,IterableAsync:()=>qu,defaultComparer:()=>so,getFieldByPath:()=>ha,getFieldPaths:()=>oo,ifNaN:()=>vu,isEqualDefault:()=>cn,isEqualValueDefault:()=>al,isPowerOfTwo:()=>nl,mapObject:()=>Qy,relativeDifference:()=>em,roundUpToMultiple:()=>il,runningiOS:()=>tm,toStringDefault:()=>si});var Jv={};ie(Jv,{between:()=>Yv,countCharsFromStart:()=>Qv,htmlEntities:()=>ty,indexOfCharCode:()=>ni,lineSpan:()=>Zv,omitChars:()=>ii,random:()=>ls,splitByLength:()=>Cc,splitRanges:()=>Xv,startsEnds:()=>ey,untilMatch:()=>Fc,unwrap:()=>xv});var Yv=(e,r,n,i=!0)=>{const a=e.indexOf(r);if(a<0)return;n===void 0&&(n=r);const u=i?e.lastIndexOf(n):e.indexOf(n,a+1);if(!(u<0))return e.substring(a+1,u)},ni=(e,r,n=0,i=e.length-1)=>{for(let a=n;a<=i;a++)if(e.charCodeAt(a)===r)return a;return-1},ii=(e,r,n)=>e.substring(0,r)+e.substring(r+n),Cc=(e,r)=>{const n=Math.ceil(e.length/r),i=[];let a=0;for(let u=0;u<n;u++)i.push(e.substring(a,a+r)),a+=r;return i},Fc=(e,r,n=0)=>{if(n>e.length)throw new Error("startPos should be less than length");const i=e.indexOf(r,n);return i<0?e:e.substring(n,i)},xv=(e,...r)=>{let n=!1;do{n=!1;for(const i of r)e.startsWith(i)&&e.endsWith(i)&&(e=e.substring(i.length,e.length-i.length*2+1),n=!0)}while(n);return e},Zv=(e,r,n)=>{let i=-1,a=-1;for(let u=0;u<e.length;u++){const o=e[u];if(i=u,o.text.length!==0&&r<o.end)break}for(let u=i;u<e.length;u++){const o=e[u];if(a=u,n===o.end){a=u+1;break}if(n<o.end)break}return{length:a-i,start:i,end:a}},Xv=(e,r)=>{let n=0,i="";const a=[];let u=0;for(let o=0;o<e.length;o++)if(e.indexOf(r,o)===o){const s=o;a.push({text:i,start:n,end:s,index:u}),n=s+1,i="",u++}else i+=e.charAt(o);return n<e.length&&a.push({text:i,start:n,index:u,end:e.length}),a},Qv=(e,...r)=>{let n=0;for(let i=0;i<e.length&&r.includes(e.charAt(i));i++)n++;return n},ey=(e,r,n=r)=>e.startsWith(r)&&e.endsWith(n),ty=e=>e.replace(/[\u00A0-\u9999<>\&]/g,r=>`&#${r.charCodeAt(0)};`),Sc={};ie(Sc,{logSet:()=>rl,logger:()=>yn});var _c={};ie(_c,{ExpiringMap:()=>Ic,addKeepingExisting:()=>Pc,addObject:()=>su,deleteByValue:()=>iy,expiringMap:()=>ry,filter:()=>Wc,find:()=>Oc,fromIterable:()=>uy,fromObject:()=>oy,getOrGenerate:()=>Rc,getOrGenerateSync:()=>Bc,hasAnyValue:()=>zc,hasKeyValue:()=>ny,mapToArray:()=>fy,mapToObjTransform:()=>sy,mergeByKey:()=>hy,sortByValue:()=>ay,sortByValueProperty:()=>Nc,toArray:()=>ou,toObject:()=>ly,transformMap:()=>cy,zipKeyValue:()=>Qu});var ry=(e={})=>new Ic(e),uu,Mc,Ic=class extends lr{constructor(e={}){super();if(Oe(this,uu),F(this,"capacity"),F(this,"store"),F(this,"keyCount"),F(this,"evictPolicy"),F(this,"autoDeleteElapsedMs"),F(this,"autoDeletePolicy"),this.capacity=e.capacity??-1,ke(this.capacity,"nonZero","capacity"),this.store=new Map,this.keyCount=0,e.evictPolicy&&this.capacity<=0)throw new Error("evictPolicy is set, but no capacity limit is set");this.evictPolicy=e.evictPolicy??"none",this.autoDeleteElapsedMs=e.autoDeleteElapsedMs??-1,this.autoDeletePolicy=e.autoDeletePolicy??"none",this.autoDeleteElapsedMs>0&&setInterval(()=>h0(this,uu,Mc).call(this),Math.max(1e3,this.autoDeleteElapsedMs*2))}get keyLength(){return this.keyCount}*entries(){for(const e of this.store.entries())yield[e[0],e[1].value]}*values(){for(const e of this.store.values())yield e.value}*keys(){yield*this.store.keys()}elapsedSet(e){const r=this.store.get(e);return r&&Date.now()-r.lastSet}elapsedGet(e){const r=this.store.get(e);return r&&Date.now()-r.lastGet}has(e){return this.store.has(e)}get(e){const r=this.store.get(e);if(r)return r.value}delete(e){const r=this.store.get(e);if(!r)return!1;const n=this.store.delete(e);return this.keyCount=this.keyCount-1,this.fireEvent("removed",{key:e,value:r.value}),n}touch(e){const r=this.store.get(e);return r?(this.store.set(e,{...r,lastSet:Date.now(),lastGet:Date.now()}),!0):!1}findEvicteeKey(){if(this.evictPolicy==="none")return null;let e="";if(this.evictPolicy==="oldestGet")e="lastGet";else if(this.evictPolicy==="oldestSet")e="lastSet";else throw Error(`Unknown eviction policy ${this.evictPolicy}`);return Nc(this.store,e)[0][0]}deleteWithElapsed(e,r){const n=[...this.store.entries()],i=[],a=Date.now();for(const u of n){const o=a-u[1].lastGet,s=a-u[1].lastSet;(r==="get"?o:r==="set"?s:Math.max(o,s))>=e&&i.push([u[0],u[1].value])}for(const u of i){this.store.delete(u[0]),this.keyCount=this.keyCount-1;const o={key:u[0],value:u[1]};this.fireEvent("expired",o),this.fireEvent("removed",o)}return i}set(e,r){const n=this.store.get(e);if(n){this.store.set(e,{...n,lastSet:performance.now()});return}if(this.keyCount===this.capacity&&this.capacity>0){const i=this.findEvicteeKey();if(!i)throw new Error(`ExpiringMap full (capacity: ${this.capacity})`);const a=this.store.get(i);if(this.store.delete(i),this.keyCount=this.keyCount-1,a){const u={key:i,value:a.value};this.fireEvent("expired",u),this.fireEvent("removed",u)}}this.keyCount++,this.store.set(e,{lastGet:0,lastSet:Date.now(),value:r}),this.fireEvent("newKey",{key:e,value:r})}};uu=new WeakSet;Mc=function(){this.autoDeletePolicy!=="none"&&this.deleteWithElapsed(this.autoDeleteElapsedMs,this.autoDeletePolicy)};var ny=(e,r,n,i)=>e.has(r)?Array.from(e.values()).some(u=>i(u,n)):!1,iy=(e,r,n=cn)=>{for(const i of Object.entries(e))n(i[1],r)&&e.delete(i[0])},Rc=(e,r)=>async(n,i)=>{let a=e.get(n);if(a!==void 0)return Promise.resolve(a);if(a=await r(n,i),a===void 0)throw new Error("fn returned undefined");return e.set(n,a),a},Bc=(e,r)=>(n,i)=>{let a=e.get(n);return a!==void 0||(a=r(n,i),e.set(n,a)),a},Pc=(e,r,...n)=>{const i=e===void 0?new Map:new Map(e);return n.forEach(a=>{const u=r(a);i.has(u)||i.set(u,a)}),i},ay=(e,r)=>{const n=r??so;[...e.entries()].sort((i,a)=>n(i[1],a[1]))},Nc=(e,r,n)=>{const i=typeof n>"u"?so:n;return[...e.entries()].sort((a,u)=>{const o=a[1],s=u[1];return i(o[r],s[r])})},zc=(e,r,n)=>Array.from(e.entries()).some(a=>n(a[1],r));function*Wc(e,r){for(const n of e.values())r(n)&&(yield n)}var ou=e=>Array.from(e.values()),uy=(e,r,n=!1)=>{const i=new Map;for(const a of e){const u=r(a);if(i.has(u)&&!n)throw new Error(`id ${u} is already used and new data will overwrite it. `);i.set(u,a)}return i},oy=e=>{const r=new Map;return Array.isArray(e)?e.forEach(n=>su(r,n)):su(r,e),r},su=(e,r)=>{const n=Object.entries(r);for(const[i,a]of n)e.set(i,a)},Oc=(e,r)=>Array.from(e.values()).find(n=>r(n)),sy=(e,r)=>Array.from(e).reduce((n,[i,a])=>{const u=r(a);return n[i]=u,n},{}),Qu=(e,r)=>{if(e.length!==r.length)throw new Error("Keys and values arrays should be same length");return Object.fromEntries(e.map((n,i)=>[n,r[i]]))},cy=(e,r)=>new Map(Array.from(e,n=>[n[0],r(n[1],n[0])])),ly=e=>Array.from(e).reduce((r,[n,i])=>(r[n]=i,r),{}),fy=(e,r)=>Array.from(e.entries()).map(n=>r(n[0],n[1])),hy=(e,...r)=>{const n=new Map;for(const i of r)for(const[a,u]of i){let o=n.get(a);o?o=e(o,u):o=u,n.set(a,o)}return n},yi={};ie(yi,{getCssVariable:()=>el,goldenAngleColour:()=>Xc,interpolate:()=>Gy,opacity:()=>oi,randomHue:()=>ao,scale:()=>Ky,toHex:()=>Hy,toHsl:()=>Vy,toRgb:()=>Qc});function kn(e,r,n){e.prototype=r.prototype=n,n.constructor=e}function mi(e,r){var n=Object.create(e.prototype);for(var i in r)n[i]=r[i];return n}function Lr(){}var rn=.7,Rn=1/rn,bn="\\s*([+-]?\\d+)\\s*",ai="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",or="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",dy=/^#([0-9a-f]{3,8})$/,vy=new RegExp(`^rgb\\(${bn},${bn},${bn}\\)$`),yy=new RegExp(`^rgb\\(${or},${or},${or}\\)$`),my=new RegExp(`^rgba\\(${bn},${bn},${bn},${ai}\\)$`),gy=new RegExp(`^rgba\\(${or},${or},${or},${ai}\\)$`),py=new RegExp(`^hsl\\(${ai},${or},${or}\\)$`),wy=new RegExp(`^hsla\\(${ai},${or},${or},${ai}\\)$`),ms={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};kn(Lr,Bn,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:gs,formatHex:gs,formatHex8:Dy,formatHsl:Ey,formatRgb:ps,toString:ps});function gs(){return this.rgb().formatHex()}function Dy(){return this.rgb().formatHex8()}function Ey(){return kc(this).formatHsl()}function ps(){return this.rgb().formatRgb()}function Bn(e){var r,n;return e=(e+"").trim().toLowerCase(),(r=dy.exec(e))?(n=r[1].length,r=parseInt(r[1],16),n===6?ws(r):n===3?new at(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):n===8?Ei(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):n===4?Ei(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=vy.exec(e))?new at(r[1],r[2],r[3],1):(r=yy.exec(e))?new at(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=my.exec(e))?Ei(r[1],r[2],r[3],r[4]):(r=gy.exec(e))?Ei(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=py.exec(e))?bs(r[1],r[2]/100,r[3]/100,1):(r=wy.exec(e))?bs(r[1],r[2]/100,r[3]/100,r[4]):ms.hasOwnProperty(e)?ws(ms[e]):e==="transparent"?new at(NaN,NaN,NaN,0):null}function ws(e){return new at(e>>16&255,e>>8&255,e&255,1)}function Ei(e,r,n,i){return i<=0&&(e=r=n=NaN),new at(e,r,n,i)}function eo(e){return e instanceof Lr||(e=Bn(e)),e?(e=e.rgb(),new at(e.r,e.g,e.b,e.opacity)):new at}function ji(e,r,n,i){return arguments.length===1?eo(e):new at(e,r,n,i??1)}function at(e,r,n,i){this.r=+e,this.g=+r,this.b=+n,this.opacity=+i}kn(at,ji,mi(Lr,{brighter(e){return e=e==null?Rn:Math.pow(Rn,e),new at(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?rn:Math.pow(rn,e),new at(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new at(xr(this.r),xr(this.g),xr(this.b),Ui(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ds,formatHex:Ds,formatHex8:by,formatRgb:Es,toString:Es}));function Ds(){return`#${Jr(this.r)}${Jr(this.g)}${Jr(this.b)}`}function by(){return`#${Jr(this.r)}${Jr(this.g)}${Jr(this.b)}${Jr((isNaN(this.opacity)?1:this.opacity)*255)}`}function Es(){const e=Ui(this.opacity);return`${e===1?"rgb(":"rgba("}${xr(this.r)}, ${xr(this.g)}, ${xr(this.b)}${e===1?")":`, ${e})`}`}function Ui(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function xr(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Jr(e){return e=xr(e),(e<16?"0":"")+e.toString(16)}function bs(e,r,n,i){return i<=0?e=r=n=NaN:n<=0||n>=1?e=r=NaN:r<=0&&(e=NaN),new nr(e,r,n,i)}function kc(e){if(e instanceof nr)return new nr(e.h,e.s,e.l,e.opacity);if(e instanceof Lr||(e=Bn(e)),!e)return new nr;if(e instanceof nr)return e;e=e.rgb();var r=e.r/255,n=e.g/255,i=e.b/255,a=Math.min(r,n,i),u=Math.max(r,n,i),o=NaN,s=u-a,c=(u+a)/2;return s?(r===u?o=(n-i)/s+(n<i)*6:n===u?o=(i-r)/s+2:o=(r-n)/s+4,s/=c<.5?u+a:2-u-a,o*=60):s=c>0&&c<1?0:o,new nr(o,s,c,e.opacity)}function Vi(e,r,n,i){return arguments.length===1?kc(e):new nr(e,r,n,i??1)}function nr(e,r,n,i){this.h=+e,this.s=+r,this.l=+n,this.opacity=+i}kn(nr,Vi,mi(Lr,{brighter(e){return e=e==null?Rn:Math.pow(Rn,e),new nr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?rn:Math.pow(rn,e),new nr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,r=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*r,a=2*n-i;return new at(Va(e>=240?e-240:e+120,a,i),Va(e,a,i),Va(e<120?e+240:e-120,a,i),this.opacity)},clamp(){return new nr(As(this.h),bi(this.s),bi(this.l),Ui(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ui(this.opacity);return`${e===1?"hsl(":"hsla("}${As(this.h)}, ${bi(this.s)*100}%, ${bi(this.l)*100}%${e===1?")":`, ${e})`}`}}));function As(e){return e=(e||0)%360,e<0?e+360:e}function bi(e){return Math.max(0,Math.min(1,e||0))}function Va(e,r,n){return(e<60?r+(n-r)*e/60:e<180?n:e<240?r+(n-r)*(240-e)/60:r)*255}var Lc=Math.PI/180,$c=180/Math.PI,Hi=18,Tc=.96422,qc=1,jc=.82521,Uc=4/29,An=6/29,Vc=3*An*An,Ay=An*An*An;function Hc(e){if(e instanceof sr)return new sr(e.l,e.a,e.b,e.opacity);if(e instanceof pr)return Gc(e);e instanceof at||(e=eo(e));var r=Ja(e.r),n=Ja(e.g),i=Ja(e.b),a=Ha((.2225045*r+.7168786*n+.0606169*i)/qc),u,o;return r===n&&n===i?u=o=a:(u=Ha((.4360747*r+.3850649*n+.1430804*i)/Tc),o=Ha((.0139322*r+.0971045*n+.7141733*i)/jc)),new sr(116*a-16,500*(u-a),200*(a-o),e.opacity)}function cu(e,r,n,i){return arguments.length===1?Hc(e):new sr(e,r,n,i??1)}function sr(e,r,n,i){this.l=+e,this.a=+r,this.b=+n,this.opacity=+i}kn(sr,cu,mi(Lr,{brighter(e){return new sr(this.l+Hi*(e??1),this.a,this.b,this.opacity)},darker(e){return new sr(this.l-Hi*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,r=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return r=Tc*Ga(r),e=qc*Ga(e),n=jc*Ga(n),new at(Ka(3.1338561*r-1.6168667*e-.4906146*n),Ka(-.9787684*r+1.9161415*e+.033454*n),Ka(.0719453*r-.2289914*e+1.4052427*n),this.opacity)}}));function Ha(e){return e>Ay?Math.pow(e,1/3):e/Vc+Uc}function Ga(e){return e>An?e*e*e:Vc*(e-Uc)}function Ka(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Ja(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Cy(e){if(e instanceof pr)return new pr(e.h,e.c,e.l,e.opacity);if(e instanceof sr||(e=Hc(e)),e.a===0&&e.b===0)return new pr(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var r=Math.atan2(e.b,e.a)*$c;return new pr(r<0?r+360:r,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function lu(e,r,n,i){return arguments.length===1?Cy(e):new pr(e,r,n,i??1)}function pr(e,r,n,i){this.h=+e,this.c=+r,this.l=+n,this.opacity=+i}function Gc(e){if(isNaN(e.h))return new sr(e.l,0,0,e.opacity);var r=e.h*Lc;return new sr(e.l,Math.cos(r)*e.c,Math.sin(r)*e.c,e.opacity)}kn(pr,lu,mi(Lr,{brighter(e){return new pr(this.h,this.c,this.l+Hi*(e??1),this.opacity)},darker(e){return new pr(this.h,this.c,this.l-Hi*(e??1),this.opacity)},rgb(){return Gc(this).rgb()}}));var Kc=-.14861,to=1.78277,ro=-.29227,la=-.90649,ui=1.97294,Cs=ui*la,Fs=ui*to,Ss=to*ro-la*Kc;function Fy(e){if(e instanceof Zr)return new Zr(e.h,e.s,e.l,e.opacity);e instanceof at||(e=eo(e));var r=e.r/255,n=e.g/255,i=e.b/255,a=(Ss*i+Cs*r-Fs*n)/(Ss+Cs-Fs),u=i-a,o=(ui*(n-a)-ro*u)/la,s=Math.sqrt(o*o+u*u)/(ui*a*(1-a)),c=s?Math.atan2(o,u)*$c-120:NaN;return new Zr(c<0?c+360:c,s,a,e.opacity)}function fu(e,r,n,i){return arguments.length===1?Fy(e):new Zr(e,r,n,i??1)}function Zr(e,r,n,i){this.h=+e,this.s=+r,this.l=+n,this.opacity=+i}kn(Zr,fu,mi(Lr,{brighter(e){return e=e==null?Rn:Math.pow(Rn,e),new Zr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?rn:Math.pow(rn,e),new Zr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*Lc,r=+this.l,n=isNaN(this.s)?0:this.s*r*(1-r),i=Math.cos(e),a=Math.sin(e);return new at(255*(r+n*(Kc*i+to*a)),255*(r+n*(ro*i+la*a)),255*(r+n*(ui*i)),this.opacity)}}));var fa=e=>()=>e;function Jc(e,r){return function(n){return e+n*r}}function Sy(e,r,n){return e=Math.pow(e,n),r=Math.pow(r,n)-e,n=1/n,function(i){return Math.pow(e+i*r,n)}}function no(e,r){var n=r-e;return n?Jc(e,n>180||n<-180?n-360*Math.round(n/360):n):fa(isNaN(e)?r:e)}function _y(e){return(e=+e)==1?ut:function(r,n){return n-r?Sy(r,n,e):fa(isNaN(r)?n:r)}}function ut(e,r){var n=r-e;return n?Jc(e,n):fa(isNaN(e)?r:e)}var Gi=function e(r){var n=_y(r);function i(a,u){var o=n((a=ji(a)).r,(u=ji(u)).r),s=n(a.g,u.g),c=n(a.b,u.b),l=ut(a.opacity,u.opacity);return function(f){return a.r=o(f),a.g=s(f),a.b=c(f),a.opacity=l(f),a+""}}return i.gamma=e,i}(1);function My(e,r){r||(r=[]);var n=e?Math.min(r.length,e.length):0,i=r.slice(),a;return function(u){for(a=0;a<n;++a)i[a]=e[a]*(1-u)+r[a]*u;return i}}function Iy(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Ry(e,r){var n=r?r.length:0,i=e?Math.min(n,e.length):0,a=new Array(i),u=new Array(n),o;for(o=0;o<i;++o)a[o]=io(e[o],r[o]);for(;o<n;++o)u[o]=r[o];return function(s){for(o=0;o<i;++o)u[o]=a[o](s);return u}}function By(e,r){var n=new Date;return e=+e,r=+r,function(i){return n.setTime(e*(1-i)+r*i),n}}function hu(e,r){return e=+e,r=+r,function(n){return e*(1-n)+r*n}}function Py(e,r){var n={},i={},a;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(a in r)a in e?n[a]=io(e[a],r[a]):i[a]=r[a];return function(u){for(a in n)i[a]=n[a](u);return i}}var du=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ya=new RegExp(du.source,"g");function Ny(e){return function(){return e}}function zy(e){return function(r){return e(r)+""}}function Wy(e,r){var n=du.lastIndex=Ya.lastIndex=0,i,a,u,o=-1,s=[],c=[];for(e=e+"",r=r+"";(i=du.exec(e))&&(a=Ya.exec(r));)(u=a.index)>n&&(u=r.slice(n,u),s[o]?s[o]+=u:s[++o]=u),(i=i[0])===(a=a[0])?s[o]?s[o]+=a:s[++o]=a:(s[++o]=null,c.push({i:o,x:hu(i,a)})),n=Ya.lastIndex;return n<r.length&&(u=r.slice(n),s[o]?s[o]+=u:s[++o]=u),s.length<2?c[0]?zy(c[0].x):Ny(r):(r=c.length,function(l){for(var f=0,h;f<r;++f)s[(h=c[f]).i]=h.x(l);return s.join("")})}function io(e,r){var n=typeof r,i;return r==null||n==="boolean"?fa(r):(n==="number"?hu:n==="string"?(i=Bn(r))?(r=i,Gi):Wy:r instanceof Bn?Gi:r instanceof Date?By:Iy(r)?My:Array.isArray(r)?Ry:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?Py:hu)(e,r)}function Yc(e){return function(r,n){var i=e((r=Vi(r)).h,(n=Vi(n)).h),a=ut(r.s,n.s),u=ut(r.l,n.l),o=ut(r.opacity,n.opacity);return function(s){return r.h=i(s),r.s=a(s),r.l=u(s),r.opacity=o(s),r+""}}}var Oy=Yc(no),ky=Yc(ut);function Ly(e,r){var n=ut((e=cu(e)).l,(r=cu(r)).l),i=ut(e.a,r.a),a=ut(e.b,r.b),u=ut(e.opacity,r.opacity);return function(o){return e.l=n(o),e.a=i(o),e.b=a(o),e.opacity=u(o),e+""}}function xc(e){return function(r,n){var i=e((r=lu(r)).h,(n=lu(n)).h),a=ut(r.c,n.c),u=ut(r.l,n.l),o=ut(r.opacity,n.opacity);return function(s){return r.h=i(s),r.c=a(s),r.l=u(s),r.opacity=o(s),r+""}}}var $y=xc(no),Ty=xc(ut);function Zc(e){return function r(n){n=+n;function i(a,u){var o=e((a=fu(a)).h,(u=fu(u)).h),s=ut(a.s,u.s),c=ut(a.l,u.l),l=ut(a.opacity,u.opacity);return function(f){return a.h=o(f),a.s=s(f),a.l=c(Math.pow(f,n)),a.opacity=l(f),a+""}}return i.gamma=r,i}(1)}var qy=Zc(no),jy=Zc(ut);function Uy(e,r){r===void 0&&(r=e,e=io);for(var n=0,i=r.length-1,a=r[0],u=new Array(i<0?0:i);n<i;)u[n]=e(a,a=r[++n]);return function(o){var s=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return u[s](o-s)}}var Vy=e=>{const r=Qc(e),n=xy(r.r,r.b,r.g);return r.opacity?{...n,opacity:r.opacity}:n},Xc=(e,r=.5,n=.75,i=1)=>{ae(e,"positive","index"),ae(r,"percentage","saturation"),ae(n,"percentage","lightness"),ae(i,"percentage","alpha");const a=e*137.508;if(i===1)return`hsl(${a},${r*100}%,${n*100}%)`},ao=(e=Zt)=>e()*360,Qc=e=>{const r=uo(e),n=r.rgb();return r.opacity<1?{r:n.r,g:n.g,b:n.b,opacity:r.opacity}:{r:n.r,g:n.g,b:n.b}},uo=e=>{if(typeof e=="string"){const r=Bn(e);if(r!==null)return r}else{if(Jy(e))return Vi(e.h,e.s,e.l);if(Yy(e))return ji(e.r,e.g,e.b)}throw new Error(`Could not resolve colour ${JSON.stringify(e)}`)},Hy=e=>uo(e).formatHex(),oi=(e,r)=>{const n=uo(e);return n.opacity*=r,n.toString()},el=(e,r="black",n)=>{n===void 0&&(n=document.body);const i=getComputedStyle(n).getPropertyValue(`--${e}`).trim();return i===void 0||i.length===0?r:i},Gy=(e,r,n,i)=>{if(ae(e,"percentage","amount"),typeof r!="string")throw new Error("Expected string for 'from' param");if(typeof n!="string")throw new Error("Expected string for 'to' param");let a;typeof i>"u"?a={}:typeof i=="string"?a={space:i}:a=i;const u=tl(a,[r,n]);if(u===void 0)throw new Error("Could not handle colour/space");return u(e)},tl=(e,r)=>{if(!Array.isArray(r))throw new Error("Expected one or more colours as parameters");let n;if(typeof e>"u"?n={}:typeof e=="string"?n={space:e}:n=e,!Array.isArray(r))throw new Error("Expected array for colours parameter");if(r.length<2)throw new Error("Interpolation expects at least two colours");const{space:i="rgb",long:a=!1}=n;let u;switch(i){case"lab":u=Ly;break;case"hsl":u=a?ky:Oy;break;case"hcl":u=a?Ty:$y;break;case"cubehelix":u=a?jy:qy;break;case"rgb":u=Gi;default:u=Gi}return n.gamma&&(i==="rgb"||i==="cubehelix")&&(u=u.gamma(n.gamma)),r.length>2?Uy(u,r):u(r[0],r[1])},Ky=(e,r,...n)=>{if(ae(e,"aboveZero","steps"),!Array.isArray(n))throw new Error("Expected one or more colours as parameters");const i=tl(r,n);if(i===void 0)throw new Error("Could not handle colour/space");const a=1/(e-1),u=[];let o=0;for(let s=0;s<e;s++)u.push(i(o)),o+=a,o>1&&(o=1);return u},Jy=e=>!(e.h===void 0||e.s===void 0||e.l===void 0),Yy=e=>!(e.r===void 0||e.g===void 0||e.b===void 0),xy=(e,r,n)=>{e/=255,r/=255,n/=255;var i=Math.min(e,r,n),a=Math.max(e,r,n),u=a-i,o,s,c;return o=0,a===i?o=0:e===a?o=(r-n)/u:r===a?o=2+(n-e)/u:n===a&&(o=4+(e-r)/u),o=Math.min(o*60,360),o<0&&(o+=360),c=(i+a)/2,a===i?s=0:c<=.5?s=u/(a+i):s=u/(2-a-i),{h:o,s,l:c}},Zy=0,Xy=Bc(new Map,()=>Xc(++Zy)),rl=(e,r=!0)=>r?{log:yn(e,"log"),warn:yn(e,"warn"),error:yn(e,"error")}:{log:n=>{},warn:yn(e,"warn"),error:yn(e,"error")},yn=(e,r="log")=>n=>{switch(n===void 0?n="(undefined)":typeof n=="object"&&(n=JSON.stringify(n)),r){case"log":console.log(`%c${e} ${n}`,`color: ${Xy(e)}`);break;case"warn":console.warn(e,n);break;case"error":console.error(e,n);break}},vu=(e,r)=>Number.isNaN(e)?r:e,Qy=(e,r)=>{const n=Object.entries(e).map(([i,a],u)=>[i,r(a,i,u)]);return Object.fromEntries(n)},nl=e=>Math.log2(e)%1===0,em=e=>r=>r/e,ha=(e,r="")=>{if(r.length===0)return e;if(r in e)return e[r];{const n=Fc(r,".");return n in e?ha(e[n],r.substring(n.length+1)):void 0}},oo=e=>{const r=[],n=(i,a="")=>{if(typeof i=="object"){const u=Object.keys(i);a.length>0&&(a+="."),u.forEach(o=>n(i[o],a+o))}else r.push(a)};return n(e),r},il=(e,r)=>(ae(e,"nonZero","v"),ae(r,"nonZero","muliple"),Math.ceil(e/r)*r),cn=(e,r)=>e===r,al=(e,r)=>e===r?!0:si(e)===si(r),si=e=>typeof e=="string"?e:JSON.stringify(e),tm=()=>["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,so=(e,r)=>{if(e===void 0&&r===void 0)return 0;if(e===void 0)return 1;if(r===void 0)return-1;const n=_s(e),i=_s(r);return n<i?-1:n>i?1:0},_s=e=>{if(e===null)return"null";if(typeof e=="boolean"||typeof e=="number")return e.toString();if(typeof e=="string")return e;if(typeof e=="symbol")throw new TypeError;return e.toString()};try{typeof window<"u"&&(window.ixfx={...window.ixfx,getFieldByPath:ha,getFieldPaths:oo})}catch{}var yr,ur,ul=class extends Array{constructor(e=0){super();Oe(this,yr,void 0),Oe(this,ur,void 0),ke(e,"positive","capacity"),Ce(this,yr,e),Ce(this,ur,0)}add(e){const r=ul.from(this);return r[J(this,ur)]=e,Ce(r,yr,J(this,yr)),J(this,yr)>0?Ce(r,ur,J(this,ur)+1===J(this,yr)?0:J(this,ur)+1):Ce(r,ur,J(this,ur)+1),r}get pointer(){return J(this,ur)}get isFull(){return J(this,yr)===0?!1:this.length===J(this,yr)}},rm=ul;yr=new WeakMap;ur=new WeakMap;var ol=e=>new rm(e),He,da=class extends lr{constructor(e,r={}){super();Oe(this,He,new Map),F(this,"groupBy"),F(this,"type"),this.type=e,this.groupBy=r.groupBy??si}get typeName(){return this.type.name}get lengthMax(){let e=0;for(const r of J(this,He).values())e=Math.max(e,this.type.count(r));return e}debugString(){const e=Array.from(J(this,He).keys());let r=`Keys: ${e.join(", ")}\r
`;return e.forEach(n=>{const i=J(this,He).get(n);if(i!==void 0){const a=this.type.toArray(i);a!==void 0&&(r+=` - ${n} (${this.type.count(i)}) = ${JSON.stringify(a)}\r
`)}else r+=` - ${n} (undefined)\r
`}),r}get isEmpty(){return J(this,He).size===0}clear(){J(this,He).clear(),super.fireEvent("clear",!0)}addKeyedValues(e,...r){const n=J(this,He).get(e);n===void 0?(J(this,He).set(e,this.type.add(void 0,r)),super.fireEvent("addedKey",{key:e}),super.fireEvent("addedValues",{values:r})):(J(this,He).set(e,this.type.add(n,r)),super.fireEvent("addedValues",{values:r}))}addValue(...e){e.forEach(r=>this.addKeyedValues(this.groupBy(r),r))}hasKeyValue(e,r){const n=J(this,He).get(e);return n===void 0?!1:this.type.has(n,r)}has(e){return J(this,He).has(e)}deleteKeyValue(e,r){const n=J(this,He).get(e);if(n===void 0)return!1;const i=this.type.count(n),a=this.type.without(n,r),u=a.length;return J(this,He).set(e,this.type.add(void 0,a)),i>u}delete(e){return J(this,He).get(e)===void 0?!1:(J(this,He).delete(e),this.fireEvent("deleteKey",{key:e}),!0)}findKeyForValue(e){return Array.from(J(this,He).keys()).find(i=>{const a=J(this,He).get(i);if(a===void 0)throw Error("Bug: map could not be accessed");return!!this.type.has(a,e)})}count(e){const r=J(this,He).get(e);return r===void 0?0:this.type.count(r)}get(e){const r=J(this,He).get(e);if(r!==void 0)return this.type.toArray(r)}getSource(e){return J(this,He).get(e)}keys(){return Array.from(J(this,He).keys())}keysAndCounts(){return this.keys().map(n=>[n,this.count(n)])}merge(e){e.keys().forEach(n=>{const i=e.get(n);i!==void 0&&this.addKeyedValues(n,...i)})}};He=new WeakMap;var sl=(e={})=>{const r=e.comparer===void 0?e.toString===void 0?(a,u)=>e.toString(a)===e.toString(u):cn:e.comparer,n={get name(){return"array"},add:(a,u)=>a===void 0?[...u]:[...a,...u],count:a=>a.length,find:(a,u)=>a.find(u),filter:(a,u)=>a.filter(u),toArray:a=>a,has:(a,u)=>a.find(o=>r(o,u))!==void 0,without:(a,u)=>a.filter(o=>!r(o,u))};return new da(n,e)},nm=e=>{const r=e?.hash??si,n=(u,o)=>r(u)===r(o),i={get name(){return"set"},add:(u,o)=>Pc(u,r,...o),count:u=>u.size,find:(u,o)=>Oc(u,o),filter:(u,o)=>Wc(u,o),toArray:u=>ou(u),has:(u,o)=>zc(u,o,n),without:(u,o)=>Td(ou(u),o,n)};return new da(i,e)},cl=e=>{const r=cn,n={get name(){return"circular"},add:(i,a)=>(i===void 0&&(i=ol(e.capacity)),a.forEach(u=>i=i?.add(u)),i),count:i=>i.length,find:(i,a)=>i.find(a),filter:(i,a)=>i.filter(a),toArray:i=>i,has:(i,a)=>i.find(u=>r(u,a))!==void 0,without:(i,a)=>i.filter(u=>!r(u,a))};return new da(n,e)},ll={};ie(ll,{stack:()=>Ki,stackMutable:()=>yl});var im=(e,r,n)=>{const i=r.length+n.length,a=e.discardPolicy??"additions",u=e.capacity??i,o=i-u;switch(e.debug&&console.log(`Stack.push: stackLen: ${r.length} potentialLen: ${i} toRemove: ${o} policy: ${a}`),a){case"additions":return e.debug&&console.log(`Stack.push:DiscardAdditions: stackLen: ${r.length} slice: ${i-u} toAddLen: ${n.length}`),r.length===e.capacity?r:[...r,...n.slice(0,n.length-o)];case"newer":return o>=r.length?n.slice(Math.max(0,n.length-u),Math.min(n.length,u)+1):(e.debug&&console.log(` from orig: ${r.slice(0,r.length-o)}`),[...r.slice(0,r.length-o),...n.slice(0,Math.min(n.length,u-o+1))]);case"older":return[...r,...n].slice(o);default:throw new Error(`Unknown discard policy ${a}`)}},fl=(e,r,...n)=>{const i=r.length+n.length;return e.capacity&&i>e.capacity?im(e,r,n):[...r,...n]},hl=(e,r)=>{if(r.length===0)throw new Error("Stack is empty");return r.slice(0,r.length-1)},yu=(e,r)=>r[r.length-1],dl=(e,r)=>r.length===0,vl=(e,r)=>e.capacity?r.length>=e.capacity:!1,mu=class{constructor(e,r){F(this,"opts"),F(this,"data"),this.opts=e,this.data=r}push(...e){return new mu(this.opts,fl(this.opts,this.data,...e))}pop(){return new mu(this.opts,hl(this.opts,this.data))}forEach(e){this.data.forEach(e)}forEachFromTop(e){[...this.data].reverse().forEach(e)}get isEmpty(){return dl(this.opts,this.data)}get isFull(){return vl(this.opts,this.data)}get peek(){return yu(this.opts,this.data)}get length(){return this.data.length}},am=class{constructor(e,r){F(this,"opts"),F(this,"data"),this.opts=e,this.data=r}push(...e){return this.data=fl(this.opts,this.data,...e),this.data.length}forEach(e){this.data.forEach(e)}forEachFromTop(e){[...this.data].reverse().forEach(e)}pop(){const e=yu(this.opts,this.data);return hl(this.opts,this.data),e}get isEmpty(){return dl(this.opts,this.data)}get isFull(){return vl(this.opts,this.data)}get peek(){return yu(this.opts,this.data)}get length(){return this.data.length}},Ki=(e={},...r)=>new mu({...e},[...r]),yl=(e={},...r)=>new am({...e},[...r]),ml={};ie(ml,{queue:()=>El,queueMutable:()=>Pn});var Ai=(e,r)=>{e.debug&&console.log(`queue:${r}`)},um=(e,r,n)=>{const i=r.length+n.length,a=e.capacity??i,u=i-a,o=e.discardPolicy??"additions";switch(Ai(e,`queueLen: ${r.length} potentialLen: ${i} toRemove: ${u} policy: ${o}`),o){case"additions":return Ai(e,`trimQueue:DiscardAdditions: queueLen: ${r.length} slice: ${i-a} toAddLen: ${n.length}`),r.length===e.capacity?r:[...r,...n.slice(0,u-1)];case"newer":if(u>=r.length)return n.slice(Math.max(0,n.length-a),Math.min(n.length,a)+1);{const s=n.slice(0,Math.min(n.length,a-u+1)),c=r.slice(0,r.length-u);Ai(e,`trimQueue: toRemove: ${u} keeping: ${JSON.stringify(c)} from orig: ${JSON.stringify(r)} toAddFinal: ${JSON.stringify(s)}`);const l=[...c,...s];return Ai(e,`final: ${JSON.stringify(l)}`),l}case"older":return[...r,...n].slice(u);default:throw new Error(`Unknown overflow policy ${o}`)}},gl=(e,r,...n)=>{if(e===void 0)throw new Error("opts parameter undefined");const i=r.length+n.length,a=e.capacity&&i>e.capacity,u=a?um(e,r,n):[...r,...n];if(e.capacity&&u.length!==e.capacity&&a)throw new Error(`Bug! Expected return to be at capacity. Return len: ${u.length} capacity: ${e.capacity} opts: ${JSON.stringify(e)}`);if(!e.capacity&&u.length!==i)throw new Error(`Bug! Return length not expected. Return len: ${u.length} expected: ${i} opts: ${JSON.stringify(e)}`);return u},pl=(e,r)=>{if(r.length===0)throw new Error("Queue is empty");return r.slice(1)},gu=(e,r)=>r[0],wl=(e,r)=>r.length===0,Dl=(e,r)=>e.capacity?r.length>=e.capacity:!1,pu=class{constructor(e,r){if(F(this,"opts"),F(this,"data"),e===void 0)throw new Error("opts parameter undefined");this.opts=e,this.data=r}forEach(e){for(let r=this.data.length-1;r>=0;r--)e(this.data[r])}forEachFromFront(e){this.data.forEach(r=>e(r))}enqueue(...e){return new pu(this.opts,gl(this.opts,this.data,...e))}dequeue(){return new pu(this.opts,pl(this.opts,this.data))}get isEmpty(){return wl(this.opts,this.data)}get isFull(){return Dl(this.opts,this.data)}get length(){return this.data.length}get peek(){return gu(this.opts,this.data)}},om=class{constructor(e,r){if(F(this,"opts"),F(this,"data"),e===void 0)throw new Error("opts parameter undefined");this.opts=e,this.data=r}enqueue(...e){return this.data=gl(this.opts,this.data,...e),this.data.length}dequeue(){const e=gu(this.opts,this.data);return this.data=pl(this.opts,this.data),e}get isEmpty(){return wl(this.opts,this.data)}get isFull(){return Dl(this.opts,this.data)}get length(){return this.data.length}get peek(){return gu(this.opts,this.data)}},El=(e={},...r)=>(e={...e},new pu(e,[...r])),Pn=(e={},...r)=>new om({...e},[...r]),sm=(e,r)=>{const n=new Map(e.entries());return r.forEach(i=>{if(i[0]===void 0)throw new Error("key cannot be undefined");if(i[1]===void 0)throw new Error("value cannot be undefined");n.set(i[0],i[1])}),n},cm=(e,r)=>{const n=new Map(e.entries());return r.forEach(i=>{if(i.key===void 0)throw new Error("key cannot be undefined");if(i.value===void 0)throw new Error("value cannot be undefined");n.set(i.key,i.value)}),n},lm=(e,r)=>e.has(r),ei=(e,...r)=>{if(e===void 0)throw new Error("map parameter is undefined");if(r===void 0)throw new Error("data parameter i.s undefined");if(r.length===0)return e;const n=r[0];return typeof n.key<"u"&&typeof n.value<"u"?cm(e,r):sm(e,r)},fm=(e,r,n)=>{const i=new Map(e.entries());return i.set(r,n),i},bl=(e,r)=>{const n=new Map(e.entries());return n.delete(r),n},mn=e=>{if(e===void 0)return mn([]);if(Array.isArray(e))return mn(ei(new Map,...e));const r=e;return{add:(...n)=>{const i=ei(r,...n);return mn(i)},get:n=>r.get(n),delete:n=>mn(bl(r,n)),clear:()=>mn(),has:n=>r.has(n),entries:()=>r.entries(),isEmpty:()=>r.size===0}},hm=(...e)=>{let r=ei(new Map,...e);return{add:(...n)=>{r=ei(r,...n)},delete:n=>{r=bl(r,n)},clear:()=>{r=ei(new Map)},set:(n,i)=>{r=fm(r,n,i)},get:n=>r.get(n),entries:()=>r.entries(),isEmpty:()=>r.size===0,has:n=>lm(r,n)}},dm=Object.freeze({a:Object.freeze({x:0,y:0}),b:Object.freeze({x:0,y:0})}),vm=Object.freeze({a:Object.freeze({x:NaN,y:NaN}),b:Object.freeze({x:NaN,y:NaN})}),ym=e=>U.isEmpty(e.a)&&U.isEmpty(e.b),mm=e=>U.isPlaceholder(e.a)&&U.isPlaceholder(e.b),$r=e=>!(e===void 0||e.a===void 0||e.b===void 0||!U.isPoint(e.a)||!U.isPoint(e.b)),Al=e=>Array.isArray(e)?!e.some(n=>!$r(n)):!1,Cl=(e,r)=>U.isEqual(e.a,r.a)&&U.isEqual(e.b,r.b),Fl=(e,r)=>Object.freeze({...e,a:r(e.a),b:r(e.b)}),va=(e,r="line")=>{if(e===void 0)throw new Error(`${r} undefined`);if(e.a===void 0)throw new Error(`${r}.a undefined. Expected {a:Point, b:Point}. Got: ${JSON.stringify(e)}`);if(e.b===void 0)throw new Error(`${r}.b undefined. Expected {a:Point, b:Point} Got: ${JSON.stringify(e)}`)},gm=(e,r)=>{let n;if($r(e))n=e.a,r=e.b;else if(n=e,r===void 0)throw new Error("b point must be provided");return Math.atan2(r.y-n.y,r.x-n.x)},Sl=(e,r)=>Object.freeze({...e,a:U.multiply(e.a,r),b:U.multiply(e.b,r)}),_l=(e,r)=>Object.freeze({...e,a:U.divide(e.a,r),b:U.divide(e.b,r)}),Ml=(e,r)=>Object.freeze({...e,a:U.sum(e.a,r),b:U.sum(e.b,r)}),Il=(e,r)=>Object.freeze({...e,a:U.subtract(e.a,r),b:U.subtract(e.b,r)}),pm=(e,r,n)=>Object.freeze({...e,a:U.normaliseByRect(e.a,r,n),b:U.normaliseByRect(e.b,r,n)}),Rl=(e,r,n)=>Ol(e,r)<=n;function Dr(e,r){if(Al(e))return e.reduce((s,c)=>Dr(c)+s,0);const[n,i]=ya(e,r),a=i.x-n.x,u=i.y-n.y;if(n.z!==void 0&&i.z!==void 0){const o=i.z-n.z;return Math.hypot(a,u,o)}else return Math.hypot(a,u)}var Bl=(e,r)=>{const[n,i]=ya(e,r);return Or(.5,n,i)},ya=(e,r)=>{let n;if($r(e))r=e.b,n=e.a;else if(n=e,r===void 0)throw new Error(`Since first parameter is not a line, two points are expected. Got a: ${JSON.stringify(n)} b: ${JSON.stringify(r)}`);return _e(n,"a"),_e(n,"b"),[n,r]},co=(e,r)=>{const n=i=>{const{a,b:u}=i,o={x:u.x-a.x,y:u.y-a.y},s={x:r.x-a.x,y:r.y-a.y},c=o.x*o.x+o.y*o.y;let l=s.x*o.x+s.y*o.y;const f=Math.min(1,Math.max(0,l/c));return l=(u.x-a.x)*(r.y-a.y)-(u.y-a.y)*(r.x-a.x),{x:a.x+o.x*f,y:a.y+o.y*f}};if(Array.isArray(e)){const i=e.map(u=>n(u)),a=i.map(u=>U.distance(u,r));return Object.freeze(i[$t.minIndex(...a)])}else return Object.freeze(n(e))},lo=(e,r)=>{let n;if($r(e))n=e.a,r=e.b;else if(n=e,r===void 0)throw new Error("b parameter required");if(r!==void 0)return(r.y-n.y)/(r.x-n.x);throw Error("Second point missing")},Pl=e=>({x:e.b.x-e.a.x,y:e.b.y-e.a.y}),Nl=e=>{const r=Dr(e),n=Pl(e);return{x:n.x/r,y:n.y/r}},zl=(e,r,n=0)=>{const i=Or(n,e),a=Nl(e);return{x:i.x-a.y*r,y:i.y+a.x*r}},Wl=(e,r)=>{const n=Pl(e),i=Nl(e),a={x:e.a.x-i.y*r,y:e.a.y+i.x*r};return{a,b:{x:a.x+n.x,y:a.y+n.y}}},wm=(e,r)=>{const n=Or(r/2,e),i=Or(.5+r/2,e);return{a:n,b:i}},Dm=(e,r)=>{const n=e.a.y+(r-e.a.x)*lo(e);return Object.freeze({x:r,y:n})},Em=(e,r)=>{const n=Dr(e);return Object.freeze({...e,a:e.a,b:Object.freeze({x:e.b.x+(e.b.x-e.a.x)/n*r,y:e.b.y+(e.b.y-e.a.y)/n*r})})};function*bm(e){const{a:r,b:n}=e;let i=Math.floor(r.x),a=Math.floor(r.y);const u=Math.floor(n.x),o=Math.floor(n.y),s=Math.abs(u-i),c=-Math.abs(o-a),l=i<u?1:-1,f=a<o?1:-1;let h=s+c;for(;yield{x:i,y:a},!(i===u&&a===o);){const g=2*h;g>=c&&(h+=c,i+=l),g<=s&&(h+=s,a+=f)}}var Ol=(e,r)=>{if(Array.isArray(e)){const n=e.map(i=>wu(i,r));return Zu(n)}else return wu(e,r)},wu=(e,r)=>{if(va(e,"line"),_e(r,"point"),Dr(e)===0)return Dr(e.a,r);const n=co(e,r);return Dr(n,r)};function Or(e,r,n,i){typeof n=="boolean"&&(i=n,n=void 0),i?ae(e,"","amount"):g0(e,"amount");const[a,u]=ya(r,n),o=Dr(a,u),s=o*(1-e);if(o===0&&s===0)return Object.freeze({...u});const c=u.x-s*(u.x-a.x)/o,l=u.y-s*(u.y-a.y)/o;return Object.freeze({...u,x:c,y:l})}function kl(e,r){if($r(e))va(e,"a"),r=e.b,e=e.a;else if(r===void 0)throw new Error("Expect second point if first is a point");return U.toString(e)+"-"+U.toString(r)}var Ji=(e,r,n,i)=>{if(Number.isNaN(e))throw new Error("x1 is NaN");if(Number.isNaN(n))throw new Error("x2 is NaN");if(Number.isNaN(r))throw new Error("y1 is NaN");if(Number.isNaN(i))throw new Error("y2 is NaN");return ma({x:e,y:r},{x:n,y:i})},Ll=(e,r)=>{if($r(e))return[e.a.x,e.a.y,e.b.x,e.b.y];if(U.isPoint(e)&&U.isPoint(r))return[e.x,e.y,r.x,r.y];throw new Error("Expected single line parameter, or a and b points")};function*Am(e){for(const r of e)yield r.a,yield r.b}var $l=(e,r)=>[`M${e.x} ${e.y} L ${r.x} ${r.y}`],Cm=e=>{if(!Array.isArray(e))throw new Error("arr parameter is not an array");if(e.length!==4)throw new Error("array is expected to have length four");return Ji(e[0],e[1],e[2],e[3])},ma=(e,r)=>(_e(e,"a"),_e(r,"b"),e=Object.freeze({...e}),r=Object.freeze({...r}),Object.freeze({a:e,b:r})),Tl=(...e)=>{const r=[];let n=e[0];for(let i=1;i<e.length;i++)r.push(ma(n,e[i])),n=e[i];return r},Fm=(e,r)=>gr(ma(e,r)),ql=e=>U.bbox(e.a,e.b),gr=e=>{const{a:r,b:n}=e;return Object.freeze({...e,length:()=>Dr(r,n),interpolate:i=>Or(i,r,n),bbox:()=>ql(e),toString:()=>kl(r,n),toFlatArray:()=>Ll(r,n),toSvgString:()=>$l(r,n),toPoints:()=>[r,n],rotate:(i,a)=>gr(jl(e,i,a)),nearest:i=>co(e,i),sum:i=>gr(Ml(e,i)),divide:i=>gr(_l(e,i)),multiply:i=>gr(Sl(e,i)),subtract:i=>gr(Il(e,i)),midpoint:()=>Bl(r,n),distance:i=>wu(e,i),parallel:i=>Wl(e,i),perpendicularPoint:(i,a)=>zl(e,i,a),slope:()=>lo(e),withinRange:(i,a)=>Rl(e,i,a),isEqual:i=>Cl(e,i),apply:i=>gr(Fl(e,i)),kind:"line"})},jl=(e,r,n)=>r===void 0||r===0?e:(n===void 0&&(n=.5),typeof n=="number"&&(n=Or(n,e.a,e.b)),Object.freeze({...e,a:U.rotate(e.a,r,n),b:U.rotate(e.b,r,n)})),Sm={};ie(Sm,{average:()=>Mm,averageWeighted:()=>Im,filter:()=>zm,isValid:()=>Ul,max:()=>Bm,min:()=>Rm,quantiseEvery:()=>Du,total:()=>Pm,tracker:()=>Nm});var fo=class{constructor(e={}){F(this,"seenCount"),F(this,"storeIntermediate"),F(this,"resetAfterSamples"),F(this,"sampleLimit"),F(this,"id"),this.id=e.id??"tracker",this.sampleLimit=e.sampleLimit??-1,this.resetAfterSamples=e.resetAfterSamples??-1,this.storeIntermediate=e.storeIntermediate??(this.sampleLimit>-1||this.resetAfterSamples>-1),this.seenCount=0}reset(){this.seenCount=0,this.onReset()}seen(...e){this.resetAfterSamples>0&&this.seenCount>this.resetAfterSamples?this.reset():this.sampleLimit>0&&this.seenCount>this.sampleLimit*2&&(this.seenCount=this.trimStore(this.sampleLimit),this.onTrimmed()),this.seenCount+=e.length;const r=this.seenImpl(e);this.onSeen(r)}onSeen(e){}},_m=class extends fo{constructor(e){super(e);F(this,"values"),F(this,"timestamps"),this.values=[],this.timestamps=[]}trimStore(e){return e>=this.values.length?this.values.length:(this.values=this.values.slice(-e),this.timestamps=this.timestamps.slice(-e),this.values.length)}onTrimmed(){}get last(){return this.values.at(-1)}get initial(){return this.values.at(0)}get size(){return this.values.length}get elapsed(){if(this.values.length<0)throw new Error("No values seen yet");return Date.now()-this.timestamps[0]}onReset(){this.values=[],this.timestamps=[]}seenImpl(e){const r=e.at(-1),n=Date.now();return this.storeIntermediate?(this.values.push(...e),this.timestamps.push(...Hu(e.length,()=>n))):this.values.length===0?(this.values.push(r),this.timestamps.push(n)):this.values.length===2?(this.values[1]=r,this.timestamps[1]=n):this.values.length===1&&(this.values.push(r),this.timestamps.push(n)),e}},ho=class extends _m{constructor(){super(...arguments);F(this,"total",0),F(this,"min",Number.MAX_SAFE_INTEGER),F(this,"max",Number.MIN_SAFE_INTEGER)}get avg(){return this.total/this.seenCount}difference(){if(this.last!==void 0&&this.initial!==void 0)return this.last-this.initial}relativeDifference(){if(this.last!==void 0&&this.initial!==void 0)return this.last/this.initial}onReset(){this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER,this.total=0,super.onReset()}onTrimmed(){this.min=Zu(this.values),this.max=bc(this.values),this.total=Ac(this.values)}onSeen(e){if(e.some(r=>Number.isNaN(r)))throw Error("Cannot add NaN");this.total=e.reduce((r,n)=>r+n,this.total),this.min=Math.min(...e,this.min),this.max=Math.max(...e,this.max)}getMinMaxAvg(){return{min:this.min,max:this.max,avg:this.avg}}},ti=(e={})=>new ho(e),Mm=(...e)=>mc(e),Im=(e,...r)=>gc(r,e),Rm=(...e)=>pc(e),Bm=(...e)=>Dc(e),Pm=(...e)=>Ec(e),Ul=e=>!(typeof e!="number"||Number.isNaN(e)),Nm=e=>ti(e);function*zm(e){for(const r of e)Ul(r)&&(yield r)}var Du=(e,r,n=!0)=>{let i=e/r;const a=i%1;return i=Math.floor(i),(a===.5&&n||a>.5)&&i++,r*i};function nn(e,r,n){if(e===void 0)return{x:0,y:0};if(U.isPoint(e))return e;if(typeof e!="number"||typeof r!="number")throw new Error(`Expected point or x,y as parameters. Got: a: ${JSON.stringify(e)} b: ${JSON.stringify(r)}`);return Object.freeze(typeof n=="number"?{x:e,y:r,z:n}:{x:e,y:r})}var Vl=(...e)=>{const r=e.map(n=>U.toArray(n));return $t.dotProduct(r)},Nn=Object.freeze({x:0,y:0}),Hl=Object.freeze({x:NaN,y:NaN}),Pi=e=>e.x===0&&e.y===0,Ni=e=>Number.isNaN(e.x)&&Number.isNaN(e.y),Wm=e=>e.x===null&&e.y===null,Om=e=>Number.isNaN(e.x)||Number.isNaN(e.y),Yr=(e,...r)=>{if(r.length===0)throw new Error("No points provided");let n=r[0];return r.forEach(i=>{n=e(n,i)}),n},km=(...e)=>Yr((r,n)=>r.x<=n.x?r:n,...e),Lm=(...e)=>Yr((r,n)=>r.x>=n.x?r:n,...e);function Kt(e,r,n,i){const a=nn(r,n,i);return _e(a),zn(a)&&zn(e)?Math.hypot(a.x-e.x,a.y-e.y,a.z-e.z):Math.hypot(a.x-e.x,a.y-e.y)}var $m=(e,r)=>{if(Ie.isRectPositioned(r))return Ie.distanceFromExterior(r,e);if(br.isCirclePositioned(r))return br.distanceFromExterior(r,e);if(Le(r))return Kt(e,r);throw new Error("Unknown shape")},Tm=(e,r)=>{if(Ie.isRectPositioned(r))return Ie.distanceFromExterior(r,e);if(br.isCirclePositioned(r))return br.distanceFromExterior(r,e);if(Le(r))return Kt(e,r);throw new Error("Unknown shape")};function _e(e,r="Point"){if(e===void 0)throw new Error(`'${r}' is undefined. Expected {x,y} got ${JSON.stringify(e)}`);if(e===null)throw new Error(`'${r}' is null. Expected {x,y} got ${JSON.stringify(e)}`);if(e.x===void 0)throw new Error(`'${r}.x' is undefined. Expected {x,y} got ${JSON.stringify(e)}`);if(e.y===void 0)throw new Error(`'${r}.y' is undefined. Expected {x,y} got ${JSON.stringify(e)}`);if(typeof e.x!="number")throw new Error(`'${r}.x' must be a number. Got ${e.x}`);if(typeof e.y!="number")throw new Error(`'${r}.y' must be a number. Got ${e.y}`);if(e.x===null)throw new Error(`'${r}.x' is null`);if(e.y===null)throw new Error(`'${r}.y' is null`);if(Number.isNaN(e.x))throw new Error(`'${r}.x' is NaN`);if(Number.isNaN(e.y))throw new Error(`'${r}.y' is NaN`)}var Gl=(e,r="pt")=>(_e(e,r),ae(e.x,"nonZero",`${r}.x`),ae(e.y,"nonZero",`${r}.y`),!0),qm=e=>({...e,x:Math.abs(e.x),y:Math.abs(e.y)}),Cn=(e,r,n)=>r===void 0?Math.atan2(e.y,e.x):n!==void 0?Math.atan2(r.y-e.y,r.x-e.x)-Math.atan2(n.y-e.y,n.x-e.x):Math.atan2(r.y-e.y,r.x-e.x),Kl=(...e)=>{if(!Array.isArray(e))throw new Error("Expected list of points");const r=e.reduce((n,i)=>{if(i===void 0)return n;if(Array.isArray(i))throw new Error("'points' list contains an array. Did you mean: centroid(...myPoints)?");if(!Le(i))throw new Error(`'points' contains something which is not a point: ${JSON.stringify(i)}`);return{x:n.x+i.x,y:n.y+i.y}},{x:0,y:0});return Object.freeze({x:r.x/e.length,y:r.y/e.length})},jm=(...e)=>{const r=Yr((l,f)=>l.x<f.x?l:f,...e),n=Yr((l,f)=>l.x>f.x?l:f,...e),i=Yr((l,f)=>l.y<f.y?l:f,...e),a=Yr((l,f)=>l.y>f.y?l:f,...e),u={x:r.x,y:i.y},o={x:n.x,y:i.y},s={x:n.x,y:a.y},c={x:r.x,y:a.y};return Ie.maxFromCorners(u,o,s,c)};function Le(e){return!(e===void 0||e===null||e.x===void 0||e.y===void 0)}var zn=e=>!(e===void 0||e===null||e.x===void 0||e.y===void 0||e.z===void 0),Um=e=>[e.x,e.y];function Jl(e,r){if(e===void 0)return"(undefined)";if(e===null)return"(null)";const n=r?e.x.toFixed(r):e.x,i=r?e.y.toFixed(r):e.y;if(e.z!==void 0){const a=r?e.z.toFixed(r):e.z;return`(${n},${i},${a})`}else return`(${n},${i})`}var ri=(...e)=>{if(e===void 0)throw new Error("parameter 'p' is undefined");if(e.length<2)return!0;for(let r=1;r<e.length;r++)if(e[r].x!==e[0].x||e[r].y!==e[0].y)return!1;return!0},Vm=(e,r,n)=>{typeof n=="number"&&(n={x:n,y:n});const i=Math.abs(r.x-e.x),a=Math.abs(r.y-e.y);return i<=n.x&&a<=n.y},Hm=(e,r,n,i=!1)=>Or(e,r,n,i),Gm=(e,r)=>{if(Array.isArray(e)){if(e.length!==2)throw new Error("Expected array of length two, got "+e.length);return Object.freeze({x:e[0],y:e[1]})}else{if(e===void 0)e=0;else if(Number.isNaN(e))throw new Error("x is NaN");if(r===void 0)r=0;else if(Number.isNaN(r))throw new Error("y is NaN");return Object.freeze({x:e,y:r})}},Yl=(...e)=>{const r=[];if(Array.isArray(e[0]))e.forEach(n=>{if(n.length%2!==0)throw new Error("coords array should be even-numbered");r.push(Object.freeze({x:n[0],y:n[1]}))});else{if(e.length%2!==0)throw new Error("Expected even number of elements: [x,y,x,y...]");for(let n=0;n<e.length;n+=2)r.push(Object.freeze({x:e[n],y:e[n+1]}))}return r};function ln(e,r,n,i){if(Le(e))return _e(e,"a"),Le(r)?(_e(r,"b"),Object.freeze({...e,x:e.x-r.x,y:e.y-r.y})):(n===void 0&&(n=r),Object.freeze({...e,x:e.x-r,y:e.y-n}));if(ae(e,"","a"),typeof r!="number")throw new Error("Second parameter is expected to by y value");if(ae(r,"","b"),Number.isNaN(n))throw new Error("Third parameter is NaN");if(Number.isNaN(i))throw new Error("Fourth parameter is NaN");return n===void 0&&(n=0),i===void 0&&(i=0),Object.freeze({x:e-n,y:r-i})}var Km=(e,r)=>Object.freeze({...e,x:r(e.x,"x"),y:r(e.y,"y")}),Jm=(e,...r)=>xl(...r)(e),xl=(...e)=>r=>e.reduce((n,i)=>i(n),r),Zl=(e,r,n={x:0,y:0})=>{let i=n;return e.forEach(a=>{i=r(a,i)}),i},Xl=function(e,r,n,i){if(e===void 0)throw new Error(`a missing. a: ${e}`);let a,u;if(Le(e))if(a=e,r===void 0&&(r=Nn),Le(r))u=r;else{if(r===void 0)throw new Error("Expects x coordinate");u={x:r,y:n===void 0?r:n}}else if(!Le(r)){if(r===void 0)throw new Error("Expected number as second param");if(a={x:e,y:r},n===void 0)throw new Error("Expects x coordiante");u={x:n,y:i===void 0?0:i}}if(a===void 0)throw new Error(`ptA missing. a: ${e}`);if(u===void 0)throw new Error(`ptB missing. b: ${r}`);return _e(a,"a"),_e(u,"b"),Object.freeze({x:a.x+u.x,y:a.y+u.y})};function vo(e,r,n){if(_e(e,"a"),typeof r=="number")return typeof n>"u"&&(n=r),ae(n,"","y"),ae(r,"","x"),Object.freeze({x:e.x*r,y:e.y*n});if(Le(r))return _e(r,"b"),Object.freeze({x:e.x*r.x,y:e.y*r.y});if(Ie.isRect(r))return Ie.guard(r,"rect"),Object.freeze({x:e.x*r.width,y:e.y*r.height});throw new Error(`Invalid arguments. a: ${JSON.stringify(e)} b: ${JSON.stringify(r)}`)}var Ym=(e,r)=>zn(e)?Object.freeze({...e,x:e.x*r,y:e.y*r,z:e.z*r}):Object.freeze({...e,x:e.x*r,y:e.y*r});function Ql(e,r,n,i){if(Le(e))return _e(e,"a"),Le(r)?(Gl(r),Object.freeze({x:e.x/r.x,y:e.y/r.y})):Ie.isRect(r)?(Ie.guard(r,"rect"),Object.freeze({x:e.x/r.width,y:e.y/r.height})):(n===void 0&&(n=r),_e(e),ae(r,"nonZero","x"),ae(n,"nonZero","y"),Object.freeze({x:e.x/r,y:e.y/n}));if(typeof r!="number")throw new Error("expected second parameter to be y1 coord");return ae(e,"positive","x1"),ae(r,"positive","y1"),n===void 0&&(n=1),i===void 0&&(i=n),ae(n,"nonZero","x2"),ae(i,"nonZero","y2"),Object.freeze({x:e/n,y:r/i})}var xm=(e,r,n=!0)=>Object.freeze({x:Du(e.x,r.x,n),y:Du(e.y,r.y,n)}),Zm=(...e)=>{const r=[...e].sort(ef);if(r.length===1)return r;const n=u=>{const o=[];return u.forEach(s=>{for(;o.length>=2;){const c=o[o.length-1],l=o[o.length-2];if((c.x-l.x)*(s.y-l.y)>=(c.y-l.y)*(s.x-l.x))o.pop();else break}o.push(s)}),o.pop(),o},i=n(r),a=n(r.reverse());return i.length===1&&a.length===1&&ri(a[0],i[0])?i:i.concat(a)},Xm=(e,r)=>e.x<r.x&&e.y<r.y?-2:e.x>r.x&&e.y>r.y?2:e.x<r.x||e.y<r.y?-1:e.x>r.x||e.y>r.y?1:e.x===r.x&&e.x===r.y?0:NaN,ef=(e,r)=>e.x-r.x||e.y-r.y,Eu=(e,r,n)=>{const i=Math.cos(n)*r+e.x,a=Math.sin(n)*r+e.y;return{x:i,y:a}};function Xr(e,r,n){n===void 0&&(n={x:0,y:0}),_e(n,"origin"),ae(r,"","amountRadian");const i=Array.isArray(e);if(r===0)return e;i||(e=[e]);const a=e;a.forEach((c,l)=>_e(c,`pt[${l}]`));const s=a.map(c=>dt.fromCartesian(c,n)).map(c=>dt.rotate(c,r)).map(c=>dt.toCartesian(c,n));return i?s:s[0]}var Qm=(e,r)=>{const n=[[Math.cos(r),-Math.sin(r)],[Math.sin(r),Math.cos(r)]],i=[];for(let a=0;a<e.length;++a)i[a]=[n[0][0]*e[a][0]+n[0][1]*e[a][1],n[1][0]*e[a][0]+n[1][1]*e[a][1]];return i},eg=(e,r)=>{if(Le(e)&&(r=e.y,e=e.x),r===void 0)throw new Error("Expected y");return Math.sqrt(e*e+r*r)},tf=(e,r)=>{const n=nn(e,r),i=eg(n);return i===0?U.Empty:Object.freeze({x:n.x/i,y:n.y/i})};function tg(e,r,n,i){if(Le(e)){if(typeof r=="number"&&n!==void 0)ae(r,"positive","width"),ae(n,"positive","height");else{if(!Ie.isRect(r))throw new Error("Expected second parameter to be a rect");n=r.height,r=r.width}return Object.freeze({x:e.x/r,y:e.y/n})}else{if(ae(e,"positive","x"),typeof r!="number")throw new Error("Expecting second parameter to be a number (width)");if(typeof n!="number")throw new Error("Expecting third parameter to be a number (height)");if(ae(r,"positive","y"),ae(n,"positive","width"),i===void 0)throw new Error("Expected height parameter");return ae(i,"positive","height"),Object.freeze({x:e/n,y:r/i})}}var rg=e=>(e===void 0&&(e=Zt),Object.freeze({x:e(),y:e()})),ng=(e,r={x:1,y:1},n={x:0,y:0})=>(_e(e,"pt"),_e(r,"ptMax"),_e(n,"ptMin"),Object.freeze({x:aa(e.x,n.x,r.x),y:aa(e.y,n.y,r.y)})),ig=(e,r="both")=>{switch(r){case"both":return zn(e)?Object.freeze({...e,x:e.x*-1,y:e.y*-1,z:e.z*-1}):Object.freeze({...e,x:e.x*-1,y:e.y*-1});case"x":return Object.freeze({...e,x:e.x*-1});case"y":return Object.freeze({...e,y:e.y*-1});case"z":if(zn(e))return Object.freeze({...e,z:e.z*-1});throw new Error("pt parameter is missing z");default:throw new Error("Unknown what parameter. Expecting 'both', 'x' or 'y'")}},ag=(e,r=Math.round)=>(_e(e,"pt"),Object.freeze({x:r(e.x),y:r(e.y)})),rf=(e,r=1,n=0)=>{const i=Kt(e);let a=1;return i>r?a=r/i:i<n&&(a=n/i),a===1?e:vo(e,a,a)};function ug(e,r,n,i){if(Le(e))return r===void 0&&(r=0),n===void 0&&(n=1),ae(r,"","min"),ae(n,"","max"),Object.freeze({x:Gt(e.x,r,n),y:Gt(e.y,r,n)});if(r===void 0)throw new Error("Expected y coordinate");return n===void 0&&(n=0),i===void 0&&(i=1),ae(e,"","x"),ae(r,"","y"),ae(n,"","min"),ae(i,"","max"),Object.freeze({x:Gt(e,n,i),y:Gt(r,n,i)})}var bu=(e,r)=>{const n=nn(e,r);let i=0,a=0,u=0,o=performance.now(),s=n;return(l,f)=>{const h=nn(l,f);i+=h.x,a+=h.y,u++;const g=Kt(h,n),C=Kt(h,s),R=performance.now(),k=C/(R-o);return o=R,s=h,Object.freeze({angle:Cn(h,n),distanceFromStart:g,distanceFromLast:C,speed:k,centroid:Kl(h,n),average:{x:i/u,y:a/u}})}},og=(e,r,n)=>{const i=U.subtract(e,r),a=U.subtract(n,r);return U.isPoint3d(i)&&U.isPoint3d(a)?(i.x*a.x+i.y*a.y+i.z*a.z)/(a.x*a.x+a.y*a.y+a.z*a.z):(i.x*a.x+i.y*a.y)/(a.x*a.x+a.y*a.y)},nf=e=>e.startRadian!==void 0&&e.endRadian!==void 0,wr=e=>e.x!==void 0&&e.y!==void 0,Ms=Math.PI*2;function sg(e,r,n,i){const a={radius:e,startRadian:Wr(r),endRadian:Wr(n)};if(Le(i)){_e(i);const u={...a,x:i.x,y:i.y};return Object.freeze(u)}else return Object.freeze(a)}var af=e=>it.fromPoints(Yi(e,e.startRadian),Yi(e,e.endRadian)),Yi=(e,r,n)=>{if(r>e.endRadian)throw new Error("angleRadian beyond end angle of arc");if(r<e.startRadian)throw new Error("angleRadian beyond start angle of arc");return n===void 0&&(wr(e)?n=e:n={x:0,y:0}),{x:Math.cos(r)*e.radius+n.x,y:Math.sin(r)*e.radius+n.y}},yo=e=>{if(e===void 0)throw new Error("Arc is undefined");if(wr(e)&&_e(e,"arc"),e.radius===void 0)throw new Error(`Arc radius is undefined (${JSON.stringify(e)})`);if(typeof e.radius!="number")throw new Error("Radius must be a number");if(Number.isNaN(e.radius))throw new Error("Radius is NaN");if(e.radius<=0)throw new Error("Radius must be greater than zero");if(e.startRadian===void 0)throw new Error("Arc is missing 'startRadian' field");if(e.endRadian===void 0)throw new Error("Arc is missing 'startRadian' field");if(Number.isNaN(e.endRadian))throw new Error("Arc endRadian is NaN");if(Number.isNaN(e.startRadian))throw new Error("Arc endRadian is NaN");if(e.startRadian>=e.endRadian)throw new Error("startRadian is expected to be les than endRadian")},mo=(e,r,n)=>(yo(r),Yi(r,r.startRadian+(r.endRadian-r.startRadian)*e,n)),cg=e=>(yo(e),Object.freeze({...e,nearest:r=>{throw new Error("not implemented")},interpolate:r=>mo(r,e),bbox:()=>of(e),length:()=>uf(e),toSvgString:()=>sf(e),kind:"arc"})),uf=e=>Ms*e.radius*((e.startRadian-e.endRadian)/Ms),of=e=>{if(wr(e)){const r=mo(.5,e),n=af(e);return U.bbox(r,n.a,n.b)}else return{width:e.radius*2,height:e.radius*2}},sf=(e,r,n,i,a)=>{if(nf(e))return wr(e)?Ci(e,e.radius,e.startRadian,e.endRadian,r):Le(r)?Ci(r,e.radius,e.startRadian,e.endRadian,n):Ci({x:0,y:0},e.radius,e.startRadian,e.endRadian);if(n===void 0)throw new Error("startAngle undefined");if(i===void 0)throw new Error("endAngle undefined");if(Le(e)){if(typeof r=="number"&&typeof n=="number"&&typeof i=="number")return Ci(e,r,n,i,a);throw new Error("Expected (point, number, number, number). Missing a number param.")}else throw new Error("Expected (point, number, number, number). Missing first point.")},Ci=(e,r,n,i,a)=>{(a===void 0||typeof a!="object")&&(a={});const u=i-n===360,o=dt.toCartesian(r,i-.01,e),s=dt.toCartesian(r,n,e),{largeArc:c=!1,sweep:l=!1}=a,f=[`
    M ${o.x} ${o.y}
    A ${r} ${r} 0 ${c?"1":"0"} ${l?"1":"0"} ${s.x} ${s.y},
  `];return u&&f.push("z"),f},lg=(e,r)=>U.distance(e,r),fg=(e,r)=>e.radius!==r.radius?!1:wr(e)&&wr(r)?!(e.x!==r.x||e.y!==r.y||e.z!==r.z):!(!(!wr(e)&&!wr(r))||e.endRadian!==r.endRadian||e.startRadian!==r.startRadian),gi={};ie(gi,{computeQuadraticSimple:()=>Dg,cubic:()=>Eg,isCubicBezier:()=>go,isQuadraticBezier:()=>ga,quadratic:()=>ff,quadraticBend:()=>wg,quadraticSimple:()=>Fn,quadraticToSvgString:()=>lf,toPath:()=>Wi});var{abs:Vn,cos:vr,sin:hn,acos:hg,atan2:Hn,sqrt:Ir,pow:Ht}=Math;function Gn(e){return e<0?-Ht(-e,1/3):Ht(e,1/3)}var cf=Math.PI,Fi=2*cf,Rr=cf/2,dg=1e-6,xa=Number.MAX_SAFE_INTEGER||9007199254740991,Za=Number.MIN_SAFE_INTEGER||-9007199254740991,vg={x:0,y:0,z:0},Z={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(e,r){const n=r(e);let i=n.x*n.x+n.y*n.y;return typeof n.z<"u"&&(i+=n.z*n.z),Ir(i)},compute:function(e,r,n){if(e===0)return r[0].t=0,r[0];const i=r.length-1;if(e===1)return r[i].t=1,r[i];const a=1-e;let u=r;if(i===0)return r[0].t=e,r[0];if(i===1){const s={x:a*u[0].x+e*u[1].x,y:a*u[0].y+e*u[1].y,t:e};return n&&(s.z=a*u[0].z+e*u[1].z),s}if(i<4){let s=a*a,c=e*e,l,f,h,g=0;i===2?(u=[u[0],u[1],u[2],vg],l=s,f=a*e*2,h=c):i===3&&(l=s*a,f=s*e*3,h=a*c*3,g=e*c);const C={x:l*u[0].x+f*u[1].x+h*u[2].x+g*u[3].x,y:l*u[0].y+f*u[1].y+h*u[2].y+g*u[3].y,t:e};return n&&(C.z=l*u[0].z+f*u[1].z+h*u[2].z+g*u[3].z),C}const o=JSON.parse(JSON.stringify(r));for(;o.length>1;){for(let s=0;s<o.length-1;s++)o[s]={x:o[s].x+(o[s+1].x-o[s].x)*e,y:o[s].y+(o[s+1].y-o[s].y)*e},typeof o[s].z<"u"&&(o[s]=o[s].z+(o[s+1].z-o[s].z)*e);o.splice(o.length-1,1)}return o[0].t=e,o[0]},computeWithRatios:function(e,r,n,i){const a=1-e,u=n,o=r;let s=u[0],c=u[1],l=u[2],f=u[3],h;if(s*=a,c*=e,o.length===2)return h=s+c,{x:(s*o[0].x+c*o[1].x)/h,y:(s*o[0].y+c*o[1].y)/h,z:i?(s*o[0].z+c*o[1].z)/h:!1,t:e};if(s*=a,c*=2*a,l*=e*e,o.length===3)return h=s+c+l,{x:(s*o[0].x+c*o[1].x+l*o[2].x)/h,y:(s*o[0].y+c*o[1].y+l*o[2].y)/h,z:i?(s*o[0].z+c*o[1].z+l*o[2].z)/h:!1,t:e};if(s*=a,c*=1.5*a,l*=3*a,f*=e*e*e,o.length===4)return h=s+c+l+f,{x:(s*o[0].x+c*o[1].x+l*o[2].x+f*o[3].x)/h,y:(s*o[0].y+c*o[1].y+l*o[2].y+f*o[3].y)/h,z:i?(s*o[0].z+c*o[1].z+l*o[2].z+f*o[3].z)/h:!1,t:e}},derive:function(e,r){const n=[];for(let i=e,a=i.length,u=a-1;a>1;a--,u--){const o=[];for(let s=0,c;s<u;s++)c={x:u*(i[s+1].x-i[s].x),y:u*(i[s+1].y-i[s].y)},r&&(c.z=u*(i[s+1].z-i[s].z)),o.push(c);n.push(o),i=o}return n},between:function(e,r,n){return r<=e&&e<=n||Z.approximately(e,r)||Z.approximately(e,n)},approximately:function(e,r,n){return Vn(e-r)<=(n||dg)},length:function(e){const n=Z.Tvalues.length;let i=0;for(let a=0,u;a<n;a++)u=.5*Z.Tvalues[a]+.5,i+=Z.Cvalues[a]*Z.arcfn(u,e);return .5*i},map:function(e,r,n,i,a){const u=n-r,o=a-i,s=e-r,c=s/u;return i+o*c},lerp:function(e,r,n){const i={x:r.x+e*(n.x-r.x),y:r.y+e*(n.y-r.y)};return r.z!==void 0&&n.z!==void 0&&(i.z=r.z+e*(n.z-r.z)),i},pointToString:function(e){let r=e.x+"/"+e.y;return typeof e.z<"u"&&(r+="/"+e.z),r},pointsToString:function(e){return"["+e.map(Z.pointToString).join(", ")+"]"},copy:function(e){return JSON.parse(JSON.stringify(e))},angle:function(e,r,n){const i=r.x-e.x,a=r.y-e.y,u=n.x-e.x,o=n.y-e.y,s=i*o-a*u,c=i*u+a*o;return Hn(s,c)},round:function(e,r){const n=""+e,i=n.indexOf(".");return parseFloat(n.substring(0,i+1+r))},dist:function(e,r){const n=e.x-r.x,i=e.y-r.y;return Ir(n*n+i*i)},closest:function(e,r){let n=Ht(2,63),i,a;return e.forEach(function(u,o){a=Z.dist(r,u),a<n&&(n=a,i=o)}),{mdist:n,mpos:i}},abcratio:function(e,r){if(r!==2&&r!==3)return!1;if(typeof e>"u")e=.5;else if(e===0||e===1)return e;const n=Ht(e,r)+Ht(1-e,r),i=n-1;return Vn(i/n)},projectionratio:function(e,r){if(r!==2&&r!==3)return!1;if(typeof e>"u")e=.5;else if(e===0||e===1)return e;const n=Ht(1-e,r),i=Ht(e,r)+n;return n/i},lli8:function(e,r,n,i,a,u,o,s){const c=(e*i-r*n)*(a-o)-(e-n)*(a*s-u*o),l=(e*i-r*n)*(u-s)-(r-i)*(a*s-u*o),f=(e-n)*(u-s)-(r-i)*(a-o);return f==0?!1:{x:c/f,y:l/f}},lli4:function(e,r,n,i){const a=e.x,u=e.y,o=r.x,s=r.y,c=n.x,l=n.y,f=i.x,h=i.y;return Z.lli8(a,u,o,s,c,l,f,h)},lli:function(e,r){return Z.lli4(e,e.c,r,r.c)},makeline:function(e,r){return new We(e.x,e.y,(e.x+r.x)/2,(e.y+r.y)/2,r.x,r.y)},findbbox:function(e){let r=xa,n=xa,i=Za,a=Za;return e.forEach(function(u){const o=u.bbox();r>o.x.min&&(r=o.x.min),n>o.y.min&&(n=o.y.min),i<o.x.max&&(i=o.x.max),a<o.y.max&&(a=o.y.max)}),{x:{min:r,mid:(r+i)/2,max:i,size:i-r},y:{min:n,mid:(n+a)/2,max:a,size:a-n}}},shapeintersections:function(e,r,n,i,a){if(!Z.bboxoverlap(r,i))return[];const u=[],o=[e.startcap,e.forward,e.back,e.endcap],s=[n.startcap,n.forward,n.back,n.endcap];return o.forEach(function(c){c.virtual||s.forEach(function(l){if(l.virtual)return;const f=c.intersects(l,a);f.length>0&&(f.c1=c,f.c2=l,f.s1=e,f.s2=n,u.push(f))})}),u},makeshape:function(e,r,n){const i=r.points.length,a=e.points.length,u=Z.makeline(r.points[i-1],e.points[0]),o=Z.makeline(e.points[a-1],r.points[0]),s={startcap:u,forward:e,back:r,endcap:o,bbox:Z.findbbox([u,e,r,o])};return s.intersections=function(c){return Z.shapeintersections(s,s.bbox,c,c.bbox,n)},s},getminmax:function(e,r,n){if(!n)return{min:0,max:0};let i=xa,a=Za,u,o;n.indexOf(0)===-1&&(n=[0].concat(n)),n.indexOf(1)===-1&&n.push(1);for(let s=0,c=n.length;s<c;s++)u=n[s],o=e.get(u),o[r]<i&&(i=o[r]),o[r]>a&&(a=o[r]);return{min:i,mid:(i+a)/2,max:a,size:a-i}},align:function(e,r){const n=r.p1.x,i=r.p1.y,a=-Hn(r.p2.y-i,r.p2.x-n),u=function(o){return{x:(o.x-n)*vr(a)-(o.y-i)*hn(a),y:(o.x-n)*hn(a)+(o.y-i)*vr(a)}};return e.map(u)},roots:function(e,r){r=r||{p1:{x:0,y:0},p2:{x:1,y:0}};const n=e.length-1,i=Z.align(e,r),a=function(P){return 0<=P&&P<=1};if(n===2){const P=i[0].y,V=i[1].y,ue=i[2].y,ee=P-2*V+ue;if(ee!==0){const pe=-Ir(V*V-P*ue),be=-P+V,T=-(pe+be)/ee,q=-(-pe+be)/ee;return[T,q].filter(a)}else if(V!==ue&&ee===0)return[(2*V-ue)/(2*V-2*ue)].filter(a);return[]}const u=i[0].y,o=i[1].y,s=i[2].y,c=i[3].y;let l=-u+3*o-3*s+c,f=3*u-6*o+3*s,h=-3*u+3*o,g=u;if(Z.approximately(l,0)){if(Z.approximately(f,0))return Z.approximately(h,0)?[]:[-g/h].filter(a);const P=Ir(h*h-4*f*g),V=2*f;return[(P-h)/V,(-h-P)/V].filter(a)}f/=l,h/=l,g/=l;const C=(3*h-f*f)/3,R=C/3,k=(2*f*f*f-9*f*h+27*g)/27,z=k/2,A=z*z+R*R*R;let S,O,$,_,I;if(A<0){const P=-C/3,V=P*P*P,ue=Ir(V),ee=-k/(2*ue),pe=ee<-1?-1:ee>1?1:ee,be=hg(pe),T=Gn(ue),q=2*T;return $=q*vr(be/3)-f/3,_=q*vr((be+Fi)/3)-f/3,I=q*vr((be+2*Fi)/3)-f/3,[$,_,I].filter(a)}else{if(A===0)return S=z<0?Gn(-z):-Gn(z),$=2*S-f/3,_=-S-f/3,[$,_].filter(a);{const P=Ir(A);return S=Gn(-z+P),O=Gn(z+P),[S-O-f/3].filter(a)}}},droots:function(e){if(e.length===3){const r=e[0],n=e[1],i=e[2],a=r-2*n+i;if(a!==0){const u=-Ir(n*n-r*i),o=-r+n,s=-(u+o)/a,c=-(-u+o)/a;return[s,c]}else if(n!==i&&a===0)return[(2*n-i)/(2*(n-i))];return[]}if(e.length===2){const r=e[0],n=e[1];return r!==n?[r/(r-n)]:[]}return[]},curvature:function(e,r,n,i,a){let u,o,s,c,l=0,f=0;const h=Z.compute(e,r),g=Z.compute(e,n),C=h.x*h.x+h.y*h.y;if(i?(u=Ir(Ht(h.y*g.z-g.y*h.z,2)+Ht(h.z*g.x-g.z*h.x,2)+Ht(h.x*g.y-g.x*h.y,2)),o=Ht(C+h.z*h.z,3/2)):(u=h.x*g.y-h.y*g.x,o=Ht(C,3/2)),u===0||o===0)return{k:0,r:0};if(l=u/o,f=o/u,!a){const R=Z.curvature(e-.001,r,n,i,!0).k,k=Z.curvature(e+.001,r,n,i,!0).k;c=(k-l+(l-R))/2,s=(Vn(k-l)+Vn(l-R))/2}return{k:l,r:f,dk:c,adk:s}},inflections:function(e){if(e.length<4)return[];const r=Z.align(e,{p1:e[0],p2:e.slice(-1)[0]}),n=r[2].x*r[1].y,i=r[3].x*r[1].y,a=r[1].x*r[2].y,u=r[3].x*r[2].y,o=18*(-3*n+2*i+3*a-u),s=18*(3*n-i-3*a),c=18*(a-n);if(Z.approximately(o,0)){if(!Z.approximately(s,0)){let g=-c/s;if(0<=g&&g<=1)return[g]}return[]}const l=2*o;if(Z.approximately(l,0))return[];const f=s*s-4*o*c;if(f<0)return[];const h=Math.sqrt(f);return[(h-s)/l,-(s+h)/l].filter(function(g){return 0<=g&&g<=1})},bboxoverlap:function(e,r){const n=["x","y"],i=n.length;for(let a=0,u,o,s,c;a<i;a++)if(u=n[a],o=e[u].mid,s=r[u].mid,c=(e[u].size+r[u].size)/2,Vn(o-s)>=c)return!1;return!0},expandbox:function(e,r){r.x.min<e.x.min&&(e.x.min=r.x.min),r.y.min<e.y.min&&(e.y.min=r.y.min),r.z&&r.z.min<e.z.min&&(e.z.min=r.z.min),r.x.max>e.x.max&&(e.x.max=r.x.max),r.y.max>e.y.max&&(e.y.max=r.y.max),r.z&&r.z.max>e.z.max&&(e.z.max=r.z.max),e.x.mid=(e.x.min+e.x.max)/2,e.y.mid=(e.y.min+e.y.max)/2,e.z&&(e.z.mid=(e.z.min+e.z.max)/2),e.x.size=e.x.max-e.x.min,e.y.size=e.y.max-e.y.min,e.z&&(e.z.size=e.z.max-e.z.min)},pairiteration:function(e,r,n){const i=e.bbox(),a=r.bbox(),u=1e5,o=n||.5;if(i.x.size+i.y.size<o&&a.x.size+a.y.size<o)return[(u*(e._t1+e._t2)/2|0)/u+"/"+(u*(r._t1+r._t2)/2|0)/u];let s=e.split(.5),c=r.split(.5),l=[{left:s.left,right:c.left},{left:s.left,right:c.right},{left:s.right,right:c.right},{left:s.right,right:c.left}];l=l.filter(function(h){return Z.bboxoverlap(h.left.bbox(),h.right.bbox())});let f=[];return l.length===0||(l.forEach(function(h){f=f.concat(Z.pairiteration(h.left,h.right,o))}),f=f.filter(function(h,g){return f.indexOf(h)===g})),f},getccenter:function(e,r,n){const i=r.x-e.x,a=r.y-e.y,u=n.x-r.x,o=n.y-r.y,s=i*vr(Rr)-a*hn(Rr),c=i*hn(Rr)+a*vr(Rr),l=u*vr(Rr)-o*hn(Rr),f=u*hn(Rr)+o*vr(Rr),h=(e.x+r.x)/2,g=(e.y+r.y)/2,C=(r.x+n.x)/2,R=(r.y+n.y)/2,k=h+s,z=g+c,A=C+l,S=R+f,O=Z.lli8(h,g,k,z,C,R,A,S),$=Z.dist(O,e);let _=Hn(e.y-O.y,e.x-O.x),I=Hn(r.y-O.y,r.x-O.x),P=Hn(n.y-O.y,n.x-O.x),V;return _<P?((_>I||I>P)&&(_+=Fi),_>P&&(V=P,P=_,_=V)):P<I&&I<_?(V=P,P=_,_=V):P+=Fi,O.s=_,O.e=P,O.r=$,O},numberSort:function(e,r){return e-r}},zi=class{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(e){return Z.pointsToString(e.points)}).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map(function(e){return e.length()}).reduce(function(e,r){return e+r})}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var r=e[0].bbox(),n=1;n<e.length;n++)Z.expandbox(r,e[n].bbox());return r}offset(e){const r=[];return this.curves.forEach(function(n){r.push(...n.offset(e))}),new zi(r)}},{abs:Kn,min:Is,max:Rs,cos:yg,sin:mg,acos:gg,sqrt:Jn}=Math,pg=Math.PI,We=class{constructor(e){let r=e&&e.forEach?e:Array.from(arguments).slice(),n=!1;if(typeof r[0]=="object"){n=r.length;const g=[];r.forEach(function(C){["x","y","z"].forEach(function(R){typeof C[R]<"u"&&g.push(C[R])})}),r=g}let i=!1;const a=r.length;if(n){if(n>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");i=!0}}else if(a!==6&&a!==8&&a!==9&&a!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const u=this._3d=!i&&(a===9||a===12)||e&&e[0]&&typeof e[0].z<"u",o=this.points=[];for(let g=0,C=u?3:2;g<a;g+=C){var s={x:r[g],y:r[g+1]};u&&(s.z=r[g+2]),o.push(s)}const c=this.order=o.length-1,l=this.dims=["x","y"];u&&l.push("z"),this.dimlen=l.length;const f=Z.align(o,{p1:o[0],p2:o[c]}),h=Z.dist(o[0],o[c]);this._linear=f.reduce((g,C)=>g+Kn(C.y),0)<h/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,r,n,i){if(typeof i>"u"&&(i=.5),i===0)return new We(r,r,n);if(i===1)return new We(e,r,r);const a=We.getABC(2,e,r,n,i);return new We(e,a.A,n)}static cubicFromPoints(e,r,n,i,a){typeof i>"u"&&(i=.5);const u=We.getABC(3,e,r,n,i);typeof a>"u"&&(a=Z.dist(r,u.C));const o=a*(1-i)/i,s=Z.dist(e,n),c=(n.x-e.x)/s,l=(n.y-e.y)/s,f=a*c,h=a*l,g=o*c,C=o*l,R={x:r.x-f,y:r.y-h},k={x:r.x+g,y:r.y+C},z=u.A,A={x:z.x+(R.x-z.x)/(1-i),y:z.y+(R.y-z.y)/(1-i)},S={x:z.x+(k.x-z.x)/i,y:z.y+(k.y-z.y)/i},O={x:e.x+(A.x-e.x)/i,y:e.y+(A.y-e.y)/i},$={x:n.x+(S.x-n.x)/(1-i),y:n.y+(S.y-n.y)/(1-i)};return new We(e,O,$,n)}static getUtils(){return Z}getUtils(){return We.getUtils()}static get PolyBezier(){return zi}valueOf(){return this.toString()}toString(){return Z.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,r=e[0].x,n=e[0].y,i=["M",r,n,this.order===2?"Q":"C"];for(let a=1,u=e.length;a<u;a++)i.push(e[a].x),i.push(e[a].y);return i.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map(function(e,r){return""+r+e.x+e.y+(e.z?e.z:0)}).join("")}update(){this._lut=[],this.dpoints=Z.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,r=Z.angle(e[0],e[this.order],e[1]);this.clockwise=r>0}length(){return Z.length(this.derivative.bind(this))}static getABC(e=2,r,n,i,a=.5){const u=Z.projectionratio(a,e),o=1-u,s={x:u*r.x+o*i.x,y:u*r.y+o*i.y},c=Z.abcratio(a,e);return{A:{x:n.x+(n.x-s.x)/c,y:n.y+(n.y-s.y)/c},B:n,C:s,S:r,E:i}}getABC(e,r){r=r||this.get(e);let n=this.points[0],i=this.points[this.order];return We.getABC(this.order,n,r,i,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e)return this._lut;this._lut=[],e++,this._lut=[];for(let r=0,n,i;r<e;r++)i=r/(e-1),n=this.compute(i),n.t=i,this._lut.push(n);return this._lut}on(e,r){r=r||5;const n=this.getLUT(),i=[];for(let a=0,u,o=0;a<n.length;a++)u=n[a],Z.dist(u,e)<r&&(i.push(u),o+=a/n.length);return i.length?t/=i.length:!1}project(e){const r=this.getLUT(),n=r.length-1,i=Z.closest(r,e),a=i.mpos,u=(a-1)/n,o=(a+1)/n,s=.1/n;let c=i.mdist,l=u,f=l,h;c+=1;for(let g;l<o+s;l+=s)h=this.compute(l),g=Z.dist(e,h),g<c&&(c=g,f=l);return f=f<0?0:f>1?1:f,h=this.compute(f),h.t=f,h.d=c,h}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?Z.computeWithRatios(e,this.points,this.ratios,this._3d):Z.compute(e,this.points,this._3d,this.ratios)}raise(){const e=this.points,r=[e[0]],n=e.length;for(let i=1,a,u;i<n;i++)a=e[i],u=e[i-1],r[i]={x:(n-i)/n*a.x+i/n*u.x,y:(n-i)/n*a.y+i/n*u.y};return r[n]=e[n-1],new We(r)}derivative(e){return Z.compute(e,this.dpoints[0],this._3d)}dderivative(e){return Z.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new We(Z.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return Z.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return Z.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const r=this.derivative(e),n=Jn(r.x*r.x+r.y*r.y);return{t:e,x:-r.y/n,y:r.x/n}}__normal3(e){const r=this.derivative(e),n=this.derivative(e+.01),i=Jn(r.x*r.x+r.y*r.y+r.z*r.z),a=Jn(n.x*n.x+n.y*n.y+n.z*n.z);r.x/=i,r.y/=i,r.z/=i,n.x/=a,n.y/=a,n.z/=a;const u={x:n.y*r.z-n.z*r.y,y:n.z*r.x-n.x*r.z,z:n.x*r.y-n.y*r.x},o=Jn(u.x*u.x+u.y*u.y+u.z*u.z);u.x/=o,u.y/=o,u.z/=o;const s=[u.x*u.x,u.x*u.y-u.z,u.x*u.z+u.y,u.x*u.y+u.z,u.y*u.y,u.y*u.z-u.x,u.x*u.z-u.y,u.y*u.z+u.x,u.z*u.z];return{t:e,x:s[0]*r.x+s[1]*r.y+s[2]*r.z,y:s[3]*r.x+s[4]*r.y+s[5]*r.z,z:s[6]*r.x+s[7]*r.y+s[8]*r.z}}hull(e){let r=this.points,n=[],i=[],a=0;for(i[a++]=r[0],i[a++]=r[1],i[a++]=r[2],this.order===3&&(i[a++]=r[3]);r.length>1;){n=[];for(let u=0,o,s=r.length-1;u<s;u++)o=Z.lerp(e,r[u],r[u+1]),i[a++]=o,n.push(o);r=n}return i}split(e,r){if(e===0&&!!r)return this.split(r).left;if(r===1)return this.split(e).right;const n=this.hull(e),i={left:this.order===2?new We([n[0],n[3],n[5]]):new We([n[0],n[4],n[7],n[9]]),right:this.order===2?new We([n[5],n[4],n[2]]):new We([n[9],n[8],n[6],n[3]]),span:n};return i.left._t1=Z.map(0,0,1,this._t1,this._t2),i.left._t2=Z.map(e,0,1,this._t1,this._t2),i.right._t1=Z.map(e,0,1,this._t1,this._t2),i.right._t2=Z.map(1,0,1,this._t1,this._t2),r?(r=Z.map(r,e,1,0,1),i.right.split(r).left):i}extrema(){const e={};let r=[];return this.dims.forEach(function(n){let i=function(u){return u[n]},a=this.dpoints[0].map(i);e[n]=Z.droots(a),this.order===3&&(a=this.dpoints[1].map(i),e[n]=e[n].concat(Z.droots(a))),e[n]=e[n].filter(function(u){return u>=0&&u<=1}),r=r.concat(e[n].sort(Z.numberSort))}.bind(this)),e.values=r.sort(Z.numberSort).filter(function(n,i){return r.indexOf(n)===i}),e}bbox(){const e=this.extrema(),r={};return this.dims.forEach(function(n){r[n]=Z.getminmax(this,n,e[n])}.bind(this)),r}overlaps(e){const r=this.bbox(),n=e.bbox();return Z.bboxoverlap(r,n)}offset(e,r){if(typeof r<"u"){const n=this.get(e),i=this.normal(e),a={c:n,n:i,x:n.x+i.x*r,y:n.y+i.y*r};return this._3d&&(a.z=n.z+i.z*r),a}if(this._linear){const n=this.normal(0),i=this.points.map(function(a){const u={x:a.x+e*n.x,y:a.y+e*n.y};return a.z&&n.z&&(u.z=a.z+e*n.z),u});return[new We(i)]}return this.reduce().map(function(n){return n._linear?n.offset(e)[0]:n.scale(e)})}simple(){if(this.order===3){const i=Z.angle(this.points[0],this.points[3],this.points[1]),a=Z.angle(this.points[0],this.points[3],this.points[2]);if(i>0&&a<0||i<0&&a>0)return!1}const e=this.normal(0),r=this.normal(1);let n=e.x*r.x+e.y*r.y;return this._3d&&(n+=e.z*r.z),Kn(gg(n))<pg/3}reduce(){let e,r=0,n=0,i=.01,a,u=[],o=[],s=this.extrema().values;for(s.indexOf(0)===-1&&(s=[0].concat(s)),s.indexOf(1)===-1&&s.push(1),r=s[0],e=1;e<s.length;e++)n=s[e],a=this.split(r,n),a._t1=r,a._t2=n,u.push(a),r=n;return u.forEach(function(c){for(r=0,n=0;n<=1;)for(n=r+i;n<=1+i;n+=i)if(a=c.split(r,n),!a.simple()){if(n-=i,Kn(r-n)<i)return[];a=c.split(r,n),a._t1=Z.map(r,0,1,c._t1,c._t2),a._t2=Z.map(n,0,1,c._t1,c._t2),o.push(a),r=n;break}r<1&&(a=c.split(r,1),a._t1=Z.map(r,0,1,c._t1,c._t2),a._t2=c._t2,o.push(a))}),o}translate(e,r,n){n=typeof n=="number"?n:r;const i=this.order;let a=this.points.map((u,o)=>(1-o/i)*r+o/i*n);return new We(this.points.map((u,o)=>({x:u.x+e.x*a[o],y:u.y+e.y*a[o]})))}scale(e){const r=this.order;let n=!1;if(typeof e=="function"&&(n=e),n&&r===2)return this.raise().scale(n);const i=this.clockwise,a=this.points;if(this._linear)return this.translate(this.normal(0),n?n(0):e,n?n(1):e);const u=n?n(0):e,o=n?n(1):e,s=[this.offset(0,10),this.offset(1,10)],c=[],l=Z.lli4(s[0],s[0].c,s[1],s[1].c);if(!l)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(f){const h=c[f*r]=Z.copy(a[f*r]);h.x+=(f?o:u)*s[f].n.x,h.y+=(f?o:u)*s[f].n.y}),n?([0,1].forEach(function(f){if(!(r===2&&!!f)){var h=a[f+1],g={x:h.x-l.x,y:h.y-l.y},C=n?n((f+1)/r):e;n&&!i&&(C=-C);var R=Jn(g.x*g.x+g.y*g.y);g.x/=R,g.y/=R,c[f+1]={x:h.x+C*g.x,y:h.y+C*g.y}}}),new We(c)):([0,1].forEach(f=>{if(r===2&&!!f)return;const h=c[f*r],g=this.derivative(f),C={x:h.x+g.x,y:h.y+g.y};c[f+1]=Z.lli4(h,C,l,a[f+1])}),new We(c))}outline(e,r,n,i){if(r=r===void 0?e:r,this._linear){const $=this.normal(0),_=this.points[0],I=this.points[this.points.length-1];let P,V,ue;n===void 0&&(n=e,i=r),P={x:_.x+$.x*e,y:_.y+$.y*e},ue={x:I.x+$.x*n,y:I.y+$.y*n},V={x:(P.x+ue.x)/2,y:(P.y+ue.y)/2};const ee=[P,V,ue];P={x:_.x-$.x*r,y:_.y-$.y*r},ue={x:I.x-$.x*i,y:I.y-$.y*i},V={x:(P.x+ue.x)/2,y:(P.y+ue.y)/2};const pe=[ue,V,P],be=Z.makeline(pe[2],ee[0]),T=Z.makeline(ee[2],pe[0]),q=[be,new We(ee),T,new We(pe)];return new zi(q)}const a=this.reduce(),u=a.length,o=[];let s=[],c,l=0,f=this.length();const h=typeof n<"u"&&typeof i<"u";function g($,_,I,P,V){return function(ue){const ee=P/I,pe=(P+V)/I,be=_-$;return Z.map(ue,0,1,$+ee*be,$+pe*be)}}a.forEach(function($){const _=$.length();h?(o.push($.scale(g(e,n,f,l,_))),s.push($.scale(g(-r,-i,f,l,_)))):(o.push($.scale(e)),s.push($.scale(-r))),l+=_}),s=s.map(function($){return c=$.points,c[3]?$.points=[c[3],c[2],c[1],c[0]]:$.points=[c[2],c[1],c[0]],$}).reverse();const C=o[0].points[0],R=o[u-1].points[o[u-1].points.length-1],k=s[u-1].points[s[u-1].points.length-1],z=s[0].points[0],A=Z.makeline(k,C),S=Z.makeline(R,z),O=[A].concat(o).concat([S]).concat(s);return new zi(O)}outlineshapes(e,r,n){r=r||e;const i=this.outline(e,r).curves,a=[];for(let u=1,o=i.length;u<o/2;u++){const s=Z.makeshape(i[u],i[o-u],n);s.startcap.virtual=u>1,s.endcap.virtual=u<o/2-1,a.push(s)}return a}intersects(e,r){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof We&&(e=e.reduce()),this.curveintersects(this.reduce(),e,r)):this.selfintersects(r)}lineIntersects(e){const r=Is(e.p1.x,e.p2.x),n=Is(e.p1.y,e.p2.y),i=Rs(e.p1.x,e.p2.x),a=Rs(e.p1.y,e.p2.y);return Z.roots(this.points,e).filter(u=>{var o=this.get(u);return Z.between(o.x,r,i)&&Z.between(o.y,n,a)})}selfintersects(e){const r=this.reduce(),n=r.length-2,i=[];for(let a=0,u,o,s;a<n;a++)o=r.slice(a,a+1),s=r.slice(a+2),u=this.curveintersects(o,s,e),i.push(...u);return i}curveintersects(e,r,n){const i=[];e.forEach(function(u){r.forEach(function(o){u.overlaps(o)&&i.push({left:u,right:o})})});let a=[];return i.forEach(function(u){const o=Z.pairiteration(u.left,u.right,n);o.length>0&&(a=a.concat(o))}),a}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,r,n,i){const a=(i-n)/4,u=this.get(n+a),o=this.get(i-a),s=Z.dist(e,r),c=Z.dist(e,u),l=Z.dist(e,o);return Kn(c-s)+Kn(l-s)}_iterate(e,r){let n=0,i=1,a;do{a=0,i=1;let u=this.get(n),o,s,c,l,f=!1,h=!1,g,C=i,R=1;do if(h=f,l=c,C=(n+i)/2,o=this.get(C),s=this.get(i),c=Z.getccenter(u,o,s),c.interval={start:n,end:i},f=this._error(c,u,n,i)<=e,g=h&&!f,g||(R=i),f){if(i>=1){if(c.interval.end=R=1,l=c,i>1){let z={x:c.x+c.r*yg(c.e),y:c.y+c.r*mg(c.e)};c.e+=Z.angle({x:c.x,y:c.y},z,this.get(1))}break}i=i+(i-n)/2}else i=C;while(!g&&a++<100);if(a>=100)break;l=l||c,r.push(l),n=R}while(i<1);return r}},ga=e=>e.quadratic!==void 0,go=e=>e.cubic1!==void 0&&e.cubic2!==void 0,wg=(e,r,n=0)=>Fn(e,r,n),Fn=(e,r,n=0)=>{if(isNaN(n))throw Error("bend is NaN");if(n<-1||n>1)throw Error("Expects bend range of -1 to 1");const i=it.interpolate(.5,e,r);let a=i;r.y<e.y?a=n>0?{x:Math.min(e.x,r.x),y:Math.min(e.y,r.y)}:{x:Math.max(e.x,r.x),y:Math.max(e.y,r.y)}:a=n>0?{x:Math.max(e.x,r.x),y:Math.min(e.y,r.y)}:{x:Math.min(e.x,r.x),y:Math.max(e.y,r.y)};const u=it.interpolate(Math.abs(n),i,a);return ff(e,r,u)},Dg=(e,r,n,i)=>{const a=Fn(e,r,n);return new We(a.a,a.quadratic,a.b).compute(i)},lf=(e,r,n)=>[`M ${e.x} ${e.y} Q ${n.x} ${n.y} ${r.x} ${r.y}`],Wi=e=>{if(go(e))return bg(e);if(ga(e))return Ag(e);throw new Error("Unknown bezier type")},Eg=(e,r,n,i)=>({a:Object.freeze(e),b:Object.freeze(r),cubic1:Object.freeze(n),cubic2:Object.freeze(i)}),bg=e=>{const{a:r,cubic1:n,cubic2:i,b:a}=e,u=new We(r,n,i,a);return Object.freeze({...e,length:()=>u.length(),interpolate:o=>u.compute(o),nearest:o=>{throw new Error("not implemented")},bbox:()=>{const{x:o,y:s}=u.bbox(),c=o.size,l=s.size;if(c===void 0)throw new Error("x.size not present on calculated bbox");if(l===void 0)throw new Error("x.size not present on calculated bbox");return Ie.fromTopLeft({x:o.min,y:s.min},c,l)},toString:()=>u.toString(),toSvgString:()=>["brrup"],kind:"bezier/cubic"})},ff=(e,r,n)=>({a:Object.freeze(e),b:Object.freeze(r),quadratic:Object.freeze(n)}),Ag=e=>{const{a:r,b:n,quadratic:i}=e,a=new We(r,i,n);return Object.freeze({...e,length:()=>a.length(),interpolate:u=>a.compute(u),nearest:u=>{throw new Error("not implemented")},bbox:()=>{const{x:u,y:o}=a.bbox(),s=u.size,c=o.size;if(s===void 0)throw new Error("x.size not present on calculated bbox");if(c===void 0)throw new Error("x.size not present on calculated bbox");return Ie.fromTopLeft({x:u.min,y:o.min},s,c)},toString:()=>a.toString(),toSvgString:()=>lf(r,n,i),kind:"bezier/quadratic"})},br={};ie(br,{area:()=>Fg,bbox:()=>gf,center:()=>Cg,circumference:()=>mf,distanceCenter:()=>wo,distanceFromExterior:()=>Ig,interpolate:()=>vf,intersectionLine:()=>Bg,intersections:()=>wf,isCircle:()=>pi,isCirclePositioned:()=>po,isContainedBy:()=>pf,isEqual:()=>Df,isIntersecting:()=>_g,isNaN:()=>Sg,isPositioned:()=>Bt,length:()=>yf,multiplyScalar:()=>Mg,nearest:()=>bf,point:()=>df,toPath:()=>Rg,toSvg:()=>Ef});var hf=Math.PI*2,Bt=e=>e.x!==void 0&&e.y!==void 0,pi=e=>e.radius!==void 0,po=e=>pi(e)&&Bt(e),df=(e,r,n)=>(n===void 0&&(Bt(e)?n=e:n={x:0,y:0}),{x:Math.cos(-r)*e.radius+n.x,y:Math.sin(-r)*e.radius+n.y}),pa=(e,r="circle")=>{if(Bt(e)&&_e(e,"circle"),Number.isNaN(e.radius))throw new Error(`${r}.radius is NaN`);if(e.radius<=0)throw new Error(`${r}.radius must be greater than zero`)},Au=(e,r="circle")=>{if(!Bt(e))throw new Error("Expected a positioned circle with x,y");return pa(e,r)},Cg=e=>Bt(e)?Object.freeze({x:e.x,y:e.y}):Object.freeze({x:e.radius,y:e.radius}),vf=(e,r)=>df(e,r*hf),yf=e=>mf(e),mf=e=>(pa(e),hf*e.radius),Fg=e=>(pa(e),Math.PI*e.radius*e.radius),gf=e=>Bt(e)?Ie.fromCenter(e,e.radius*2,e.radius*2):{width:e.radius*2,height:e.radius*2},pf=(e,r)=>{const n=wo(e,r);return pi(r)?n<Math.abs(e.radius-r.radius):n<=e.radius},Sg=e=>!!(Number.isNaN(e.radius)||Bt(e)&&(Number.isNaN(e.x)||Number.isNaN(e.y))),_g=(e,r)=>U.isEqual(e,r)||pf(e,r)?!0:pi(r)?wf(e,r).length===2:!1,wf=(e,r)=>{const n=U.subtract(r,e),i=Math.sqrt(n.y*n.y+n.x*n.x);if(i>e.radius+r.radius)return[];if(i<Math.abs(e.radius-r.radius))return[];if(Df(e,r))return[];const a=(e.radius*e.radius-r.radius*r.radius+i*i)/(2*i),u={x:e.x+n.x*a/i,y:e.y+n.y*a/i},o=Math.sqrt(e.radius*e.radius-a*a),s={x:-n.y*(o/i),y:n.x*(o/i)};return[U.sum(u,s),U.subtract(u,s)]},Df=(e,r)=>e.radius!==r.radius?!1:Bt(e)&&Bt(r)?!(e.x!==r.x||e.y!==r.y||e.z!==r.z):(!Bt(e)&&!Bt(r),!1);function Mg(e,r){if(Bt(e)){const n=U.multiplyScalar(e,r);return Object.freeze({...e,...n,radius:e.radius*r})}else return Object.freeze({...e,radius:e.radius*r})}var wo=(e,r)=>(Au(e,"a"),po(r)&&Au(r,"b"),U.distance(e,r)),Ig=(e,r)=>{if(Au(e,"a"),po(r))return Math.max(0,wo(e,r)-e.radius-r.radius);if(U.isPoint(r)){const n=U.distance(e,r);return n<e.radius?0:n}else throw new Error("Second parameter invalid type")},Ef=(e,r,n)=>{if(pi(e)){if(n!==void 0)return Xa(e.radius,n,r);if(Bt(e))return Xa(e.radius,e,r);throw new Error("origin parameter needed for non-positioned circle")}else{if(n!==void 0)return Xa(e,n,r);throw new Error("origin parameter needed")}},Xa=(e,r,n)=>{const{x:i,y:a}=r,u=n?"1":"0";return`
    M ${i}, ${a}
    m -${e}, 0
    a ${e},${e} 0 1,${u} ${e*2},0
    a ${e},${e} 0 1,${u} -${e*2},0
  `.split(`
`)},bf=(e,r)=>{const n=i=>{const a=Math.sqrt(Math.pow(r.x-i.x,2)+Math.pow(r.y-i.y,2)),u=i.x+i.radius*((r.x-i.x)/a),o=i.y+i.radius*((r.y-i.y)/a);return{x:u,y:o}};if(Array.isArray(e)){const i=e.map(u=>n(u)),a=i.map(u=>U.distance(u,r));return Object.freeze(i[$t.minIndex(...a)])}else return Object.freeze(n(e))},Rg=e=>(pa(e),Object.freeze({...e,nearest:r=>bf(e,r),interpolate:r=>vf(e,r),bbox:()=>gf(e),length:()=>yf(e),toSvgString:(r=!0)=>Ef(e,r),kind:"circular"})),Bg=(e,r)=>{const n={x:r.b.x-r.a.x,y:r.b.y-r.a.y},i={x:r.a.x-e.x,y:r.a.y-e.y},a=(n.x*i.x+n.y*i.y)*-2,u=2*(n.x*n.x+n.y*n.y),o=Math.sqrt(a*a-2*u*(i.x*i.x+i.y*i.y-e.radius*e.radius));if(Number.isNaN(o))return[];const s=(a-o)/u,c=(a+o)/u,l=[];return s<=1&&s>=0&&l.push({x:r.a.x+n.x*s,y:r.a.y+n.y*s}),c<=1&&c>=0&&l.push({x:r.a.x+n.x*c,y:r.a.y+n.y*c}),l},Do={};ie(Do,{bbox:()=>Cf,computeDimensions:()=>Eo,fromPaths:()=>Mf,guardContinuous:()=>Sf,interpolate:()=>Af,setSegment:()=>Pg,toString:()=>Ff,toSvgString:()=>_f});var Pg=(e,r,n)=>{const i=[...e.segments];return i[r]=n,Mf(...i)},Af=(e,r,n,i)=>{i===void 0&&(i=Eo(e));const a=r*(n?i.totalWidth:i.totalLength);let u=0;const o=n?i.widths:i.lengths;for(let s=0;s<o.length;s++)if(u+o[s]>=a){let l=(a-u)/o[s];return l>1&&(l=1),e[s].interpolate(l)}else u+=o[s];return{x:0,y:0}},Eo=e=>{const r=e.map(u=>u.bbox().width),n=e.map(u=>u.length());let i=0,a=0;for(let u=0;u<n.length;u++)i+=n[u];for(let u=0;u<r.length;u++)a+=r[u];return{totalLength:i,totalWidth:a,widths:r,lengths:n}},Cf=e=>{const n=e.map(i=>i.bbox()).map(i=>Ie.corners(i)).flat();return U.bbox(...n)},Ff=e=>e.map(r=>r.toString()).join(", "),Sf=e=>{let r=Sn.getEnd(e[0]);for(let n=1;n<e.length;n++){const i=Sn.getStart(e[n]);if(!U.isEqual(i,r))throw new Error("Path index "+n+" does not start at prior path end. Start: "+i.x+","+i.y+" expected: "+r.x+","+r.y);r=Sn.getEnd(e[n])}},_f=e=>e.flatMap(r=>r.toSvgString()),Mf=(...e)=>{Sf(e);const r=Eo(e);return Object.freeze({segments:e,length:()=>r.totalLength,nearest:n=>{throw new Error("not implemented")},interpolate:(n,i=!1)=>Af(e,n,i,r),bbox:()=>Cf(e),toString:()=>Ff(e),toSvgString:()=>_f(e),kind:"compound"})},bo={};ie(bo,{allDirections:()=>Ao,cellAtPoint:()=>kg,cellEquals:()=>Rf,cellKeyString:()=>If,cellMiddle:()=>Lg,cells:()=>So,crossDirections:()=>Pf,getLine:()=>$g,getVectorFromCardinal:()=>Co,guardCell:()=>cr,inside:()=>Bf,isEqual:()=>Wg,neighbours:()=>Nf,offset:()=>Fo,offsetCardinals:()=>Tg,rectangleForCell:()=>Og,rows:()=>xg,simpleLine:()=>qg,visitFor:()=>Jg,visitor:()=>fn,visitorBreadth:()=>Vg,visitorColumn:()=>Yg,visitorDepth:()=>Ug,visitorRandom:()=>Gg,visitorRandomContiguous:()=>Hg,visitorRow:()=>Kg});var Ng=e=>e===void 0?!1:"x"in e&&"y"in e,zg=e=>!(e===void 0||e[1]===void 0),Wg=(e,r)=>{if("rows"in e&&"cols"in e)if("rows"in r&&"cols"in r){if(e.rows!==r.rows||e.cols!==r.cols)return!1}else return!1;if("size"in e)if("size"in r){if(e.size!==r.size)return!1}else return!1;return!0},If=e=>`Cell{${e.x},${e.y}}`,Rf=(e,r)=>r===void 0||e===void 0?!1:e.x===r.x&&e.y===r.y,cr=(e,r="Param",n)=>{if(e===void 0)throw new Error(r+" is undefined. Expecting {x,y}");if(e.x===void 0)throw new Error(r+".x is undefined");if(e.y===void 0)throw new Error(r+".y is undefined");if(!Number.isInteger(e.x))throw new Error(r+".x is non-integer");if(!Number.isInteger(e.y))throw new Error(r+".y is non-integer");if(n!==void 0&&!Bf(n,e))throw new Error(`${r} is outside of grid. Cell: ${e.x},${e.y} Grid: ${n.cols}, ${n.rows}`)},wa=(e,r="Param")=>{if(e===void 0)throw new Error(`${r} is undefined. Expecting grid.`);if(!("rows"in e))throw new Error(`${r}.rows is undefined`);if(!("cols"in e))throw new Error(`${r}.cols is undefined`);if(!Number.isInteger(e.rows))throw new Error(`${r}.rows is not an integer`);if(!Number.isInteger(e.cols))throw new Error(`${r}.cols is not an integer`)},Bf=(e,r)=>!(r.x<0||r.y<0||r.x>=e.cols||r.y>=e.rows),Og=(e,r)=>{cr(e);const n=r.size,i=e.x*n,a=e.y*n;return Ie.fromTopLeft({x:i,y:a},n,n)},kg=(e,r)=>{const n=r.size;if(e.x<0||e.y<0)return;const i=Math.floor(e.x/n),a=Math.floor(e.y/n);if(!(i>=r.cols)&&!(a>=r.rows))return{x:i,y:a}},Ao=Object.freeze(["n","ne","nw","e","s","se","sw","w"]),Pf=Object.freeze(["n","e","s","w"]),Nf=(e,r,n="undefined",i)=>{const a=i??Ao,u=a.map(o=>Fo(e,r,Co(o),n));return Qu(a,u)},Lg=(e,r)=>{cr(e);const n=r.size,i=e.x*n,a=e.y*n;return Object.freeze({x:i+n/2,y:a+n/2})},$g=(e,r)=>{cr(e),cr(r);let n=e.x,i=e.y;const a=Math.abs(r.x-n),u=Math.abs(r.y-i),o=n<r.x?1:-1,s=i<r.y?1:-1;let c=a-u;const l=[];for(;l.push(Object.freeze({x:n,y:i})),!(n===r.x&&i===r.y);){const f=2*c;f>-u&&(c-=u,n+=o),f<a&&(c+=a,i+=s)}return l},Tg=(e,r,n,i="stop")=>{wa(e,"grid"),cr(r,"start"),ke(n,"aboveZero","steps");const a=Ao,u=a.map(s=>Co(s,n)),o=a.map((s,c)=>Fo(e,r,u[c],i));return Qu(a,o)},Co=(e,r=1)=>{let n;switch(e){case"n":n={x:0,y:-1*r};break;case"ne":n={x:1*r,y:-1*r};break;case"e":n={x:1*r,y:0};break;case"se":n={x:1*r,y:1*r};break;case"s":n={x:0,y:1*r};break;case"sw":n={x:-1*r,y:1*r};break;case"w":n={x:-1*r,y:0};break;case"nw":n={x:-1*r,y:-1*r};break;default:n={x:0,y:0}}return Object.freeze(n)},qg=function(e,r,n=!1){const i=[];if(e.x===r.x){const a=n?r.y+1:r.y;for(let u=e.y;u<a;u++)i.push({x:e.x,y:u})}else if(e.y===r.y){const a=n?r.x+1:r.x;for(let u=e.x;u<a;u++)i.push({x:u,y:e.y})}else throw new Error(`Only does vertical and horizontal: ${e.x},${e.y} - ${r.x},${r.y}`);return i},Fo=function(e,r,n,i="undefined"){cr(r,"start",e),cr(n),wa(e,"grid");let a=r.x,u=r.y;switch(i){case"wrap":a+=n.x%e.cols,u+=n.y%e.rows,a<0?a=e.cols+a:a>=e.cols&&(a-=e.cols),u<0?u=e.rows+u:u>=e.rows&&(u-=e.rows);break;case"stop":a+=n.x,u+=n.y,a=au(a,e.cols),u=au(u,e.rows);break;case"undefined":if(a+=n.x,u+=n.y,a<0||u<0||a>=e.cols||u>=e.rows)return;break;case"unbounded":a+=n.x,u+=n.y;break;default:throw new Error(`Unknown BoundsLogic case ${i}`)}return Object.freeze({x:a,y:u})},jg=(e,r,n,i)=>{const a=Nf(e,r,i,n);return Object.entries(a).filter(zg)},fn=function*(e,r,n,i={}){wa(r,"grid"),cr(n,"start",r);const a=i.visited??Lu(l=>If(l)),u=e.options?e.options:(l,f)=>jg(l,f,Pf,"undefined");if(!Ng(n))throw new Error("'start' parameter is undefined or not a cell");let o=[n],s=[],c=null;for(;o.length>0;){if(c===null){const l=o.pop();if(l===void 0)break;c=l}if(!a.has(c)){a.add(c),yield c;const l=u(r,c).filter(f=>!a.has(f[1]));l.length===0?c!==null&&(o=o.filter(f=>Rf(f,c))):s.push(...l)}if(s=s.filter(l=>!a.has(l[1])),s.length===0)c=null;else{const l=e.select(s);l!==void 0&&(o.push(l[1]),c=l[1])}}},Ug=(e,r,n={})=>fn({select:i=>i[i.length-1]},e,r,n),Vg=(e,r,n={})=>fn({select:i=>i[0]},e,r,n),zf=e=>ds(e),Hg=(e,r,n={})=>fn({select:zf},e,r,n),Gg=(e,r,n={})=>fn({options:(i,a)=>{const u=[];for(const o of So(i,a))u.push(["n",o]);return u},select:zf},e,r,n),Kg=(e,r,n={})=>{const{reversed:i=!1}=n;return fn({select:s=>s.find(c=>c[0]===(i?"w":"e")),options:(s,c)=>(i?c.x>0?c={x:c.x-1,y:c.y}:c.y>0?c={x:s.cols-1,y:c.y-1}:c={x:s.cols-1,y:s.rows-1}:c.x<s.rows-1?c={x:c.x+1,y:c.y}:c.y<s.rows-1?c={x:0,y:c.y+1}:c={x:0,y:0},[[i?"w":"e",c]])},e,r,n)},Jg=(e,r,n,i)=>{ke(n,"","steps");const a={reversed:n<0};n=Math.abs(n);let u=r,o=i(e,r,a);o.next();let s=0;for(;s<n;){s++;const{value:c}=o.next();if(c)u=c,a.debug&&console.log(`stepsMade: ${s} cell: ${u.x}, ${u.y} reverse: ${a.reversed}`);else if(n>=e.cols*e.rows)n-=e.cols*e.rows,s=0,o=i(e,r,a),o.next(),u=r,a.debug&&console.log(`resetting visitor to ${n}`);else throw new Error("Value not received by visitor")}return u},Yg=(e,r,n={})=>{const{reversed:i=!1}=n;return fn({select:u=>u.find(o=>o[0]===(i?"n":"s")),options:(u,o)=>(i?o.y>0?o={x:o.x,y:o.y-1}:o.x===0?o={x:u.cols-1,y:u.rows-1}:o={x:o.x-1,y:u.rows-1}:o.y<u.rows-1?o={x:o.x,y:o.y+1}:o.x<u.cols-1?o={x:o.x+1,y:0}:o={x:0,y:0},[[i?"n":"s",o]])},e,r,n)},xg=function*(e,r={x:0,y:0}){let n=r.y,i=[];for(const a of So(e,r))a.y!==n?(yield i,i=[a],n=a.y):i.push(a);i.length>0&&(yield i)},So=function*(e,r={x:0,y:0}){wa(e,"grid"),cr(r,"start",e);let{x:n,y:i}=r,a=!0;do yield{x:n,y:i},n++,n===e.cols&&(i++,n=0),i===e.rows&&(i=0,n=0),n===r.x&&i===r.y&&(a=!1);while(a)},Sn={};ie(Sn,{getEnd:()=>Xg,getStart:()=>Zg});var Zg=function(e){if(gi.isQuadraticBezier(e))return e.a;if(it.isLine(e))return e.a;throw new Error(`Unknown path type ${JSON.stringify(e)}`)},Xg=function(e){if(gi.isQuadraticBezier(e))return e.b;if(it.isLine(e))return e.b;throw new Error(`Unknown path type ${JSON.stringify(e)}`)},Ie={};ie(Ie,{area:()=>gp,center:()=>Lf,corners:()=>Mo,distanceFromCenter:()=>cp,distanceFromExterior:()=>sp,edges:()=>$f,empty:()=>Qg,emptyPositioned:()=>Wf,fromCenter:()=>op,fromElement:()=>tp,fromNumbers:()=>np,fromTopLeft:()=>fp,getEdgeX:()=>Su,getEdgeY:()=>_u,guard:()=>hr,intersectsPoint:()=>xi,isEmpty:()=>ep,isEqual:()=>Of,isEqualSize:()=>rp,isPlaceholder:()=>ci,isPositioned:()=>Lt,isRect:()=>zr,isRectPositioned:()=>Fu,lengths:()=>yp,maxFromCorners:()=>lp,multiply:()=>dp,multiplyScalar:()=>vp,normaliseByRect:()=>hp,perimeter:()=>mp,placeholder:()=>_o,placeholderPositioned:()=>Cu,random:()=>pp,subtract:()=>ap,sum:()=>up,toArray:()=>ip});var Qg=Object.freeze({width:0,height:0}),Wf=Object.freeze({x:0,y:0,width:0,height:0}),_o=Object.freeze({width:Number.NaN,height:Number.NaN}),Cu=Object.freeze({x:Number.NaN,y:Number.NaN,width:Number.NaN,height:Number.NaN}),ep=e=>e.width===0&&e.height===0,ci=e=>Number.isNaN(e.width)&&Number.isNaN(e.height),Lt=e=>e.x!==void 0&&e.y!==void 0,zr=e=>!(e===void 0||e.width===void 0||e.height===void 0),Fu=e=>zr(e)&&Lt(e),tp=e=>({width:e.clientWidth,height:e.clientHeight}),rp=(e,r)=>{if(e===void 0)throw new Error("a undefined");if(r===void 0)throw new Error("b undefined");return e.width===r.width&&e.height===r.height};function np(e,r,n,i){if(n===void 0||i===void 0){if(typeof e!="number")throw new Error("width is not an number");if(typeof r!="number")throw new Error("height is not an number");return Object.freeze({width:e,height:r})}if(typeof e!="number")throw new Error("x is not an number");if(typeof r!="number")throw new Error("y is not an number");if(typeof n!="number")throw new Error("width is not an number");if(typeof i!="number")throw new Error("height is not an number");return Object.freeze({x:e,y:r,width:n,height:i})}function ip(e){if(Lt(e))return[e.x,e.y,e.width,e.height];if(zr(e))return[e.width,e.height];throw new Error(`rect param is not a rectangle. Got: ${JSON.stringify(e)}`)}var Of=(e,r)=>Lt(e)&&Lt(r)?U.isEqual(e,r)?e.width===r.width&&e.height===r.height:!1:!Lt(e)&&!Lt(r)?e.width===r.width&&e.height===r.height:!1;function ap(e,r,n){if(e===void 0)throw new Error("First parameter undefined");if(typeof r=="number"){const i=n===void 0?0:n;return Object.freeze({...e,width:e.width-r,height:e.height-i})}else return Object.freeze({...e,width:e.width-r.width,height:e.height-r.height})}function up(e,r,n){if(e===void 0)throw new Error("First parameter undefined");if(typeof r=="number"){const i=n===void 0?0:n;return Object.freeze({...e,width:e.width+r,height:e.height+i})}else return Object.freeze({...e,width:e.width+r.width,height:e.height+r.height})}function xi(e,r,n){hr(e,"rect");let i=0,a=0;if(typeof r=="number"){if(n===void 0)throw new Error("x and y coordinate needed");i=r,a=n}else i=r.x,a=r.y;if(Lt(e)){if(i-e.x>e.width||i<e.x||a-e.y>e.height||a<e.y)return!1}else if(i>e.width||i<0||a>e.height||a<0)return!1;return!0}var op=(e,r,n)=>{U.guard(e,"origin"),Wn(r,"width"),Wn(n,"height");const i=r/2,a=n/2;return{x:e.x-i,y:e.y-a,width:r,height:n}},sp=(e,r)=>{if(kf(e,"rect"),U.guard(r,"pt"),xi(e,r))return 0;const n=Math.max(e.x-r.x,0,r.x-e.x+e.width),i=Math.max(e.y-r.y,0,r.y-e.y+e.height);return Math.sqrt(n*n+i*i)},cp=(e,r)=>U.distance(Lf(e),r),lp=(e,r,n,i)=>{if(e.y>n.y)throw new Error("topLeft.y greater than bottomRight.y");if(e.y>i.y)throw new Error("topLeft.y greater than bottomLeft.y");const a=r.x-e.x,u=n.x-i.x,o=Math.abs(i.y-e.y),s=Math.abs(n.y-r.y);return{x:Math.min(e.x,i.x),y:Math.min(r.y,e.y),width:Math.max(a,u),height:Math.max(o,s)}},Wn=(e,r="Dimension")=>{if(e===void 0)throw Error(`${r} is undefined`);if(isNaN(e))throw Error(`${r} is NaN`);if(e<0)throw Error(`${r} cannot be negative`)},hr=(e,r="rect")=>{if(e===void 0)throw Error("{$name} undefined");Lt(e)&&U.guard(e,r),Wn(e.width,r+".width"),Wn(e.height,r+".height")},kf=(e,r="rect")=>{if(!Lt(e))throw new Error(`Expected ${r} to have x,y`);hr(e,r)},fp=(e,r,n)=>(Wn(r,"width"),Wn(n,"height"),U.guard(e,"origin"),{x:e.x,y:e.y,width:r,height:n}),Mo=(e,r)=>{if(hr(e),r===void 0&&U.isPoint(e))r=e;else if(r===void 0)throw new Error("Unpositioned rect needs origin param");return[{x:r.x,y:r.y},{x:r.x+e.width,y:r.y},{x:r.x+e.width,y:r.y+e.height},{x:r.x,y:r.y+e.height}]},Su=(e,r)=>{switch(hr(e),r){case"top":return U.isPoint(e)?e.x:0;case"bottom":return U.isPoint(e)?e.x:0;case"left":return U.isPoint(e)?e.y:0;case"right":return U.isPoint(e)?e.x+e.width:e.width}},_u=(e,r)=>{switch(hr(e),r){case"top":return U.isPoint(e)?e.y:0;case"bottom":return U.isPoint(e)?e.y+e.height:e.height;case"left":return U.isPoint(e)?e.y:0;case"right":return U.isPoint(e)?e.y:0}},hp=(e,r,n)=>{let i;if(n===void 0)if(zr(r))n=r.height,i=r.width;else throw new Error("Expects rectangle or width and height parameters for normaliseBy");else if(typeof r=="number")i=r;else throw new Error("Expects rectangle or width and height parameters for normaliseBy");return Lt(e)?Object.freeze({x:e.x/i,y:e.y/n,width:e.width/i,height:e.height/n}):Object.freeze({width:e.width/i,height:e.height/n})};function dp(e,r,n){if(hr(e,"a"),zr(r))return Fu(e)?Object.freeze({...e,x:e.x*r.width,y:e.y*r.height,width:e.width*r.width,height:e.height*r.height}):Object.freeze({...e,width:e.width*r.width,height:e.height*r.height});if(typeof r!="number")throw new Error(`Expected second parameter of type Rect or number. Got ${JSON.stringify(r)}`);return n===void 0&&(n=r),Fu(e)?Object.freeze({...e,x:e.x*r,y:e.y*n,width:e.width*r,height:e.height*n}):Object.freeze({...e,width:e.width*r,height:e.height*n})}function vp(e,r){return Lt(e)?Object.freeze({...e,x:e.x*r,y:e.y*r,width:e.width*r,height:e.height*r}):Object.freeze({...e,width:e.width*r,height:e.height*r})}var Lf=(e,r)=>(hr(e),r===void 0&&U.isPoint(e)?r=e:r===void 0&&(r={x:0,y:0}),Object.freeze({x:r.x+e.width/2,y:r.y+e.height/2})),yp=e=>(kf(e,"rect"),$f(e).map(r=>it.length(r))),$f=(e,r)=>{const n=Mo(e,r);return it.joinPointsToLines(...n,n[0])},mp=e=>(hr(e),e.height+e.height+e.width+e.width),gp=e=>(hr(e),e.height*e.width),pp=e=>(e===void 0&&(e=Zt),Object.freeze({x:e(),y:e(),width:e(),height:e()})),Io={};ie(Io,{fromDegrees:()=>wp});var wp=(e,r,n=0,i=0,a=360)=>({radiusX:e,radiusY:r,rotation:Wr(n),startAngle:Wr(i),endAngle:Wr(a)}),dt={};ie(dt,{clampMagnitude:()=>zp,divide:()=>Np,dotProduct:()=>Fp,fromCartesian:()=>Ep,guard:()=>Tt,invert:()=>Sp,isAntiParallel:()=>Ip,isCoord:()=>Tf,isOpposite:()=>_p,isParallel:()=>Mp,multiply:()=>Pp,normalise:()=>Cp,rotate:()=>Ap,rotateDegrees:()=>Rp,spiral:()=>bp,spiralRaw:()=>Bp,toCartesian:()=>Oi,toPoint:()=>Op,toString:()=>Wp});var Dp=Object.freeze({x:0,y:0}),Tf=e=>!(e.distance===void 0||e.angleRadian===void 0),Ep=(e,r)=>{e=ln(e,r);const n=Math.atan2(e.y,e.x);return Object.freeze({...e,angleRadian:n,distance:Math.sqrt(e.x*e.x+e.y*e.y)})},Oi=(e,r,n)=>{if(Tf(e)){if(r===void 0&&(r=Nn),Le(r))return Bs(e.distance,e.angleRadian,r);throw new Error("Expecting (Coord, Point). Second parameter is not a point")}else if(typeof e=="number"&&typeof r=="number"){if(n===void 0&&(n=Nn),!Le(n))throw new Error("Expecting (number, number, Point). Point param wrong type");return Bs(e,r,n)}else throw new Error(`Expecting parameters of (number, number). Got: (${typeof e}, ${typeof r}, ${typeof n}). a: ${JSON.stringify(e)}`)};function*bp(e,r){let n=0;for(;;){const i=e*n++;yield{distance:r*i,angleRadian:i,step:n}}}var Ap=(e,r)=>Object.freeze({...e,angleRadian:e.angleRadian+r}),Cp=e=>{if(e.distance===0)throw new Error("Cannot normalise vector of length 0");return Object.freeze({...e,distance:1})},Tt=(e,r="Point")=>{if(e===void 0)throw new Error(`'${r}' is undefined. Expected {distance, angleRadian} got ${JSON.stringify(e)}`);if(e===null)throw new Error(`'${r}' is null. Expected {distance, angleRadian} got ${JSON.stringify(e)}`);if(e.angleRadian===void 0)throw new Error(`'${r}.angleRadian' is undefined. Expected {distance, angleRadian} got ${JSON.stringify(e)}`);if(e.distance===void 0)throw new Error(`'${r}.distance' is undefined. Expected {distance, angleRadian} got ${JSON.stringify(e)}`);if(typeof e.angleRadian!="number")throw new Error(`'${r}.angleRadian' must be a number. Got ${e.angleRadian}`);if(typeof e.distance!="number")throw new Error(`'${r}.distance' must be a number. Got ${e.distance}`);if(e.angleRadian===null)throw new Error(`'${r}.angleRadian' is null`);if(e.distance===null)throw new Error(`'${r}.distance' is null`);if(Number.isNaN(e.angleRadian))throw new Error(`'${r}.angleRadian' is NaN`);if(Number.isNaN(e.distance))throw new Error(`'${r}.distance' is NaN`)},Fp=(e,r)=>(Tt(e,"a"),Tt(r,"b"),e.distance*r.distance*Math.cos(r.angleRadian-e.angleRadian)),Sp=e=>(Tt(e,"c"),Object.freeze({...e,angleRadian:e.angleRadian-Math.PI})),_p=(e,r)=>(Tt(e,"a"),Tt(r,"b"),e.distance!==r.distance?!1:e.angleRadian===-r.angleRadian),Mp=(e,r)=>(Tt(e,"a"),Tt(r,"b"),e.angleRadian===r.angleRadian),Ip=(e,r)=>(Tt(e,"a"),Tt(r,"b"),e.angleRadian===-r.angleRadian),Rp=(e,r)=>Object.freeze({...e,angleRadian:e.angleRadian+Wr(r)}),Bp=(e,r,n)=>{const i=r*e;return Object.freeze({distance:n*i,angleRadian:i})},Pp=(e,r)=>(Tt(e),ae(r,"","amt"),Object.freeze({...e,distance:e.distance*r})),Np=(e,r)=>(Tt(e),ae(r,"","amt"),Object.freeze({...e,distance:e.distance/r})),zp=(e,r=1,n=0)=>{let i=e.distance;return i>r&&(i=r),i<n&&(i=n),Object.freeze({...e,distance:i})},Bs=(e,r,n=Nn)=>(_e(n),Object.freeze({x:n.x+e*Math.cos(r),y:n.y+e*Math.sin(r)})),Wp=(e,r)=>{if(e===void 0)return"(undefined)";if(e===null)return"(null)";const n=Fa(e.angleRadian),i=r?e.distance.toFixed(r):e.distance,a=r?n.toFixed(r):n;return`(${i},${a})`},Op=(e,r=Dp)=>(Tt(e,"v"),Object.freeze({x:r.x+e.distance*Math.cos(e.angleRadian),y:r.y+e.distance*Math.sin(e.angleRadian)})),Ro={};ie(Ro,{arrow:()=>$p,center:()=>kp,starburst:()=>Lp});var kp=e=>{if(e===void 0)return Object.freeze({x:.5,y:.5});if(Ie.isRect(e))return Ie.center(e);if(Qr.isTriangle(e))return Qr.centroid(e);if(br.isCircle(e))return br.center(e);throw new Error(`Unknown shape: ${JSON.stringify(e)}`)},Lp=(e,r=5,n,i={x:0,y:0},a)=>{ke(r,"positive","points");const u=Math.PI*2/r,o=u/2,s=a?.initialAngleRadian??-Math.PI/2;n===void 0&&(n=e/2);let c=s;const l=[];for(let f=0;f<r;f++){const h=Oi(e,c,i),g=Oi(n,c-o,i),C=Oi(n,c+o,i);l.push(g,h),f+1<r&&l.push(C),c+=u}return l},$p=(e,r,n={})=>{const i=n.tailLength??10,a=n.tailThickness??Math.max(i/5,5),u=n.angleRadian??0,o=n.arrowSize??Math.max(i/5,15),s=Math.PI/2;let c,l;if(r==="tip")c=Qr.equilateralFromVertex(e,o,s),l=Ie.corners(Ie.fromTopLeft({x:c.a.x-i,y:e.y-a/2},i,a));else if(r==="middle"){const h=i+o/2,g=a/2;c=Qr.equilateralFromVertex({x:e.x+o*1.2,y:e.y},o,s),l=Ie.corners(Ie.fromTopLeft({x:e.x-h,y:e.y-g},i+o,a))}else l=Ie.corners(Ie.fromTopLeft({x:e.x,y:e.y-a/2},i,a)),c=Qr.equilateralFromVertex({x:e.x+i+o*.7,y:e.y},o,s);return U.rotate([l[0],l[1],c.a,c.b,c.c,l[2],l[3]],u,e)},Zi={};ie(Zi,{clampMagnitude:()=>Kp,divide:()=>Zp,dotProduct:()=>Gp,fromLineCartesian:()=>qp,fromLinePolar:()=>jp,fromPointPolar:()=>qf,multiply:()=>xp,normalise:()=>Up,quadrantOffsetAngle:()=>Vp,subtract:()=>Yp,sum:()=>Jp,toCartesian:()=>Ar,toPolar:()=>wi,toString:()=>Hp});var Tp=Object.freeze({x:0,y:0}),ki=Math.PI*2,Xi=Math.PI,qf=(e,r="",n=Tp)=>{e=ln(e,n);let i=Math.atan2(e.y,e.x);return r==="unipolar"&&i<0?i+=ki:r==="bipolar"&&(i>Xi?i-=ki:i<=-Xi&&(i+=ki)),Object.freeze({distance:Kt(e),angleRadian:i})},qp=e=>ln(e.b,e.a),jp=e=>{va(e,"line");const r=ln(e.b,e.a);return qf(r)},ar=e=>!!dt.isCoord(e),an=e=>!!Le(e),Up=e=>{if(ar(e))return dt.normalise(e);if(an(e))return tf(e);throw new Error(`Expected polar/cartesian vector. Got: ${e}`)},Vp=e=>e.x>=0&&e.y>=0?0:e.x<0&&e.y>=0||e.x<0&&e.y<0?Xi:ki,wi=(e,r=Nn)=>{if(ar(e))return e;if(an(e))return dt.fromCartesian(e,r);throw new Error(`Expected polar/cartesian vector. Got: ${e}`)},Ar=e=>{if(ar(e))return dt.toPoint(e);if(an(e))return e;throw new Error(`Expected polar/cartesian vector. Got: ${e}`)},Hp=(e,r)=>{if(ar(e))return dt.toString(e,r);if(an(e))return Jl(e,r);throw new Error(`Expected polar/cartesian vector. Got: ${e}`)},Gp=(e,r)=>{if(ar(e)&&ar(r))return dt.dotProduct(e,r);if(an(e)&&an(r))return Vl(e,r);throw new Error("Expected two polar/Cartesian vectors.")},Kp=(e,r=1,n=0)=>{if(ar(e))return dt.clampMagnitude(e,r,n);if(an(e))return rf(e,r,n);throw new Error("Expected either polar or Cartesian vector")},Jp=(e,r)=>{const n=ar(e);e=Ar(e),r=Ar(r);const i=Xl(e,r);return n?wi(i):i},Yp=(e,r)=>{const n=ar(e);e=Ar(e),r=Ar(r);const i=ln(e,r);return n?wi(i):i},xp=(e,r)=>{const n=ar(e);e=Ar(e),r=Ar(r);const i=vo(e,r);return n?wi(i):i},Zp=(e,r)=>{const n=ar(e);e=Ar(e),r=Ar(r);const i=Ql(e,r);return n?wi(i):i},jf={};ie(jf,{fromPoints:()=>Xp,init:()=>Uf});var Xp=(e,r={})=>{const n=Tl(...e);return Uf(n.map(i=>gr(i)),r)},Uf=(e,r={})=>{const n=r.maxDistanceFromLine??.1;return a=>{const o=e.map((c,l)=>{const f=c.nearest(a),h=Kt(a,f);return{path:c,index:l,nearest:f,distance:h}}).filter(c=>c.distance<=n);return $t.sortByNumericProperty(o,"distance")}},Qi={};ie(Qi,{scaler:()=>Qp});var Qp=(e="both",r)=>{const n=r??_o;let i=1,a=1,u={x:1,y:1};const o=()=>{switch(e){case"height":return{x:a,y:a};case"width":return{x:i,y:i};case"min":return{x:Math.min(i,a),y:Math.min(i,a)};case"max":return{x:Math.max(i,a),y:Math.max(i,a)};default:return{x:i,y:a}}},s=(h,g,C,R)=>{let k=Number.NaN,z=Number.NaN,A=n.width,S=n.height;if(typeof h=="number")if(k=h,typeof g=="number"){if(z=g,C===void 0)return[k,z,A,S];if(zr(C))A=C.width,S=C.height;else if(typeof C=="number")if(A=C,typeof R=="number")S=R;else throw new Error("Missing final height value");else throw new Error("Missing valid output range")}else if(zr(g))A=g.width,S=g.height;else throw new Error("Expected input y or output Rect to follow first number parameter");else if(Le(h)){if(k=h.x,z=h.y,g===void 0)return[k,z,A,S];if(zr(g))A=g.width,S=g.height;else if(typeof g=="number")if(A=g,typeof C=="number")S=C;else throw new Error("Expected height as third parameter after Point and output width");else throw new Error("Expected Rect or width as second parameter when first parameter is a Point")}else throw new Error("Expected input Point or x value as first parameter");return[k,z,A,S]},c=(h,g,C,R)=>{const k=s(h,g,C,R);return f(!0,...k)},l=(h,g,C,R)=>{const k=s(h,g,C,R);return f(!1,...k)},f=(h,g,C,R,k)=>{if(Number.isNaN(R))throw new Error("Output width range missing");if(Number.isNaN(k))throw new Error("Output height range missing");return(R!==i||k!==a)&&(i=R,a=k,u=o()),h?{x:g*u.x,y:C*u.y}:{x:g/u.x,y:C/u.y}};return{rel:l,abs:c}},Qr={};ie(Qr,{Empty:()=>zw,Equilateral:()=>Vf,Isosceles:()=>Gf,Placeholder:()=>Ww,Right:()=>Hf,angles:()=>Di,anglesDegrees:()=>qw,apply:()=>Lw,area:()=>Zf,barycentricCoord:()=>Qf,barycentricToCartestian:()=>e1,bbox:()=>Xf,centroid:()=>Ca,corners:()=>Mu,edges:()=>Aa,equilateralFromVertex:()=>Zw,fromFlatArray:()=>Qw,fromPoints:()=>Po,fromRadius:()=>Yw,guard:()=>xt,innerCircle:()=>Kw,intersectsPoint:()=>t1,isAcute:()=>Hw,isEmpty:()=>Ow,isEqual:()=>Tw,isEquilateral:()=>jw,isIsoceles:()=>Uw,isOblique:()=>Vw,isObtuse:()=>Gw,isPlaceholder:()=>kw,isRightAngle:()=>Yf,isTriangle:()=>$w,lengths:()=>Bo,outerCircle:()=>Jw,perimeter:()=>xf,rotate:()=>r1,rotateByVertex:()=>xw,toFlatArray:()=>Xw});var Vf={};ie(Vf,{area:()=>uw,centerFromA:()=>tw,centerFromB:()=>rw,centerFromC:()=>nw,circumcircle:()=>ow,fromCenter:()=>ew,height:()=>iw,incircle:()=>Da,perimeter:()=>aw});var Ps=Math.PI*4/3,Ns=Math.PI*2/3,Tr=e=>typeof e=="number"?e:e.length,ew=(e,r={x:0,y:0},n)=>{const i=Tr(e)/Math.sqrt(3),a=n??Math.PI*1.5,u={x:i*Math.cos(a)+r.x,y:i*Math.sin(a)+r.y},o={x:i*Math.cos(a+Ps)+r.x,y:i*Math.sin(a+Ps)+r.y},s={x:i*Math.cos(a+Ns)+r.x,y:i*Math.sin(a+Ns)+r.y};return Object.freeze({a:o,b:u,c:s})},tw=(e,r={x:0,y:0})=>{const n=Tr(e),{radius:i}=Da(e);return{x:r.x+n/2,y:r.y-i}},rw=(e,r={x:0,y:0})=>{const{radius:n}=Da(e);return{x:r.x,y:r.y+n*2}},nw=(e,r={x:0,y:0})=>{const n=Tr(e),{radius:i}=Da(e);return{x:r.x-n/2,y:r.y-i}},iw=e=>Math.sqrt(3)/2*Tr(e),aw=e=>Tr(e)*3,uw=e=>Math.pow(Tr(e),2)*Math.sqrt(3)/4,ow=e=>({radius:Math.sqrt(3)/3*Tr(e)}),Da=e=>({radius:Math.sqrt(3)/6*Tr(e)}),Hf={};ie(Hf,{adjacentFromHypotenuse:()=>Dw,adjacentFromOpposite:()=>Ew,angleAtPointA:()=>dw,angleAtPointB:()=>vw,area:()=>hw,circumcircle:()=>mw,fromA:()=>sw,fromB:()=>cw,fromC:()=>lw,height:()=>Ea,hypotenuseFromAdjacent:()=>Aw,hypotenuseFromOpposite:()=>bw,hypotenuseSegments:()=>ba,incircle:()=>gw,medians:()=>yw,oppositeFromAdjacent:()=>pw,oppositeFromHypotenuse:()=>ww,perimeter:()=>fw,resolveLengths:()=>Yt});var sw=(e,r={x:0,y:0})=>{const n=Yt(e),i=ba(e),a=Ea(e),u={x:r.x,y:r.y},o={x:r.x+n.hypotenuse,y:r.y},s={x:r.x+i[1],y:r.y-a};return{a:u,b:o,c:s}},cw=(e,r={x:0,y:0})=>{const n=Yt(e),i=ba(e),a=Ea(e),u={x:r.x,y:r.y},o={x:r.x-n.hypotenuse,y:r.y},s={x:r.x-i[0],y:r.y-a};return{a:o,b:u,c:s}},lw=(e,r={x:0,y:0})=>{const n=ba(e),i=Ea(e),a={x:r.x,y:r.y},u={x:r.x-n[1],y:r.y+i},o={x:r.x+n[0],y:r.y+i};return{a:u,b:o,c:a}},Yt=e=>{const r=e.adjacent,n=e.opposite,i=e.hypotenuse;if(r!==void 0&&n!==void 0)return{...e,adjacent:r,opposite:n,hypotenuse:Math.sqrt(r*r+n*n)};if(r&&i)return{...e,adjacent:r,hypotenuse:i,opposite:i*i-r*r};if(n&&i)return{...e,hypotenuse:i,opposite:n,adjacent:i*i-n*n};if(e.opposite&&e.hypotenuse&&e.adjacent)return e;throw new Error("Missing at least two edges")},Ea=e=>{const r=Yt(e),n=r.opposite*r.opposite/r.hypotenuse,i=r.adjacent*r.adjacent/r.hypotenuse;return Math.sqrt(n*i)},ba=e=>{const r=Yt(e),n=r.opposite*r.opposite/r.hypotenuse,i=r.adjacent*r.adjacent/r.hypotenuse;return[n,i]},fw=e=>{const r=Yt(e);return r.adjacent+r.hypotenuse+r.opposite},hw=e=>{const r=Yt(e);return r.opposite*r.adjacent/2},dw=e=>{const r=Yt(e);return Math.acos((r.adjacent*r.adjacent+r.hypotenuse*r.hypotenuse-r.opposite*r.opposite)/(2*r.adjacent*r.hypotenuse))},vw=e=>{const r=Yt(e);return Math.acos((r.opposite*r.opposite+r.hypotenuse*r.hypotenuse-r.adjacent*r.adjacent)/(2*r.opposite*r.hypotenuse))},yw=e=>{const r=Yt(e),n=r.adjacent*r.adjacent,i=r.hypotenuse*r.hypotenuse,a=r.opposite*r.opposite;return[Math.sqrt(2*(n+i)-a)/2,Math.sqrt(2*(i+a)-n)/2,Math.sqrt(2*(a+n)-i)/2]},mw=e=>({radius:Yt(e).hypotenuse/2}),gw=e=>{const r=Yt(e);return{radius:(r.adjacent+r.opposite-r.hypotenuse)/2}},pw=(e,r)=>Math.tan(e)*r,ww=(e,r)=>Math.sin(e)*r,Dw=(e,r)=>Math.cos(e)*r,Ew=(e,r)=>r/Math.tan(e),bw=(e,r)=>r/Math.sin(e),Aw=(e,r)=>r/Math.cos(e),Gf={};ie(Gf,{apexAngle:()=>Cw,area:()=>_w,baseAngle:()=>Kf,circumcircle:()=>Mw,fromA:()=>Bw,fromB:()=>Pw,fromC:()=>Nw,fromCenter:()=>Rw,height:()=>qr,incircle:()=>Jf,legHeights:()=>Fw,medians:()=>Iw,perimeter:()=>Sw});var Kf=e=>Math.acos(e.base/(2*e.legs)),Cw=e=>{const r=e.legs*e.legs,n=e.base*e.base;return Math.acos((2*r-n)/(2*r))},qr=e=>{const r=e.legs*e.legs,n=e.base*e.base;return Math.sqrt((4*r-n)/4)},Fw=e=>{const r=Kf(e);return e.base*Math.sin(r)},Sw=e=>2*e.legs+e.base,_w=e=>qr(e)*e.base/2,Mw=e=>{const r=qr(e),n=r*r,i=e.base*e.base;return{radius:(4*n+i)/(8*r)}},Jf=e=>{const r=qr(e);return{radius:e.base*r/(2*e.legs+e.base)}},Iw=e=>{const r=e.legs*e.legs,n=e.base*e.base,i=Math.sqrt(r+2*n)/2,a=Math.sqrt(4*r-n)/2;return[i,i,a]},Rw=(e,r={x:0,y:0})=>{const n=qr(e),i=Jf(e).radius,a=n-i,u={x:r.x-e.base/2,y:r.y+i},o={x:r.x+e.base/2,y:r.y+i},s={x:r.x,y:r.y-a};return{a:u,b:o,c:s}},Bw=(e,r={x:0,y:0})=>{const n=qr(e),i={x:r.x,y:r.y},a={x:r.x+e.base,y:r.y},u={x:r.x+e.base/2,y:r.y-n};return{a:i,b:a,c:u}},Pw=(e,r={x:0,y:0})=>{const n=qr(e),i={x:r.x,y:r.y},a={x:r.x-e.base,y:r.y},u={x:r.x-e.base/2,y:r.y-n};return{a,b:i,c:u}},Nw=(e,r={x:0,y:0})=>{const n=qr(e),i={x:r.x,y:r.y},a={x:r.x-e.base/2,y:r.y+n},u={x:r.x+e.base/2,y:r.y+n};return{a,b:u,c:i}},zs=Math.PI*2,zw=Object.freeze({a:{x:0,y:0},b:{x:0,y:0},c:{x:0,y:0}}),Ww=Object.freeze({a:{x:NaN,y:NaN},b:{x:NaN,y:NaN},c:{x:NaN,y:NaN}}),Ow=e=>Pi(e.a)&&Pi(e.b)&&Pi(e.c),kw=e=>Ni(e.a)&&Ni(e.b)&&Ni(e.c),Lw=(e,r)=>Object.freeze({...e,a:r(e.a,"a"),b:r(e.b,"b"),c:r(e.c,"c")}),xt=(e,r="t")=>{if(e===void 0)throw Error("{$name} undefined");_e(e.a,r+".a"),_e(e.b,r+".b"),_e(e.c,r+".c")},$w=e=>{if(e===void 0)return!1;const r=e;return!(!Le(r.a)||!Le(r.b)||!Le(r.c))},Tw=(e,r)=>ri(e.a,r.a)&&ri(e.b,r.b)&&ri(e.c,r.c),Mu=e=>(xt(e),[e.a,e.b,e.c]),Aa=e=>(xt(e),it.joinPointsToLines(e.a,e.b,e.c,e.a)),Bo=e=>(xt(e),[Kt(e.a,e.b),Kt(e.b,e.c),Kt(e.c,e.a)]),Di=e=>(xt(e),[Cn(e.a,e.b),Cn(e.b,e.c),Cn(e.c,e.a)]),qw=e=>(xt(e),Fa(Di(e))),jw=e=>{xt(e);const[r,n,i]=Bo(e);return r===n&&n===i},Uw=e=>{const[r,n,i]=Bo(e);return r===n||n===i||i===r},Yf=e=>Di(e).some(r=>r===Math.PI/2),Vw=e=>!Yf(e),Hw=e=>!Di(e).some(r=>r>=Math.PI/2),Gw=e=>Di(e).some(r=>r>Math.PI/2),Ca=e=>{xt(e);const r=Zl([e.a,e.b,e.c],(i,a)=>({x:i.x+a.x,y:i.y+a.y}));return{x:r.x/3,y:r.y/3}},xf=e=>(xt(e),Aa(e).reduce((r,n)=>r+it.length(n),0)),Zf=e=>{xt(e,"t");const r=Aa(e).map(i=>it.length(i)),n=(r[0]+r[1]+r[2])/2;return Math.sqrt(n*(n-r[0])*(n-r[1])*(n-r[2]))},Kw=e=>{const r=Ca(e),n=xf(e)/2;return{radius:Zf(e)/n,...r}},Jw=e=>{const[r,n,i]=Aa(e).map(o=>it.length(o)),a=Ca(e);return{radius:r*n*i/Math.sqrt((r+n+i)*(-r+n+i)*(r-n+i)*(r+n-i)),...a}},Yw=(e,r,n={})=>{ae(r,"positive","radius"),_e(e,"origin");const i=n.initialAngleRadian??0,u=[i,i+zs*1/3,i+zs*2/3].map(o=>dt.toCartesian(r,o,e));return Po(u)},xw=(e,r,n="b")=>{const i=n==="a"?e.a:n==="b"?e.b:e.c;return Object.freeze({a:Xr(e.a,r,i),b:Xr(e.b,r,i),c:Xr(e.c,r,i)})},Zw=(e={x:0,y:0},r=10,n=Math.PI/2)=>{const i=Eu(e,r,Math.PI- -n/2),a=Eu(e,r,Math.PI-n/2);return{a:i,b:e,c:a}},Xw=e=>(xt(e),[e.a.x,e.a.y,e.b.x,e.b.y,e.c.x,e.c.y]),Qw=e=>{if(!Array.isArray(e))throw new Error("coords expected as array");if(e.length!==6)throw new Error(`coords array expected with 6 elements. Got ${e.length}`);return Po(Yl(...e))},Po=e=>{if(!Array.isArray(e))throw new Error("points expected as array");if(e.length!==3)throw new Error(`points array expected with 3 elements. Got ${e.length}`);return{a:e[0],b:e[1],c:e[2]}},Xf=(e,r=0)=>{const{a:n,b:i,c:a}=e,u=Math.min(n.x,i.x,a.x)-r,o=Math.max(n.x,i.x,a.x)+r,s=Math.min(n.y,i.y,a.y)-r,c=Math.max(n.y,i.y,a.y)+r;return{x:u,y:s,width:o-u,height:c-s}},Qf=(e,r,n)=>{const i=nn(r,n),a=(c,l,f,h)=>(f.y-h.y)*c+(h.x-f.x)*l+f.x*h.y-h.x*f.y,u=a(i.x,i.y,e.b,e.c)/a(e.a.x,e.a.y,e.b,e.c),o=a(i.x,i.y,e.c,e.a)/a(e.b.x,e.b.y,e.c,e.a),s=a(i.x,i.y,e.a,e.b)/a(e.c.x,e.c.y,e.a,e.b);return{a:u,b:o,c:s}},e1=(e,r)=>{xt(e);const{a:n,b:i,c:a}=e,u=n.x*r.a+i.x*r.b+a.x*r.c,o=n.y*r.a+i.y*r.b+a.y*r.c;if(n.z&&i.z&&a.z){const s=n.z*r.a+i.z*r.b+a.z*r.c;return Object.freeze({x:u,y:o,z:s})}else return Object.freeze({x:u,y:o})},t1=(e,r,n)=>{const i=Xf(e),a=nn(r,n);if(!Ie.intersectsPoint(i,a))return!1;const u=Qf(e,a);return 0<=u.a&&u.a<=1&&0<=u.b&&u.b<=1&&0<=u.c&&u.c<=1},r1=(e,r,n)=>r===void 0||r===0?e:(n===void 0&&(n=Ca(e)),Object.freeze({...e,a:Xr(e.a,r,n),b:Xr(e.b,r,n),c:Xr(e.c,r,n)}));function Wr(e){return Array.isArray(e)?e.map(r=>r*(Math.PI/180)):e*(Math.PI/180)}function Fa(e){return Array.isArray(e)?e.map(r=>r*180/Math.PI):e*180/Math.PI}var eh=e=>Math.atan2(e.x,e.y);try{typeof window<"u"&&(window.ixfx={...window.ixfx,Geometry:{Circles:br,Arcs:Xu,Lines:it,Rects:Ie,Points:U,Paths:Sn,Grids:bo,Beziers:gi,Compound:Do,Ellipses:Io,Polar:dt,Shapes:Ro,radiansFromAxisX:eh,radianToDegree:Fa,degreeToRadian:Wr}})}catch{}var n1={};ie(n1,{AudioAnalysers:()=>ih,AudioVisualisers:()=>ah,Bluetooth:()=>th,Camera:()=>hh,Codec:()=>No,Espruino:()=>oh,FrameProcessor:()=>p1,Serial:()=>sh,StringReceiveBuffer:()=>zo,StringWriteBuffer:()=>Wo,VideoFile:()=>vh});var th={};ie(th,{NordicBleDevice:()=>nh,defaultOpts:()=>Sa});var No=class{constructor(){F(this,"enc",new TextEncoder),F(this,"dec",new TextDecoder("utf-8"))}toBuffer(e){return this.enc.encode(e)}fromBuffer(e){return this.dec.decode(e)}},zo=class{constructor(e,r=`
`){this.onData=e,this.separator=r,F(this,"buffer",""),F(this,"stream")}async close(){const e=this.stream;!e||(await e.abort(),await e.close())}clear(){this.buffer=""}writable(){return this.stream===void 0&&(this.stream=this.createWritable()),this.stream}createWritable(){const e=this;return new WritableStream({write(r){e.add(r)},close(){e.clear()}})}addImpl(e){const r=e.indexOf(this.separator);if(r<0)return this.buffer+=e,"";const n=e.substring(0,r);try{this.onData(this.buffer+n),e=e.substring(n.length+this.separator.length)}catch(i){console.warn(i)}return this.buffer="",e}add(e){for(;e.length>0;)e=this.addImpl(e)}},Wo=class{constructor(e,r=-1){this.onData=e,this.chunkSize=r,F(this,"paused",!1),F(this,"queue"),F(this,"writer"),F(this,"intervalMs"),F(this,"stream"),this.intervalMs=10,this.queue=Pn(),this.writer=Uu(()=>this.onWrite(),this.intervalMs)}async close(){const e=this.stream?.getWriter();e?.releaseLock(),await e?.close()}clear(){this.queue=Pn()}writable(){return this.stream===void 0&&(this.stream=this.createWritable()),this.stream}createWritable(){const e=this;return new WritableStream({write(r){e.add(r)},close(){e.clear()}})}async onWrite(){if(this.queue.isEmpty)return!1;if(this.paused)return console.warn("WriteBuffer.onWrite: paused..."),!0;const e=this.queue.dequeue();return e===void 0?!1:(await this.onData(e),!0)}add(e){this.chunkSize>0?this.queue.enqueue(...Cc(e,this.chunkSize)):this.queue.enqueue(e),this.writer.start()}},rh=async(e,r=5,n=200,i)=>{ke(r,"positive","attempts"),ke(n,"positive","startingTimeoutMs");let a=n,u=0;for(;r>0;){try{return await e()}catch{r--}if(u+=a,i&&i.cancel)throw new Error("Cancelled");if(await tn(a),i&&i.cancel)throw new Error("Cancelled");a*=2}throw new Error(`Retry failed after ${r} attempts over ${u} ms.`)},i1=class extends lr{constructor(e,r){super();this.device=e,this.config=r,F(this,"states"),F(this,"codec"),F(this,"rx"),F(this,"tx"),F(this,"gatt"),F(this,"verboseLogging",!1),F(this,"rxBuffer"),F(this,"txBuffer"),this.verboseLogging=r.debug,this.txBuffer=new Wo(async n=>{await this.writeInternal(n)},r.chunkSize),this.rxBuffer=new zo(n=>{this.fireEvent("data",{data:n})}),this.codec=new No,this.states=new on("ready",{ready:"connecting",connecting:["connected","closed"],connected:["closed"],closed:"connecting"}),this.states.addEventListener("change",n=>{this.fireEvent("change",n),this.verbose(`${n.priorState} -> ${n.newState}`),n.priorState==="connected"&&(this.rxBuffer.clear(),this.txBuffer.clear())}),e.addEventListener("gattserverdisconnected",()=>{this.isClosed||(this.verbose("GATT server disconnected"),this.states.state="closed")}),this.verbose(`ctor ${e.name} ${e.id}`)}get isConnected(){return this.states.state==="connected"}get isClosed(){return this.states.state==="closed"}write(e){if(this.states.state!=="connected")throw new Error(`Cannot write while state is ${this.states.state}`);this.txBuffer.add(e)}async writeInternal(e){this.verbose(`writeInternal ${e}`);const r=this.tx;if(r===void 0)throw new Error("Unexpectedly without tx characteristic");try{await r.writeValue(this.codec.toBuffer(e))}catch(n){this.warn(n)}}disconnect(){this.states.state==="connected"&&this.gatt?.disconnect()}async connect(){const e=this.config.connectAttempts??3;this.states.state="connecting",this.verbose("connect");const r=this.device.gatt;if(r===void 0)throw new Error("Gatt not available on device");await rh(async()=>{const n=await r.connect();this.verbose("Getting primary service");const i=await n.getPrimaryService(this.config.service);this.verbose("Getting characteristics");const a=await i.getCharacteristic(this.config.rxGattCharacteristic),u=await i.getCharacteristic(this.config.txGattCharacteristic);a.addEventListener("characteristicvaluechanged",o=>this.onRx(o)),this.rx=a,this.tx=u,this.gatt=r,this.states.state="connected",await a.startNotifications()},e,200)}onRx(e){if(this.rx===void 0)return;const n=e.target.value;if(n===void 0)return;let i=this.codec.fromBuffer(n.buffer);const a=ni(i,19),u=ni(i,17);u&&a<u&&(this.verbose("Tx plz start"),i=ii(i,u,1),this.txBuffer.paused=!1),a&&a>u&&(this.verbose("Tx plz stop"),i=ii(i,a,1),this.txBuffer.paused=!0),this.rxBuffer.add(i)}verbose(e){this.verboseLogging&&console.info(`${this.config.name} `,e)}log(e){console.log(`${this.config.name} `,e)}warn(e){console.warn(`${this.config.name} `,e)}},Sa={chunkSize:20,service:"6e400001-b5a3-f393-e0a9-e50e24dcca9e",txGattCharacteristic:"6e400002-b5a3-f393-e0a9-e50e24dcca9e",rxGattCharacteristic:"6e400003-b5a3-f393-e0a9-e50e24dcca9e",name:"NordicDevice",connectAttempts:5,debug:!1},nh=class extends i1{constructor(e,r={}){super(e,{...Sa,...r})}},ih={};ie(ih,{AudioAnalyser:()=>_a,basic:()=>a1,freq:()=>u1,peakLevel:()=>o1});var ah={};ie(ah,{default:()=>uh});var uh=class{constructor(e,r){F(this,"freqMaxRange",200),F(this,"audio"),F(this,"parent"),F(this,"lastPointer",{x:0,y:0}),F(this,"pointerDown",!1),F(this,"pointerClicking",!1),F(this,"pointerClickDelayMs",100),F(this,"pointerDelaying",!1),F(this,"waveTracker"),F(this,"freqTracker"),F(this,"el"),this.audio=r,this.parent=e,this.waveTracker=ti(),this.freqTracker=ti(),e.innerHTML=`
    <section>
      <button id="rendererComponentToggle">\u{1F53C}</button>
      <div>
        <h1>Visualiser</h1>
        <div style="display:flex; flex-wrap: wrap">
          <div class="visPanel">
            <h2>Frequency distribution</h2>
            <br />
            <canvas id="rendererComponentFreqData" height="200" width="400"></canvas>
          </div>
          <div class="visPanel">
            <h2>Waveform</h2>
            <button id="rendererComponentWaveReset">Reset</button>
            <div>
              Press and hold on wave to measure
            </div>
            <br />
            <canvas id="rendererComponentWaveData" height="200" width="400"></canvas>
          </div>
        </div>
      </div>
    </section>
    `,this.el=e.children[0],document.getElementById("rendererComponentToggle")?.addEventListener("click",()=>{this.setExpanded(!this.isExpanded())}),this.el.addEventListener("pointermove",n=>this.onPointer(n)),this.el.addEventListener("pointerup",()=>{this.pointerDelaying=!1,this.pointerDown=!1}),this.el.addEventListener("pointerdown",()=>{this.pointerDelaying=!0,setTimeout(()=>{this.pointerDelaying&&(this.pointerDelaying=!1,this.pointerDown=!0)},this.pointerClickDelayMs)}),this.el.addEventListener("pointerleave",()=>{this.pointerDelaying=!1,this.pointerDown=!1}),document.getElementById("rendererComponentWaveReset")?.addEventListener("click",()=>{this.clear()})}renderFreq(e){if(!this.isExpanded()||!e)return;const r=document.getElementById("rendererComponentFreqData");if(r===null)throw new Error("Cannot find canvas element");const n=r.getContext("2d");if(n===null)throw new Error("Cannot create drawing context");const i=e.length,a=r.clientWidth,u=r.clientHeight;n.clearRect(0,0,a,u);const o=this.getPointerRelativeTo(r),s=a/i,c=$t.minMaxAvg(e);for(let l=0;l<i;l++){if(!Number.isFinite(e[l]))continue;const h=(e[l]-c.min)/this.freqMaxRange,g=Math.abs(u*h),C=u-g,R=l/i*360,k=l*s;if(n.fillStyle="hsl("+R+", 100%, 50%)",o.y>0&&o.y<=u&&o.x>=k&&o.x<=k+s){this.freqTracker.id!==l.toString()&&(this.freqTracker=ti({id:l.toString()})),this.freqTracker.seen(e[l]);const z=this.freqTracker.getMinMaxAvg();n.fillStyle="black",this.audio&&n.fillText(`Frequency (${l}) at pointer: ${this.audio.getFrequencyAtIndex(l).toLocaleString("en")} - ${this.audio.getFrequencyAtIndex(l+1).toLocaleString("en")}`,2,10),n.fillText(`Raw value: ${e[l].toFixed(2)}`,2,20),n.fillText(`Min: ${z.min.toFixed(2)}`,2,40),n.fillText(`Max: ${z.max.toFixed(2)}`,60,40),n.fillText(`Avg: ${z.avg.toFixed(2)}`,120,40)}n.fillRect(k,C,s,g)}}isExpanded(){const e=this.el.querySelector("div");if(e===null)throw new Error("contents div not found");return e.style.display===""}setExpanded(e){const r=this.el.querySelector("div"),n=this.el.querySelector("button");if(n===null)throw new Error("Button element not found");if(r===null)throw new Error("Contents element not found");e?(r.style.display="",n.innerText="\u{1F53C}"):(r.style.display="none",n.innerText="\u{1F53D}")}clear(){this.clearCanvas(document.getElementById("rendererComponentFreqData")),this.clearCanvas(document.getElementById("rendererComponentWaveData"))}clearCanvas(e){if(e===null)throw new Error("Canvas is null");const r=e.getContext("2d");if(r===null)throw new Error("Cannot create drawing context");r.fillStyle="white",r.fillRect(0,0,e.clientWidth,e.clientHeight)}renderWave(e,r=!0){if(!this.isExpanded()||!e)return;const n=document.getElementById("rendererComponentWaveData");if(n===null)throw new Error("Cannot find wave canvas");const i=n.getContext("2d");if(i===null)throw new Error("Cannot create drawing context for wave");const a=n.clientWidth,u=n.clientHeight,o=this.getPointerRelativeTo(n),s=20,c=60,l=e.length;i.fillStyle="white",i.fillRect(0,0,c,s);const f=a/l;i.fillStyle="rgba(255, 255, 255, 0.03)",i.fillRect(0,20,a,u),i.fillStyle="red",r?i.fillRect(0,u/2,a,1):i.fillRect(0,u-1,a,1),i.lineWidth=1,i.strokeStyle="black",i.beginPath();let h=0;for(let g=0;g<l;g++){const C=e[g]*u,R=r?u/2-C:u-C;g===0?i.moveTo(h,R):i.lineTo(h,R),h+=f,this.pointerDown&&this.waveTracker.seen(e[g])}if(i.lineTo(a,r?u/2:u),i.stroke(),this.pointerDown){const g=this.waveTracker.getMinMaxAvg();i.fillStyle="rgba(255,255,0,1)",i.fillRect(c,0,150,20),i.fillStyle="black",i.fillText("Min: "+g.min.toFixed(2),60,10),i.fillText("Max: "+g.max.toFixed(2),110,10),i.fillText("Avg: "+g.avg.toFixed(2),160,10)}else this.waveTracker.reset();o.y>0&&o.y<=u&&o.x>=0&&o.x<=a&&(i.fillStyle="black",i.fillText("Level: "+(1-o.y/u).toFixed(2),2,10))}getPointerRelativeTo(e){const r=e.getBoundingClientRect();return{x:this.lastPointer.x-r.left-window.scrollX,y:this.lastPointer.y-r.top-window.scrollY}}onPointer(e){this.lastPointer={x:e.pageX,y:e.pageY},e.preventDefault()}},a1=(e,r={})=>new _a((n,i)=>{const a=new Float32Array(n.frequencyBinCount),u=new Float32Array(n.fftSize);n.getFloatFrequencyData(a),n.getFloatTimeDomainData(u),e(a,u,i)},r),u1=(e,r={})=>new _a((n,i)=>{const a=new Float32Array(n.frequencyBinCount);n.getFloatFrequencyData(a),e(a,i)},r),o1=(e,r={})=>new _a((n,i)=>{const a=new Float32Array(n.fftSize);n.getFloatTimeDomainData(a),e($t.maxFast(a),i)},r),xn,gn,_a=class{constructor(e,r={}){if(F(this,"showVis"),F(this,"fftSize"),F(this,"smoothingTimeConstant"),Oe(this,xn,!1),F(this,"debug"),Oe(this,gn,!1),F(this,"visualiser"),F(this,"audioCtx"),F(this,"analyserNode"),F(this,"analyse"),this.showVis=r.showVis??!1,this.fftSize=r.fftSize??1024,this.debug=r.debug??!1,this.smoothingTimeConstant=r.smoothingTimeConstant??.8,ke(this.fftSize,"positive","opts.fftSize"),ae(this.smoothingTimeConstant,"percentage","opts.smoothingTimeConstant"),!nl(this.fftSize))throw new Error(`fftSize must be a power of two from 32 to 32768 (${this.fftSize})`);if(this.fftSize<32)throw new Error("fftSize must be at least 32");if(this.fftSize>32768)throw new Error("fftSize must be no greater than 32768");this.analyse=e,this.paused=!1,this.init();const n=document.getElementById("audio-visualiser");if(n){const i=new uh(n,this);i.setExpanded(this.showVis),this.visualiser=i}}init(){if(J(this,gn)){this.debug&&console.debug("Init already in progress");return}Ce(this,gn,!0),navigator.mediaDevices.getUserMedia({audio:!0}).then(e=>{this.onMicSuccess(e)}).catch(e=>{Ce(this,gn,!1),console.error(e)})}get paused(){return J(this,xn)}set paused(e){e!==J(this,xn)&&(Ce(this,xn,e),e?this.debug&&console.log("Paused"):(this.debug&&console.log("Unpaused"),window.requestAnimationFrame(this.analyseLoop.bind(this))))}setup(e,r){const n=e.createAnalyser();return n.fftSize=this.fftSize,n.smoothingTimeConstant=this.smoothingTimeConstant,e.createMediaStreamSource(r).connect(n),n}onMicSuccess(e){try{const r=new AudioContext;r.addEventListener("statechange",()=>{this.debug&&console.log(`Audio context state: ${r.state}`)}),this.audioCtx=r,this.analyserNode=this.setup(r,e),window.requestAnimationFrame(this.analyseLoop.bind(this))}catch(r){Ce(this,gn,!1),console.error(r)}}analyseLoop(){if(this.paused){this.debug&&console.log("Paused");return}const e=this.analyserNode;if(e===void 0){console.warn("Analyser undefined");return}try{this.analyse(e,this)}catch(r){console.error(r)}window.requestAnimationFrame(this.analyseLoop.bind(this))}getFrequencyRangeMax(e,r,n){const i=this.sliceByFrequency(e,r,n);return $t.max(i)}sliceByFrequency(e,r,n){const i=this.getIndexForFrequency(e),a=this.getIndexForFrequency(r);return n.slice(i,a)}getFrequencyAtIndex(e){const r=this.analyserNode,n=this.audioCtx;if(r===void 0)throw new Error("Analyser not available");if(n===void 0)throw new Error("Audio context not available");if(ke(e,"positive","index"),e>r.frequencyBinCount)throw new Error(`Index ${e} exceeds frequency bin count ${r.frequencyBinCount}`);return e*n.sampleRate/(r.frequencyBinCount*2)}getIndexForFrequency(e){const r=this.analyserNode;if(r===void 0)throw new Error("Analyser not available");const n=r.context.sampleRate/2,i=Math.round(e/n*r.frequencyBinCount);return i<0?0:i>=r.frequencyBinCount?r.frequencyBinCount-1:i}};xn=new WeakMap;gn=new WeakMap;var oh={};ie(oh,{EspruinoBleDevice:()=>Oo,EspruinoSerialDevice:()=>lh,connectBle:()=>f1,deviceEval:()=>ko,puck:()=>c1,serial:()=>l1});var Oo=class extends nh{constructor(e,r={}){super(e,r);F(this,"evalTimeoutMs"),F(this,"evalReplyBluetooth",!0),this.evalTimeoutMs=r.evalTimeoutMs??5*1e3}async writeScript(e){this.write(`reset();
`),this.write(`${e}
`)}async eval(e,r={},n){const i=r.debug??!1;return ko(e,r,this,"Bluetooth.println",i,n??(u=>this.warn(u)))}},sh={};ie(sh,{Device:()=>ch});var s1=class extends lr{constructor(e={}){super();F(this,"states"),F(this,"codec"),F(this,"verboseLogging",!1),F(this,"name"),F(this,"connectAttempts"),F(this,"chunkSize"),F(this,"rxBuffer"),F(this,"txBuffer"),this.verboseLogging=e.debug??!1,this.chunkSize=e.chunkSize??1024,this.connectAttempts=e.connectAttempts??3,this.name=e.name??"JsonDevice",this.txBuffer=new Wo(async r=>{await this.writeInternal(r)},e.chunkSize),this.rxBuffer=new zo(r=>{this.fireEvent("data",{data:r})}),this.codec=new No,this.states=new on("ready",{ready:"connecting",connecting:["connected","closed"],connected:["closed"],closed:"connecting"}),this.states.addEventListener("change",r=>{this.fireEvent("change",r),this.verbose(`${r.priorState} -> ${r.newState}`),r.priorState==="connected"&&(this.rxBuffer.clear(),this.txBuffer.clear())})}get isConnected(){return this.states.state==="connected"}get isClosed(){return this.states.state==="closed"}write(e){if(this.states.state!=="connected")throw new Error(`Cannot write while state is ${this.states.state}`);this.txBuffer.add(e)}async close(){this.states.state==="connected"&&this.onClosed()}async connect(){const e=this.connectAttempts;this.states.state="connecting",await this.onPreConnect(),await rh(async()=>{await this.onConnectAttempt(),this.states.state="connected"},e,200)}onRx(e){const r=e.target.value;if(r===void 0)return;let n=this.codec.fromBuffer(r.buffer);const i=ni(n,19),a=ni(n,17);a&&i<a&&(this.verbose("Tx plz start"),n=ii(n,a,1),this.txBuffer.paused=!1),i&&i>a&&(this.verbose("Tx plz stop"),n=ii(n,i,1),this.txBuffer.paused=!0),this.rxBuffer.add(n)}verbose(e){this.verboseLogging&&console.info(`${this.name} `,e)}log(e){console.log(`${this.name} `,e)}warn(e){console.warn(`${this.name} `,e)}},ch=class extends s1{constructor(e={}){super(e);this.config=e,F(this,"port"),F(this,"tx"),F(this,"abort"),F(this,"baudRate"),this.abort=new AbortController;const r=e.eol??`\r
`;this.baudRate=e.baudRate??9600,e.name===void 0&&(super.name="Serial.Device"),this.rxBuffer.separator=r}async writeInternal(e){if(this.tx===void 0)throw new Error("tx not ready");try{this.tx.write(e)}catch(r){this.warn(r)}}onClosed(){this.tx?.releaseLock(),this.abort.abort("closing port"),this.states.state="closed"}onPreConnect(){return Promise.resolve()}async onConnectAttempt(){let e={};const r={baudRate:this.baudRate};this.config.filters&&(e={filters:[...this.config.filters]}),this.port=await navigator.serial.requestPort(e),this.port.addEventListener("disconnect",o=>{this.close()}),await this.port.open(r);const n=this.port.writable,i=new TextEncoderStream;n!==null&&(i.readable.pipeTo(n,{signal:this.abort.signal}).catch(o=>{console.log("Serial.onConnectAttempt txText pipe:"),console.log(o)}),this.tx=i.writable.getWriter());const a=this.port.readable,u=new TextDecoderStream;a!==null&&(a.pipeTo(u.writable,{signal:this.abort.signal}).catch(o=>{console.log("Serial.onConnectAttempt rxR pipe:"),console.log(o)}),u.readable.pipeTo(this.rxBuffer.writable(),{signal:this.abort.signal}).catch(o=>{console.log("Serial.onConnectAttempt rxText pipe:"),console.log(o);try{this.port?.close()}catch(s){console.log(s)}}))}},lh=class extends ch{constructor(e){super(e);F(this,"evalTimeoutMs"),F(this,"evalReplyBluetooth",!1),e===void 0&&(e={}),this.evalTimeoutMs=e.evalTimeoutMs??5*1e3}async disconnect(){return super.close()}async writeScript(e){this.write(`reset();
`),this.write(`${e}
`)}async eval(e,r={},n){const i=r.debug??!1;return ko(e,r,this,"USB.println",i,n??(u=>this.warn(u)))}},c1=async(e={})=>{const r=e.name??"Puck",n=e.debug??!1,i=await navigator.bluetooth.requestDevice({filters:fh(e),optionalServices:[Sa.service]});console.log(i.name);const a=new Oo(i,{name:r,debug:n});return await a.connect(),a},l1=async(e={})=>{const r=new lh(e);return await r.connect(),r},fh=e=>{const r=[];return e.filters?r.push(...e.filters):e.name?(r.push({name:e.name}),console.info(`Filtering Bluetooth devices by name '${e.name}'`)):r.push({namePrefix:"Puck.js"}),r},f1=async(e={})=>{const r=await navigator.bluetooth.requestDevice({filters:fh(e),optionalServices:[Sa.service]}),n=new Oo(r,{name:"Espruino"});return await n.connect(),n},ko=async(e,r={},n,i,a,u)=>{const o=r.timeoutMs??n.evalTimeoutMs,s=r.assumeExclusive??!0;if(typeof e!="string")throw new Error("code parameter should be a string");return new Promise((c,l)=>{const f=ls(5),h=k=>{try{let z=k.data;z.startsWith(">{")&&z.endsWith("}")&&(z=z.substring(1));const A=JSON.parse(z);"reply"in A?A.reply===f?(C(),"result"in A&&c(A.result)):u(`Expected reply ${f}, got ${A.reply}`):u(`Expected packet, missing 'reply' field. Got: ${k.data}`)}catch(z){s?C(k.data):u(z)}},g=k=>{k.newState!=="connected"&&C(`State changed to '${k.newState}', aborting`)};n.addEventListener("data",h),n.addEventListener("change",g);const C=Vu(o,k=>{l(k)},()=>{n.removeEventListener("data",h),n.removeEventListener("change",g)}),R=`${i}(JSON.stringify({reply:"${f}", result:JSON.stringify(${e})}))
`;a&&u(R),n.write(R)})},hh={};ie(hh,{dumpDevices:()=>d1,start:()=>dh});var h1=1e4,d1=async(e="videoinput")=>{(await navigator.mediaDevices.enumerateDevices()).forEach(n=>{n.kind===e&&(console.log(n.label),console.log(` Kind: ${n.kind}`),console.log(` Device id: ${n.deviceId}`))})},dh=async(e={})=>{const r=document.createElement("VIDEO");r.style.display="none",r.playsInline=!0,r.muted=!0,r.classList.add("ixfx-camera"),document.body.appendChild(r);let n=()=>{};const i=()=>{try{n()}catch{}r.remove()};try{return n=(await v1(r,e)).dispose,{videoEl:r,dispose:i}}catch(a){throw console.error(a),i(),a}},v1=async(e,r={})=>{if(e===void 0)throw new Error("videoEl undefined");if(e===null)throw new Error("videoEl null");const n=r.max,i=r.min,a=r.ideal,u={audio:!1,video:{width:{},height:{}}};r.facingMode==="front"&&(r={...r,facingMode:"user"}),r.facingMode==="back"&&(r={...r,facingMode:"environment"}),r.facingMode&&(u.video.facingMode=r.facingMode),r.deviceId&&(u.video.deviceId=r.deviceId),a&&(u.video.width={...u.video.width,ideal:a.width},u.video.height={...u.video.height,ideal:a.height}),n&&(u.video.width={...u.video.width,max:n.width},u.video.height={...u.video.height,max:n.height}),i&&(u.video.width={...u.video.width,min:i.width},u.video.height={...u.video.height,min:i.height});const o=Vu(r.startTimeoutMs??h1,s=>{throw new Error(`Camera getUserMedia failed: ${s}`)});try{const s=await navigator.mediaDevices.getUserMedia(u),c=()=>{e.pause(),s.getTracks().forEach(g=>g.stop())};e.srcObject=s,o();const l={videoEl:e,dispose:c};return new Promise((h,g)=>{e.addEventListener("loadedmetadata",()=>{e.play().then(()=>{h(l)}).catch(C=>{g(C)})})})}catch(s){throw o(s.toString()),s}},vh={};ie(vh,{start:()=>yh});var yh=async e=>{const r=document.createElement("VIDEO");r.style.display="none",r.playsInline=!0,r.muted=!0,r.classList.add("ixfx-video"),document.body.appendChild(r);let n=()=>{};const i=()=>{try{n()}catch{}r.remove()};try{return n=(await y1(r,e)).dispose,{videoEl:r,dispose:i}}catch(a){throw console.error(a),i(),a}},y1=async(e,r)=>{if(e===void 0)throw new Error("videoEl undefined");if(e===null)throw new Error("videoEl null");const n=URL.createObjectURL(r);e.src=n,e.loop=!0;const a={videoEl:e,dispose:()=>{e.pause()}};return new Promise((o,s)=>{e.addEventListener("loadedmetadata",()=>{e.play().then(()=>{o(a)}).catch(c=>{s(c)})})})},Lo={};ie(Lo,{capture:()=>g1,frames:()=>m1,manualCapture:()=>mh});async function*m1(e,r={}){const n=r.maxIntervalMs??0,i=r.showCanvas??!1;let a=r.canvasEl,u,o;u=o=0,a===void 0&&(a=document.createElement("CANVAS"),a.classList.add("ixfx-frames"),i||(a.style.display="none"),document.body.appendChild(a));const s=()=>{a!==void 0&&(u=e.videoWidth,o=e.videoHeight,a.width=u,a.height=o)};let c=null;const l=$u(n);for await(const f of l){if((u===0||o===0)&&s(),u===0||o===0)continue;if(c===null&&(c=a.getContext("2d")),c===null)return;c.drawImage(e,0,0,u,o),yield c.getImageData(0,0,u,o)}}var g1=(e,r={})=>{const n=r.maxIntervalMs??0,i=r.showCanvas??!1,a=r.onFrame,u=e.videoWidth,o=e.videoHeight,s=document.createElement("CANVAS");s.classList.add("ixfx-capture"),i||(s.style.display="none"),s.width=u,s.height=o;let c=null,l;r.workerScript&&(l=new Worker(r.workerScript));const f=l||a;!f&&!i&&console.warn("Video will be captured to hidden element without any processing. Is this what you want?");const h=Uu(()=>{if(c===null&&(c=s.getContext("2d")),c===null)return;c.drawImage(e,0,0,u,o);let g;if(f&&(g=c.getImageData(0,0,u,o)),l&&l.postMessage({pixels:g.data.buffer,width:u,height:o,channels:4},[g.data.buffer]),a)try{a(g)}catch(C){console.error(C)}},n);return{start:()=>h.start(),cancel:()=>h.cancel(),canvasEl:s}},mh=(e,r={})=>{const n=r.showCanvas??!1,i=e.videoWidth,a=e.videoHeight,u=r.canvasEl!==void 0;let o=r.canvasEl;return o||(o=document.createElement("CANVAS"),o.classList.add("ixfx-capture"),document.body.append(o),n||(o.style.display="none")),o.width=i,o.height=a,{canvasEl:o,capture:()=>{let f;if(f||(f=o?.getContext("2d",{willReadFrequently:!0})),!f)throw new Error("Could not create graphics context");f.drawImage(e,0,0,i,a);const h=f.getImageData(0,0,i,a);return h.currentTime=e.currentTime,r.postCaptureDraw&&r.postCaptureDraw(f,i,a),h},dispose:()=>{if(!u)try{o?.remove()}catch{}}}},p1=class{constructor(e={}){F(this,"_source"),F(this,"_state"),F(this,"_teardownNeeded",!1),F(this,"_cameraConstraints"),F(this,"_cameraStartResult"),F(this,"_videoSourceCapture"),F(this,"_videoFile"),F(this,"_videoStartResult"),F(this,"_showCanvas"),F(this,"_showPreview"),F(this,"_postCaptureDraw"),F(this,"_timer"),F(this,"_captureCanvasEl"),this._state="ready",this._source="",this._timer=performance.now(),this._showCanvas=e.showCanvas??!1,this._showPreview=e.showPreview??!1,this._cameraConstraints=e.cameraConstraints??void 0,this._captureCanvasEl=e.captureCanvasEl??void 0,this._postCaptureDraw=e.postCaptureDraw}showPreview(e){if(this._state==="disposed")throw new Error("Disposed");let r;switch(this._source){case"camera":r=this._cameraStartResult?.videoEl,r!==void 0&&(r.style.display=e?"block":"none");break}this._showPreview=e}showCanvas(e){if(this._state==="disposed")throw new Error("Disposed");let r;if(this._source==="camera"||this._source==="video")r=this._videoSourceCapture?.canvasEl,r!==void 0&&(r.style.display=e?"block":"none");else throw new Error(`Source not implemented: ${this._source}`);this._showCanvas=e}getCapturer(){if(this._state==="disposed")throw new Error("Disposed");if(this._source==="camera"||this._source==="video")return this._videoSourceCapture;throw new Error(`Source kind not supported ${this._source}`)}async useCamera(e){if(this._state==="disposed")throw new Error("Disposed");this._source="camera",this._teardownNeeded&&this.teardown(),e&&this._cameraConstraints,await this.init()}async useVideo(e){if(this._state==="disposed")throw new Error("Disposed");this._source="video",this._teardownNeeded&&this.teardown(),this._videoFile=e,await this.init()}async initCamera(){const e=await dh(this._cameraConstraints);if(e===void 0)throw new Error("Could not start camera");this._cameraStartResult=e,this.postInit(e)}async initVideo(){if(!this._videoFile)throw new Error("Video file not defined");const e=await yh(this._videoFile);this._videoStartResult=e,this.postInit(e)}async postInit(e){this._showPreview&&(e.videoEl.style.display="block"),this._videoSourceCapture=mh(e.videoEl,{postCaptureDraw:this._postCaptureDraw,showCanvas:this._showCanvas,canvasEl:this._captureCanvasEl}),this._teardownNeeded=!0,this._cameraStartResult=e}dispose(){this._state!=="disposed"&&(this.teardown(),this._state="disposed")}async init(){switch(this._timer=performance.now(),this._source){case"camera":await this.initCamera();break;case"video":await this.initVideo();break}this._state="initialised"}teardown(){if(!!this._teardownNeeded){switch((this._source==="camera"||this._source==="video")&&this._videoSourceCapture?.dispose(),this._source){case"camera":this._cameraStartResult?.dispose();break;case"video":this._videoStartResult?.dispose();break}this._teardownNeeded=!1}}getFrame(){if(this._state==="disposed")throw new Error("Disposed");switch(this._source){case"camera":return this.getFrameCamera();case"video":return this.getFrameCamera();default:throw new Error(`source type unhandled ${this._source}`)}}getTimestamp(){return performance.now()-this._timer}getFrameCamera(){return this._videoSourceCapture?.capture()}},w1={};ie(w1,{Colour:()=>yi,Drawing:()=>Ma,Palette:()=>es,Plot:()=>xo,Plot2:()=>Xo,SceneGraph:()=>Qo,Svg:()=>Ko,Video:()=>Lo});var Ma={};ie(Ma,{arc:()=>Ih,bezier:()=>Ph,circle:()=>Rh,connectedPoints:()=>Ba,copyToImg:()=>ND,dot:()=>ir,drawingStack:()=>Dn,ellipse:()=>BD,getCtx:()=>Mh,line:()=>Go,lineThroughPoints:()=>RD,makeHelper:()=>_D,paths:()=>Bh,pointLabels:()=>Pa,rect:()=>zh,textBlock:()=>Wh,textBlockAligned:()=>OD,textWidth:()=>En,translatePoint:()=>PD,triangle:()=>WD});var D1=un(zv(),1),{__extends:Ln,__assign:Rb,__rest:Bb,__decorate:Pb,__param:Nb,__metadata:zb,__awaiter:E1,__generator:gh,__exportStar:Wb,__createBinding:Ob,__values:Iu,__read:On,__spread:kb,__spreadArrays:Lb,__spreadArray:li,__await:Qa,__asyncGenerator:b1,__asyncDelegator:$b,__asyncValues:A1,__makeTemplateObject:Tb,__importStar:qb,__importDefault:jb,__classPrivateFieldGet:Ub,__classPrivateFieldSet:Vb}=D1.default;function Ue(e){return typeof e=="function"}function C1(e){var r=function(i){Error.call(i),i.stack=new Error().stack},n=e(r);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var eu=C1(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(i,a){return a+1+") "+i.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function Ru(e,r){if(e){var n=e.indexOf(r);0<=n&&e.splice(n,1)}}var Ia=function(){function e(r){this.initialTeardown=r,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var r,n,i,a,u;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var s=Iu(o),c=s.next();!c.done;c=s.next()){var l=c.value;l.remove(this)}}catch(k){r={error:k}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}else o.remove(this);var f=this.initialTeardown;if(Ue(f))try{f()}catch(k){u=k instanceof eu?k.errors:[k]}var h=this._finalizers;if(h){this._finalizers=null;try{for(var g=Iu(h),C=g.next();!C.done;C=g.next()){var R=C.value;try{Ws(R)}catch(k){u=u??[],k instanceof eu?u=li(li([],On(u)),On(k.errors)):u.push(k)}}}catch(k){i={error:k}}finally{try{C&&!C.done&&(a=g.return)&&a.call(g)}finally{if(i)throw i.error}}}if(u)throw new eu(u)}},e.prototype.add=function(r){var n;if(r&&r!==this)if(this.closed)Ws(r);else{if(r instanceof e){if(r.closed||r._hasParent(this))return;r._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(r)}},e.prototype._hasParent=function(r){var n=this._parentage;return n===r||Array.isArray(n)&&n.includes(r)},e.prototype._addParent=function(r){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(r),n):n?[n,r]:r},e.prototype._removeParent=function(r){var n=this._parentage;n===r?this._parentage=null:Array.isArray(n)&&Ru(n,r)},e.prototype.remove=function(r){var n=this._finalizers;n&&Ru(n,r),r instanceof e&&r._removeParent(this)},e.EMPTY=function(){var r=new e;return r.closed=!0,r}(),e}();Ia.EMPTY;function ph(e){return e instanceof Ia||e&&"closed"in e&&Ue(e.remove)&&Ue(e.add)&&Ue(e.unsubscribe)}function Ws(e){Ue(e)?e():e.unsubscribe()}var wh={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},F1={setTimeout:function(e,r){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setTimeout.apply(void 0,li([e,r],On(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function Dh(e){F1.setTimeout(function(){throw e})}function Os(){}function S1(e){e()}var $o=function(e){Ln(r,e);function r(n){var i=e.call(this)||this;return i.isStopped=!1,n?(i.destination=n,ph(n)&&n.add(i)):i.destination=R1,i}return r.create=function(n,i,a){return new Bu(n,i,a)},r.prototype.next=function(n){this.isStopped||this._next(n)},r.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},r.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},r.prototype._next=function(n){this.destination.next(n)},r.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},r.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},r}(Ia),_1=Function.prototype.bind;function tu(e,r){return _1.call(e,r)}var M1=function(){function e(r){this.partialObserver=r}return e.prototype.next=function(r){var n=this.partialObserver;if(n.next)try{n.next(r)}catch(i){Si(i)}},e.prototype.error=function(r){var n=this.partialObserver;if(n.error)try{n.error(r)}catch(i){Si(i)}else Si(r)},e.prototype.complete=function(){var r=this.partialObserver;if(r.complete)try{r.complete()}catch(n){Si(n)}},e}(),Bu=function(e){Ln(r,e);function r(n,i,a){var u=e.call(this)||this,o;if(Ue(n)||!n)o={next:n??void 0,error:i??void 0,complete:a??void 0};else{var s;u&&wh.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=function(){return u.unsubscribe()},o={next:n.next&&tu(n.next,s),error:n.error&&tu(n.error,s),complete:n.complete&&tu(n.complete,s)}):o=n}return u.destination=new M1(o),u}return r}($o);function Si(e){Dh(e)}function I1(e){throw e}var R1={closed:!0,next:Os,error:I1,complete:Os},To=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function B1(e){return e}function P1(e){return e.length===0?B1:e.length===1?e[0]:function(n){return e.reduce(function(i,a){return a(i)},n)}}var Sr=function(){function e(r){r&&(this._subscribe=r)}return e.prototype.lift=function(r){var n=new e;return n.source=this,n.operator=r,n},e.prototype.subscribe=function(r,n,i){var a=this,u=z1(r)?r:new Bu(r,n,i);return S1(function(){var o=a,s=o.operator,c=o.source;u.add(s?s.call(u,c):c?a._subscribe(u):a._trySubscribe(u))}),u},e.prototype._trySubscribe=function(r){try{return this._subscribe(r)}catch(n){r.error(n)}},e.prototype.forEach=function(r,n){var i=this;return n=ks(n),new n(function(a,u){var o=new Bu({next:function(s){try{r(s)}catch(c){u(c),o.unsubscribe()}},error:u,complete:a});i.subscribe(o)})},e.prototype._subscribe=function(r){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(r)},e.prototype[To]=function(){return this},e.prototype.pipe=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return P1(r)(this)},e.prototype.toPromise=function(r){var n=this;return r=ks(r),new r(function(i,a){var u;n.subscribe(function(o){return u=o},function(o){return a(o)},function(){return i(u)})})},e.create=function(r){return new e(r)},e}();function ks(e){var r;return(r=e??wh.Promise)!==null&&r!==void 0?r:Promise}function N1(e){return e&&Ue(e.next)&&Ue(e.error)&&Ue(e.complete)}function z1(e){return e&&e instanceof $o||N1(e)&&ph(e)}function W1(e){return Ue(e?.lift)}function qo(e){return function(r){if(W1(r))return r.lift(function(n){try{return e(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function ea(e,r,n,i,a){return new O1(e,r,n,i,a)}var O1=function(e){Ln(r,e);function r(n,i,a,u,o,s){var c=e.call(this,n)||this;return c.onFinalize=o,c.shouldUnsubscribe=s,c._next=i?function(l){try{i(l)}catch(f){n.error(f)}}:e.prototype._next,c._error=u?function(l){try{u(l)}catch(f){n.error(f)}finally{this.unsubscribe()}}:e.prototype._error,c._complete=a?function(){try{a()}catch(l){n.error(l)}finally{this.unsubscribe()}}:e.prototype._complete,c}return r.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var i=this.closed;e.prototype.unsubscribe.call(this),!i&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},r}($o),k1={now:function(){return Date.now()},delegate:void 0},L1=function(e){Ln(r,e);function r(n,i){return e.call(this)||this}return r.prototype.schedule=function(n,i){return this},r}(Ia),Ls={setInterval:function(e,r){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setInterval.apply(void 0,li([e,r],On(n)))},clearInterval:function(e){return clearInterval(e)},delegate:void 0},$1=function(e){Ln(r,e);function r(n,i){var a=e.call(this,n,i)||this;return a.scheduler=n,a.work=i,a.pending=!1,a}return r.prototype.schedule=function(n,i){var a;if(i===void 0&&(i=0),this.closed)return this;this.state=n;var u=this.id,o=this.scheduler;return u!=null&&(this.id=this.recycleAsyncId(o,u,i)),this.pending=!0,this.delay=i,this.id=(a=this.id)!==null&&a!==void 0?a:this.requestAsyncId(o,this.id,i),this},r.prototype.requestAsyncId=function(n,i,a){return a===void 0&&(a=0),Ls.setInterval(n.flush.bind(n,this),a)},r.prototype.recycleAsyncId=function(n,i,a){if(a===void 0&&(a=0),a!=null&&this.delay===a&&this.pending===!1)return i;i!=null&&Ls.clearInterval(i)},r.prototype.execute=function(n,i){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var a=this._execute(n,i);if(a)return a;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},r.prototype._execute=function(n,i){var a=!1,u;try{this.work(n)}catch(o){a=!0,u=o||new Error("Scheduled action threw falsy error")}if(a)return this.unsubscribe(),u},r.prototype.unsubscribe=function(){if(!this.closed){var n=this,i=n.id,a=n.scheduler,u=a.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Ru(u,this),i!=null&&(this.id=this.recycleAsyncId(a,i,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},r}(L1),$s=function(){function e(r,n){n===void 0&&(n=e.now),this.schedulerActionCtor=r,this.now=n}return e.prototype.schedule=function(r,n,i){return n===void 0&&(n=0),new this.schedulerActionCtor(this,r).schedule(i,n)},e.now=k1.now,e}(),T1=function(e){Ln(r,e);function r(n,i){i===void 0&&(i=$s.now);var a=e.call(this,n,i)||this;return a.actions=[],a._active=!1,a}return r.prototype.flush=function(n){var i=this.actions;if(this._active){i.push(n);return}var a;this._active=!0;do if(a=n.execute(n.state,n.delay))break;while(n=i.shift());if(this._active=!1,a){for(;n=i.shift();)n.unsubscribe();throw a}},r}($s),q1=new T1($1),Eh=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function j1(e){return Ue(e?.then)}function U1(e){return Ue(e[To])}function V1(e){return Symbol.asyncIterator&&Ue(e?.[Symbol.asyncIterator])}function H1(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function G1(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var K1=G1();function J1(e){return Ue(e?.[K1])}function Y1(e){return b1(this,arguments,function(){var n,i,a,u;return gh(this,function(o){switch(o.label){case 0:n=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,Qa(n.read())];case 3:return i=o.sent(),a=i.value,u=i.done,u?[4,Qa(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,Qa(a)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function x1(e){return Ue(e?.getReader)}function jo(e){if(e instanceof Sr)return e;if(e!=null){if(U1(e))return Z1(e);if(Eh(e))return X1(e);if(j1(e))return Q1(e);if(V1(e))return bh(e);if(J1(e))return eD(e);if(x1(e))return tD(e)}throw H1(e)}function Z1(e){return new Sr(function(r){var n=e[To]();if(Ue(n.subscribe))return n.subscribe(r);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function X1(e){return new Sr(function(r){for(var n=0;n<e.length&&!r.closed;n++)r.next(e[n]);r.complete()})}function Q1(e){return new Sr(function(r){e.then(function(n){r.closed||(r.next(n),r.complete())},function(n){return r.error(n)}).then(null,Dh)})}function eD(e){return new Sr(function(r){var n,i;try{for(var a=Iu(e),u=a.next();!u.done;u=a.next()){var o=u.value;if(r.next(o),r.closed)return}}catch(s){n={error:s}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}r.complete()})}function bh(e){return new Sr(function(r){rD(e,r).catch(function(n){return r.error(n)})})}function tD(e){return bh(Y1(e))}function rD(e,r){var n,i,a,u;return E1(this,void 0,void 0,function(){var o,s;return gh(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=A1(e),c.label=1;case 1:return[4,n.next()];case 2:if(i=c.sent(),!!i.done)return[3,4];if(o=i.value,r.next(o),r.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=c.sent(),a={error:s},[3,11];case 6:return c.trys.push([6,,9,10]),i&&!i.done&&(u=n.return)?[4,u.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(a)throw a.error;return[7];case 10:return[7];case 11:return r.complete(),[2]}})})}function nD(e,r,n,i,a){i===void 0&&(i=0),a===void 0&&(a=!1);var u=r.schedule(function(){n(),a?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(u),!a)return u}function ta(e,r){return qo(function(n,i){var a=0;n.subscribe(ea(i,function(u){i.next(e.call(r,u,a++))}))})}var iD=Array.isArray;function aD(e,r){return iD(r)?e.apply(void 0,li([],On(r))):e(r)}function uD(e){return ta(function(r){return aD(e,r)})}function oD(e,r,n,i,a,u,o,s){var c=[],l=0,f=0,h=!1,g=function(){h&&!c.length&&!l&&r.complete()},C=function(k){return l<i?R(k):c.push(k)},R=function(k){u&&r.next(k),l++;var z=!1;jo(n(k,f++)).subscribe(ea(r,function(A){a?.(A),u?C(A):r.next(A)},function(){z=!0},void 0,function(){if(z)try{l--;for(var A=function(){var S=c.shift();o?nD(r,o,function(){return R(S)}):R(S)};c.length&&l<i;)A();g()}catch(S){r.error(S)}}))};return e.subscribe(ea(r,C,function(){h=!0,g()})),function(){s?.()}}function Ah(e,r,n){return n===void 0&&(n=1/0),Ue(r)?Ah(function(i,a){return ta(function(u,o){return r(i,u,a,o)})(jo(e(i,a)))},n):(typeof r=="number"&&(n=r),qo(function(i,a){return oD(i,a,e,n)}))}var sD=["addListener","removeListener"],cD=["addEventListener","removeEventListener"],lD=["on","off"];function ra(e,r,n,i){if(Ue(n)&&(i=n,n=void 0),i)return ra(e,r,n).pipe(uD(i));var a=On(dD(e)?cD.map(function(s){return function(c){return e[s](r,c,n)}}):fD(e)?sD.map(Ts(e,r)):hD(e)?lD.map(Ts(e,r)):[],2),u=a[0],o=a[1];if(!u&&Eh(e))return Ah(function(s){return ra(s,r,n)})(jo(e));if(!u)throw new TypeError("Invalid event target");return new Sr(function(s){var c=function(){for(var l=[],f=0;f<arguments.length;f++)l[f]=arguments[f];return s.next(1<l.length?l:l[0])};return u(c),function(){return o(c)}})}function Ts(e,r){return function(n){return function(i){return e[n](r,i)}}}function fD(e){return Ue(e.addListener)&&Ue(e.removeListener)}function hD(e){return Ue(e.on)&&Ue(e.off)}function dD(e){return Ue(e.addEventListener)&&Ue(e.removeEventListener)}function Ch(e,r){return r===void 0&&(r=q1),qo(function(n,i){var a=null,u=null,o=null,s=function(){if(a){a.unsubscribe(),a=null;var l=u;u=null,i.next(l)}};function c(){var l=o+e,f=r.now();if(f<l){a=this.schedule(void 0,l-f),i.add(a);return}s()}n.subscribe(ea(i,function(l){u=l,o=r.now(),a||(a=r.schedule(c,e),i.add(a))},function(){s(),i.complete()},void 0,function(){u=a=null}))})}var Fh=un(Wv(),1),Sh=(e,r)=>{const n=ot(e),i=Ra(),a=()=>{const u=window.innerWidth,o=window.innerHeight;n.setAttribute("width",u.toString()),n.setAttribute("height",o.toString());const s={width:u,height:o,center:{x:u/2,y:o/2}};r!==void 0&&r({el:n,bounds:s})};return i.subscribe(a),a(),i},vD=(e,r)=>{if(!e)throw new Error("domQueryOrEl is null or undefined");const n=ot(e);if(n.nodeName!=="CANVAS")throw new Error(`Expected CANVAS HTML element. Got: ${n.nodeName}`);const i=r.fullSize??!0,a=Math.round(window.devicePixelRatio)||1,u=r.scaleBy??"both";let o=Qi.scaler("both");const s=f=>{o=Qi.scaler(u,f);const h=Ie.multiply(f,a,a);n.width=h.width,n.height=h.height,n.style.width=f.width+"px",n.style.height=f.height+"px"},c=()=>{const f={width:window.innerWidth,height:window.innerHeight};s(f)},l=()=>{const f=n.getContext("2d");if(f===null)throw new Error("Could not create drawing context");f.scale(a,a)};return i&&Ra().subscribe(c),{abs:o.abs,rel:o.rel,getContext:l}},yD=(e,r,n=!1)=>{if(e==null)throw new Error("domQueryOrEl is null or undefined");const i=ot(e);if(i.nodeName!=="CANVAS")throw new Error(`Expected HTML element with node name CANVAS, not ${i.nodeName}`);const a=i.getContext("2d");if(a===null)throw new Error("Could not create drawing context");const u=()=>{const s=window.innerWidth,c=window.innerHeight;i.width=s,i.height=c;const l={width:s,height:c,center:{x:s/2,y:c/2}};r!==void 0&&r({ctx:a,el:i,bounds:l})};n||(i.style.top="0",i.style.left="0",i.style.zIndex="-100",i.style.position="fixed");const o=Ra();return o.subscribe(u),u(),o},mD=(e,r)=>{if(!(e===null||!e)){if(!Array.isArray(r))throw new Error("List should be an array of strings");for(let n=0;n<r.length;n++)if(e.classList.contains(r[n])){e.classList.remove(r[n]),n+1<r.length?e.classList.add(r[n+1]):e.classList.add(r[0]);return}e.classList.add(r[0])}},gD=(e,r,n=100)=>{const i=ot(e),a=i.parentElement;if(a===null)throw new Error("Element has no parent");return Vo(a,n).subscribe(o=>{const s=o.find(h=>h.target===a);if(s===void 0)return;const c=s.contentRect.width,l=s.contentRect.height;i.setAttribute("width",c+"px"),i.setAttribute("height",l+"px");const f={width:c,height:l,center:{x:c/2,y:l/2}};r!==void 0&&r({el:i,bounds:f})})},pD=e=>{const r=ot(e),i=window.getComputedStyle(r).transform;if(i==="none"||typeof i>"u")return{x:0,y:0,z:0};const a=i.includes("3d")?"3d":"2d",u=i.match(/matrix.*\((.+)\)/)[1].split(", ");return a==="2d"?{x:parseFloat(u[4]),y:parseFloat(u[5]),z:0}:a==="3d"?{x:parseFloat(u[12]),y:parseFloat(u[13]),z:parseFloat(u[14])}:{x:0,y:0,z:0}},Uo=(e,r,n=100)=>{const i=ot(e);if(i.nodeName!=="CANVAS")throw new Error(`Expected HTML element with node name CANVAS, not ${i.nodeName}`);const a=i.parentElement;if(a===null)throw new Error("Element has no parent");const u=i.getContext("2d");if(u===null)throw new Error("Could not create drawing context");return i.style.width="100%",i.style.height="100%",Vo(a,n).subscribe(s=>{const c=s.find(g=>g.target===a);if(c===void 0)return;const l=c.contentRect.width,f=c.contentRect.height;i.setAttribute("width",i.offsetWidth+"px"),i.setAttribute("height",i.offsetHeight+"px");const h={width:l,height:f,center:{x:l/2,y:f/2}};r!==void 0&&r({ctx:u,el:i,bounds:h})})},Ra=(e=100)=>ra(window,"resize").pipe(Ch(e)),ot=e=>{if(typeof e=="string"){const n=document.querySelector(e);if(n===null)throw e.startsWith("#")?new Error(`Query '${e}' did not match anything. Try '#id', 'div', or '.class'`):new Error(`Query '${e}' did not match anything. Did you mean '#${e}?`);e=n}else{if(e===null)throw new Error(`domQueryOrEl ${e} is null`);if(e===void 0)throw new Error(`domQueryOrEl ${e} is undefined`)}return e},wD=(e,r)=>{const n=document.createElement(r);return e.parentElement?.insertBefore(n,e.nextSibling),n},DD=(e,r)=>{const n=document.createElement(r);return e.appendChild(n),n},ED=(e,r)=>{const n=ot(e),i=a=>{const u=new Set;for(const[s,c]of a){const l=`table-${s}`;u.add(l);let f=n.querySelector(`#${l}`);f===null&&(f=document.createElement("table"),f.id=l,n.append(f)),Pu(f,c)}Array.from(n.querySelectorAll("table")).forEach(s=>{u.has(s.id)||s.remove()})};return r&&i(r),a=>{i(a)}},Pu=(e,r,n={})=>{const i=n.precision??2;if(r===void 0){e.innerHTML="";return}const a=new Set;for(const[o,s]of Object.entries(r)){const c=`row-${o}`;a.add(c);let l=e.querySelector(`#${c}`);if(l===null){l=document.createElement("tr"),e.append(l),l.id=c;const g=document.createElement("td");g.innerText=o,l.append(g)}let f=l.querySelector(`#${c}-val`);f===null&&(f=document.createElement("td"),f.id=`${c}-val`,l.append(f));let h;n.formatter&&(h=n.formatter(s,o)),h===void 0&&(typeof s=="object"?h=Fh.default.stringify(s):typeof s=="number"?n.roundNumbers?h=Math.round(s).toString():h=s.toFixed(i):h=s.toString()),f.innerHTML=h}Array.from(e.querySelectorAll("tr")).forEach(o=>{a.has(o.id)||o.remove()})},bD=(e,r,n)=>{const i=ot(e),a=document.createElement("table");return i.append(a),r&&Pu(a,r,n),u=>{Pu(a,u,n)}},AD=e=>{let r=e.lastElementChild;for(;r;)e.removeChild(r),r=e.lastElementChild},CD=()=>new Sr(r=>{const n=new MutationObserver(a=>{r.next(a)}),i={attributeFilter:["class"],attributes:!0};return n.observe(document.documentElement,i),function(){n.disconnect()}}),Vo=(e,r=1e3)=>{if(e===null)throw new Error("elem parameter is null. Expected element to observe");if(e===void 0)throw new Error("elem parameter is undefined. Expected element to observe");return new Sr(i=>{const a=new ResizeObserver(u=>{i.next(u)});return a.observe(e),function(){a.unobserve(e)}}).pipe(Ch(r))},FD=e=>new Promise((n,i)=>{const a=Fh.default.stringify(e);navigator.clipboard.writeText(JSON.stringify(a)).then(()=>{n(!0)},u=>{console.warn("Could not copy to clipboard"),console.log(a),i(u)})}),SD=(e,r,n)=>{if(e===null)throw new Error("parentEl is null");if(e===void 0)throw new Error("parentEl is undefined");const i=new Set;for(const[u,o]of r){const s=`c-${u}`,c=e.querySelector(`#${s}`),l=n(o,c);c!==l&&(l.id=s,e.append(l)),i.add(s)}const a=[];for(let u=0;u<e.children.length;u++){const o=e.children[u];i.has(o.id)||a.push(o)}a.forEach(u=>u.remove())},_h=Math.PI*2,Mh=e=>{if(e===null)throw Error("canvasElCtxOrQuery null. Must be a 2d drawing context or Canvas element");if(e===void 0)throw Error("canvasElCtxOrQuery undefined. Must be a 2d drawing context or Canvas element");const r=e instanceof CanvasRenderingContext2D?e:e instanceof HTMLCanvasElement?e.getContext("2d"):typeof e=="string"?ot(e).getContext("2d"):e;if(r===null)throw new Error("Could not create 2d context for canvas");return r},_D=(e,r)=>{const n=Mh(e);return{paths(i,a){Bh(n,i,a)},line(i,a){Go(n,i,a)},rect(i,a){zh(n,i,a)},bezier(i,a){Ph(n,i,a)},connectedPoints(i,a){Ba(n,i,a)},pointLabels(i,a){Pa(n,i,a)},dot(i,a){ir(n,i,a)},circle(i,a){Rh(n,i,a)},arc(i,a){Ih(n,i,a)},textBlock(i,a){a.bounds===void 0&&r!==void 0&&(a={...a,bounds:{...r,x:0,y:0}}),Wh(n,i,a)}}},Ho=e=>MD(e.strokeStyle,e.fillStyle),bt=(e,r={},...n)=>{if(e===void 0)throw Error("ctx undefined");const i=Dn(e).push(Ho(r),...n);return i.apply(),i},Ih=(e,r,n={})=>{bt(e,n);const i=a=>{e.beginPath(),e.arc(a.x,a.y,a.radius,a.startRadian,a.endRadian),e.stroke()};Array.isArray(r)?r.forEach(i):i(r)},MD=(e,r)=>i=>{r&&(i.fillStyle=r),e&&(i.strokeStyle=e)},ID=(e,r,n)=>a=>{e&&(a.lineWidth=e),r&&(a.lineJoin=r),n&&(a.lineCap=n)},Dn=(e,r)=>(r===void 0&&(r=Ki()),{push:(...u)=>{r===void 0&&(r=Ki());const o=r.push(...u);return u.forEach(s=>s(e)),Dn(e,o)},pop:()=>{const u=r?.pop();return Dn(e,u)},apply:()=>r===void 0?Dn(e):(r.forEach(u=>u(e)),Dn(e,r))}),RD=(e,r,n)=>{bt(e,n),e.moveTo(r[0].x,r[0].y),r.forEach((i,a)=>{if(a+2>=r.length)return;const u=r[a+1],o={x:(i.x+u.x)/2,y:(i.y+u.y)/2},s=(o.x+i.x)/2,c=(o.x+u.x)/2;e.quadraticCurveTo(s,u.y,o.x,o.y),e.quadraticCurveTo(c,u.y,u.x,u.y)})},Rh=(e,r,n={})=>{bt(e,n);const i=a=>{e.beginPath(),e.arc(a.x,a.y,a.radius,0,_h),n.strokeStyle&&e.stroke(),n.fillStyle&&e.fill()};Array.isArray(r)?r.forEach(i):i(r)},BD=(e,r,n={})=>{bt(e,n);const i=a=>{e.beginPath();const u=a.rotation??0,o=a.startAngle??0,s=a.endAngle??_h;e.ellipse(a.x,a.y,a.radiusX,a.radiusY,u,o,s),n.strokeStyle&&e.stroke(),n.fillStyle&&e.fill()};Array.isArray(r)?r.forEach(i):i(r)},Bh=(e,r,n={})=>{bt(e,n);const i=a=>{if(ga(a))Nh(e,a,n);else if($r(a))Go(e,a,n);else throw new Error(`Unknown path type ${JSON.stringify(a)}`)};Array.isArray(r)?r.forEach(i):i(r)},Ba=(e,r,n={})=>{const i=n.loop??!1;w0(r),r.length!==0&&(r.forEach((a,u)=>_e(a,`Index ${u}`)),bt(e,n),e.beginPath(),e.moveTo(r[0].x,r[0].y),r.forEach(a=>e.lineTo(a.x,a.y)),i&&e.lineTo(r[0].x,r[0].y),(n.strokeStyle||n.strokeStyle===void 0&&n.fillStyle===void 0)&&e.stroke(),n.fillStyle&&e.fill())},Pa=(e,r,n={},i)=>{r.length!==0&&(r.forEach((a,u)=>_e(a,`Index ${u}`)),bt(e,n),r.forEach((a,u)=>{const o=i!==void 0&&u<i.length?i[u]:u.toString();e.fillText(o.toString(),a.x,a.y)}))},PD=(e,r)=>{const n=e.getTransform();return{x:r.x*n.a+r.y*n.c+n.e,y:r.x*n.b+r.y*n.d+n.f}},ND=e=>{const r=document.createElement("img");return r.src=e.toDataURL("image/jpeg"),r},ir=(e,r,n)=>{n===void 0&&(n={});const i=n.radius??10;if(bt(e,n),e.beginPath(),Array.isArray(r))r.forEach(a=>{e.arc(a.x,a.y,i,0,2*Math.PI)});else{const a=r;e.arc(a.x,a.y,i,0,2*Math.PI)}(n.filled||!n.outlined)&&e.fill(),n.outlined&&e.stroke()},Ph=(e,r,n)=>{ga(r)?Nh(e,r,n):go(r)&&zD(e,r,n)},zD=(e,r,n={})=>{let i=bt(e,n);const{a,b:u,cubic1:o,cubic2:s}=r,c=n.debug??!1;e.beginPath(),e.moveTo(a.x,a.y),e.bezierCurveTo(o.x,o.y,s.x,s.y,u.x,u.y),e.stroke(),c&&(i=i.push(Ho({...n,strokeStyle:oi(n.strokeStyle??"silver",.6),fillStyle:oi(n.fillStyle??"yellow",.4)})),i.apply(),e.moveTo(a.x,a.y),e.lineTo(o.x,o.y),e.stroke(),e.moveTo(u.x,u.y),e.lineTo(s.x,s.y),e.stroke(),e.fillText("a",a.x+5,a.y),e.fillText("b",u.x+5,u.y),e.fillText("c1",o.x+5,o.y),e.fillText("c2",s.x+5,s.y),ir(e,o,{radius:3}),ir(e,s,{radius:3}),ir(e,a,{radius:3}),ir(e,u,{radius:3}),i=i.pop(),i.apply())},Nh=(e,r,n={})=>{const{a:i,b:a,quadratic:u}=r,o=n.debug??!1;let s=bt(e,n);e.beginPath(),e.moveTo(i.x,i.y),e.quadraticCurveTo(u.x,u.y,a.x,a.y),e.stroke(),o&&(s=s.push(Ho({...n,strokeStyle:oi(n.strokeStyle??"silver",.6),fillStyle:oi(n.fillStyle??"yellow",.4)})),Ba(e,[i,u,a]),e.fillText("a",i.x+5,i.y),e.fillText("b",a.x+5,a.y),e.fillText("h",u.x+5,u.y),ir(e,u,{radius:3}),ir(e,i,{radius:3}),ir(e,a,{radius:3}),s=s.pop(),s.apply())},Go=(e,r,n={})=>{const i=n.debug??!1,a=ID(n.lineWidth,n.lineJoin,n.lineCap);bt(e,n,a);const u=o=>{const{a:s,b:c}=o;e.beginPath(),e.moveTo(s.x,s.y),e.lineTo(c.x,c.y),i&&(e.fillText("a",s.x,s.y),e.fillText("b",c.x,c.y),ir(e,s,{radius:5,strokeStyle:"black"}),ir(e,c,{radius:5,strokeStyle:"black"})),e.stroke()};Array.isArray(r)?r.forEach(u):u(r)},WD=(e,r,n={})=>{bt(e,n);const i=a=>{Ba(e,Mu(a),{...n,loop:!0}),n.debug&&Pa(e,Mu(a),void 0,["a","b","c"])};Array.isArray(r)?r.forEach(i):i(r)},zh=(e,r,n={})=>{bt(e,n);const i=a=>{n.filled&&e.fillRect(a.x,a.y,a.width,a.height),e.strokeRect(a.x,a.y,a.width,a.height),n.debug&&Pa(e,Mo(a),void 0,["NW","NE","SE","SW"])};Array.isArray(r)?r.forEach(i):i(r)},En=(e,r,n=0,i)=>{if(r==null||r.length===0)return 0;const a=e.measureText(r);return i?il(a.width,i)+n:a.width+n},Wh=(e,r,n)=>{bt(e,n);const i=n.anchorPadding??0,a=n.anchor,u=n.bounds??{x:0,y:0,width:1e6,height:1e6},o=r.map(C=>e.measureText(C)),s=o.map(C=>C.width),c=o.map(C=>C.actualBoundingBoxAscent+C.actualBoundingBoxDescent),l=Math.max(...s),f=c.reduce((C,R)=>C+R,0);let{x:h,y:g}=a;a.x+l>u.width?h=u.width-(l+i):h-=i,h<u.x&&(h=u.x+i),a.y+f>u.height?g=u.height-(f+i):g-=i,g<u.y&&(g=u.y+i),r.forEach((C,R)=>{e.fillText(C,h,g),g+=c[R]})},OD=(e,r,n)=>{const{bounds:i}=n,{horiz:a="left",vert:u="top"}=n;let o;typeof r=="string"?o=[r]:o=r,bt(e,n),e.save(),e.translate(i.x,i.y),e.textAlign="left",e.textBaseline="top";const s=i.width/2,c=i.height/2,l=o.map(C=>e.measureText(C)),f=l.map(C=>C.actualBoundingBoxAscent+C.actualBoundingBoxDescent),h=f.reduce((C,R)=>C+R,0);let g=0;u==="center"?g=c-h/2:u==="bottom"&&(g=i.height-h),o.forEach((C,R)=>{let k=0;a==="center"?k=s-l[R].width/2:a==="right"&&(k=i.width-l[R].width),e.fillText(o[R],k,g),g+=f[R]}),e.restore()},Ko={};ie(Ko,{Elements:()=>na,applyOpts:()=>_r,applyPathOpts:()=>Yo,applyStrokeOpts:()=>jr,clear:()=>$D,createEl:()=>Na,createOrResolve:()=>Cr,getBounds:()=>TD,makeHelper:()=>jD,remove:()=>Gh,setBounds:()=>qD});var kD=(e,r,n)=>{const i=Na("marker",e);if(r.markerWidth&&i.setAttribute("markerWidth",r.markerWidth?.toString()),r.markerHeight&&i.setAttribute("markerHeight",r.markerHeight?.toString()),r.orient?i.setAttribute("orient",r.orient.toString()):i.setAttribute("orient","auto-start-reverse"),r.viewBox&&i.setAttribute("viewBox",r.viewBox.toString()),r.refX&&i.setAttribute("refX",r.refX.toString()),r.refY&&i.setAttribute("refY",r.refY.toString()),n){const a=n();i.appendChild(a)}return i},ru=(e,r,n)=>{if(e===null)return"(elem null)";const i=e.ownerSVGElement;if(i===null)throw new Error("parent for elem is null");const a=Cr(i,"defs","defs");let u=a.querySelector(`#${r.id}`);if(u!==null)return`url(#${r.id})`;if(r.id==="triangle")r={...r,strokeStyle:"transparent"},r.markerHeight||(r={...r,markerHeight:6}),r.markerWidth||(r={...r,markerWidth:6}),r.refX||(r={...r,refX:r.markerWidth}),r.refY||(r={...r,refY:r.markerHeight}),(!r.fillStyle||r.fillStyle==="none")&&(r={...r,fillStyle:"black"}),r.viewBox||(r={...r,viewBox:"0 0 10 10"}),u=kD(r.id,r,()=>{const o=Na("path");return o.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),r&&_r(o,r),o});else throw new Error(`Do not know how to make ${r.id}`);return u.id=r.id,a.appendChild(u),`url(#${r.id})`},na={};ie(na,{circle:()=>$h,circleUpdate:()=>Lh,grid:()=>Hh,group:()=>LD,groupUpdate:()=>Th,line:()=>ia,lineUpdate:()=>qh,path:()=>Oh,pathUpdate:()=>kh,text:()=>Vh,textPath:()=>Uh,textPathUpdate:()=>jh,textUpdate:()=>Jo});var qs=e=>e>=0&&e<=1?e*100+"%":e.toString(),Oh=(e,r,n,i)=>{const a=Cr(r,"path",i),u=typeof e=="string"?e:e.join(`
`);return a.setAttributeNS(null,"d",u),r.appendChild(a),kh(a,n)},kh=(e,r)=>(r&&_r(e,r),r&&jr(e,r),e),Lh=(e,r,n)=>(e.setAttributeNS(null,"cx",r.x.toString()),e.setAttributeNS(null,"cy",r.y.toString()),e.setAttributeNS(null,"r",r.radius.toString()),n&&_r(e,n),n&&jr(e,n),e),$h=(e,r,n,i)=>{const a=Cr(r,"circle",i);return Lh(a,e,n)},LD=(e,r,n)=>{const i=Cr(r,"g",n);return Th(i,e)},Th=(e,r)=>{for(const n of r)n.parentNode!==e&&e.appendChild(n);return e},ia=(e,r,n,i)=>{const a=Cr(r,"line",i);return qh(a,e,n)},qh=(e,r,n)=>(e.setAttributeNS(null,"x1",r.a.x.toString()),e.setAttributeNS(null,"y1",r.a.y.toString()),e.setAttributeNS(null,"x2",r.b.x.toString()),e.setAttributeNS(null,"y2",r.b.y.toString()),n&&_r(e,n),n&&Yo(e,n),n&&jr(e,n),e),jh=(e,r,n)=>(n?.method&&e.setAttributeNS(null,"method",n.method),n?.side&&e.setAttributeNS(null,"side",n.side),n?.spacing&&e.setAttributeNS(null,"spacing",n.spacing),n?.startOffset&&e.setAttributeNS(null,"startOffset",qs(n.startOffset)),n?.textLength&&e.setAttributeNS(null,"textLength",qs(n.textLength)),r&&(e.textContent=r),n&&_r(e,n),n&&jr(e,n),e),Uh=(e,r,n,i,a)=>{const u=Cr(n,"text",a+"-text");Jo(u,void 0,void 0,i);const o=Cr(u,"textPath",a);return o.setAttributeNS(null,"href",e),jh(o,r,i)},Jo=(e,r,n,i)=>(r&&(e.setAttributeNS(null,"x",r.x.toString()),e.setAttributeNS(null,"y",r.y.toString())),n&&(e.textContent=n),i&&(_r(e,i),i&&jr(e,i),i.anchor&&e.setAttributeNS(null,"text-anchor",i.anchor),i.align&&e.setAttributeNS(null,"alignment-baseline",i.align),(i.userSelect??!0)||(e.style.userSelect="none",e.style.webkitUserSelect="none")),e),Vh=(e,r,n,i,a)=>{const u=Cr(r,"text",a);return Jo(u,n,e,i)},Hh=(e,r,n,i,a,u={})=>{u.strokeStyle||(u={...u,strokeStyle:el("bg-dim","silver")}),u.strokeWidth||(u={...u,strokeWidth:1});const o=Na("g");_r(o,u),Yo(o,u),jr(o,u);let s=0;for(;s<a;){const l=Ji(0,s,i,s);ia(l,o),s+=n}let c=0;for(;c<i;){const l=Ji(c,0,c,a);ia(l,o),c+=n}return e.appendChild(o),o},Cr=(e,r,n)=>{let i=null;if(n!==void 0&&(typeof n=="string"?i=e.querySelector(n):i=n),i===null){const a=document.createElementNS("http://www.w3.org/2000/svg",r);return e.appendChild(a),n&&typeof n=="string"&&n.startsWith("#")&&(a.id=n.substring(1)),a}return i},Gh=(e,r)=>{if(typeof r=="string"){const n=e.querySelector(r);if(n===null)return;n.remove()}else r.remove()},$D=e=>{let r=e.lastElementChild;for(;r;)e.removeChild(r),r=e.lastElementChild},Na=(e,r)=>{const n=document.createElementNS("http://www.w3.org/2000/svg",e);return r&&(n.id=r),n},Yo=(e,r)=>{r.markerEnd&&e.setAttribute("marker-end",ru(e,r.markerEnd)),r.markerStart&&e.setAttribute("marker-start",ru(e,r.markerStart)),r.markerMid&&e.setAttribute("marker-mid",ru(e,r.markerMid))},_r=(e,r)=>{r.fillStyle&&e.setAttributeNS(null,"fill",r.fillStyle),r.opacity&&e.setAttributeNS(null,"opacity",r.opacity.toString())},jr=(e,r)=>{r.strokeStyle&&e.setAttributeNS(null,"stroke",r.strokeStyle),r.strokeWidth&&e.setAttributeNS(null,"stroke-width",r.strokeWidth.toString()),r.strokeDash&&e.setAttribute("stroke-dasharray",r.strokeDash),r.strokeLineCap&&e.setAttribute("stroke-linecap",r.strokeLineCap)},TD=e=>{const r=e.getAttributeNS(null,"width"),n=r===null?0:parseFloat(r),i=e.getAttributeNS(null,"height"),a=i===null?0:parseFloat(i);return{width:n,height:a}},qD=(e,r)=>{e.setAttributeNS(null,"width",r.width.toString()),e.setAttributeNS(null,"height",r.height.toString())},jD=(e,r)=>(r&&(_r(e,r),jr(e,r)),{remove:i=>Gh(e,i),text:(i,a,u,o)=>Vh(i,e,a,u,o),textPath:(i,a,u,o)=>Uh(i,a,e,u,o),line:(i,a,u)=>ia(i,e,a,u),circle:(i,a,u)=>$h(i,e,a,u),path:(i,a,u)=>Oh(i,e,a,u),grid:(i,a,u,o,s)=>Hh(e,i,a,u,o,s),query:i=>e.querySelector(i),get width(){const i=e.getAttributeNS(null,"width");return i===null?0:parseFloat(i)},set width(i){e.setAttributeNS(null,"width",i.toString())},get parent(){return e},get height(){const i=e.getAttributeNS(null,"height");return i===null?0:parseFloat(i)},set height(i){e.setAttributeNS(null,"height",i.toString())},clear:()=>{for(;e.firstChild;)e.removeChild(e.lastChild)}}),xo={};ie(xo,{add:()=>Kh,calcScale:()=>Zo,defaultAxis:()=>Nu,draw:()=>_n,drawValue:()=>Jh,plot:()=>ZD});var UD=Math.PI*2,Nu=e=>({endWith:"none",lineWidth:1,namePosition:"none",name:e,showLabels:e==="y",showLine:!0,textSize:e==="y"?20:10}),Zo=(e,r,n)=>{const i=e.keys(),a=[];return i.forEach(u=>{const o=e.get(u);if(o===void 0)return;let{min:s,max:c}=ca(o),l=c-s,f;n!==void 0&&(f=n[u]),f==null&&(r.defaultSeriesVariable?f=yi.getCssVariable("accent",r.defaultSeriesColour):f=r.defaultSeriesColour),l===0&&(l=s,s=s-l/2,c=c+l/2),a.push({min:s,max:c,range:l,name:u,colour:f})}),a},Kh=(e,r,n="")=>{e.addKeyedValues(n,r)},Jh=(e,r,n)=>{const i={...n,translucentPlot:!0,leadingEdgeDot:!1};_n(r,i),n={...n,highlightIndex:e,leadingEdgeDot:!0,translucentPlot:!1,style:"none",clearCanvas:!1},_n(r,n)},VD=(e,r,n)=>Zo(e,n,n.seriesColours).map(i=>({...i,range:r[1]-r[0],min:r[0],max:r[1]})),_n=(e,r)=>{const{x:n,y:i,ctx:a,canvasSize:u}=r,o=r.margin,s=r.y.scaleRange?VD(e,r.y.scaleRange,r):Zo(e,r,r.seriesColours);r.clearCanvas&&a.clearRect(0,0,u.width,u.height),r.debug&&(a.strokeStyle="orange",a.strokeRect(0,0,u.width,u.height)),a.translate(o,o);const c=r.plotSize??xh(u,r),l={height:c.height+o+o,width:c.width};if((i.showLabels||i.showLine)&&(s.forEach(h=>{i.allowedSeries!==void 0&&!i.allowedSeries.includes(h.name)||HD(h,l,r)}),s.length>0&&i.showLine&&GD(l,s[0],r)),(n.showLabels||n.showLine)&&s.length>0){const h=i.labelRange?i.labelRange[0]:s[0].min;JD(c.width,en(h,s[0],c.height)+o+n.lineWidth,r)}const f={...r,plotSize:c};Ma.translatePoint(a,r.pointer),s.forEach(h=>{const g=e.getSource(h.name);if(g===void 0)return;let C=e.typeName==="circular"?g.pointer-1:g.length-1;r.highlightIndex!==void 0&&(C=r.highlightIndex),a.save(),a.translate(0,o+o),YD(h,g,c,f,C),a.restore()}),r.showLegend&&(a.save(),a.translate(0,c.height+o+o+o),c.width,r.x.textSize+o+o,KD(s,r),a.restore()),a.resetTransform()},HD=(e,r,n)=>{const{ctx:i,y:a,digitsPrecision:u,margin:o}=n,{height:s}=r;n.debug&&(i.strokeStyle="purple",i.strokeRect(0,0,a.textSize,s+o)),i.fillStyle=e.colour.length>0?e.colour:"white",a.colour&&(i.fillStyle=a.colour);const c=a.labelRange?a.labelRange[0]:e.min,l=a.labelRange?a.labelRange[1]:e.max,f=a.labelRange?l-c:e.range,h=c+f/2,g=n.textHeight/2;i.textBaseline="top",i.fillText(c.toFixed(u),0,en(c,e,s)-g),i.fillText(h.toFixed(u),0,en(h,e,s)-g),i.fillText(l.toFixed(u),0,en(l,e,s)-o),i.translate(a.textSize+o,0)},GD=(e,r,n)=>{if(r===void 0)throw new Error("series undefined");const{ctx:i,y:a}=n,{height:u}=e,o=a.labelRange?a.labelRange[0]:r.min,s=a.labelRange?a.labelRange[1]:r.max,c=en(o,r,u),l=en(s,r,u);i.translate(a.lineWidth,0),i.lineWidth=a.lineWidth,i.beginPath(),i.moveTo(0,c),i.lineTo(0,l),i.strokeStyle=r.colour,a.colour&&(i.strokeStyle=a.colour),i.stroke(),i.translate(a.lineWidth,0)},KD=(e,r,n)=>{const{ctx:i}=r,a=10;let u=0;const o=r.margin*3,s=r.margin;i.lineWidth=r.lineWidth,e.forEach(c=>{i.moveTo(u,o),i.strokeStyle=c.colour,i.lineTo(u+a,o),i.stroke(),u+=a+r.margin;let l=c.name;c.lastValue&&(l+=" "+c.lastValue.toFixed(r.digitsPrecision));const f=i.measureText(l);i.fillStyle=c.colour,i.fillText(l,u,s),u+=f.width})},JD=(e,r,n)=>{const{ctx:i,x:a,y:u}=n;!a.showLine||(a.colour&&(i.strokeStyle=a.colour),i.lineWidth=a.lineWidth,i.beginPath(),i.moveTo(0,r),i.lineTo(e,r),i.stroke())},YD=(e,r,n,i,a)=>{const{ctx:u,lineWidth:o,translucentPlot:s=!1,margin:c,x:l}=i,f=i.style??"connected",h=n.height-c;let g=1;if(l.scaleRange){const A=l.scaleRange[1]-l.scaleRange[0];g=n.width/A}else i.capacity===0?g=n.width/r.length:g=n.width/i.capacity;const C=i.coalesce&&g<0?Math.floor(1/g):1;let R=0,k;i.debug&&(u.strokeStyle="green",u.strokeRect(0,0,n.width,n.height));const z=A=>s?yi.opacity(A,.2):A;f==="dots"?u.fillStyle=z(e.colour):f==="none"||(u.beginPath(),u.lineWidth=o,u.strokeStyle=z(e.colour));for(let A=0;A<r.length;A+=C){let S=en(r[A],e,h)-1;f==="dots"?(u.beginPath(),u.arc(R,S,o,0,UD),u.fill()):f==="none"||(A==0&&u.moveTo(R,S),u.lineTo(R,S)),A===a&&(k={x:R,y:S},e.lastValue=r[A]),R+=g}f==="connected"&&u.stroke(),k!==void 0&&i.leadingEdgeDot&&(u.beginPath(),u.fillStyle=z(e.colour),u.arc(k.x,k.y,3,0,2*Math.PI),u.fill())},en=(e,r,n)=>(1-(e-r.min)/r.range)*n,Yh=(e,r,n,i)=>{let a=e;n.showLabels&&(a+=n.textSize),n.showLine&&(a+=n.lineWidth),(n.showLabels||n.showLine)&&(a+=e+e);let u=e,o=e+e,s=e+e;return r.showLabels?s+=r.textSize:s+=e,r.showLine&&(s+=r.lineWidth),(r.showLabels||r.showLine)&&(s+=e),i&&(s+=r.textSize),{left:a,right:u,top:o,bottom:s}},xh=(e,r)=>{const{width:n,height:i}=e,a=Yh(r.margin,r.x,r.y,r.showLegend);return{width:n-a.left-a.right,height:i-a.top-a.bottom}},xD=(e,r)=>{const{width:n,height:i}=e,a=Yh(r.margin,r.x,r.y,r.showLegend);return{width:n+a.left+a.right,height:i+a.top+a.bottom}},ZD=(e,r)=>{if(e===null)throw new Error("parentElOrQuery is null. Expected string or element");const n=ot(e);let i,a=!0,u=r.plotSize,o;n.nodeName==="CANVAS"?(i=n,a=!1,o={width:i.width,height:i.height}):(i=document.createElement("CANVAS"),n.append(i),u=r.plotSize,o={width:i.width,height:i.height});const s={x:0,y:0},c=A=>{s.x=A.offsetX,s.y=A.offsetY};i.addEventListener("pointermove",c);const l=i.getContext("2d"),f=r.capacity??10,h=f>0?cl({capacity:f}):sl(),g=l.measureText("Xy"),C=r.coalesce??!0;if(l===null)throw new Error("Drawing context not available");let R=Nu("x");r.x&&(R={...R,...r.x});let k=Nu("y");r.y&&(k={...k,...r.y});let z={...r,y:k,x:R,pointer:s,capacity:f,coalesce:C,plotSize:u,canvasSize:o,ctx:l,textHeight:r.textHeight??g.actualBoundingBoxAscent+g.actualBoundingBoxDescent,style:r.style??"connected",defaultSeriesColour:r.defaultSeriesColour??"yellow",margin:3,clearCanvas:!0,leadingEdgeDot:!0,debug:r.debug??!1,digitsPrecision:r.digitsPrecision??2,lineWidth:r.lineWidth??2,showLegend:r.showLegend??!1};if(u){const A=xD(u,z);i.width=A.width,i.height=A.height,z.canvasSize=A}return r.autoSizeCanvas&&Uo(i,A=>{const S=A.bounds;z={...z,plotSize:xh(S,z),canvasSize:S},_n(h,z)}),{drawValue:A=>{Jh(A,h,z)},dispose:()=>{i.removeEventListener("pointermove",c),a&&i.remove()},add:(A,S="",O=!1)=>{Kh(h,A,S),!O&&_n(h,z)},draw:()=>{_n(h,z)},clear:()=>{h.clear()}}},Xo={};ie(Xo,{AxisX:()=>id,AxisY:()=>ud,Legend:()=>nd,Plot:()=>tE,PlotArea:()=>rd,Series:()=>td});var Qo={};ie(Qo,{Box:()=>Xh,CanvasBox:()=>$n,CanvasMeasureState:()=>Qh,MeasureState:()=>Zh});var _i=(e,r)=>e.type==="px"&&r.type==="px"?e.value===r.value:!1,XD=(e,r)=>e===void 0&&r===void 0?!0:!(e===void 0||r===void 0||e.x&&r.x&&!_i(e.x,r.x)||e.y&&r.y&&!_i(e.y,r.y)||e.width&&r.width&&!_i(e.width,r.width)||e.height&&r.height&&!_i(e.height,r.height)),Zh=class{constructor(e){F(this,"bounds"),F(this,"pass"),F(this,"measurements"),this.bounds=e,this.pass=0,this.measurements=new Map}getSize(e){const r=this.measurements.get(e);if(r!==void 0&&!ci(r.size))return r.size}resolveToPx(e,r){if(e===void 0)return r;if(e.type==="px")return e.value;throw new Error(`Unknown unit type ${e.type}`)}},Xh=class{constructor(e,r){F(this,"visual",Cu),F(this,"_desiredSize"),F(this,"_lastMeasure"),F(this,"children",[]),F(this,"_parent"),F(this,"_idMap",new Map),F(this,"debugLayout",!1),F(this,"_visible",!0),F(this,"_ready",!0),F(this,"takesSpaceWhenInvisible",!1),F(this,"needsDrawing",!0),F(this,"_needsLayout",!0),F(this,"debugHue",ao()),F(this,"id"),this.id=r,this._parent=e,e?.onChildAdded(this)}hasChild(e){const r=this.children.find(i=>i===e),n=this.children.find(i=>i.id===e.id);return r!==void 0||n!==void 0}notify(e,r){this.onNotify(e,r),this.children.forEach(n=>n.notify(e,r))}onNotify(e,r){}onChildAdded(e){if(e.hasChild(this))throw new Error("Recursive");if(e===this)throw new Error("Cannot add self as child");if(this.hasChild(e))throw new Error("Child already present");this.children.push(e),this._idMap.set(e.id,e)}setReady(e,r=!1){this._ready=e,r&&this.children.forEach(n=>n.setReady(e,r))}get visible(){return this._visible}set visible(e){this._visible!==e&&(this._visible=e,this.onLayoutNeeded())}get desiredSize(){return this._desiredSize}set desiredSize(e){XD(e,this._desiredSize)||(this._desiredSize=e,this.onLayoutNeeded())}onLayoutNeeded(){this.notifyChildLayoutNeeded()}notifyChildLayoutNeeded(){this._needsLayout=!0,this.needsDrawing=!0,this._parent!==void 0?this._parent.notifyChildLayoutNeeded():this.update()}get root(){return this._parent===void 0?this:this._parent.root}measurePreflight(){}measureApply(e,r){let n=!0;return this._needsLayout=!1,Of(e.size,this.visual)&&(n=!1),Lt(e.size)?this.visual=e.size:this.visual={x:0,y:0,width:e.size.width,height:e.size.height},e.children.forEach(i=>{i!==void 0&&i.ref.measureApply(i,r)}),(n||r)&&(this.needsDrawing=!0,this.root.notify("measureApplied",this)),n}debugLog(e){console.log(this.id,e)}measureStart(e,r,n){this.measurePreflight();let i={ref:this,size:_o,children:[]};if(e.measurements.set(this.id,i),!this._visible&&!this.takesSpaceWhenInvisible)i.size=Wf;else{let a=this._lastMeasure;if((this._needsLayout||this._lastMeasure===void 0)&&(a=this.measureSelf(e,n),this.root.notify("measured",this)),a===void 0)return;i.size=a,this._lastMeasure=a}if(i.children=this.children.map(a=>a.measureStart(e,r,i)),!($t.without(i.children,void 0).length<this.children.length))return i}measureSelf(e,r){let n=Cu;if(r?r.size&&(n={x:0,y:0,width:r.size.width,height:r.size.height}):n={x:0,y:0,width:e.bounds.width,height:e.bounds.height},!ci(n))return n}updateDone(e,r){this.onUpdateDone(e,r),this.children.forEach(n=>n.updateDone(e,r))}update(e=!1){const r=this.updateBegin(e);let n=5,i=!1;for(;n--;){const a=this.measureStart(r,e);if(a!==void 0){if(this.measureApply(a,e),!this._ready)return;i=!0}}this.updateDone(r,e),i||console.warn("Ran out of measurement attempts")}},Qh=class extends Zh{constructor(e,r){super(e);F(this,"ctx"),this.ctx=r}},$n=class extends Xh{constructor(e,r,n){super(e,n);if(F(this,"canvasEl"),r===void 0)throw new Error("canvasEl undefined");if(r===null)throw new Error("canvasEl null");this.canvasEl=r,e===void 0&&this.designateRoot()}designateRoot(){this.canvasEl.addEventListener("pointermove",e=>{const r={x:e.offsetX,y:e.offsetY};this.notifyPointerMove(r)}),this.canvasEl.addEventListener("pointerleave",e=>{this.notifyPointerLeave()}),this.canvasEl.addEventListener("click",e=>{const r={x:e.offsetX,y:e.offsetY};this.notifyClick(r)})}onClick(e){}notifyClick(e){if(!ci(this.visual)&&xi(this.visual,e)){const r=U.subtract(e,this.visual.x,this.visual.y);this.onClick(r),this.children.forEach(n=>n.notifyClick(r))}}notifyPointerLeave(){this.onPointerLeave(),this.children.forEach(e=>e.notifyPointerLeave())}notifyPointerMove(e){if(!ci(this.visual)&&xi(this.visual,e)){const r=U.subtract(e,this.visual.x,this.visual.y);this.onPointerMove(r),this.children.forEach(n=>n.notifyPointerMove(r))}}onPointerLeave(){}onPointerMove(e){}updateBegin(){const e=this.canvasEl.getContext("2d");if(e===null)throw new Error("Context unavailable");const r=this.canvasEl.getBoundingClientRect();return new Qh({width:r.width,height:r.height},e)}onUpdateDone(e,r){if(!this.needsDrawing&&!r)return;const n=this.canvasEl.getContext("2d");if(n===null)throw new Error("Context unavailable");n.save(),n.translate(this.visual.x,this.visual.y);const i=this.visual;this.debugLayout&&(n.lineWidth=1,n.strokeStyle=`hsl(${this.debugHue}, 100%, 50%)`,n.strokeRect(0,0,i.width,i.height),n.fillStyle=n.strokeStyle,n.fillText(this.id,10,10,i.width),n.beginPath(),n.moveTo(0,0),n.lineTo(i.width,i.height),n.stroke()),this.drawSelf(n),this.needsDrawing=!1,n.restore()}drawSelf(e){}},ed=class{constructor(e){F(this,"data"),F(this,"series"),F(this,"dirty",!1),F(this,"type","array"),F(this,"_range"),this.series=e,this.data=[],this.dirty=!0}clear(){this.set([]),this._range=void 0}set(e){this.data=e,this.dirty=!0}get length(){return this.data.length}get range(){return!this.dirty&&this._range!==void 0?this._range:(this.dirty=!1,this._range=$t.minMaxAvg(this.data),{...this._range,changed:!0})}add(e){this.data=[...this.data,e],this.dirty=!0}},QD=class extends ed{constructor(e){super(e);F(this,"desiredDataPointMinWidth",5)}add(e){const r=this.series.lastPxPerPt;if(r>-1&&r<this.desiredDataPointMinWidth){const n=Math.floor(this.desiredDataPointMinWidth/r),i=[...this.data.slice(n),e];super.set(i)}else super.add(e)}},td=class{constructor(e,r,n,i){if(this.plot=n,F(this,"name"),F(this,"colour"),F(this,"source"),F(this,"drawingStyle"),F(this,"width",3),F(this,"dataHitPoint"),F(this,"tooltip"),F(this,"precision",2),F(this,"axisRange"),F(this,"lastPxPerPt",-1),F(this,"_visualRange"),F(this,"_visualRangeStretch"),this.name=e,this.drawingStyle=i.drawingStyle??"line",this.colour=i.colour,this.width=i.width??3,this.axisRange=i.axisRange??{min:Number.NaN,max:Number.NaN},this._visualRange={...this.axisRange},this._visualRangeStretch=i.visualRangeStretch??!0,r==="array")this.source=new ed(this);else if(r==="stream")this.source=new QD(this);else throw new Error("Unknown sourceType. Expected array|stream")}formatValue(e){return e.toFixed(this.precision)}get visualRange(){let e=this._visualRange;const r=this.source.range;let n=!1;if(r.changed)if(this._visualRangeStretch){const i=Math.min(vu(e.min,r.min),r.min),a=Math.max(vu(e.max,r.max),r.max);(i!==e.min||a!==e.max)&&(e={min:i,max:a},n=!0)}else ad(r,e)||(e=r,n=!0);return this._visualRange=e,{...e,changed:n}}scaleValue(e){if(this.source===void 0)return e;const r=this.visualRange;return r.min==r.max?.5:Er(e,r.min,r.max)}add(e){ae(e,"","value"),this.source.add(e),this.plot.plotArea.needsDrawing=!0}clear(){this.source.clear(),this._visualRange={...this.axisRange},this.plot.plotArea.needsDrawing=!0}},rd=class extends $n{constructor(e){super(e,e.canvasEl,"PlotArea");this.plot=e,F(this,"paddingPx",3),F(this,"piPi",Math.PI*2),F(this,"pointerDistanceThreshold",20),F(this,"lastRangeChange",0),F(this,"pointer")}clear(){this.lastRangeChange=0,this.pointer=void 0}measureSelf(e,r){const n=e.getSize("AxisY");if(n===void 0)return;const i=e.getSize("Legend");if(i===void 0)return;const a=e.getSize("AxisX");if(a!==void 0)return{x:n.width,y:0,width:e.bounds.width-n.width,height:e.bounds.height-i.height-a.height}}onNotify(e,r){e==="measureApplied"&&r===this.plot.axisY&&(this._needsLayout=!0),e==="measureApplied"&&r===this.plot.legend&&(this._needsLayout=!0)}onPointerLeave(){[...this.plot.series.values()].forEach(r=>{r.tooltip=void 0}),this.pointer=void 0,this.plot.legend.onLayoutNeeded()}onPointerMove(e){this.pointer=e,this.plot.legend.onLayoutNeeded()}measurePreflight(){this.updateTooltip()}updateTooltip(){const e=this.pointer;if(e===void 0)return;[...this.plot.series.values()].forEach(n=>{if(e===void 0){n.tooltip=void 0;return}if(n.dataHitPoint===void 0)return;const i=n.dataHitPoint(e);i[0]!==void 0&&(i[1]>this.pointerDistanceThreshold||(n.tooltip=n.formatValue(i[0].value)))}),this.plot.legend.needsDrawing=!0}drawSelf(e){if(this.plot.frozen)return;const r=this.plot.seriesArray();e.clearRect(0,0,this.visual.width,this.visual.height),r.forEach(n=>{if(n.source.type==="array"||n.source.type==="stream"){const i=n.source;if(i.data===void 0)return;const a=[...i.data];this.drawDataSet(n,a,e)}else console.warn(`Unknown data source type ${n.source.type}`)})}computeY(e,r){const n=e.scaleValue(r);return Ti(n)*this.visual.height+this.paddingPx}drawDataSet(e,r,n){const i=this.paddingPx+e.width,a=Ie.subtract(this.visual,i*2,i*3.5),u=a.width/r.length;e.lastPxPerPt=u;let o=i;n.strokeStyle=e.colour,n.lineWidth=e.width;const s=[];if(e.dataHitPoint=c=>{const l=s.map(g=>U.distanceToExterior(c,g)),f=wc(...l);return[s[f],l[f]]},e.drawingStyle==="line"){let c=0;n.beginPath();for(let l=0;l<r.length;l++){const f=Gt(e.scaleValue(r[l]));c=i+this.paddingPx+a.height*Ti(f),s.push({x:o,y:c,index:l,value:r[l]}),l==0?n.moveTo(o+u/2,c):n.lineTo(o+u/2,c),c>this.visual.height&&console.warn(c+" h: "+this.visual.height),o+=u}n.strokeStyle=e.colour,n.stroke()}else if(e.drawingStyle==="dotted"){let c=0;n.fillStyle=e.colour;for(let l=0;l<r.length;l++){const f=e.scaleValue(r[l]);c=i+a.height*Ti(f),n.beginPath(),n.arc(o+u/2,c,e.width,0,this.piPi),n.fill(),s.push({radius:e.width,x:o,y:c,index:l,value:r[l]}),o+=u}}else if(e.drawingStyle==="bar"){n.fillStyle=e.colour;const c=Math.ceil(u*.1);for(let l=0;l<r.length;l++){const f=e.scaleValue(r[l]),h=a.height*f,g={x:o+c,y:a.height-h+i,width:u-c,height:h,index:l,value:r[l]};n.fillRect(g.x,g.y,g.width,g.height),s.push(g),o+=u}}}},nd=class extends $n{constructor(e){super(e,e.canvasEl,"Legend");this.plot=e,F(this,"sampleSize",{width:10,height:10}),F(this,"padding",3),F(this,"widthSnapping",20)}clear(){}measureSelf(e,r){const n=e.measurements.get("AxisY"),i=this.sampleSize,a=this.widthSnapping,u=this.padding,o=e.ctx;if(n===void 0)return;const s=e.bounds.width-n.size.width,c=this.plot.seriesArray();let l=u;for(let g=0;g<c.length;g++)l+=i.width+u,l+=En(o,c[g].name,u,a),l+=En(o,c[g].tooltip,u,a);const h=Math.max(1,Math.ceil(l/s))*(this.sampleSize.height+this.padding+this.padding);return{x:n.size.width,y:e.bounds.height-h,width:s,height:h}}drawSelf(e){const r=this.plot.seriesArray(),n=this.sampleSize,i=this.padding,a=this.widthSnapping;let u=i,o=i;e.clearRect(0,0,this.visual.width,this.visual.height);for(let s=0;s<r.length;s++){const c=r[s];e.fillStyle=c.colour,e.fillRect(u,o,n.width,n.height),u+=n.width+i,e.textBaseline="middle",e.fillText(c.name,u,o+n.height/2),u+=En(e,c.name,i,a),c.tooltip&&(e.fillStyle=this.plot.axisColour,e.fillText(c.tooltip,u,o+n.height/2),u+=En(e,c.tooltip,i,a)),u+=i,u>this.visual.width-100&&(u=i,o+=n.height+i+i)}}onNotify(e,r){e==="measureApplied"&&r===this._parent.axisY&&(this._needsLayout=!0)}},id=class extends $n{constructor(e){super(e,e.canvasEl,"AxisX");this.plot=e,F(this,"paddingPx",2),F(this,"colour")}clear(){}onNotify(e,r){e==="measureApplied"&&r===this.plot.axisY&&(this._needsLayout=!0),e==="measureApplied"&&r===this.plot.legend&&this.onLayoutNeeded()}drawSelf(e){const r=this.plot,n=this.visual,i=r.axisWidth,a=this.colour??r.axisColour;e.strokeStyle=a,e.clearRect(0,0,n.width,n.height),e.beginPath(),e.lineWidth=i,e.moveTo(0,i/2),e.lineTo(n.width,i/2),e.stroke()}measureSelf(e,r){const n=this.plot,i=e.measurements.get("AxisY");if(i===void 0)return;const a=e.measurements.get("Legend");if(a===void 0)return;const u=n.axisWidth+this.paddingPx;return{x:i.size.width,y:e.bounds.height-u-a.size.height,width:e.bounds.width-i.size.width,height:u}}},ad=(e,r)=>e.max===r.max&&e.min===r.min,eE=e=>e.max===e.min,ud=class extends $n{constructor(e){super(e,e.canvasEl,"AxisY");this.plot=e,F(this,"_maxDigits",1),F(this,"seriesToShow"),F(this,"paddingPx",2),F(this,"colour"),F(this,"lastRange"),F(this,"lastPlotAreaHeight",0),this.lastRange={min:0,max:0}}clear(){this.lastRange={min:0,max:0},this.lastPlotAreaHeight=0}measurePreflight(){const e=this.getSeries();e!==void 0&&!ad(e.visualRange,this.lastRange)&&(this._needsLayout=!0,this.needsDrawing=!0)}onNotify(e,r){const n=this.plot.plotArea;e==="measureApplied"&&r===n&&n.visual.height!==this.lastPlotAreaHeight&&(this.lastPlotAreaHeight=n.visual.height,this.needsDrawing=!0)}measureSelf(e){const r=e,n=this.paddingPx;let i=this.plot.axisWidth+n;const a=this.getSeries();if(a!==void 0){const o=a.visualRange;this._maxDigits=Math.ceil(o.max).toString().length+a.precision+1;const s="9".repeat(this._maxDigits);i+=En(r.ctx,s,n*2)}const u=e.resolveToPx(this.desiredSize?.width,i);return{x:0,y:0,width:u,height:e.bounds.height}}drawSelf(e){const r=this.getSeries();if(r!==void 0)this.seriesAxis(r,e);else{if(this.seriesToShow===void 0)return;console.warn(`Plot AxisY series '${this.seriesToShow}' is missing.`)}}getSeries(){return this.seriesToShow===void 0?this.plot.seriesArray()[0]:this.plot.series.get(this.seriesToShow)}seriesAxis(e,r){const n=this.plot,i=n.plotArea,a=this.visual,u=this.paddingPx,o=e.visualRange,s=n.axisWidth,c=this.colour??n.axisColour;if(r.strokeStyle=c,r.fillStyle=c,Number.isNaN(o.min)&&Number.isNaN(o.max))return;this.lastRange=o,r.clearRect(0,0,a.width,a.height),r.beginPath(),r.lineWidth=s;const l=a.width-s/2;r.moveTo(l,i.paddingPx+s),r.lineTo(l,i.visual.height+s),r.stroke(),r.textBaseline="top";const f=a.width-u*4;eE(o)?nu(r,e.formatValue(o.max),h=>[f-h.width,i.computeY(e,o.max)-u*4]):(nu(r,e.formatValue(o.max),h=>[f-h.width,i.computeY(e,o.max)+s/2]),nu(r,e.formatValue(o.min),h=>[f-h.width,i.computeY(e,o.min)-5]))}},nu=(e,r,n)=>{const i=e.measureText(r),a=n(i);e.fillText(r,a[0],a[1])},tE=class extends $n{constructor(e,r={}){if(e===void 0)throw new Error("canvasEl undefined");super(void 0,e,"Plot");F(this,"plotArea"),F(this,"legend"),F(this,"axisX"),F(this,"axisY"),F(this,"axisColour"),F(this,"axisWidth"),F(this,"series"),F(this,"_frozen",!1),F(this,"defaultSeriesOpts"),r.autoSize&&Uo(e,n=>{this.update(!0)}),this.axisColour=r.axisColour??"black",this.axisWidth=r.axisWidth??3,this.series=new Map,this.plotArea=new rd(this),this.legend=new nd(this),this.axisX=new id(this),this.axisY=new ud(this)}clearSeries(){for(const e of this.series.values())e.clear()}clear(){this.series=new Map,this.plotArea.clear(),this.legend.clear(),this.axisX.clear(),this.axisY.clear(),this.update(!0)}get frozen(){return this._frozen}set frozen(e){this._frozen=e,e?(this.canvasEl.classList.add("frozen"),this.canvasEl.title="Plot frozen. Tap to unfreeze"):(this.canvasEl.title="",this.canvasEl.classList.remove("frozen"))}seriesArray(){return[...this.series.values()]}get seriesLength(){return this.series.size}plot(e){oo(e).forEach(n=>{let i=this.series.get(n);i===void 0&&(i=this.createSeries(n,"stream"),i.drawingStyle="line"),i.add(ha(e,n))})}createSeriesFromObject(e,r=""){const n=Object.keys(e),i=a=>{const u=e[a];return typeof u=="object"?this.createSeriesFromObject(u,r+a+"."):typeof u=="number"?[this.createSeries(a,"stream")]:[]};return n.flatMap(i)}createSeries(e,r="array",n){const i=this.seriesLength;if(e===void 0&&(e=`series-${i}`),this.series.has(e))throw new Error(`Series name '${e}' already in use`);let a={colour:`hsl(${i*25%360}, 70%,50%)`,...n};this.defaultSeriesOpts&&(a={...this.defaultSeriesOpts,...a});const u=new td(e,r,this,a);return this.series.set(e,u),this.setReady(!0,!0),this.plotArea.needsDrawing=!0,u}},es={};ie(es,{create:()=>rE});var rE=e=>new nE(e),Zn,Li,pn,Xn,nE=class{constructor(e){Oe(this,Zn,new Map),Oe(this,Li,new Map),F(this,"fallbacks"),Oe(this,pn,0),Oe(this,Xn,void 0),e!==void 0?this.fallbacks=e:this.fallbacks=["red","blue","green","orange"],Ce(this,Xn,document.body)}setElementBase(e){Ce(this,Xn,e)}add(e,r){J(this,Zn).set(e,r)}alias(e,r){J(this,Li).set(e,r)}get(e,r){const n=J(this,Li).get(e);n!==void 0&&(e=n);const i=J(this,Zn).get(e);if(i!==void 0)return i;const a="--"+e;let u=getComputedStyle(J(this,Xn)).getPropertyValue(a).trim();if(u===void 0||u.length===0){if(r!==void 0)return r;u=this.fallbacks[J(this,pn)],f0(this,pn)._++,J(this,pn)===this.fallbacks.length&&Ce(this,pn,0)}return u}getOrAdd(e,r){if(this.has(e))return this.get(e);const n=this.get(e,r);return this.add(e,n),n}has(e){return J(this,Zn).has(e)}};Zn=new WeakMap;Li=new WeakMap;pn=new WeakMap;Xn=new WeakMap;try{typeof window<"u"&&(window.ixfx={...window.ixfx,Visuals:{SceneGraph:Qo,Plot2:Xo,Drawing:Ma,Svg:Ko,Plot:xo,Palette:es,Colour:yi,Video:Lo}})}catch{}var iE={};ie(iE,{DragDrop:()=>fd,Forms:()=>od,canvasHelper:()=>vD,clear:()=>AD,copyToClipboard:()=>FD,createAfter:()=>wD,createIn:()=>DD,cycleCssClass:()=>mD,dataTable:()=>bD,dataTableList:()=>ED,defaultErrorHandler:()=>mE,fullSizeCanvas:()=>yD,fullSizeElement:()=>Sh,getTranslation:()=>pD,log:()=>uE,parentSize:()=>gD,parentSizeCanvas:()=>Uo,pointerVisualise:()=>yE,reconcileChildren:()=>SD,resizeObservable:()=>Vo,resolveEl:()=>ot,rx:()=>oE,themeChangeObservable:()=>CD,windowResize:()=>Ra});var aE=(e,r)=>{const n=document.createElement("style");n.textContent=r;let i;return e.shadowRoot?(i=e.shadowRoot,i.innerHTML=""):i=e.attachShadow({mode:"open"}),i.appendChild(n),i},uE=(e,r={})=>{const{capacity:n=0,monospaced:i=!0,timestamp:a=!1,collapseDuplicates:u=!0,css:o=""}=r;let s=0,c,l=0;const f=ot(e),g=aE(f,`
  .log {
    font-family: ${i?'Consolas, "Andale Mono WT", "Andale Mono", "Lucida Console", "Lucida Sans Typewriter", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Liberation Mono", Monaco, "Courier New", Courier, monospace':"normal"};
    background-color: var(--code-background-color);
    padding: var(--padding1, 0.2em);
    overflow-y: auto;
    height:100%;
  }
  .timestamp {
    margin-right: 0.5em;
    opacity: 0.5;
    font-size: 70%;
    align-self: center;
  }
  .line {
    display: flex;
    padding-bottom: 0.1em;
    padding-top: 0.1em;
  }
  .line:hover {
  
  }
  .error {
    color: red;
  }
  .badge {
    border: 1px solid currentColor;
    align-self: center;
    font-size: 70%;
    padding-left: 0.2em;
    padding-right: 0.2em;
    border-radius: 1em;
    margin-left: 0.5em;
    margin-right: 0.5em;
  }
  .msg {
    flex: 1;
    word-break: break-word;
  }
  ${o}
  `),C=document.createElement("div");C.className="log",g.append(C);const R=$=>{const _=document.createElement("div");if(typeof $=="string")_.innerHTML=$;else if($ instanceof Error){const I=$.stack;I===void 0?_.innerHTML=$.toString():_.innerHTML=I.toString()}else _.innerHTML=$;_.classList.add("error"),A(_),c=void 0,l=0};let k=0;const z=($="")=>{let _;const I=window.performance.now()-k;if(!(r.minIntervalMs&&I<r.minIntervalMs))if(k=window.performance.now(),typeof $=="object"?_=JSON.stringify($):$===void 0?_="(undefined)":$===null?_="(null)":typeof $=="number"?(Number.isNaN(_)&&(_="(NaN)"),_=$.toString()):_=$,_.length===0){const P=document.createElement("hr");c=void 0,A(P)}else if(_===c&&u){const P=C.firstElementChild;let V=P.querySelector(".badge");return V===null&&(V=document.createElement("div"),V.className="badge",P.insertAdjacentElement("beforeend",V)),P!==null&&(V.textContent=(++l).toString()),P}else{const P=document.createElement("div");return P.innerText=_,A(P),c=_,P}},A=$=>{if(a){const _=document.createElement("div"),I=document.createElement("div");I.className="timestamp",I.innerText=new Date().toLocaleTimeString(),_.append(I,$),$.classList.add("msg"),_.classList.add("line"),$=_}else $.classList.add("line","msg");if(r.reverse?C.appendChild($):C.insertBefore($,C.firstChild),n>0&&++s>n*2)for(;s>n;)C.lastChild?.remove(),s--;r.reverse&&(C.scrollTop=C.scrollHeight),l=0};return{error:R,log:z,append:A,clear:()=>{C.innerHTML="",c=void 0,l=0,s=0},dispose:()=>{C.remove()},get isEmpty(){return s===0}}},oE=(e,r,n)=>{const i=ot(e),a=ra(i,r),u={},o=()=>{Object.keys(u).forEach(l=>{delete u[l]})},s=c=>(c.subscribe({next:l=>{Object.assign(u,l)}}),{value:u,clear:o});return n===void 0?s(a):n.pluck?s(a.pipe(ta(c=>c[n.pluck]))):n.transform?s(a.pipe(ta(c=>n.transform(c)))):s(a)},od={};ie(od,{button:()=>fE,checkbox:()=>cE,numeric:()=>lE,select:()=>hE,textAreaKeyboard:()=>sE});var sE=e=>{e.addEventListener("keydown",r=>{const n=e.value,i=e.selectionStart,a=e.selectionEnd;if(r.key==="Tab"&&r.shiftKey)return e.value.substring(i-2,i)==="  "&&(e.value=n.substring(0,i-2)+n.substring(a)),e.selectionStart=e.selectionEnd=i-2,r.preventDefault(),!1;if(r.key==="Tab")return e.value=n.substring(0,i)+"  "+n.substring(a),e.selectionStart=e.selectionEnd=i+2,r.preventDefault(),!1})},cE=(e,r)=>{const n=ot(e);return r&&n.addEventListener("change",()=>{r(n.checked)}),{get checked(){return n.checked},set checked(i){n.checked=i}}},lE=(e,r,n)=>{const i=ot(e),a=n?"change":"input";return r&&i.addEventListener(a,()=>{r(parseInt(i.value))}),{get value(){return parseInt(i.value)},set value(u){i.value=u.toString()}}},fE=(e,r)=>{const n=ot(e);return r&&n.addEventListener("click",i=>{r()}),{click(){r&&r()},set disabled(i){n.disabled=i}}},hE=(e,r,n={})=>{const i=ot(e),{placeholderOpt:a,shouldAddChoosePlaceholder:u=!1,autoSelectAfterChoice:o=-1}=n,s=()=>{r!==void 0&&r(i.value),o>=0&&(i.selectedIndex=o)};return r&&i.addEventListener("change",c=>{s()}),{set disabled(c){i.disabled=c},get value(){return i.value},get index(){return i.selectedIndex},get isSelectedPlaceholder(){return(u||n.placeholderOpt!==void 0)&&i.selectedIndex===0},setOpts(c,l){i.options.length=0,u?c=["-- Choose --",...c]:a!==void 0&&(c=[a,...c]);let f=0;c.forEach((h,g)=>{const C=document.createElement("option");C.value=h,C.innerHTML=h,l!==void 0&&h===l&&(f=g),i.options.add(C)}),i.selectedIndex=f},select(c=0,l=!1){i.selectedIndex=c,l&&r&&s()}}},sd=class{constructor(e){F(this,"store"),F(this,"gog"),this.store=new Map,this.gog=Rc(this.store,e)}get size(){return this.store.size}has(e){return this.store.has(e)}async seen(e,...r){return(await this.getTrackedValue(e,...r)).seen(...r)}async getTrackedValue(e,...r){if(e===null)throw new Error("id parameter cannot be null");if(e===void 0)throw new Error("id parameter cannot be undefined");return await this.gog(e,r[0])}delete(e){this.store.delete(e)}reset(){this.store=new Map}*ids(){yield*this.store.keys()}*tracked(){yield*this.store.values()}*trackedByAge(){const e=Array.from(this.store.values());e.sort((r,n)=>{const i=r.elapsed,a=n.elapsed;return i===a?0:i>a?-1:1});for(const r of e)yield r}*valuesByAge(){for(const e of this.trackedByAge())yield e.last}*last(){for(const e of this.store.values())yield e.last}*initialValues(){for(const e of this.store.values())yield e.initial}get(e){return this.store.get(e)}},dE=class extends fo{constructor(e={}){super(e);F(this,"values"),this.values=[]}onTrimmed(){}trimStore(e){return e>=this.values.length?this.values.length:(this.values=this.values.slice(-e),this.values.length)}onReset(){this.values=[]}seenImpl(e){const r=e.map(i=>"at"in i?i:{...i,at:Date.now()}),n=r.at(-1);return this.storeIntermediate?this.values.push(...r):this.values.length===0?this.values.push(n):this.values.length===2?this.values[1]=n:this.values.length===1&&this.values.push(n),r}get last(){return this.values.length===1?this.values[0]:this.values.at(-1)}get initial(){return this.values.at(0)}get size(){return this.values.length}get elapsed(){return Date.now()-this.values[0].at}},ts=class extends dE{constructor(e={}){super(e);F(this,"initialRelation"),F(this,"lastResult")}onTrimmed(){this.initialRelation=void 0}get x(){return this.last.x}get y(){return this.last.y}onReset(){super.onReset(),this.lastResult=void 0,this.initialRelation=void 0}seen(...e){const r=this.last;super.seen(...e);const n=this.last;if(this.initialRelation===void 0&&this.initial)this.initialRelation=bu(this.initial);else if(this.initialRelation===void 0)throw new Error("Bug: No initialRelation, and this.inital is undefined?");const i=bu(r),a={...this.initialRelation(n)},u={...i(n),speed:this.values.length<2?0:it.length(r,n)/(n.at-r.at)},o={fromInitial:a,fromLast:u,values:[...this.values]};return this.lastResult=o,o}get line(){return this.values.length===1?[]:it.joinPointsToLines(...this.values)}get vectorPolar(){return Zi.fromLinePolar(this.lineStartEnd)}get vectorCartesian(){return Zi.fromLineCartesian(this.lineStartEnd)}get lineStartEnd(){const e=this.initial;return this.values.length<2||!e?it.Empty:{a:e,b:this.last}}distanceFromStart(){const e=this.initial;return this.values.length>=2&&e!==void 0?Kt(e,this.last):0}difference(){const e=this.initial;return this.values.length>=2&&e!==void 0?ln(this.last,e):Hl}angleFromStart(){const e=this.initial;if(e!==void 0&&this.values.length>2)return Cn(e,this.last)}get length(){if(this.values.length===1)return 0;const e=this.line;return it.length(e)}},cd=class extends sd{constructor(e={}){super((r,n)=>{if(n===void 0)throw new Error("Requires start point");const i=new ts({...e,id:r});return i.seen(n),i})}},ld=(e={})=>new cd(e),vE=(e={})=>new ts(e),yE=(e,r={})=>{const n=r.touchRadius??45,i=r.touchRadius??20,a=r.trace??!1,u=r.hue??100,o=`hsla(${u}, 100%, 10%, 10%)`;let s=u;const c=ot(e),l=ld({storeIntermediate:a}),f=document.createElementNS("http://www.w3.org/2000/svg","svg");f.id="pointerVis",f.style.zIndex="-1000",f.style.position="fixed",f.style.top="0",f.style.left="0",f.style.width="100%",f.style.height="100%",f.style.boxSizing="border-box",f.style.border="3px solid red",f.style.pointerEvents="none",f.style.touchAction="none",Sh(f);let h=0;const g=async R=>{const k=R.pointerId.toString();l.delete(k),s=u,f.querySelector(`#pv-start-${k}`)?.remove();for(let z=0;z<h+10;z++)f.querySelector(`#pv-progress-${k}-${z}`)?.remove();h=0},C=async R=>{const k=R.pointerId.toString(),z={x:R.x,y:R.y},A=R.pointerType;if(R.type==="pointermove"&&!l.has(k))return;const S=await l.seen(k,z);if(S.values.length===1){const _=na.circle({...S.values[0],radius:A==="touch"?n:i},f,{fillStyle:o},`#pv-start-${k}`);_.style.pointerEvents="none",_.style.touchAction="none"}const O=`hsla(${s}, 100%, 50%, 50%)`,$=na.circle({...z,radius:A==="touch"?n:i},f,{fillStyle:O},`#pv-progress-${k}-${S.values.length}`);return $.style.pointerEvents="none",$.style.touchAction="none",s+=1,h=S.values.length,!0};document.body.appendChild(f),c.addEventListener("pointerdown",C),c.addEventListener("pointermove",C),c.addEventListener("pointerup",g),c.addEventListener("pointerleave",g),c.addEventListener("contextmenu",R=>{R.preventDefault()})},mE=()=>{let e=!0;const r=document.createElement("div");r.style.color="black",r.style.border="2px solid red",r.style.backgroundColor="hsl(0, 80%, 90%)",r.style.padding="1em",r.style.display="none",r.style.top="1em",r.style.left="1em",r.style.position="absolute",r.style.fontFamily="monospace";const n=document.createElement("div");n.style.maxWidth="50vw",n.style.maxHeight="50vh",n.style.overflowY="scroll",r.innerHTML="<h1>Error</h1>",r.append(n);const i=c=>{c.style.padding="0.3em",c.style.marginTop="1em"},a=document.createElement("button");a.innerText="Close",a.onclick=()=>{s()};const u=document.createElement("button");u.innerText="Stop displaying errors",u.onclick=()=>{e=!1,s()},i(a),i(u),r.append(a),r.append(u),document.body.append(r);const o=c=>{r.style.display="inline",c.stack?n.innerHTML+=`<pre>${c.stack}</pre>`:n.innerHTML+=`<p>${c}</p>`},s=()=>{r.style.display="none"};return window.onerror=(c,l,f,h,g)=>{e&&(g?(console.log(g),o(g)):(console.log(c),o(c)))},window.addEventListener("unhandledrejection",c=>{console.log(c.reason),e&&o(c.reason)}),{show:o,hide:s}},fd={};ie(fd,{draggable:()=>gE});var gE=(e,r)=>{let n=U.Placeholder,i;const a=()=>{e.classList.contains("drag-sel")&&e.classList.remove("drag-sel")},u=h=>{e.classList.contains("drag-sel")?e.classList.remove("drag-sel"):e.classList.add("drag-sel"),h.stopPropagation()};e.ownerDocument.addEventListener("click",a),e.addEventListener("click",u);const o=()=>{e.classList.remove("drag-progress"),e.ownerDocument.removeEventListener("pointermove",c),e.ownerDocument.removeEventListener("pointerup",l),e.ownerDocument.removeEventListener("pointercancel",f)},s=()=>{console.log("drag dispose"),e.classList.contains("drag-progress")?f(null,"dispose"):o(),e.ownerDocument.removeEventListener("click",a),e.removeEventListener("click",u)},c=h=>{h.preventDefault(),h.stopPropagation();const C={delta:U.isPlaceholder(n)?{x:h.offsetX,y:h.offsetY}:{x:h.x-n.x,y:h.y-n.y},initial:n,token:i};typeof r.progress<"u"&&!r.progress(C)&&f(null,"discontinued")},l=h=>{o();const g={x:h.x-n.x,y:h.y-n.y},C={initial:n,token:i,delta:g};typeof r.success<"u"&&r.success(C)},f=(h,g="pointercancel")=>{o();const C={token:i,initial:n,delta:{x:-1,y:-1}};typeof r.abort<"u"&&r.abort(g,C)};return e.addEventListener("pointerdown",h=>{if(!e.classList.contains("drag-sel"))return;n={x:h.x,y:h.y};const C=typeof r.start<"u"?r.start():{allow:!0,token:i};!C.allow||(i=C.token,e.classList.add("drag-progress"),e.ownerDocument.addEventListener("pointermove",c),e.ownerDocument.addEventListener("pointerup",l),e.ownerDocument.addEventListener("pointercancel",f))}),s},pE={};ie(pE,{Easings:()=>xu,Forces:()=>ns,Oscillators:()=>us,adsr:()=>rs,adsrSample:()=>vd,defaultAdsrOpts:()=>dd,jitter:()=>bd,pingPong:()=>Tu,pingPongPercent:()=>Ys});var hd={};ie(hd,{adsr:()=>rs,adsrSample:()=>vd,defaultAdsrOpts:()=>dd});var dd=()=>({attackBend:-1,decayBend:-.3,releaseBend:-.3,peakLevel:1,initialLevel:0,sustainLevel:.6,releaseLevel:0,attackDuration:600,decayDuration:200,releaseDuration:800,shouldLoop:!1}),Dt,$i,mr,Gr,Nr,wE=class extends lr{constructor(e){super();Oe(this,Dt,void 0),Oe(this,$i,void 0),Oe(this,mr,void 0),Oe(this,Gr,void 0),Oe(this,Nr,void 0),F(this,"attackDuration"),F(this,"decayDuration"),F(this,"releaseDuration"),F(this,"decayDurationTotal"),F(this,"shouldLoop"),this.attackDuration=e.attackDuration??300,this.decayDuration=e.decayDuration??500,this.releaseDuration=e.releaseDuration??1e3,this.shouldLoop=e.shouldLoop??!1;const r={attack:["decay","release"],decay:["sustain","release"],sustain:["release"],release:["complete"],complete:null};Ce(this,Dt,new on("attack",r)),J(this,Dt).addEventListener("change",n=>{n.newState==="release"&&J(this,Nr)&&J(this,mr)?.reset(),super.fireEvent("change",n)}),J(this,Dt).addEventListener("stop",n=>{super.fireEvent("complete",n)}),Ce(this,$i,fr),Ce(this,Gr,Ce(this,Nr,!1)),this.decayDurationTotal=this.attackDuration+this.decayDuration}switchState(){if(J(this,mr)===void 0)return!1;let e=J(this,mr).elapsed;const r=J(this,Nr)&&!J(this,Gr);let n=!1;do switch(n=!1,J(this,Dt).state){case"attack":(e>this.attackDuration||r)&&(J(this,Dt).next(),n=!0);break;case"decay":(e>this.decayDurationTotal||r)&&(J(this,Dt).next(),n=!0);break;case"sustain":(!J(this,Gr)||r)&&(e=0,J(this,Dt).next(),J(this,mr)?.reset(),n=!0);break;case"release":e>this.releaseDuration&&(J(this,Dt).next(),n=!0);break;case"complete":this.shouldLoop&&this.trigger(J(this,Nr))}while(n);return n}computeRaw(e=!0){if(J(this,mr)===void 0)return[void 0,0,J(this,Dt).state];e&&this.switchState();const r=J(this,Dt).state,n=J(this,mr).elapsed;let i=0;const a=J(this,Dt).state;switch(a){case"attack":i=n/this.attackDuration;break;case"decay":i=(n-this.attackDuration)/this.decayDuration;break;case"sustain":i=1;break;case"release":i=Math.min(n/this.releaseDuration,1);break;case"complete":return[void 0,1,r];default:throw new Error(`State machine in unknown state: ${a}`)}return[a,i,r]}get isDone(){return J(this,Dt).isDone}onTrigger(){}trigger(e=!1){this.onTrigger(),J(this,Dt).reset(),Ce(this,mr,J(this,$i).call(this)),Ce(this,Gr,e),Ce(this,Nr,e)}compute(){}release(){this.isDone||!J(this,Nr)||(Ce(this,Gr,!1),this.compute())}};Dt=new WeakMap;$i=new WeakMap;mr=new WeakMap;Gr=new WeakMap;Nr=new WeakMap;var DE=class extends wE{constructor(e){super(e);F(this,"attackPath"),F(this,"decayPath"),F(this,"releasePath"),F(this,"initialLevel"),F(this,"peakLevel"),F(this,"releaseLevel"),F(this,"sustainLevel"),F(this,"attackBend"),F(this,"decayBend"),F(this,"releaseBend"),F(this,"initialLevelOverride"),F(this,"retrigger"),F(this,"releasedAt"),this.initialLevel=e.initialLevel??0,this.peakLevel=e.peakLevel??1,this.releaseLevel=e.releaseLevel??0,this.sustainLevel=e.sustainLevel??.75,this.retrigger=e.retrigger??!0,this.attackBend=e.attackBend??0,this.releaseBend=e.releaseBend??0,this.decayBend=e.decayBend??0;const r=1;this.attackPath=Wi(Fn({x:0,y:this.initialLevel},{x:r,y:this.peakLevel},-this.attackBend)),this.decayPath=Wi(Fn({x:0,y:this.peakLevel},{x:r,y:this.sustainLevel},-this.decayBend)),this.releasePath=Wi(Fn({x:0,y:this.sustainLevel},{x:r,y:this.releaseLevel},-this.releaseBend))}onTrigger(){if(this.initialLevelOverride=void 0,!this.retrigger){const[e,r,n]=this.compute();!Number.isNaN(r)&&r>0&&(this.initialLevelOverride=r)}}get value(){return this.compute(!0)[1]}compute(e=!0){const[r,n]=super.computeRaw(e);if(r===void 0)return[void 0,NaN,NaN];let i;switch(r){case"attack":i=this.attackPath.interpolate(n).y,this.initialLevelOverride!==void 0&&(i=Er(i,0,1,this.initialLevelOverride,1)),this.releasedAt=i;break;case"decay":i=this.decayPath.interpolate(n).y,this.releasedAt=i;break;case"sustain":i=this.sustainLevel,this.releasedAt=i;break;case"release":i=this.releasePath.interpolate(n).y,this.releasedAt!==void 0&&(i=Er(i,0,this.sustainLevel,0,this.releasedAt));break;case"complete":i=this.releaseLevel,this.releasedAt=void 0;break;default:throw new Error(`Unknown state: ${r}`)}return[r,i,n]}},rs=e=>new DE(e);async function*vd(e,r){if(e.shouldLoop)throw new Error("Cannot sample a looping envelope");const n=rs(e);for(n.trigger();;){await tn(r);const i=n.value;if(n.isDone)return;yield i}}var ns={};ie(ns,{accelerationForce:()=>SE,angleFromAccelerationForce:()=>gd,angleFromVelocityForce:()=>pd,angularForce:()=>md,apply:()=>FE,attractionForce:()=>AE,computeAccelerationToTarget:()=>wd,computeAttractionForce:()=>yd,computePositionFromAngle:()=>Dd,computePositionFromVelocity:()=>as,computeVelocity:()=>is,constrainBounce:()=>bE,guard:()=>EE,magnitudeForce:()=>_E,nullForce:()=>ME,orientationForce:()=>zE,pendulumForce:()=>BE,springForce:()=>RE,targetForce:()=>CE,velocityForce:()=>IE});var EE=(e,r="t")=>{if(e===void 0)throw new Error(`Parameter ${r} is undefined. Expected ForceAffected`);if(e===null)throw new Error(`Parameter ${r} is null. Expected ForceAffected`);if(typeof e!="object")throw new Error(`Parameter ${r} is type ${typeof e}. Expected object of shape ForceAffected`)},bE=(e={width:1,height:1},r=1)=>{const n=Su(e,"left"),i=Su(e,"right"),a=_u(e,"top"),u=_u(e,"bottom");return o=>{const s=as(o.position??U.Empty,o.velocity??U.Empty);let c=o.velocity??U.Empty,{x:l,y:f}=s;return l>i?(l=i,c=U.invert(U.multiply(c,r),"x")):l<n&&(l=n,c=U.invert(U.multiply(c,r),"x")),f>u?(f=u,c=U.multiply(U.invert(c,"y"),r)):s.y<a&&(f=a,c=U.invert(U.multiply(c,r),"y")),Object.freeze({...o,position:{x:l,y:f},velocity:c})}},AE=(e,r,n={})=>i=>{let a=i.acceleration??U.Empty;return e.forEach(u=>{if(u===i)return;const o=yd(u,i,r,n);a=U.sum(a,o)}),{...i,acceleration:a}},yd=(e,r,n,i={})=>{if(e.position===void 0)throw new Error("attractor.position not set");if(r.position===void 0)throw new Error("attractee.position not set");const a=i.min??.01,u=i.max??.7,o=U.normalise(U.subtract(e.position,r.position)),s=Gt(U.distance(o),a,u);return U.multiply(o,n*(e.mass??1)*(r.mass??1)/(s*s))},CE=(e,r={})=>i=>{const a=wd(e,i.position??{x:.5,y:.5},r);return{...i,acceleration:U.sum(i.acceleration??U.Empty,a)}},FE=(e,...r)=>{if(e===void 0)throw new Error("t parameter is undefined");r.forEach(u=>{u!=null&&(typeof u=="function"?e=u(e):e={...e,acceleration:U.sum(e.acceleration??U.Empty,u)})});const n=is(e.acceleration??U.Empty,e.velocity??U.Empty),i=as(e.position??U.Empty,n);return{...e,position:i,velocity:n,acceleration:U.Empty}},SE=(e,r="ignored")=>n=>Object.freeze({...n,acceleration:za(e,n,r)}),za=(e,r,n="ignored")=>{let i;if(n==="dampen")i=a=>U.divide(e,a,a);else if(n==="multiply")i=a=>U.multiply(e,a,a);else if(n==="ignored")i=a=>e;else throw new Error(`Unknown 'mass' parameter '${n}. Expected 'dampen', 'multiply' or 'ignored'`);return U.sum(r.acceleration??U.Empty,i(r.mass??1))},_E=(e,r="ignored")=>n=>{if(n.velocity===void 0)return n;const i=U.distance(U.normalise(n.velocity)),a=e*i*i,u=U.multiply(U.invert(n.velocity),a);return Object.freeze({...n,acceleration:za(u,n,r)})},ME=e=>e,IE=(e,r)=>{const n=U.pipeline(U.invert,i=>U.multiply(i,e));return i=>{if(i.velocity===void 0)return i;const a=n(i.velocity);return Object.freeze({...i,acceleration:za(a,i,r)})}},md=()=>e=>{const r=e.angularAcceleration??0,n=e.angularVelocity??0,i=e.angle??0,a=n+r,u=i+a;return Object.freeze({...e,angle:u,angularVelocity:a,angularAcceleration:0})},gd=(e=20)=>r=>{const n=r.acceleration??U.Empty;return Object.freeze({...r,angularAcceleration:n.x*e})},pd=(e=1)=>r=>{const n=U.angle(r.velocity??U.Empty);return Object.freeze({...r,angle:e<1?Nd(e,r.angle??0,n):n})},RE=(e,r=.5,n=2e-4,i=.999)=>a=>{const u=U.subtract(a.position??U.Empty,e),o=U.distance(u),s=Math.abs(r-o),c=U.pipelineApply(u,U.normalise,g=>U.multiply(g,-n*s)),l=za(c,a,"dampen"),f=is(l??U.Empty,a.velocity??U.Empty),h=U.multiply(f,i,i);return{...a,velocity:h,acceleration:U.Empty}},BE=(e={x:.5,y:0},r={})=>n=>{const i=r.length??U.distance(e,n.position??U.Empty),a=r.speed??.001,u=r.damping??.995;let o=n.angle;o===void 0&&(n.position?o=U.angle(e,n.position)-Math.PI/2:o=0);const s=-1*a/i*Math.sin(o),c=(n.angularVelocity??0)+s;return o+=c,Object.freeze({angularVelocity:c*u,angle:o,position:Dd(i,o+Math.PI/2,e)})},is=(e,r,n)=>{const i=U.sum(r,e);return n!==void 0?U.clampMagnitude(i,n):i},wd=(e,r,n={})=>{const i=n.diminishBy??.001,a=U.subtract(e,r);return n.range&&U.compare(U.abs(a),n.range)===-2?U.Empty:U.multiply(a,i)},as=(e,r)=>U.sum(e,r),Dd=(e,r,n)=>dt.toCartesian(e,r,n),PE=md(),NE=gd(),zE=(e=.5)=>{const r=pd(e);return n=>(n=PE(n),n=NE(n),n=r(n),n)},us={};ie(us,{saw:()=>TE,sine:()=>kE,sineBipolar:()=>LE,spring:()=>OE,square:()=>qE,triangle:()=>$E});var Ed=Math.PI*2,WE=(e={},r=0,n=1)=>{const i=e.mass??1,a=e.stiffness??100,u=e.soft??!1,o=e.damping??10,s=e.velocity??.1,c=n-r;if(u===!0||1<=o/(2*Math.sqrt(a*i))){const l=-Math.sqrt(a/i),f=-l*c-s;return h=>n-(c+h*f)*Math.E**(h*l)}else{const l=Math.sqrt(4*i*a-o**2),f=(o*c-2*i*s)/l,h=.5*l/i,g=-(.5*o)/i;return C=>n-(Math.cos(C*h)*c+Math.sin(C*h)*f)*Math.E**(C*g)}};function*OE(e={},r){r===void 0?r=fr():typeof r=="number"&&(r=Fr(r));const n=WE(e,0,1);let i=e.countdown??10;for(;i>0;){const a=n(r.elapsed/1e3);yield a,a===1?i--:i=100}}function*kE(e){for(typeof e=="number"&&(e=Fr(e));;)yield(Math.sin(e.elapsed*Ed)+1)/2}function*LE(e){for(typeof e=="number"&&(e=Fr(e));;)yield Math.sin(e.elapsed*Ed)}function*$E(e){for(typeof e=="number"&&(e=Fr(e));;){let r=e.elapsed;r<.5?r*=2:r=2-r*2,yield r}}function*TE(e){for(typeof e=="number"&&(e=Fr(e));;)yield e.elapsed}function*qE(e){for(typeof e=="number"&&(e=Fr(e));;)yield e.elapsed<.5?0:1}var bd=(e,r,n={})=>{const i=n.type??"abs",a=n.clamped??!0,u=n.random??Zt;ae(e,a?"percentage":"bipolar","value"),ae(r,a?"percentage":"bipolar","jitter");let o;if(i==="rel"){r=e*r;const s=r*2*u();o=e-r+s}else if(i==="abs"){const s=r*2*u();o=e-r+s}else throw new Error(`Unknown jitter type: ${i}.`);return a?Gt(o):o};try{typeof window<"u"&&(window.ixfx={...window.ixfx,Modulation:{Forces:ns,jitter:bd,Envelopes:hd,Oscillators:us,Easings:xu}})}catch{}var Et,wn,Ad=class extends lr{constructor(e=void 0){super();Oe(this,Et,void 0),Oe(this,wn,void 0),Ce(this,Et,new Map),e===void 0&&(e=r=>{if(r===void 0)throw new Error("Cannot create key for undefined");return typeof r=="string"?r:JSON.stringify(r)}),Ce(this,wn,e)}clear(){J(this,Et).clear(),this.fireEvent("change",void 0)}keys(){return J(this,Et).keys()}values(){return J(this,Et).values()}toArray(){return Array.from(J(this,Et).entries())}debugString(){let e="";for(const[r,n]of J(this,Et).entries())e+=`${r}: ${n}, `;return e.endsWith(", ")?e.substring(0,e.length-2):e}frequencyOf(e){if(typeof e=="string")return J(this,Et).get(e);const r=J(this,wn).call(this,e);return J(this,Et).get(r)}relativeFrequencyOf(e){let r;if(typeof e=="string")r=J(this,Et).get(e);else{const i=J(this,wn).call(this,e);r=J(this,Et).get(i)}if(r===void 0)return;const n=this.minMaxAvg();return r/n.total}entries(){return Array.from(J(this,Et).entries())}minMaxAvg(){return dc.minMaxAvg(this.entries())}entriesSorted(e="value"){return jd(e)(this.entries())}add(...e){if(e===void 0)throw new Error("value parameter is undefined");e.map(J(this,wn)).forEach(n=>{const i=J(this,Et).get(n)??0;J(this,Et).set(n,i+1)}),this.fireEvent("change",void 0)}};Et=new WeakMap;wn=new WeakMap;var jE=e=>new Ad(e),Cd=(e=3)=>{ke(e,"aboveZero","scaling");let r=0,n=0,i=!1;return{dispose(){i=!0},get isDisposed(){return i},add(u){if(i)throw new Error("MovingAverage disposed, cannot add");return n++,r=r+(u-r)/Math.min(n,e),r},clear(){if(i)throw new Error("MovingAverage disposed, cannot clear");r=0,n=0},compute(){return r}}},UE=(e=200,r=0,n=3)=>{ke(n,"aboveZero","scaling"),ke(e,"aboveZero","decayRateMs");const i=Cd(n);let a=0;const u=()=>{a!==0&&clearTimeout(a),a=setTimeout(o,e)},o=()=>{i.add(r),i.isDisposed||setTimeout(o,e)};return{add(c){return u(),i.add(c)},dispose(){i.dispose()},clear:function(){i.clear()},compute:function(){return i.compute()},isDisposed:!1}},VE=(e=100,r)=>{let n=!1,i=Pn({capacity:e,discardPolicy:"older"});const a=()=>{i=Pn({capacity:e,discardPolicy:"older"})},u=()=>r===void 0?$t.average(i.data):$t.averageWeighted(i.data,r);return{add:c=>(i.enqueue(c),u()),compute:u,clear:a,dispose:()=>{n=!0},isDisposed:n}},Fd=class extends ho{constructor(){super(...arguments);F(this,"lastMark",0)}mark(){this.lastMark>0&&this.seen(window.performance.now()-this.lastMark),this.lastMark=window.performance.now()}},HE=e=>new Fd(e),Ti=e=>(typeof e=="function"&&(e=e()),ae(e,"percentage","v"),1-e),Sd=(e,r=0,n=360)=>(ke(e,void 0,"v"),ke(r,void 0,"min"),ke(n,void 0,"max"),e===r||e===n?r:(e>0&&e<r&&(e+=r),e-=r,n-=r,e=e%n,e<0&&(e=n-Math.abs(e)+r),e+r)),aa=(e,r=0,n=1)=>{if(ae(e,"","min"),ae(r,"","min"),ae(n,"","max"),e===r||e===n)return r;for(;(e<=r||e>=n)&&!(e===n||e===r);)e>n?e=r+(e-n):e<r&&(e=n-(r-e));return e},GE=(e,r,n,i,a)=>{let u=0;const o=Math.abs(a-i),s=Math.abs(r-i+a),c=Math.abs(i+(360-a)),l=Math.min(o,s,c);return l===c?u=i-n(l):l===s?u=i+n(l):i>a?u=i-n(l):u=i+n(l),Sd(u,e,r)},_d={};ie(_d,{align:()=>Md,alignById:()=>JE});var KE=(e,r)=>e.score>r.score?-1:e.score<r.score?1:0,Md=(e,r,n,i={})=>{const a=i.matchThreshold??0,u=i.debug??!1,o=new Map,s=[],c=new Map;r?.forEach((l,f)=>{if(l===void 0)throw new Error(`'lastData' contains undefined (index: ${f})`);c.set(l.id,l)});for(let l=0;l<n.length;l++){const f=n[l];if(!r||r.length===0){u&&console.debug(`Correlate.align() new id: ${f.id}`),s.push(f);continue}const h=Array.from(c.values()).map(C=>({id:C.id,score:C===null?-1:e(C,f),last:C}));if(h.length===0){u&&console.debug(`Correlate.align() no valid last values id: ${f.id}`),s.push(f);continue}h.sort(KE);const g=h[0];if(g.score<a){u&&console.debug(`Correlate.align() new item does not reach threshold. Top score: ${g.score} id: ${f.id}`),s.push(f);continue}u&&g.id!==f.id&&console.log(`Correlate.align() Remapped ${f.id} -> ${g.id} (score: ${g.score})`),o.set(g.id,{...f,id:g.id}),c.delete(g.id)}return s.forEach(l=>o.set(l.id,l)),Array.from(o.values())},JE=(e,r={})=>{let n=[];return a=>(n=Md(e,n,a,r),[...n])},Id={};ie(Id,{Pool:()=>Pd,PoolUser:()=>Rd,Resource:()=>Bd,create:()=>YE});var Rd=class extends lr{constructor(e,r){super();this.key=e,this.resource=r,F(this,"_lastUpdate"),F(this,"_pool"),F(this,"_state"),F(this,"_userExpireAfterMs"),this._lastUpdate=performance.now(),this._pool=r.pool,this._userExpireAfterMs=this._pool.userExpireAfterMs,this._state="idle",this._pool.log.log(`PoolUser ctor key: ${this.key}`)}toString(){return this.isDisposed?"PoolUser. State: disposed":`PoolUser. State: ${this._state} Elapsed: ${performance.now()-this._lastUpdate} Data: ${JSON.stringify(this.resource.data)}`}keepAlive(){if(this._state==="disposed")throw new Error("PoolItem disposed");this._lastUpdate=performance.now()}_dispose(e){if(this._state==="disposed")return;const r=this.resource,n=r.data;this._state="disposed",r._release(this),this._pool.log.log(`PoolUser dispose key: ${this.key} reason: ${e}`),this.fireEvent("disposed",{data:n,reason:e}),super.clearEventListeners()}release(e){if(this.isDisposed)throw new Error("User disposed");const n=this.resource.data;this._pool.log.log(`PoolUser release key: ${this.key} reason: ${e}`),this.fireEvent("released",{data:n,reason:e}),this._dispose(`release-${e}`)}get data(){if(this.isDisposed)throw new Error("User disposed");return this.resource.data}get isExpired(){return this._userExpireAfterMs>0?performance.now()>this._lastUpdate+this._userExpireAfterMs:!1}get elapsed(){return performance.now()-this._lastUpdate}get isDisposed(){return this._state==="disposed"}get isValid(){return!(this.isDisposed||this.isExpired||this.resource.isDisposed)}},Bd=class{constructor(e,r){this.pool=e,F(this,"state"),F(this,"_data"),F(this,"users"),F(this,"capacityPerResource"),F(this,"resourcesWithoutUserExpireAfterMs"),F(this,"lastUsersChange"),this._data=r,this.lastUsersChange=0,this.resourcesWithoutUserExpireAfterMs=e.resourcesWithoutUserExpireAfterMs,this.capacityPerResource=e.capacityPerResource,this.users=[],this.state="idle"}get data(){if(this.state==="disposed")throw new Error("Resource disposed");return this._data}toString(){return`Resource (expired: ${this.isExpiredFromUsers} users: ${this.users.length}, state: ${this.state}) data: ${JSON.stringify(this.data)}`}_assign(e){if(this.users.find(n=>n===e||n.key===e.key))throw new Error("User instance already assigned to resource");this.users.push(e),this.lastUsersChange=performance.now()}_release(e){this.users=this.users.filter(r=>r!==e),this.pool._release(e),this.lastUsersChange=performance.now()}get hasUserCapacity(){return this.usersCount<this.capacityPerResource}get usersCount(){return this.users.length}get isExpiredFromUsers(){return this.resourcesWithoutUserExpireAfterMs<=0||this.users.length>0?!1:performance.now()>this.resourcesWithoutUserExpireAfterMs+this.lastUsersChange}get isDisposed(){return this.state==="disposed"}dispose(e){if(this.state==="disposed")return;const r=this._data;this.state="disposed",this.pool.log.log(`Resource disposed (${e})`);for(const n of this.users)n._dispose(`resource-${e}`);this.users=[],this.lastUsersChange=performance.now(),this.pool._releaseResource(this,e),this.pool.freeResource&&this.pool.freeResource(r)}},Pd=class{constructor(e={}){F(this,"_resources"),F(this,"_users"),F(this,"capacity"),F(this,"userExpireAfterMs"),F(this,"resourcesWithoutUserExpireAfterMs"),F(this,"capacityPerResource"),F(this,"fullPolicy"),F(this,"generateResource"),F(this,"freeResource"),F(this,"log"),this.capacity=e.capacity??-1,this.fullPolicy=e.fullPolicy??"error",this.capacityPerResource=e.capacityPerResource??1,this.userExpireAfterMs=e.userExpireAfterMs??-1,this.resourcesWithoutUserExpireAfterMs=e.resourcesWithoutUserExpireAfterMs??-1,this.generateResource=e.generate,this.freeResource=e.free,this._users=new Map,this._resources=[],this.log=rl("Pool",e.debug??!1);const r=Math.max(this.userExpireAfterMs,this.resourcesWithoutUserExpireAfterMs);r>0&&setInterval(()=>{this.maintain()},r*1.1)}dumpToString(){let e=`Pool
    capacity: ${this.capacity} userExpireAfterMs: ${this.userExpireAfterMs} capacityPerResource: ${this.capacityPerResource}
    resources count: ${this._resources.length}`;const r=this._resources.map(n=>n.toString()).join(`\r
	`);e+=`\r
Resources:\r
	`+r,e+=`\r
Users: \r
`;for(const[n,i]of this._users.entries())e+=`	k: ${n} v: ${i.toString()}\r
`;return e}getUsersByLongestElapsed(){return[...this._users.values()].sort((e,r)=>{const n=e.elapsed,i=r.elapsed;return n===i?0:n<i?1:-1})}getResourcesSortedByUse(){return[...this._resources].sort((e,r)=>e.usersCount===r.usersCount?0:e.usersCount<r.usersCount?-1:1)}addResource(e){if(e===void 0)throw new Error("Cannot add undefined resource");if(e===null)throw new Error("Cannot add null resource");if(this.capacity>0&&this._resources.length===this.capacity)throw new Error(`Capacity limit (${this.capacity}) reached. Cannot add more.`);this.log.log(`Adding resource: ${JSON.stringify(e)}`);const r=new Bd(this,e);return this._resources.push(r),r}maintain(){let e=!1;const r=[];for(const i of this._resources)i.isDisposed?(this.log.log(`Maintain, disposed resource: ${JSON.stringify(i.data)}`),r.push(i)):i.isExpiredFromUsers&&(this.log.log(`Maintain, expired resource: ${JSON.stringify(i.data)}`),r.push(i));if(r.length>0){for(const i of r)i.dispose("diposed/expired");e=!0}const n=[];for(const[i,a]of this._users.entries())a.isValid||(this.log.log(`Maintain. Invalid user: ${a.key} (Disposed: ${a.isDisposed} Expired: ${a.isExpired} Resource disposed: ${a.resource.isDisposed})`),n.push(i),a._dispose("invalid"));for(const i of n)this._users.delete(i),e=!0;e&&this.log.log(`End: resource len: ${this._resources.length} users: ${this.usersLength}`)}*resources(){const e=[...this._resources];for(const r of e)yield r}*values(){const e=[...this._resources];for(const r of e)yield r.data}release(e,r){const n=this._users.get(e);!n||n.release(r??"Pool.release")}_release(e){this._users.delete(e.key)}_releaseResource(e,r){this._resources=this._resources.filter(n=>n!==e)}hasResource(e){return this._resources.find(n=>n.data===e)!==void 0}hasUser(e){return this._users.has(e)}_assign(e,r){const n=new Rd(e,r);return this._users.set(e,n),r._assign(n),n}_findUser(e){const r=this.getResourcesSortedByUse();if(r.length>0&&r[0].hasUserCapacity)return this.log.log(`resource has capacity: ${r[0].data}`),this._assign(e,r[0]);if(this.generateResource&&(this.capacity<0||this._resources.length<this.capacity)){this.log.log(`capacity: ${this.capacity} resources: ${this._resources.length}`);const n=this.addResource(this.generateResource());return this._assign(e,n)}}get usersLength(){return[...this._users.values()].length}useValue(e){return this.use(e).resource.data}use(e){const r=this._users.get(e);if(r)return r.keepAlive(),r;this.maintain();const n=this._findUser(e);if(n)return n;if(this.fullPolicy==="error")throw console.log(this.dumpToString()),new Error(`Pool is fully used (fullPolicy: ${this.fullPolicy}, capacity: ${this.capacity})`);if(this.fullPolicy==="evictOldestUser"){const i=this.getUsersByLongestElapsed();if(i.length>0){this.release(i[0].key,"evictedOldestUser");const a=this._findUser(e);if(a)return a}}throw new Error(`Pool is fully used (${this.fullPolicy})`)}},YE=(e={})=>new Pd(e),zu=Math.PI*2,os=(e,r,n)=>(1-e)*r+e*n,Nd=(e,r,n)=>{const i=aa(n-r,0,zu);return os(e,r,r+(i>Math.PI?i-zu:i))},Qn=Math.sqrt,Ge=Math.pow,js=Math.cos,Kr=Math.PI,Yn=Math.sin,xE=function(e,r){return zd(e,r,fr)},ZE=function(e,r){return zd(e,r,oa)},zd=function(e,r,n){let i;if(typeof e=="function"?i=e:i=Wa(e),i===void 0)throw new Error(`Easing function not found: ${e}`);const a=sn(r,n(),!0);return{get isDone(){return a.isDone},compute:()=>{const u=a.elapsed;return i(u)},reset:()=>{a.reset()}}},XE=(e,r)=>n=>{const i=1-n,a=i*i,u=n*n,o=u*n;return 3*e*a*n+3*r*i*u+o},Wd=(e,r,n,i)=>os(r,n(e),i(e)),QE=(e,r,n)=>Wd(e,e,r,n),Wa=function(e){if(e===null)throw new Error("easingName is null");if(e===void 0)throw new Error("easingName is undefined");const r=e.toLocaleLowerCase(),n=Object.entries(ss).find(([i,a])=>i.toLocaleLowerCase()===r);return n===void 0?n:n[1]},eb=function(){return Array.from(Object.keys(ss))},Od=(e=.4)=>{const r=1/Qn(2*Kr),n=.5;return i=>{const a=r/e;let u=-2.5,o=(i-n)/e;o*=o,u*=o;const s=a*Ge(Math.E,u);return s>1?1:s<0?0:s}},Mi=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},tb=e=>e*e*e*e*e,rb=e=>1-Ge(1-e,5),nb=e=>e*(1-e)*4,ss={arch:nb,bell:Od(),sineIn:e=>1-js(e*Kr/2),sineOut:e=>Yn(e*Kr/2),quadIn:e=>e*e,quadOut:e=>1-(1-e)*(1-e),sineInOut:e=>-(js(Kr*e)-1)/2,quadInOut:e=>e<.5?2*e*e:1-Ge(-2*e+2,2)/2,cubicIn:e=>e*e*e,cubicOut:e=>1-Ge(1-e,3),quartIn:e=>e*e*e*e,quartOut:e=>1-Ge(1-e,4),quintIn:tb,quintOut:rb,expoIn:e=>e===0?0:Ge(2,10*e-10),expoOut:e=>e===1?1:1-Ge(2,-10*e),quintInOut:e=>e<.5?16*e*e*e*e*e:1-Ge(-2*e+2,5)/2,expoInOut:e=>e===0?0:e===1?1:e<.5?Ge(2,20*e-10)/2:(2-Ge(2,-20*e+10))/2,circIn:e=>1-Qn(1-Ge(e,2)),circOut:e=>Qn(1-Ge(e-1,2)),backIn:e=>2.70158*e*e*e-1.70158*e*e,backOut:e=>1+2.70158*Ge(e-1,3)+1.70158*Ge(e-1,2),circInOut:e=>e<.5?(1-Qn(1-Ge(2*e,2)))/2:(Qn(1-Ge(-2*e+2,2))+1)/2,backInOut:e=>{const n=2.5949095;return e<.5?Ge(2*e,2)*((n+1)*2*e-n)/2:(Ge(2*e-2,2)*((n+1)*(e*2-2)+n)+2)/2},elasticIn:e=>{const r=2*Kr/3;return e===0?0:e===1?1:-Ge(2,10*e-10)*Yn((e*10-10.75)*r)},elasticOut:e=>{const r=2*Kr/3;return e===0?0:e===1?1:Ge(2,-10*e)*Yn((e*10-.75)*r)+1},bounceIn:e=>1-Mi(1-e),bounceOut:Mi,elasticInOut:e=>{const r=2*Kr/4.5;return e===0?0:e===1?1:e<.5?-(Ge(2,20*e-10)*Yn((20*e-11.125)*r))/2:Ge(2,-20*e+10)*Yn((20*e-11.125)*r)/2+1},bounceInOut:e=>e<.5?(1-Mi(1-2*e))/2:(1+Mi(2*e-1))/2},Zt=Math.random,kd=(e="quadIn",r=Zt)=>{const n=r(),i=Wa(e);if(i===void 0)throw new Error(`Easing function '${e}' not found.`);return i(n)},ib=(e="quadIn",r=Zt)=>()=>kd(e,r),ab=(e,r,n,i=Zt)=>{ae(e);let a,u,o;if(o="quadIn",a=0,r===void 0)u=e;else if(typeof r=="number")a=e,u=r,n!==void 0&&(o=n);else if(typeof r=="string")u=e,o=r;else throw new Error(`Unexpected value type for maxOrEasing: ${r}`);n!==void 0&&(o=n);const s=Wa(o);if(s===void 0)throw new Error(`Easing '${o}' not found`);if(ae(a),u<=a)throw new Error("Max should be greater than min");const c=Gt(s(i()));return Math.floor(c*(u-a))+a},cs=(e=1)=>{let i=0,a=0;for(;i===0;)i=Math.random();for(;a===0;)a=Math.random();let u=Math.sqrt(-2*Math.log(i))*Math.cos(2*Math.PI*a);return u=u/10+.5,u>1||u<0?u=cs(e):(u=Math.pow(u,e),u*=1-0,u+=0),u},ub=(e=1)=>()=>cs(e),ob=(e,r)=>{let n=!1;r===void 0&&(e<0&&(e=Math.abs(e),n=!0),r=0);const i=e-r,a=Math.floor(Math.random()*i)+r;return n?-a:a},sb=(e=1,r=0)=>Math.random()*(e-r)+r,ls=e=>Math.random().toString(36).substring(2,e+2),cb=()=>{const e=Math.random()*46656|0,r=Math.random()*46656|0,n=`000${e.toString(36)}`.slice(-3),i=`000${r.toString(36)}`.slice(-3);return n+i},Tn=(e,r="?")=>{if(e===void 0)throw new Error(`Param '${r}' is undefined. Expected array.`);if(e===null)throw new Error(`Param '${r}' is null. Expected array.`);if(!Array.isArray(e))throw new Error(`Param '${r}' not an array as expected`)},ua=(e,r,n="index")=>{if(Tn(e),ke(r,"positive",n),r>e.length-1)throw new Error(`'${n}' ${r} beyond array max of ${e.length-1}`)},fs=(e,r)=>{if(!Array.isArray(e))throw new Error("Param 'array' is not an array.");if(e.length===0)return!0;const n=r===void 0?al:r,i=e[0];return!e.some(u=>!n(i,u))},lb=(e,r,n=cn)=>e.filter(i=>r.some(a=>n(i,a))),fb=e=>Array.prototype.concat.apply([],[...e]),Ld=(...e)=>{if(e.some(a=>!Array.isArray(a)))throw new Error("All parameters must be an array");const r=e.map(a=>a.length);if(!fs(r))throw new Error("Arrays must be of same length");const n=[],i=r[0];for(let a=0;a<i;a++)n.push(e.map(u=>u[a]));return n},hb=(...e)=>{if(e.some(a=>!Array.isArray(a)))throw new Error("All parameters must be an array");const r=e.map(a=>a.length);if(!fs(r))throw new Error("Arrays must be of same length");const n=[],i=r[0];for(let a=0;a<i;a++)for(let u=0;u<e.length;u++)n.push(e[u][a]);return n},db=(e,r,n="undefined")=>{if(e===void 0)throw new Error("Data undefined");if(!Array.isArray(e))throw new Error("data is not an array");if(e.length===r)return[...e];if(e.length>r)return e.slice(0,r);const i=[...e],a=r-i.length;for(let u=0;u<a;u++)n==="undefined"?i.push(void 0):n==="repeat"?i.push(e[u%e.length]):n==="first"?i.push(e[0]):n==="last"&&i.push(e[e.length-1]);return i},$d=(e,r,n,i)=>{Tn(e),typeof n>"u"&&(n=0),typeof i>"u"&&(i=e.length-1),ua(e,n,"startIndex"),ua(e,i,"endIndex");const a=[];for(let u=n;u<=i;u++)r(e[u],u,e)&&a.push(e[u]);return a},hs=(e,r=Zt)=>Math.floor(r()*e.length),ds=(e,r=Zt)=>(Tn(e,"array"),e[Math.floor(r()*e.length)]),vb=(e,r=!1,n=Zt)=>{if(e===void 0)throw new Error("array is undefined");if(!Array.isArray(e))throw new Error("'array' param is not an array");if(e.length===0)return{value:void 0,array:[]};const i=hs(e,n);if(r)return{value:e[i],array:e.splice(i,1)};{const a=[...e];return a.splice(i,1),{value:e[i],array:a}}},yb=(e,r=Zt)=>{const n=[...e];for(let i=n.length-1;i>0;i--){const a=Math.floor(r()*(i+1));[n[i],n[a]]=[n[a],n[i]]}return n},mb=(e,r)=>[...e].sort((n,i)=>{Tn(e,"data");const a=n[r],u=i[r];return a<u?-1:a>u?1:0}),Td=(e,r,n=cn)=>e.filter(i=>!n(i,r)),gb=(e,r,n)=>{const i=[];let a=n;for(let u=0;u<e.length;u++){const[o,s]=r(e[u],a);if(o)break;a=s,i.push(e[u])}return i},pb=(e,r)=>{if(!Array.isArray(e))throw new Error("'data' parameter should be an array");return ua(e,r,"index"),[...e.slice(0,r),...e.slice(r+1)]},wb=(e,r)=>e.reduce((n,i)=>{const a=r(i),u=n.get(a);return u===void 0?n.set(a,[i]):u.push(i),n},new Map),Db=(e,r)=>{let n=1;if(r<=1){const a=e.length*r;n=Math.round(e.length/a)}else n=r;if(ke(n,"positive","amount"),n>e.length-1)throw new Error("Subsample steps exceeds array length");const i=[];for(let a=n-1;a<e.length;a+=n)i.push(e[a]);return i};function Eb(e,r){const n=[];for(let i=0;i<e.length;i+=r)n.push(e.slice(i,i+r));return n}var bb=(e,r,...n)=>{const i=new Map;for(const a of n)for(const u of a){if(u===void 0)continue;const o=e(u);let s=i.get(o);s?s=r(s,u):s=u,i.set(o,s)}return[...i.values()]},Ab=(e,r,n)=>{if(Tn(e,"arr"),e.length<2)return n;for(let i=0;i<e.length-1;i++)n=r(n,e[i],e[i+1]);return n},Cb=(e,r,n)=>{const i=n??cn,a=[...e];for(const u of r)a.find(s=>i(s,u))||a.push(u);return a},Fb=(e=!1)=>(0,Yu.pipe)(e?(0,Mn.reverse)(qi.Ord):qi.Ord,(0,Mn.contramap)(r=>r[0])),qd=(e=!1)=>(0,Yu.pipe)(e?(0,Mn.reverse)(qi.Ord):qi.Ord,(0,Mn.contramap)(r=>r[1])),Sb=(e=!1)=>(0,Yu.pipe)(e?(0,Mn.reverse)(ys.Ord):ys.Ord,(0,Mn.contramap)(r=>r[1])),Wu=(e=!1)=>(0,Ju.sort)(Fb(e)),_b=(e=!1)=>(0,Ju.sort)(qd(e)),Ou=(e=!1)=>(0,Ju.sort)(Sb(e)),jd=e=>{switch(e){case"value":return Ou(!1);case"valueReverse":return Ou(!0);case"key":return Wu(!1);case"keyReverse":return Wu(!0);default:throw new Error(`Unknown sorting value '${e}'. Expecting: value, valueReverse, key or keyReverse`)}},Mb=(e,r)=>{r===void 0&&(r=i=>i[1]);const n=e.map(r);return ca(n)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */export{Ov as $,$t as A,gi as B,yi as C,Ma as D,xu as E,od as F,b0 as G,br as H,Lu as I,Wr as J,wD as K,it as L,DD as M,vc as N,us as O,xo as P,ml as Q,ll as R,na as S,Ib as T,Oe as U,Zi as V,Ce as W,jd as X,J as Y,jE as Z,F as _,rs as a,hE as a0,fE as a1,on as a2,es as b,FD as c,dd as d,Cv as e,Fr as f,Uu as g,Ev as h,kd as i,bd as j,cs as k,uE as l,Hu as m,Io as n,bo as o,jD as p,U as q,ot as r,Fa as s,CD as t,Fc as u,fd as v,ab as w,dt as x,Xu as y,Ko as z};
