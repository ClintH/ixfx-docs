import{r as g,b as q,D as de,f as ue,p as fe,c as S,w as H,d as pe,e as j}from"./chunk-IHDSSOYZ.47df1e9b.js";import{_ as T,f as F,c as V}from"./chunk-7KTY42OF.629611b4.js";import{ac as L,ad as D,ae as me,af as B,l as z,ag as O,ah as I,ai as R,aj as A,ak as _,al as he,am as ve,an as ge,ao as ye,U as be,ap as we,aq as xe,ar as Ee}from"./chunk-V24WECPW.c3e6523e.js";var U={};T(U,{button:()=>W,buttonCreate:()=>ke,checkbox:()=>Le,numeric:()=>Ce,select:()=>Te,textAreaKeyboard:()=>Se});var Se=e=>{e.addEventListener("keydown",t=>{const n=e.value,r=e.selectionStart,s=e.selectionEnd;if(t.key==="Tab"&&t.shiftKey)return e.value.substring(r-2,r)==="  "&&(e.value=n.slice(0,Math.max(0,r-2))+n.slice(Math.max(0,s))),e.selectionStart=e.selectionEnd=r-2,t.preventDefault(),!1;if(t.key==="Tab")return e.value=n.slice(0,Math.max(0,r))+"  "+n.slice(Math.max(0,s)),e.selectionStart=e.selectionEnd=r+2,t.preventDefault(),!1})},Le=(e,t)=>{const n=g(e);return t&&n.addEventListener("change",()=>{t(n.checked)}),{get checked(){return n.checked},set checked(r){n.checked=r}}},Ce=(e,t,n)=>{const r=g(e),s=n?"change":"input";return t&&r.addEventListener(s,()=>{t(Number.parseInt(r.value))}),{get value(){return Number.parseInt(r.value)},set value(o){r.value=o.toString()}}},W=(e,t)=>{const n=g(e),r=()=>{t&&n.addEventListener("click",t)},s=()=>{t&&n.removeEventListener("click",t)};return r(),{get title(){return n.textContent},set title(o){n.textContent=o},dispose(o=!1){s(),o&&n.remove()},onClick(o){s(),t=o,r()},click(){t&&t()},set disabled(o){n.disabled=o},get el(){return n}}},ke=(e,t)=>{const n=document.createElement("button"),r=W(n,t);return r.title=e,r},Te=(e,t,n={})=>{const r=g(e),{placeholderOpt:s,shouldAddChoosePlaceholder:o=!1,autoSelectAfterChoice:i=-1}=n,d=()=>{t!==void 0&&t(r.value),i>=0&&(r.selectedIndex=i)};return t&&r.addEventListener("change",a=>{d()}),{set disabled(a){r.disabled=a},get value(){return r.value},get index(){return r.selectedIndex},get isSelectedPlaceholder(){return(o||n.placeholderOpt!==void 0)&&r.selectedIndex===0},setOpts(a,l){r.options.length=0,o?a=["-- Choose --",...a]:s!==void 0&&(a=[s,...a]);let c=0;for(const[u,p]of a.entries()){const f=document.createElement("option");f.value=p,f.innerHTML=p,l!==void 0&&p===l&&(c=u),r.options.add(f)}r.selectedIndex=c},select(a=0,l=!1){r.selectedIndex=a,l&&t&&d()}}},Ae={};T(Ae,{DataDisplay:()=>Ye,DataTable:()=>ne,DragDrop:()=>le,Forms:()=>U,Rx:()=>de,Variables:()=>ce,byId:()=>Ve,canvasHelper:()=>st,cardinalPosition:()=>De,clear:()=>_e,copyToClipboard:()=>qe,createAfter:()=>ze,createIn:()=>Ie,cycleCssClass:()=>Pe,defaultErrorHandler:()=>Ze,el:()=>Oe,elRequery:()=>Be,fullSizeCanvas:()=>ue,fullSizeElement:()=>ae,getTranslation:()=>je,inlineConsole:()=>tt,insertSorted:()=>He,log:()=>Y,parentSize:()=>Ge,parentSizeCanvas:()=>fe,pointScaler:()=>X,pointerVisualise:()=>Qe,positionFn:()=>J,positionFromMiddle:()=>$e,positionRelative:()=>Ne,query:()=>$,reconcileChildren:()=>Fe,resolveEl:()=>g,resolveEls:()=>S,setCssClass:()=>G,setCssDisplay:()=>Z,setCssToggle:()=>Q,setHtml:()=>ee,setText:()=>te,viewportToSpace:()=>K});var Me=(e,t)=>{const n=document.createElement("style");n.textContent=t;let r;return e.shadowRoot?(r=e.shadowRoot,r.innerHTML=""):r=e.attachShadow({mode:"open"}),r.append(n),r},Y=(e,t={})=>{const{capacity:n=0,monospaced:r=!0,timestamp:s=!1,collapseDuplicates:o=!0,css:i=""}=t;let d=0,a,l=0;const c=g(e),p=Me(c,`
  .log {
    font-family: ${r?'Consolas, "Andale Mono WT", "Andale Mono", "Lucida Console", "Lucida Sans Typewriter", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Liberation Mono", Monaco, "Courier New", Courier, monospace':"normal"};
    background-color: var(--code-background-color);
    padding: var(--padding1, 0.2em);
    overflow-y: auto;
    height:100%;
  }
  .timestamp {
    margin-right: 0.5em;
    opacity: 0.5;
    font-size: 70%;
    align-self: center;
  }
  .line {
    display: flex;
    padding-bottom: 0.1em;
    padding-top: 0.1em;
  }
  .line:hover {
  
  }
  .error {
    color: red;
  }
  .badge {
    border: 1px solid currentColor;
    align-self: center;
    font-size: 70%;
    padding-left: 0.2em;
    padding-right: 0.2em;
    border-radius: 1em;
    margin-left: 0.5em;
    margin-right: 0.5em;
  }
  .msg {
    flex: 1;
    word-break: break-word;
  }
  ${i}
  `),f=document.createElement("div");f.className="log",p.append(f);const v=m=>{const h=document.createElement("div");if(typeof m=="string")h.innerHTML=m;else if(m instanceof Error){const x=m.stack;h.innerHTML=x===void 0?m.toString():x.toString()}else h.innerHTML=m;h.classList.add("error"),w(h),a=void 0,l=0};let y=0;const E=(m="")=>{const h=C(m);return h&&(h.classList.add("warning"),h)},C=(m="")=>{let h;const x=window.performance.now()-y;if(!(t.minIntervalMs&&x<t.minIntervalMs))if(y=window.performance.now(),typeof m=="object"?h=JSON.stringify(m):m===void 0?h="(undefined)":m===null?h="(null)":typeof m=="number"?(Number.isNaN(h)&&(h="(NaN)"),h=m.toString()):h=m,h.length===0){const b=document.createElement("hr");a=void 0,w(b)}else if(h===a&&o){const b=f.firstElementChild;let k=b.querySelector(".badge");return k===null&&(k=document.createElement("div"),k.className="badge",b.insertAdjacentElement("beforeend",k)),b!==null&&(k.textContent=(++l).toString()),b}else{const b=document.createElement("div");return b.textContent=h,w(b),a=h,b}},w=m=>{if(s){const h=document.createElement("div"),x=document.createElement("div");x.className="timestamp",x.textContent=new Date().toLocaleTimeString(),h.append(x,m),m.classList.add("msg"),h.classList.add("line"),m=h}else m.classList.add("line","msg");if(t.reverse?f.append(m):f.insertBefore(m,f.firstChild),n>0&&++d>n*2)for(;d>n;)f.lastChild?.remove(),d--;t.reverse&&(f.scrollTop=f.scrollHeight),l=0};return{error:v,log:C,warn:E,append:w,clear:()=>{f.innerHTML="",a=void 0,l=0,d=0},dispose:()=>{f.remove()},get isEmpty(){return d===0}}},Re=F(q(),1),X=(e="viewport")=>{switch(e){case"viewport":return(t,n)=>{const r=L(t,n);return Object.freeze({x:r.x/window.innerWidth,y:r.y/window.innerHeight})};case"screen":return(t,n)=>{const r=L(t,n);return Object.freeze({x:r.x/screen.width,y:r.y/screen.height})};case"document":return(t,n)=>{const r=L(t,n);return Object.freeze({x:r.x/document.body.scrollWidth,y:r.y/document.body.scrollHeight})};default:throw new Error(`Unknown 'reference' parameter: ${JSON.stringify(e)}`)}},J=(e,t={})=>{const n=t.target??"viewport",r=t.relative??!1,s=t.anchor??"nw",o=g(e),i=K(n);if(r){const d=X(n);return()=>d(i(D(o.getBoundingClientRect(),s)))}else return()=>i(D(o.getBoundingClientRect(),s))},De=(e,t="nw")=>{const n=g(e);return D(n.getBoundingClientRect(),t)},Ne=(e,t="viewport")=>J(e,{relative:!0,target:t})(),K=(e="viewport")=>{switch(e){case"screen":return(t,n)=>{const r=L(t,n);return Object.freeze({x:r.x+window.screenX,y:r.y+window.screenY})};case"document":return(t,n)=>{const r=L(t,n);return Object.freeze({x:r.x+window.scrollX,y:r.y+window.scrollY})};case"viewport":return(t,n)=>{const r=L(t,n);return Object.freeze({x:r.x,y:r.y})};default:throw new Error(`Unexpected target coordinate space: ${e}. Expected: viewport, document or screen`)}},$e=(e,t,n="window")=>{if(!e)throw new Error("domQueryOrEl is null or undefined");const r=g(e),s=me(t,window.innerWidth,window.innerHeight),o=r.getBoundingClientRect(),i=B(s,o.width/2,o.height/2);r.style.transform=`translate(${i.x}px, ${i.y}px)`},Pe=(e,t)=>{if(!(e===null||!e)){if(!Array.isArray(t))throw new TypeError("List should be an array of strings");for(let n=0;n<t.length;n++)if(e.classList.contains(t[n])){e.classList.remove(t[n]),n+1<t.length?e.classList.add(t[n+1]):e.classList.add(t[0]);return}e.classList.add(t[0])}},je=e=>{const t=g(e),r=window.getComputedStyle(t).transform;if(r==="none"||typeof r>"u")return{x:0,y:0,z:0};const s=r.includes("3d")?"3d":"2d",o=r.match(/matrix.*\((.+)\)/)[1].split(", ");return s==="2d"?{x:Number.parseFloat(o[4]),y:Number.parseFloat(o[5]),z:0}:s==="3d"?{x:Number.parseFloat(o[12]),y:Number.parseFloat(o[13]),z:Number.parseFloat(o[14])}:{x:0,y:0,z:0}},ze=(e,t)=>{const n=document.createElement(t);return e.parentElement?.insertBefore(n,e.nextSibling),n},Ie=(e,t)=>{const n=document.createElement(t);return e.append(n),n},_e=e=>{let t=e.lastElementChild;for(;t;)t.remove(),t=e.lastElementChild},qe=e=>new Promise((n,r)=>{const s=Re.default.stringify(e);navigator.clipboard.writeText(JSON.stringify(s)).then(()=>{n(!0)},o=>{console.warn("Could not copy to clipboard"),console.log(s),r(new Error(o))})}),He=(e,t)=>{const n=t.getAttribute("data-sort")??"";let r,s;for(const o of e.children){const i=o.getAttribute("data-sort")??"";if(n>=i&&(r=o),n<=i&&(s=o),r!==void 0&&s!==void 0)break}r!==void 0?r.insertAdjacentElement("afterend",t):s===void 0?e.append(t):s.insertAdjacentElement("beforebegin",t)},Fe=(e,t,n)=>{if(e===null)throw new Error("parentEl is null");if(e===void 0)throw new Error("parentEl is undefined");const r=new Set;for(const[o,i]of t){const d=`c-${o}`,a=e.querySelector(`#${d}`),l=n(i,a);a!==l&&(l.id=d,e.append(l)),r.add(d)}const s=[];for(const o of e.children)r.has(o.id)||s.push(o);for(const o of s)o.remove()},G=(e,t,n)=>{const r=S(e);if(r.length!==0)for(const s of r)t?s.classList.add(n):s.classList.remove(n)},Q=(e,t)=>{const n=S(e);if(n.length!==0)for(const r of n)r.classList.toggle(t)},Z=(e,t)=>{const n=S(e);if(n.length!==0)for(const r of n)r.style.display=t},Ve=e=>{const t=document.getElementById(e);if(t===null)throw new Error(`HTML element with id '${e}' not found`);return t},ee=(e,t)=>{const n=S(e);if(n.length!==0){typeof t=="number"&&(t=t.toString());for(const r of n)r.innerHTML=t}},te=(e,t)=>{const n=S(e);if(n.length!==0){typeof t=="number"&&(t=t.toString());for(const r of n)r.textContent=t}},Be=e=>{},Oe=e=>{const t=S(e);return{text:n=>{te(t,n)},html:n=>{ee(t,n)},cssDisplay:n=>{Z(t,n)},cssClass:(n,r)=>{G(t,n,r)},cssToggle:n=>{Q(t,n)},el:()=>t[0],els:()=>t}},ne={};T(ne,{fromList:()=>We,fromObject:()=>oe});var re=F(q(),1),Ue=(e,t)=>{if(e===null)return"(null)";if(e===void 0)return"(undefined)";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return`"${e}"`;if(typeof e=="number"){let n=e;return t.roundNumbers!==void 0&&(n=Ee(t.roundNumbers,e)),t.precision!==void 0?n.toFixed(t.precision):n.toString()}return typeof e=="object"?se(e,t):re.default.stringify(e)},se=(e,t)=>{let n='<div style="display:grid; grid-template-columns: repeat(2, 1fr)">';for(const r of Object.entries(e)){const s=Ue(r[1],t);n+=`<div class="label" style="display:table-cell">${r[0]}</div>
      <div class="data" style="display:table-cell">${s}</div>`}return n+="</div>",n},We=(e,t)=>{const n=g(e);let r=document.createElement("DIV");n.append(r);const s=()=>r?(r.remove(),r=void 0,!0):!1,o=i=>{const d=new Set;for(const[l,c]of i){const u=`table-${l}`;d.add(u);let p=n.querySelector(`#${u}`);if(p===null){if(p=document.createElement("table"),!p)throw new Error("Could not create table element");p.id=u,n.append(p)}N(p,c)}const a=Array.from(n.querySelectorAll("table"));for(const l of a)d.has(l.id)||l.remove()};return t&&o(t),{update:o,remove:s}},N=(e,t,n={})=>{const r=n.precision??2,s=n.idPrefix??"",o=n.objectsAsTables??!1;if(t===void 0){e.innerHTML="";return}const i=new Set;for(const[a,l]of Object.entries(t)){const c=`${s}-row-${a}`;i.add(c);let u=e.querySelector(`tr[data-key='${c}']`);if(u===null){u=document.createElement("tr"),e.append(u),u.setAttribute("data-key",c);const v=document.createElement("td");v.textContent=a,v.classList.add("label"),u.append(v)}let p=u.querySelector(`td[data-key='${c}-val']`);p===null&&(p=document.createElement("td"),p.classList.add("data"),p.setAttribute("data-key",`${c}-val`),u.append(p));let f;n.formatter&&(f=n.formatter(l,a)),f===void 0&&(typeof l=="object"?f=o?se(l,n):re.default.stringify(l):typeof l=="number"?f=n.roundNumbers?Math.round(l).toString():l.toFixed(r):typeof l=="boolean"?f=l?"true":"false":typeof l=="string"?f=`"${l}"`:f=JSON.stringify(l)),p.innerHTML=f}const d=Array.from(e.querySelectorAll("tr"));for(const a of d){const l=a.getAttribute("data-key");i.has(l)||a.remove()}},oe=(e,t,n)=>{const r=g(e),s=n?.idPrefix??Math.floor(Math.random()*1e3).toString();let o=document.createElement("table");r.append(o);const i=()=>o?(o.remove(),o=void 0,!0):!1;return t&&N(o,t,n),{remove:i,update:a=>{if(!o)throw new Error("Table disposed");N(o,a,{...n,idPrefix:s})}}},Ye=class{dataTable;constructor(e={}){const t=e.theme??"dark";if(document.querySelector("#ixfx-data-display")!==null)throw new Error("DataDisplay already loaded on this page");const r=document.createElement("div");r.id="ixfx-data-display",r.classList.add(`theme-${t}`);const s=document.createElement("style");s.textContent=`
    #ixfx-data-display {
      background: white;
      color: black;
      border: 2px solid hsl(0deg 0.61% 90%);
      border-radius: 4px;
      z-index: 1000;
      opacity: 40%;
      padding: 1em;
      font-family: monospace;
      position: fixed;
      right: 1em;
      top: 1em;
    }
    #ixfx-data-display.theme-dark {
      background: black;
      color: white;
      border: 2px solid hsl(0deg 0.61% 10%);
    }
    #ixfx-data-display:hover {
      opacity: 100%;
    }
    #ixfx-data-display table {
      border-collapse: collapse;
    }
    #ixfx-data-display tr:not(:last-child) {
      border-bottom: 2px solid hsl(0deg 0.61% 90%);
    }
    #ixfx-data-display.dark tr:not(:last-child) {
      border-bottom: 2px solid hsl(0deg 0.61% 10%);
    }
    #ixfx-data-display td {
      padding-bottom: 0.4em;
      padding-top: 0.4em;
    }
    #ixfx-data-display .label {
      color: hsl(0deg 0.61% 60%);
      text-align: right;
      padding-right: 0.5em;
    }
    #ixfx-data-display.theme-dark .label {
      color: gray;
    }
    `,r.style.display="inline-block",document.body.append(s),document.body.append(r),this.dataTable=oe(r,void 0,{objectsAsTables:!0,roundNumbers:2})}update(e){this.dataTable.update(e)}},Xe=class extends we{values;constructor(e={}){super(e);this.values=[]}onTrimmed(){}trimStore(e){return e>=this.values.length?this.values.length:(this.values=this.values.slice(-e),this.values.length)}onReset(){this.values=[]}filterData(e){const t=e.map(r=>"at"in r?r:{...r,at:Date.now()}),n=t.at(-1);if(this.storeIntermediate)this.values.push(...t);else switch(this.values.length){case 0:{this.values.push(n);break}case 1:{this.values.push(n);break}case 2:{this.values[1]=n;break}}return t}get last(){return this.values.length===1?this.values[0]:this.values.at(-1)}get initial(){return this.values.at(0)}get size(){return this.values.length}get elapsed(){return Date.now()-this.values[0].at}},ie=class extends Xe{initialRelation;lastResult;constructor(e={}){super(e)}onTrimmed(){this.initialRelation=void 0}get x(){return this.last.x}get y(){return this.last.y}onReset(){super.onReset(),this.lastResult=void 0,this.initialRelation=void 0}seenEvent(e){if("getCoalescedEvents"in e){const n=e.getCoalescedEvents().map(r=>({x:r.clientX,y:r.clientY}));return this.seen(...n)}else return this.seen({x:e.clientX,y:e.clientY})}computeResults(e){const t=this.last,n=this.values.at(-2);if(this.initialRelation===void 0&&this.initial)this.initialRelation=R(this.initial);else if(this.initialRelation===void 0)throw new Error("Bug: No initialRelation, and this.inital is undefined?");const r=n===void 0?R(t):R(n),s=this.initialRelation(t),o=n===void 0?0:A.length(n,t)/(t.at-n.at),i={...r(t),speed:o},d={fromInitial:s,fromLast:i,values:[...this.values]};return this.lastResult=d,d}get line(){return this.values.length===1?[]:A.joinPointsToLines(...this.values)}get vectorPolar(){return _.fromLinePolar(this.lineStartEnd)}get vectorCartesian(){return _.fromLineCartesian(this.lineStartEnd)}get lineStartEnd(){const e=this.initial;return this.values.length<2||!e?A.Empty:{a:e,b:this.last}}distanceFromStart(){const e=this.initial;return this.values.length>=2&&e!==void 0?he(e,this.last):0}difference(){const e=this.initial;return this.values.length>=2&&e!==void 0?B(this.last,e):ve}angleFromStart(){const e=this.initial;if(e!==void 0&&this.values.length>2)return ge(e,this.last)}get length(){if(this.values.length===1)return 0;const e=this.line;return A.length(e)}},Je=class extends ye{constructor(e={}){super((t,n)=>{if(n===void 0)throw new Error("Requires start point");const r=new ie({...e,id:t});return r.seen(n),r})}seenEvent(e){if("getCoalescedEvents"in e){const n=e.getCoalescedEvents().map(r=>super.seen(r.pointerId.toString(),r));return Promise.all(n)}else return Promise.all([super.seen(e.pointerId.toString(),e)])}},Ke=(e={})=>new Je(e),ct=(e={})=>new ie(e),ae=(e,t)=>{const n=g(e),r=H(),s=()=>{const o=window.innerWidth,i=window.innerHeight;if(n.setAttribute("width",o.toString()),n.setAttribute("height",i.toString()),t!==void 0){const d={min:Math.min(o,i),max:Math.max(o,i),width:o,height:i,center:{x:o/2,y:i/2}};t({el:n,bounds:d})}};return r.value(s),s(),r},Ge=(e,t,n=100)=>{const r=g(e),s=r.parentElement;if(s===null)throw new Error("Element has no parent");return pe(s,n).value(i=>{const d=i.find(c=>c.target===s);if(d===void 0)return;const a=d.contentRect.width,l=d.contentRect.height;if(r.setAttribute("width",a+"px"),r.setAttribute("height",l+"px"),t!==void 0){const c={min:Math.min(a,l),max:Math.max(a,l),width:a,height:l,center:{x:a/2,y:l/2}};t({el:r,bounds:c})}})},Qe=(e,t={})=>{const n=t.touchRadius??45,r=t.touchRadius??20,s=t.trace??!1,o=t.hue??100,i=`hsla(${o}, 100%, 10%, 10%)`;let d=o;const a=g(e),l=Ke({storeIntermediate:s}),c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.id="pointerVis",c.style.zIndex="-1000",c.style.position="fixed",c.style.top="0",c.style.left="0",c.style.width="100%",c.style.height="100%",c.style.boxSizing="border-box",c.style.border="3px solid red",c.style.pointerEvents="none",c.style.touchAction="none",ae(c);let u=0;const p=v=>{const y=v.pointerId.toString();l.delete(y),d=o,c.querySelector(`#pv-start-${y}`)?.remove();for(let E=0;E<u+10;E++)c.querySelector(`#pv-progress-${y}-${E}`)?.remove();u=0},f=async v=>{const y=v.pointerId.toString(),E={x:v.x,y:v.y},C=v.pointerType;if(v.type==="pointermove"&&!l.has(y))return;const w=await l.seen(v.pointerId.toString(),{x:v.clientX,y:v.clientY});if(w.values.length===1){const m=j.circle({...w.values[0],radius:C==="touch"?n:r},c,{fillStyle:i},`#pv-start-${y}`);m.style.pointerEvents="none",m.style.touchAction="none"}const P=`hsla(${d}, 100%, 50%, 50%)`,M=j.circle({...E,radius:C==="touch"?n:r},c,{fillStyle:P},`#pv-progress-${y}-${w.values.length}`);M.style.pointerEvents="none",M.style.touchAction="none",d+=1,u=w.values.length};document.body.append(c),a.addEventListener("pointerdown",f),a.addEventListener("pointermove",f),a.addEventListener("pointerup",p),a.addEventListener("pointerleave",p),a.addEventListener("contextmenu",v=>{v.preventDefault()})},Ze=()=>{let e=!0;const t=document.createElement("div");t.style.color="black",t.style.border="2px solid red",t.style.backgroundColor="hsl(0, 80%, 90%)",t.style.padding="1em",t.style.display="none",t.style.top="1em",t.style.left="1em",t.style.position="absolute",t.style.fontFamily="monospace";const n=document.createElement("div");n.style.maxWidth="50vw",n.style.maxHeight="50vh",n.style.overflowY="scroll",t.innerHTML="<h1>Error</h1>",t.append(n);const r=a=>{a.style.padding="0.3em",a.style.marginTop="1em"},s=document.createElement("button");s.textContent="Close",s.addEventListener("click",()=>{d()});const o=document.createElement("button");o.textContent="Stop displaying errors",o.addEventListener("click",()=>{e=!1,d()}),r(s),r(o),t.append(s),t.append(o),document.body.append(t);const i=a=>{t.style.display="inline",n.innerHTML+=a.stack?`<pre>${a.stack}</pre>`:`<p>${O(a)}</p>`},d=()=>{t.style.display="none"};return window.onerror=(a,l,c,u,p)=>{e&&(p?(console.log(p),i(p)):(console.log(a),i(a)))},window.addEventListener("unhandledrejection",a=>{console.log(a.reason),e&&i(a.reason)}),{show:i,hide:d}},le={};T(le,{draggable:()=>et});var et=(e,t)=>{let n=z.Placeholder,r;const s=()=>{e.classList.contains("drag-sel")&&e.classList.remove("drag-sel")},o=u=>{e.classList.contains("drag-sel")?e.classList.remove("drag-sel"):e.classList.add("drag-sel"),u.stopPropagation()};e.ownerDocument.addEventListener("click",s),e.addEventListener("click",o);const i=()=>{e.classList.remove("drag-progress"),e.ownerDocument.removeEventListener("pointermove",a),e.ownerDocument.removeEventListener("pointerup",l),e.ownerDocument.removeEventListener("pointercancel",c)},d=()=>{console.log("drag dispose"),e.classList.contains("drag-progress")?c(void 0,"dispose"):i(),e.ownerDocument.removeEventListener("click",s),e.removeEventListener("click",o)},a=u=>{u.preventDefault(),u.stopPropagation();const f={delta:z.isPlaceholder(n)?{x:u.offsetX,y:u.offsetY}:{x:u.x-n.x,y:u.y-n.y},initial:n,token:r};typeof t.progress<"u"&&!t.progress(f)&&c(void 0,"discontinued")},l=u=>{i();const p={x:u.x-n.x,y:u.y-n.y},f={initial:n,token:r,delta:p};typeof t.success<"u"&&t.success(f)},c=(u,p="pointercancel")=>{i();const f={token:r,initial:n,delta:{x:-1,y:-1}};typeof t.abort<"u"&&t.abort(p,f)};return e.addEventListener("pointerdown",u=>{if(!e.classList.contains("drag-sel"))return;n={x:u.x,y:u.y};const f=typeof t.start>"u"?{allow:!0,token:r}:t.start();!f.allow||(r=f.token,e.classList.add("drag-progress"),e.ownerDocument.addEventListener("pointermove",a),e.ownerDocument.addEventListener("pointerup",l),e.ownerDocument.addEventListener("pointercancel",c))}),d},tt=(e={})=>{const t={log:console.log,error:console.error,warn:console.warn},n=document.createElement("DIV");n.id="ixfx-log",n.style.position="fixed",n.style.left="0px",n.style.top="0px",n.style.pointerEvents="none",n.style.display="none",document.body.prepend(n);const r=Y(n,e),s=o=>{n.style.display=o?"block":"none"};console.error=(o,...i)=>{r.error(o),i.length>0&&r.error(i),t.error(o,...i),s(!0)},console.warn=(o,...i)=>{r.warn(o),i.length>0&&r.warn(i),s(!0)},console.log=(o,...i)=>{r.log(o),i.length>0&&r.log(i),t.log(o,...i),s(!0)},window.onerror=(o,i,d,a,l)=>{const c=i===void 0?"":V(i,"/",{fromEnd:!0}),u=O(l);r.error(u+` (${c}:${d})`),s(!0)}},ce={};T(ce,{parseAsAttributes:()=>nt,setFromVariables:()=>rt});var nt=e=>e.map(t=>{let n;Array.isArray(t)&&(n=t[1],t=t[0]);const r=t.indexOf("-");if(r<0)throw new Error("Simple expression expects form of: 'elementid-attribute'");return{variable:t,attribute:t.slice(r+1),id:t.slice(0,r),defaultValue:n}}),rt=(e,...t)=>{const n=g(e),r=window.getComputedStyle(n);for(const s of t){const o=V(s.variable,"--");let i=r.getPropertyValue(`--${o}`);if(i===null||i.length===0){if(s.defaultValue===void 0)continue;i=s.defaultValue}let d,a;if("query"in s&&s.query!==void 0?d=s.query:"id"in s&&s.id!==void 0?d=`#${s.id}`:"element"in s&&s.element!==void 0&&(a=Array.isArray(s.element)?s.element:[s.element]),d===void 0){if(a===void 0)throw new Error("Missing query, id or element")}else a=[...n.querySelectorAll(d)];if(a!==null&&a!==void 0)if(s.attribute)for(const l of a)l.setAttribute(s.attribute,i);else if(s.field)for(const l of a)l[s.field]=i;else throw new Error(`Neither 'attribute' or 'field' to set is defined in option (${JSON.stringify(s)})`)}},st=(e,t)=>{if(!e)throw new Error("domQueryOrEl is null or undefined");const n=g(e);if(n.nodeName!=="CANVAS")throw new Error(`Expected CANVAS HTML element. Got: ${n.nodeName}`);const r=t.fullSize??!0,s=Math.round(window.devicePixelRatio)||1,o=t.scaleBy??"both";let i=I.scaler("both");const d=c=>{i=I.scaler(o,c);const u=xe(c,s,s);n.width=u.width,n.height=u.height,n.style.width=c.width+"px",n.style.height=c.height+"px"},a=()=>{const c={width:window.innerWidth,height:window.innerHeight};d(c)},l=()=>{const c=n.getContext("2d");if(c===null)throw new Error("Could not create drawing context");c.scale(s,s)};return r&&H().value(a),{abs:i.abs,rel:i.rel,getContext:l}},dt=(e=be)=>{const t=new Set;return n=>{if(n===null)throw new TypeError("Param 'value' cannot be null");if(n===void 0)throw new TypeError("Param 'value' cannot be undefined");const r=typeof n=="string"?n:e(n);return t.has(r)?!1:(t.add(r),!0)}},ot=()=>{const e=new Set;return t=>{if(t===null)throw new TypeError("Param 'value' cannot be null");if(t===void 0)throw new TypeError("Param 'value' cannot be undefined");return e.has(t)?!1:(e.add(t),!0)}};async function*$(e,t={}){if(typeof e=="string")return $([e],t);if(typeof e=="object"&&"nodeName"in e)return $([e],t);const r=t??!1?ot():s=>!0;if(Array.isArray(e))for(const s of e)if(typeof s=="string")for(const o of document.querySelectorAll(s)){const i=o;r(i)&&(yield i)}else r(s)&&(yield s);else for await(const s of e)if(typeof s=="string")for(const o of document.querySelectorAll(s))r(o)&&(yield o);else r(s)&&(yield s)}export{le as D,U as F,ie as P,Je as T,Ke as a,ot as b,qe as c,ze as d,Ie as e,W as f,Y as l,ct as p,Te as s,dt as t};
