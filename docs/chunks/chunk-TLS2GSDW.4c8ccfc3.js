var Y0=Object.create,Jn=Object.defineProperty,xs=Object.getOwnPropertyDescriptor,Hs=Object.getOwnPropertyNames,X0=Object.getPrototypeOf,Z0=Object.prototype.hasOwnProperty,Q0=(e,r,n)=>r in e?Jn(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n,je=(e,r)=>function(){return r||(0,e[Hs(e)[0]])((r={exports:{}}).exports,r),r.exports},Z=(e,r)=>{for(var n in r)Jn(e,n,{get:r[n],enumerable:!0})},ev=(e,r,n,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of Hs(r))!Z0.call(e,a)&&a!==n&&Jn(e,a,{get:()=>r[a],enumerable:!(i=xs(r,a))||i.enumerable});return e},wn=(e,r,n)=>(n=e!=null?Y0(X0(e)):{},ev(r||!e||!e.__esModule?Jn(n,"default",{value:e,enumerable:!0}):n,e)),uC=(e,r,n,i)=>{for(var a=i>1?void 0:i?xs(r,n):r,u=e.length-1,o;u>=0;u--)(o=e[u])&&(a=(i?o(r,n,a):o(a))||a);return i&&a&&Jn(r,n,a),a},oC=(e,r,n)=>(Q0(e,typeof r!="symbol"?r+"":r,n),n),Ks={};Z(Ks,{queue:()=>nv,queueMutable:()=>xr});var oi=(e,r)=>{e.debug&&console.log(`queue:${r}`)},tv=(e,r,n)=>{const i=r.length+n.length,a=e.capacity??i,u=i-a,o=e.discardPolicy??"additions";switch(oi(e,`queueLen: ${r.length} potentialLen: ${i} toRemove: ${u} policy: ${o}`),o){case"additions":return oi(e,`trimQueue:DiscardAdditions: queueLen: ${r.length} slice: ${i-a} toAddLen: ${n.length}`),r.length===e.capacity?r:[...r,...n.slice(0,u-1)];case"newer":if(u>=r.length)return n.slice(Math.max(0,n.length-a),Math.min(n.length,a)+1);{const s=n.slice(0,Math.min(n.length,a-u+1)),c=r.slice(0,r.length-u);oi(e,`trimQueue: toRemove: ${u} keeping: ${JSON.stringify(c)} from orig: ${JSON.stringify(r)} toAddFinal: ${JSON.stringify(s)}`);const l=[...c,...s];return oi(e,`final: ${JSON.stringify(l)}`),l}case"older":return[...r,...n].slice(u);default:throw new Error(`Unknown overflow policy ${o}`)}},Js=(e,r,...n)=>{if(e===void 0)throw new Error("opts parameter undefined");const i=r.length+n.length,a=e.capacity&&i>e.capacity,u=a?tv(e,r,n):[...r,...n];if(e.capacity&&u.length!==e.capacity&&a)throw new Error(`Bug! Expected return to be at capacity. Return len: ${u.length} capacity: ${e.capacity} opts: ${JSON.stringify(e)}`);if(!e.capacity&&u.length!==i)throw new Error(`Bug! Return length not expected. Return len: ${u.length} expected: ${i} opts: ${JSON.stringify(e)}`);return u},Gs=(e,r)=>{if(r.length===0)throw new Error("Queue is empty");return r.slice(1)},Xa=(e,r)=>r[0],Ys=(e,r)=>r.length===0,Xs=(e,r)=>e.capacity?r.length>=e.capacity:!1,rv=class Za{opts;data;constructor(r,n){if(r===void 0)throw new Error("opts parameter undefined");this.opts=r,this.data=n}forEach(r){for(let n=this.data.length-1;n>=0;n--)r(this.data[n])}forEachFromFront(r){this.data.forEach(r)}enqueue(...r){return new Za(this.opts,Js(this.opts,this.data,...r))}dequeue(){return new Za(this.opts,Gs(this.opts,this.data))}get isEmpty(){return Ys(this.opts,this.data)}get isFull(){return Xs(this.opts,this.data)}get length(){return this.data.length}get peek(){return Xa(this.opts,this.data)}},nv=(e={},...r)=>(e={...e},new rv(e,[...r])),iv=class{opts;data;constructor(e,r){if(e===void 0)throw new Error("opts parameter undefined");this.opts=e,this.data=r}enqueue(...e){return this.data=Js(this.opts,this.data,...e),this.data.length}dequeue(){const e=Xa(this.opts,this.data);return this.data=Gs(this.opts,this.data),e}get isEmpty(){return Ys(this.opts,this.data)}get isFull(){return Xs(this.opts,this.data)}get length(){return this.data.length}get peek(){return Xa(this.opts,this.data)}};function xr(e={},...r){return new iv({...e},[...r])}var Ft=je({"node_modules/fp-ts/lib/function.js"(e){var r=e&&e.__spreadArray||function(E,I,H){if(H||arguments.length===2)for(var U=0,Q=I.length,ae;U<Q;U++)(ae||!(U in I))&&(ae||(ae=Array.prototype.slice.call(I,0,U)),ae[U]=I[U]);return E.concat(ae||Array.prototype.slice.call(I))};Object.defineProperty(e,"__esModule",{value:!0}),e.dual=e.getEndomorphismMonoid=e.not=e.SK=e.hole=e.pipe=e.untupled=e.tupled=e.absurd=e.decrement=e.increment=e.tuple=e.flow=e.flip=e.constVoid=e.constUndefined=e.constNull=e.constFalse=e.constTrue=e.constant=e.unsafeCoerce=e.identity=e.apply=e.getRing=e.getSemiring=e.getMonoid=e.getSemigroup=e.getBooleanAlgebra=void 0;var n=function(E){return function(){return{meet:function(I,H){return function(U){return E.meet(I(U),H(U))}},join:function(I,H){return function(U){return E.join(I(U),H(U))}},zero:function(){return E.zero},one:function(){return E.one},implies:function(I,H){return function(U){return E.implies(I(U),H(U))}},not:function(I){return function(H){return E.not(I(H))}}}}};e.getBooleanAlgebra=n;var i=function(E){return function(){return{concat:function(I,H){return function(U){return E.concat(I(U),H(U))}}}}};e.getSemigroup=i;var a=function(E){var I=(0,e.getSemigroup)(E);return function(){return{concat:I().concat,empty:function(){return E.empty}}}};e.getMonoid=a;var u=function(E){return{add:function(I,H){return function(U){return E.add(I(U),H(U))}},zero:function(){return E.zero},mul:function(I,H){return function(U){return E.mul(I(U),H(U))}},one:function(){return E.one}}};e.getSemiring=u;var o=function(E){var I=(0,e.getSemiring)(E);return{add:I.add,mul:I.mul,one:I.one,zero:I.zero,sub:function(H,U){return function(Q){return E.sub(H(Q),U(Q))}}}};e.getRing=o;var s=function(E){return function(I){return I(E)}};e.apply=s;function c(E){return E}e.identity=c,e.unsafeCoerce=c;function l(E){return function(){return E}}e.constant=l,e.constTrue=l(!0),e.constFalse=l(!1),e.constNull=l(null),e.constUndefined=l(void 0),e.constVoid=e.constUndefined;function f(E){return function(){for(var I=[],H=0;H<arguments.length;H++)I[H]=arguments[H];return I.length>1?E(I[1],I[0]):function(U){return E(U)(I[0])}}}e.flip=f;function h(E,I,H,U,Q,ae,ge,he,ze){switch(arguments.length){case 1:return E;case 2:return function(){return I(E.apply(this,arguments))};case 3:return function(){return H(I(E.apply(this,arguments)))};case 4:return function(){return U(H(I(E.apply(this,arguments))))};case 5:return function(){return Q(U(H(I(E.apply(this,arguments)))))};case 6:return function(){return ae(Q(U(H(I(E.apply(this,arguments))))))};case 7:return function(){return ge(ae(Q(U(H(I(E.apply(this,arguments)))))))};case 8:return function(){return he(ge(ae(Q(U(H(I(E.apply(this,arguments))))))))};case 9:return function(){return ze(he(ge(ae(Q(U(H(I(E.apply(this,arguments)))))))))}}}e.flow=h;function y(){for(var E=[],I=0;I<arguments.length;I++)E[I]=arguments[I];return E}e.tuple=y;function D(E){return E+1}e.increment=D;function P(E){return E-1}e.decrement=P;function q(E){throw new Error("Called `absurd` function which should be uncallable")}e.absurd=q;function N(E){return function(I){return E.apply(void 0,I)}}e.tupled=N;function b(E){return function(){for(var I=[],H=0;H<arguments.length;H++)I[H]=arguments[H];return E(I)}}e.untupled=b;function M(E,I,H,U,Q,ae,ge,he,ze){switch(arguments.length){case 1:return E;case 2:return I(E);case 3:return H(I(E));case 4:return U(H(I(E)));case 5:return Q(U(H(I(E))));case 6:return ae(Q(U(H(I(E)))));case 7:return ge(ae(Q(U(H(I(E))))));case 8:return he(ge(ae(Q(U(H(I(E)))))));case 9:return ze(he(ge(ae(Q(U(H(I(E))))))));default:{for(var st=arguments[0],ct=1;ct<arguments.length;ct++)st=arguments[ct](st);return st}}}e.pipe=M,e.hole=q;var B=function(E,I){return I};e.SK=B;function L(E){return function(I){return!E(I)}}e.not=L;var W=function(){return{concat:function(E,I){return h(E,I)},empty:c}};e.getEndomorphismMonoid=W;var $=function(E,I){var H=typeof E=="number"?function(U){return U.length>=E}:E;return function(){var U=Array.from(arguments);return H(arguments)?I.apply(this,U):function(Q){return I.apply(void 0,r([Q],U,!1))}}};e.dual=$}}),Mr=je({"node_modules/fp-ts/lib/internal.js"(e){var r=e&&e.__spreadArray||function(E,I,H){if(H||arguments.length===2)for(var U=0,Q=I.length,ae;U<Q;U++)(ae||!(U in I))&&(ae||(ae=Array.prototype.slice.call(I,0,U)),ae[U]=I[U]);return E.concat(ae||Array.prototype.slice.call(I))};Object.defineProperty(e,"__esModule",{value:!0}),e.flatMapReader=e.flatMapTask=e.flatMapIO=e.flatMapEither=e.flatMapOption=e.flatMapNullable=e.liftOption=e.liftNullable=e.fromReadonlyNonEmptyArray=e.has=e.emptyRecord=e.emptyReadonlyArray=e.tail=e.head=e.isNonEmpty=e.singleton=e.right=e.left=e.isRight=e.isLeft=e.some=e.none=e.isSome=e.isNone=void 0;var n=Ft(),i=function(E){return E._tag==="None"};e.isNone=i;var a=function(E){return E._tag==="Some"};e.isSome=a,e.none={_tag:"None"};var u=function(E){return{_tag:"Some",value:E}};e.some=u;var o=function(E){return E._tag==="Left"};e.isLeft=o;var s=function(E){return E._tag==="Right"};e.isRight=s;var c=function(E){return{_tag:"Left",left:E}};e.left=c;var l=function(E){return{_tag:"Right",right:E}};e.right=l;var f=function(E){return[E]};e.singleton=f;var h=function(E){return E.length>0};e.isNonEmpty=h;var y=function(E){return E[0]};e.head=y;var D=function(E){return E.slice(1)};e.tail=D,e.emptyReadonlyArray=[],e.emptyRecord={},e.has=Object.prototype.hasOwnProperty;var P=function(E){return r([E[0]],E.slice(1),!0)};e.fromReadonlyNonEmptyArray=P;var q=function(E){return function(I,H){return function(){for(var U=[],Q=0;Q<arguments.length;Q++)U[Q]=arguments[Q];var ae=I.apply(void 0,U);return E.fromEither(ae==null?(0,e.left)(H.apply(void 0,U)):(0,e.right)(ae))}}};e.liftNullable=q;var N=function(E){return function(I,H){return function(){for(var U=[],Q=0;Q<arguments.length;Q++)U[Q]=arguments[Q];var ae=I.apply(void 0,U);return E.fromEither((0,e.isNone)(ae)?(0,e.left)(H.apply(void 0,U)):(0,e.right)(ae.value))}}};e.liftOption=N;var b=function(E,I){return(0,n.dual)(3,function(H,U,Q){return I.flatMap(H,(0,e.liftNullable)(E)(U,Q))})};e.flatMapNullable=b;var M=function(E,I){return(0,n.dual)(3,function(H,U,Q){return I.flatMap(H,(0,e.liftOption)(E)(U,Q))})};e.flatMapOption=M;var B=function(E,I){return(0,n.dual)(2,function(H,U){return I.flatMap(H,function(Q){return E.fromEither(U(Q))})})};e.flatMapEither=B;var L=function(E,I){return(0,n.dual)(2,function(H,U){return I.flatMap(H,function(Q){return E.fromIO(U(Q))})})};e.flatMapIO=L;var W=function(E,I){return(0,n.dual)(2,function(H,U){return I.flatMap(H,function(Q){return E.fromTask(U(Q))})})};e.flatMapTask=W;var $=function(E,I){return(0,n.dual)(2,function(H,U){return I.flatMap(H,function(Q){return E.fromReader(U(Q))})})};e.flatMapReader=$}}),Hi=je({"node_modules/fp-ts/lib/Apply.js"(e){var r=e&&e.__createBinding||(Object.create?function(b,M,B,L){L===void 0&&(L=B);var W=Object.getOwnPropertyDescriptor(M,B);(!W||("get"in W?!M.__esModule:W.writable||W.configurable))&&(W={enumerable:!0,get:function(){return M[B]}}),Object.defineProperty(b,L,W)}:function(b,M,B,L){L===void 0&&(L=B),b[L]=M[B]}),n=e&&e.__setModuleDefault||(Object.create?function(b,M){Object.defineProperty(b,"default",{enumerable:!0,value:M})}:function(b,M){b.default=M}),i=e&&e.__importStar||function(b){if(b&&b.__esModule)return b;var M={};if(b!=null)for(var B in b)B!=="default"&&Object.prototype.hasOwnProperty.call(b,B)&&r(M,b,B);return n(M,b),M};Object.defineProperty(e,"__esModule",{value:!0}),e.sequenceS=e.sequenceT=e.getApplySemigroup=e.apS=e.apSecond=e.apFirst=e.ap=void 0;var a=Ft(),u=i(Mr());function o(b,M){return function(B){return function(L){return b.ap(b.map(L,function(W){return function($){return M.ap(W,$)}}),B)}}}e.ap=o;function s(b){return function(M){return function(B){return b.ap(b.map(B,function(L){return function(){return L}}),M)}}}e.apFirst=s;function c(b){return function(M){return function(B){return b.ap(b.map(B,function(){return function(L){return L}}),M)}}}e.apSecond=c;function l(b){return function(M,B){return function(L){return b.ap(b.map(L,function(W){return function($){var E;return Object.assign({},W,(E={},E[M]=$,E))}}),B)}}}e.apS=l;function f(b){return function(M){return{concat:function(B,L){return b.ap(b.map(B,function(W){return function($){return M.concat(W,$)}}),L)}}}}e.getApplySemigroup=f;function h(b,M,B){return function(L){for(var W=Array(B.length+1),$=0;$<B.length;$++)W[$]=B[$];return W[B.length]=L,M===0?b.apply(null,W):h(b,M-1,W)}}var y={1:function(b){return[b]},2:function(b){return function(M){return[b,M]}},3:function(b){return function(M){return function(B){return[b,M,B]}}},4:function(b){return function(M){return function(B){return function(L){return[b,M,B,L]}}}},5:function(b){return function(M){return function(B){return function(L){return function(W){return[b,M,B,L,W]}}}}}};function D(b){return u.has.call(y,b)||(y[b]=h(a.tuple,b-1,[])),y[b]}function P(b){return function(){for(var M=[],B=0;B<arguments.length;B++)M[B]=arguments[B];for(var L=M.length,W=D(L),$=b.map(M[0],W),E=1;E<L;E++)$=b.ap($,M[E]);return $}}e.sequenceT=P;function q(b){var M=b.length;switch(M){case 1:return function(B){var L;return L={},L[b[0]]=B,L};case 2:return function(B){return function(L){var W;return W={},W[b[0]]=B,W[b[1]]=L,W}};case 3:return function(B){return function(L){return function(W){var $;return $={},$[b[0]]=B,$[b[1]]=L,$[b[2]]=W,$}}};case 4:return function(B){return function(L){return function(W){return function($){var E;return E={},E[b[0]]=B,E[b[1]]=L,E[b[2]]=W,E[b[3]]=$,E}}}};case 5:return function(B){return function(L){return function(W){return function($){return function(E){var I;return I={},I[b[0]]=B,I[b[1]]=L,I[b[2]]=W,I[b[3]]=$,I[b[4]]=E,I}}}}};default:return h(function(){for(var B=[],L=0;L<arguments.length;L++)B[L]=arguments[L];for(var W={},$=0;$<M;$++)W[b[$]]=B[$];return W},M-1,[])}}function N(b){return function(M){for(var B=Object.keys(M),L=B.length,W=q(B),$=b.map(M[B[0]],W),E=1;E<L;E++)$=b.ap($,M[B[E]]);return $}}e.sequenceS=N}}),Gn=je({"node_modules/fp-ts/lib/Chain.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.bind=e.tap=e.chainFirst=void 0;function r(a){var u=n(a);return function(o){return function(s){return u(s,o)}}}e.chainFirst=r;function n(a){return function(u,o){return a.chain(u,function(s){return a.map(o(s),function(){return s})})}}e.tap=n;function i(a){return function(u,o){return function(s){return a.chain(s,function(c){return a.map(o(c),function(l){var f;return Object.assign({},c,(f={},f[u]=l,f))})})}}}e.bind=i}}),Zs=je({"node_modules/fp-ts/lib/FromEither.js"(e){var r=e&&e.__createBinding||(Object.create?function(N,b,M,B){B===void 0&&(B=M);var L=Object.getOwnPropertyDescriptor(b,M);(!L||("get"in L?!b.__esModule:L.writable||L.configurable))&&(L={enumerable:!0,get:function(){return b[M]}}),Object.defineProperty(N,B,L)}:function(N,b,M,B){B===void 0&&(B=M),N[B]=b[M]}),n=e&&e.__setModuleDefault||(Object.create?function(N,b){Object.defineProperty(N,"default",{enumerable:!0,value:b})}:function(N,b){N.default=b}),i=e&&e.__importStar||function(N){if(N&&N.__esModule)return N;var b={};if(N!=null)for(var M in N)M!=="default"&&Object.prototype.hasOwnProperty.call(N,M)&&r(b,N,M);return n(b,N),b};Object.defineProperty(e,"__esModule",{value:!0}),e.tapEither=e.filterOrElse=e.chainFirstEitherK=e.chainEitherK=e.fromEitherK=e.chainOptionK=e.fromOptionK=e.fromPredicate=e.fromOption=void 0;var a=Gn(),u=Ft(),o=i(Mr());function s(N){return function(b){return function(M){return N.fromEither(o.isNone(M)?o.left(b()):o.right(M.value))}}}e.fromOption=s;function c(N){return function(b,M){return function(B){return N.fromEither(b(B)?o.right(B):o.left(M(B)))}}}e.fromPredicate=c;function l(N){var b=s(N);return function(M){var B=b(M);return function(L){return(0,u.flow)(L,B)}}}e.fromOptionK=l;function f(N,b){var M=l(N);return function(B){var L=M(B);return function(W){return function($){return b.chain($,L(W))}}}}e.chainOptionK=f;function h(N){return function(b){return(0,u.flow)(b,N.fromEither)}}e.fromEitherK=h;function y(N,b){var M=h(N);return function(B){return function(L){return b.chain(L,M(B))}}}e.chainEitherK=y;function D(N,b){var M=q(N,b);return function(B){return function(L){return M(L,B)}}}e.chainFirstEitherK=D;function P(N,b){return function(M,B){return function(L){return b.chain(L,function(W){return N.fromEither(M(W)?o.right(W):o.left(B(W)))})}}}e.filterOrElse=P;function q(N,b){var M=h(N),B=(0,a.tap)(b);return function(L,W){return B(L,M(W))}}e.tapEither=q}}),Yn=je({"node_modules/fp-ts/lib/Functor.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.asUnit=e.as=e.getFunctorComposition=e.let=e.bindTo=e.flap=e.map=void 0;var r=Ft();function n(l,f){return function(h){return function(y){return l.map(y,function(D){return f.map(D,h)})}}}e.map=n;function i(l){return function(f){return function(h){return l.map(h,function(y){return y(f)})}}}e.flap=i;function a(l){return function(f){return function(h){return l.map(h,function(y){var D;return D={},D[f]=y,D})}}}e.bindTo=a;function u(l){return function(f,h){return function(y){return l.map(y,function(D){var P;return Object.assign({},D,(P={},P[f]=h(D),P))})}}}e.let=u;function o(l,f){var h=n(l,f);return{map:function(y,D){return(0,r.pipe)(y,h(D))}}}e.getFunctorComposition=o;function s(l){return function(f,h){return l.map(f,function(){return h})}}e.as=s;function c(l){var f=s(l);return function(h){return f(h,void 0)}}e.asUnit=c}}),Pu=je({"node_modules/fp-ts/lib/Eq.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.eqDate=e.eqNumber=e.eqString=e.eqBoolean=e.eq=e.strictEqual=e.getStructEq=e.getTupleEq=e.Contravariant=e.getMonoid=e.getSemigroup=e.eqStrict=e.URI=e.contramap=e.tuple=e.struct=e.fromEquals=void 0;var r=Ft(),n=function(f){return{equals:function(h,y){return h===y||f(h,y)}}};e.fromEquals=n;var i=function(f){return(0,e.fromEquals)(function(h,y){for(var D in f)if(!f[D].equals(h[D],y[D]))return!1;return!0})};e.struct=i;var a=function(){for(var f=[],h=0;h<arguments.length;h++)f[h]=arguments[h];return(0,e.fromEquals)(function(y,D){return f.every(function(P,q){return P.equals(y[q],D[q])})})};e.tuple=a;var u=function(f,h){return(0,r.pipe)(f,(0,e.contramap)(h))},o=function(f){return function(h){return(0,e.fromEquals)(function(y,D){return h.equals(f(y),f(D))})}};e.contramap=o,e.URI="Eq",e.eqStrict={equals:function(f,h){return f===h}};var s={equals:function(){return!0}},c=function(){return{concat:function(f,h){return(0,e.fromEquals)(function(y,D){return f.equals(y,D)&&h.equals(y,D)})}}};e.getSemigroup=c;var l=function(){return{concat:(0,e.getSemigroup)().concat,empty:s}};e.getMonoid=l,e.Contravariant={URI:e.URI,contramap:u},e.getTupleEq=e.tuple,e.getStructEq=e.struct,e.strictEqual=e.eqStrict.equals,e.eq=e.Contravariant,e.eqBoolean=e.eqStrict,e.eqString=e.eqStrict,e.eqNumber=e.eqStrict,e.eqDate={equals:function(f,h){return f.valueOf()===h.valueOf()}}}}),Xn=je({"node_modules/fp-ts/lib/Ord.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ordDate=e.ordNumber=e.ordString=e.ordBoolean=e.ord=e.getDualOrd=e.getTupleOrd=e.between=e.clamp=e.max=e.min=e.geq=e.leq=e.gt=e.lt=e.equals=e.trivial=e.Contravariant=e.getMonoid=e.getSemigroup=e.URI=e.contramap=e.reverse=e.tuple=e.fromCompare=e.equalsDefault=void 0;var r=Pu(),n=Ft(),i=function($){return function(E,I){return E===I||$(E,I)===0}};e.equalsDefault=i;var a=function($){return{equals:(0,e.equalsDefault)($),compare:function(E,I){return E===I?0:$(E,I)}}};e.fromCompare=a;var u=function(){for(var $=[],E=0;E<arguments.length;E++)$[E]=arguments[E];return(0,e.fromCompare)(function(I,H){for(var U=0;U<$.length-1;U++){var Q=$[U].compare(I[U],H[U]);if(Q!==0)return Q}return $[U].compare(I[U],H[U])})};e.tuple=u;var o=function($){return(0,e.fromCompare)(function(E,I){return $.compare(I,E)})};e.reverse=o;var s=function($,E){return(0,n.pipe)($,(0,e.contramap)(E))},c=function($){return function(E){return(0,e.fromCompare)(function(I,H){return E.compare($(I),$(H))})}};e.contramap=c,e.URI="Ord";var l=function(){return{concat:function($,E){return(0,e.fromCompare)(function(I,H){var U=$.compare(I,H);return U!==0?U:E.compare(I,H)})}}};e.getSemigroup=l;var f=function(){return{concat:(0,e.getSemigroup)().concat,empty:(0,e.fromCompare)(function(){return 0})}};e.getMonoid=f,e.Contravariant={URI:e.URI,contramap:s},e.trivial={equals:n.constTrue,compare:(0,n.constant)(0)};var h=function($){return function(E){return function(I){return I===E||$.compare(I,E)===0}}};e.equals=h;var y=function($){return function(E,I){return $.compare(E,I)===-1}};e.lt=y;var D=function($){return function(E,I){return $.compare(E,I)===1}};e.gt=D;var P=function($){return function(E,I){return $.compare(E,I)!==1}};e.leq=P;var q=function($){return function(E,I){return $.compare(E,I)!==-1}};e.geq=q;var N=function($){return function(E,I){return E===I||$.compare(E,I)<1?E:I}};e.min=N;var b=function($){return function(E,I){return E===I||$.compare(E,I)>-1?E:I}};e.max=b;var M=function($){var E=(0,e.min)($),I=(0,e.max)($);return function(H,U){return function(Q){return I(E(Q,U),H)}}};e.clamp=M;var B=function($){var E=(0,e.lt)($),I=(0,e.gt)($);return function(H,U){return function(Q){return!(E(Q,H)||I(Q,U))}}};e.between=B,e.getTupleOrd=e.tuple,e.getDualOrd=e.reverse,e.ord=e.Contravariant;function L($,E){return $<E?-1:$>E?1:0}var W={equals:r.eqStrict.equals,compare:L};e.ordBoolean=W,e.ordString=W,e.ordNumber=W,e.ordDate=(0,n.pipe)(e.ordNumber,(0,e.contramap)(function($){return $.valueOf()}))}}),av=je({"node_modules/fp-ts/lib/Magma.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.concatAll=e.endo=e.filterSecond=e.filterFirst=e.reverse=void 0;var r=function(o){return{concat:function(s,c){return o.concat(c,s)}}};e.reverse=r;var n=function(o){return function(s){return{concat:function(c,l){return o(c)?s.concat(c,l):l}}}};e.filterFirst=n;var i=function(o){return function(s){return{concat:function(c,l){return o(l)?s.concat(c,l):c}}}};e.filterSecond=i;var a=function(o){return function(s){return{concat:function(c,l){return s.concat(o(c),o(l))}}}};e.endo=a;var u=function(o){return function(s){return function(c){return c.reduce(function(l,f){return o.concat(l,f)},s)}}};e.concatAll=u}}),uv=je({"node_modules/fp-ts/lib/Semigroup.js"(e){var r=e&&e.__createBinding||(Object.create?function(M,B,L,W){W===void 0&&(W=L);var $=Object.getOwnPropertyDescriptor(B,L);(!$||("get"in $?!B.__esModule:$.writable||$.configurable))&&($={enumerable:!0,get:function(){return B[L]}}),Object.defineProperty(M,W,$)}:function(M,B,L,W){W===void 0&&(W=L),M[W]=B[L]}),n=e&&e.__setModuleDefault||(Object.create?function(M,B){Object.defineProperty(M,"default",{enumerable:!0,value:B})}:function(M,B){M.default=B}),i=e&&e.__importStar||function(M){if(M&&M.__esModule)return M;var B={};if(M!=null)for(var L in M)L!=="default"&&Object.prototype.hasOwnProperty.call(M,L)&&r(B,M,L);return n(B,M),B};Object.defineProperty(e,"__esModule",{value:!0}),e.semigroupProduct=e.semigroupSum=e.semigroupString=e.getFunctionSemigroup=e.semigroupAny=e.semigroupAll=e.fold=e.getIntercalateSemigroup=e.getMeetSemigroup=e.getJoinSemigroup=e.getDualSemigroup=e.getStructSemigroup=e.getTupleSemigroup=e.getFirstSemigroup=e.getLastSemigroup=e.getObjectSemigroup=e.semigroupVoid=e.concatAll=e.last=e.first=e.intercalate=e.tuple=e.struct=e.reverse=e.constant=e.max=e.min=void 0;var a=Ft(),u=i(Mr()),o=i(av()),s=i(Xn()),c=function(M){return{concat:s.min(M)}};e.min=c;var l=function(M){return{concat:s.max(M)}};e.max=l;var f=function(M){return{concat:function(){return M}}};e.constant=f,e.reverse=o.reverse;var h=function(M){return{concat:function(B,L){var W={};for(var $ in M)u.has.call(M,$)&&(W[$]=M[$].concat(B[$],L[$]));return W}}};e.struct=h;var y=function(){for(var M=[],B=0;B<arguments.length;B++)M[B]=arguments[B];return{concat:function(L,W){return M.map(function($,E){return $.concat(L[E],W[E])})}}};e.tuple=y;var D=function(M){return function(B){return{concat:function(L,W){return B.concat(L,B.concat(M,W))}}}};e.intercalate=D;var P=function(){return{concat:a.identity}};e.first=P;var q=function(){return{concat:function(M,B){return B}}};e.last=q,e.concatAll=o.concatAll,e.semigroupVoid=(0,e.constant)(void 0);var N=function(){return{concat:function(M,B){return Object.assign({},M,B)}}};e.getObjectSemigroup=N,e.getLastSemigroup=e.last,e.getFirstSemigroup=e.first,e.getTupleSemigroup=e.tuple,e.getStructSemigroup=e.struct,e.getDualSemigroup=e.reverse,e.getJoinSemigroup=e.max,e.getMeetSemigroup=e.min,e.getIntercalateSemigroup=e.intercalate;function b(M){var B=(0,e.concatAll)(M);return function(L,W){return W===void 0?B(L):B(L)(W)}}e.fold=b,e.semigroupAll={concat:function(M,B){return M&&B}},e.semigroupAny={concat:function(M,B){return M||B}},e.getFunctionSemigroup=a.getSemigroup,e.semigroupString={concat:function(M,B){return M+B}},e.semigroupSum={concat:function(M,B){return M+B}},e.semigroupProduct={concat:function(M,B){return M*B}}}}),Ru=je({"node_modules/fp-ts/lib/ReadonlyNonEmptyArray.js"(e){var r=e&&e.__createBinding||(Object.create?function(A,F,z,j){j===void 0&&(j=z);var te=Object.getOwnPropertyDescriptor(F,z);(!te||("get"in te?!F.__esModule:te.writable||te.configurable))&&(te={enumerable:!0,get:function(){return F[z]}}),Object.defineProperty(A,j,te)}:function(A,F,z,j){j===void 0&&(j=z),A[j]=F[z]}),n=e&&e.__setModuleDefault||(Object.create?function(A,F){Object.defineProperty(A,"default",{enumerable:!0,value:F})}:function(A,F){A.default=F}),i=e&&e.__importStar||function(A){if(A&&A.__esModule)return A;var F={};if(A!=null)for(var z in A)z!=="default"&&Object.prototype.hasOwnProperty.call(A,z)&&r(F,A,z);return n(F,A),F},a=e&&e.__spreadArray||function(A,F,z){if(z||arguments.length===2)for(var j=0,te=F.length,le;j<te;j++)(le||!(j in F))&&(le||(le=Array.prototype.slice.call(F,0,j)),le[j]=F[j]);return A.concat(le||Array.prototype.slice.call(F))};Object.defineProperty(e,"__esModule",{value:!0}),e.reduceRight=e.foldMap=e.reduce=e.mapWithIndex=e.map=e.flatten=e.duplicate=e.extend=e.flatMap=e.ap=e.alt=e.altW=e.of=e.chunksOf=e.splitAt=e.chop=e.chainWithIndex=e.intersperse=e.prependAll=e.unzip=e.zip=e.zipWith=e.modifyAt=e.updateAt=e.sort=e.groupBy=e.group=e.reverse=e.concat=e.concatW=e.fromArray=e.unappend=e.unprepend=e.range=e.replicate=e.makeBy=e.fromReadonlyArray=e.rotate=e.union=e.sortBy=e.uniq=e.unsafeUpdateAt=e.unsafeInsertAt=e.append=e.appendW=e.prepend=e.prependW=e.isOutOfBound=e.isNonEmpty=e.empty=void 0,e.groupSort=e.chain=e.intercalate=e.updateLast=e.modifyLast=e.updateHead=e.modifyHead=e.matchRight=e.matchLeft=e.concatAll=e.max=e.min=e.init=e.last=e.tail=e.head=e.apS=e.bind=e.let=e.bindTo=e.Do=e.Comonad=e.Alt=e.TraversableWithIndex=e.Traversable=e.FoldableWithIndex=e.Foldable=e.Monad=e.chainFirst=e.Chain=e.Applicative=e.apSecond=e.apFirst=e.Apply=e.FunctorWithIndex=e.Pointed=e.flap=e.Functor=e.getUnionSemigroup=e.getEq=e.getSemigroup=e.getShow=e.URI=e.extract=e.traverseWithIndex=e.sequence=e.traverse=e.reduceRightWithIndex=e.foldMapWithIndex=e.reduceWithIndex=void 0,e.readonlyNonEmptyArray=e.fold=e.prependToAll=e.insertAt=e.snoc=e.cons=e.unsnoc=e.uncons=e.filterWithIndex=e.filter=void 0;var u=Hi(),o=Gn(),s=Pu(),c=Ft(),l=Yn(),f=i(Mr()),h=Xn(),y=i(uv());e.empty=f.emptyReadonlyArray,e.isNonEmpty=f.isNonEmpty;var D=function(A,F){return A<0||A>=F.length};e.isOutOfBound=D;var P=function(A){return function(F){return a([A],F,!0)}};e.prependW=P,e.prepend=e.prependW;var q=function(A){return function(F){return a(a([],F,!0),[A],!1)}};e.appendW=q,e.append=e.appendW;var N=function(A,F,z){if((0,e.isNonEmpty)(z)){var j=f.fromReadonlyNonEmptyArray(z);return j.splice(A,0,F),j}return[F]};e.unsafeInsertAt=N;var b=function(A,F,z){if(z[A]===F)return z;var j=f.fromReadonlyNonEmptyArray(z);return j[A]=F,j};e.unsafeUpdateAt=b;var M=function(A){return function(F){if(F.length===1)return F;for(var z=[(0,e.head)(F)],j=(0,e.tail)(F),te=function(Gt){z.every(function(me){return!A.equals(me,Gt)})&&z.push(Gt)},le=0,Me=j;le<Me.length;le++){var mt=Me[le];te(mt)}return z}};e.uniq=M;var B=function(A){if((0,e.isNonEmpty)(A)){var F=(0,h.getMonoid)();return(0,e.sort)(A.reduce(F.concat,F.empty))}return c.identity};e.sortBy=B;var L=function(A){var F=(0,e.uniq)(A);return function(z){return function(j){return F((0,c.pipe)(j,he(z)))}}};e.union=L;var W=function(A){return function(F){var z=F.length,j=Math.round(A)%z;if((0,e.isOutOfBound)(Math.abs(j),F)||j===0)return F;if(j<0){var te=(0,e.splitAt)(-j)(F),le=te[0],Me=te[1];return(0,c.pipe)(Me,he(le))}else return(0,e.rotate)(j-z)(F)}};e.rotate=W;var $=function(A){return(0,e.isNonEmpty)(A)?f.some(A):f.none};e.fromReadonlyArray=$;var E=function(A){return function(F){for(var z=Math.max(0,Math.floor(F)),j=[A(0)],te=1;te<z;te++)j.push(A(te));return j}};e.makeBy=E;var I=function(A){return(0,e.makeBy)(function(){return A})};e.replicate=I;var H=function(A,F){return A<=F?(0,e.makeBy)(function(z){return A+z})(F-A+1):[A]};e.range=H;var U=function(A){return[(0,e.head)(A),(0,e.tail)(A)]};e.unprepend=U;var Q=function(A){return[(0,e.init)(A),(0,e.last)(A)]};e.unappend=Q;var ae=function(A){return(0,e.fromReadonlyArray)(A.slice())};e.fromArray=ae;function ge(A){return function(F){return F.concat(A)}}e.concatW=ge;function he(A,F){return F?A.concat(F):function(z){return z.concat(A)}}e.concat=he;var ze=function(A){return A.length===1?A:a([(0,e.last)(A)],A.slice(0,-1).reverse(),!0)};e.reverse=ze;function st(A){return function(F){var z=F.length;if(z===0)return e.empty;for(var j=[],te=F[0],le=[te],Me=1;Me<z;Me++){var mt=F[Me];A.equals(mt,te)?le.push(mt):(j.push(le),te=mt,le=[te])}return j.push(le),j}}e.group=st;var ct=function(A){return function(F){for(var z={},j=0,te=F;j<te.length;j++){var le=te[j],Me=A(le);f.has.call(z,Me)?z[Me].push(le):z[Me]=[le]}return z}};e.groupBy=ct;var xt=function(A){return function(F){return F.length===1?F:F.slice().sort(A.compare)}};e.sort=xt;var ir=function(A,F){return(0,e.modifyAt)(A,function(){return F})};e.updateAt=ir;var ar=function(A,F){return function(z){return(0,e.isOutOfBound)(A,z)?f.none:f.some((0,e.unsafeUpdateAt)(A,F(z[A]),z))}};e.modifyAt=ar;var ur=function(A,F,z){for(var j=[z(A[0],F[0])],te=Math.min(A.length,F.length),le=1;le<te;le++)j[le]=z(A[le],F[le]);return j};e.zipWith=ur;function Ht(A,F){return F===void 0?function(z){return Ht(z,A)}:(0,e.zipWith)(A,F,function(z,j){return[z,j]})}e.zip=Ht;var Wt=function(A){for(var F=[A[0][0]],z=[A[0][1]],j=1;j<A.length;j++)F[j]=A[j][0],z[j]=A[j][1];return[F,z]};e.unzip=Wt;var or=function(A){return function(F){for(var z=[A,F[0]],j=1;j<F.length;j++)z.push(A,F[j]);return z}};e.prependAll=or;var Kt=function(A){return function(F){var z=(0,e.tail)(F);return(0,e.isNonEmpty)(z)?(0,c.pipe)(z,(0,e.prependAll)(A),(0,e.prepend)((0,e.head)(F))):F}};e.intersperse=Kt;var Jt=function(A){return function(F){for(var z=f.fromReadonlyNonEmptyArray(A(0,(0,e.head)(F))),j=1;j<F.length;j++)z.push.apply(z,A(j,F[j]));return z}};e.chainWithIndex=Jt;var sr=function(A){return function(F){for(var z=A(F),j=z[0],te=z[1],le=[j],Me=te;(0,e.isNonEmpty)(Me);){var mt=A(Me),Gt=mt[0],me=mt[1];le.push(Gt),Me=me}return le}};e.chop=sr;var cr=function(A){return function(F){var z=Math.max(1,A);return z>=F.length?[F,e.empty]:[(0,c.pipe)(F.slice(1,z),(0,e.prepend)((0,e.head)(F))),F.slice(z)]}};e.splitAt=cr;var lr=function(A){return(0,e.chop)((0,e.splitAt)(A))};e.chunksOf=lr;var We=function(A,F){return(0,c.pipe)(A,(0,e.map)(F))},de=function(A,F){return(0,c.pipe)(A,(0,e.mapWithIndex)(F))},Ye=function(A,F){return(0,c.pipe)(A,(0,e.ap)(F))},be=function(A,F){return(0,c.pipe)(A,(0,e.extend)(F))},_e=function(A,F,z){return(0,c.pipe)(A,(0,e.reduce)(F,z))},$e=function(A){var F=(0,e.foldMap)(A);return function(z,j){return(0,c.pipe)(z,F(j))}},Se=function(A,F,z){return(0,c.pipe)(A,(0,e.reduceRight)(F,z))},Ce=function(A){var F=(0,e.traverse)(A);return function(z,j){return(0,c.pipe)(z,F(j))}},De=function(A,F){return(0,c.pipe)(A,(0,e.alt)(F))},lt=function(A,F,z){return(0,c.pipe)(A,(0,e.reduceWithIndex)(F,z))},Xe=function(A){var F=(0,e.foldMapWithIndex)(A);return function(z,j){return(0,c.pipe)(z,F(j))}},pt=function(A,F,z){return(0,c.pipe)(A,(0,e.reduceRightWithIndex)(F,z))},ft=function(A){var F=(0,e.traverseWithIndex)(A);return function(z,j){return(0,c.pipe)(z,F(j))}};e.of=f.singleton;var se=function(A){return function(F){return(0,c.pipe)(F,ge(A()))}};e.altW=se,e.alt=e.altW;var oe=function(A){return(0,e.flatMap)(function(F){return(0,c.pipe)(A,(0,e.map)(F))})};e.ap=oe,e.flatMap=(0,c.dual)(2,function(A,F){return(0,c.pipe)(A,(0,e.chainWithIndex)(function(z,j){return F(j,z)}))});var wt=function(A){return function(F){for(var z=(0,e.tail)(F),j=[A(F)];(0,e.isNonEmpty)(z);)j.push(A(z)),z=(0,e.tail)(z);return j}};e.extend=wt,e.duplicate=(0,e.extend)(c.identity),e.flatten=(0,e.flatMap)(c.identity);var Ze=function(A){return(0,e.mapWithIndex)(function(F,z){return A(z)})};e.map=Ze;var ce=function(A){return function(F){for(var z=[A(0,(0,e.head)(F))],j=1;j<F.length;j++)z.push(A(j,F[j]));return z}};e.mapWithIndex=ce;var ht=function(A,F){return(0,e.reduceWithIndex)(A,function(z,j,te){return F(j,te)})};e.reduce=ht;var Ue=function(A){return function(F){return function(z){return z.slice(1).reduce(function(j,te){return A.concat(j,F(te))},F(z[0]))}}};e.foldMap=Ue;var T=function(A,F){return(0,e.reduceRightWithIndex)(A,function(z,j,te){return F(j,te)})};e.reduceRight=T;var Et=function(A,F){return function(z){return z.reduce(function(j,te,le){return F(le,j,te)},A)}};e.reduceWithIndex=Et;var ve=function(A){return function(F){return function(z){return z.slice(1).reduce(function(j,te,le){return A.concat(j,F(le+1,te))},F(0,z[0]))}}};e.foldMapWithIndex=ve;var He=function(A,F){return function(z){return z.reduceRight(function(j,te,le){return F(le,te,j)},A)}};e.reduceRightWithIndex=He;var St=function(A){var F=(0,e.traverseWithIndex)(A);return function(z){return F(function(j,te){return z(te)})}};e.traverse=St;var Mt=function(A){return(0,e.traverseWithIndex)(A)(c.SK)};e.sequence=Mt;var dt=function(A){return function(F){return function(z){for(var j=A.map(F(0,(0,e.head)(z)),e.of),te=1;te<z.length;te++)j=A.ap(A.map(j,function(le){return function(Me){return(0,c.pipe)(le,(0,e.append)(Me))}}),F(te,z[te]));return j}}};e.traverseWithIndex=dt,e.extract=f.head,e.URI="ReadonlyNonEmptyArray";var It=function(A){return{show:function(F){return"[".concat(F.map(A.show).join(", "),"]")}}};e.getShow=It;var vt=function(){return{concat:he}};e.getSemigroup=vt;var tt=function(A){return(0,s.fromEquals)(function(F,z){return F.length===z.length&&F.every(function(j,te){return A.equals(j,z[te])})})};e.getEq=tt;var ne=function(A){var F=(0,e.union)(A);return{concat:function(z,j){return F(j)(z)}}};e.getUnionSemigroup=ne,e.Functor={URI:e.URI,map:We},e.flap=(0,l.flap)(e.Functor),e.Pointed={URI:e.URI,of:e.of},e.FunctorWithIndex={URI:e.URI,map:We,mapWithIndex:de},e.Apply={URI:e.URI,map:We,ap:Ye},e.apFirst=(0,u.apFirst)(e.Apply),e.apSecond=(0,u.apSecond)(e.Apply),e.Applicative={URI:e.URI,map:We,ap:Ye,of:e.of},e.Chain={URI:e.URI,map:We,ap:Ye,chain:e.flatMap},e.chainFirst=(0,o.chainFirst)(e.Chain),e.Monad={URI:e.URI,map:We,ap:Ye,of:e.of,chain:e.flatMap},e.Foldable={URI:e.URI,reduce:_e,foldMap:$e,reduceRight:Se},e.FoldableWithIndex={URI:e.URI,reduce:_e,foldMap:$e,reduceRight:Se,reduceWithIndex:lt,foldMapWithIndex:Xe,reduceRightWithIndex:pt},e.Traversable={URI:e.URI,map:We,reduce:_e,foldMap:$e,reduceRight:Se,traverse:Ce,sequence:e.sequence},e.TraversableWithIndex={URI:e.URI,map:We,mapWithIndex:de,reduce:_e,foldMap:$e,reduceRight:Se,traverse:Ce,sequence:e.sequence,reduceWithIndex:lt,foldMapWithIndex:Xe,reduceRightWithIndex:pt,traverseWithIndex:ft},e.Alt={URI:e.URI,map:We,alt:De},e.Comonad={URI:e.URI,map:We,extend:be,extract:e.extract},e.Do=(0,e.of)(f.emptyRecord),e.bindTo=(0,l.bindTo)(e.Functor);var Pe=(0,l.let)(e.Functor);e.let=Pe,e.bind=(0,o.bind)(e.Chain),e.apS=(0,u.apS)(e.Apply),e.head=e.extract,e.tail=f.tail;var Re=function(A){return A[A.length-1]};e.last=Re;var yt=function(A){return A.slice(0,-1)};e.init=yt;var it=function(A){var F=y.min(A);return function(z){return z.reduce(F.concat)}};e.min=it;var Qe=function(A){var F=y.max(A);return function(z){return z.reduce(F.concat)}};e.max=Qe;var Dt=function(A){return function(F){return F.reduce(A.concat)}};e.concatAll=Dt;var kt=function(A){return function(F){return A((0,e.head)(F),(0,e.tail)(F))}};e.matchLeft=kt;var Ot=function(A){return function(F){return A((0,e.init)(F),(0,e.last)(F))}};e.matchRight=Ot;var S=function(A){return function(F){return a([A((0,e.head)(F))],(0,e.tail)(F),!0)}};e.modifyHead=S;var d=function(A){return(0,e.modifyHead)(function(){return A})};e.updateHead=d;var p=function(A){return function(F){return(0,c.pipe)((0,e.init)(F),(0,e.append)(A((0,e.last)(F))))}};e.modifyLast=p;var R=function(A){return(0,e.modifyLast)(function(){return A})};e.updateLast=R;var x=function(A){var F=(0,e.concatAll)(A);return function(z){return(0,c.flow)((0,e.intersperse)(z),F)}};e.intercalate=x,e.chain=e.flatMap;function K(A){var F=(0,e.sort)(A),z=st(A);return function(j){return(0,e.isNonEmpty)(j)?z(F(j)):e.empty}}e.groupSort=K;function ee(A){return(0,e.filterWithIndex)(function(F,z){return A(z)})}e.filter=ee;var ue=function(A){return function(F){return(0,e.fromReadonlyArray)(F.filter(function(z,j){return A(j,z)}))}};e.filterWithIndex=ue,e.uncons=e.unprepend,e.unsnoc=e.unappend;function Ae(A,F){return F===void 0?(0,e.prepend)(A):(0,c.pipe)(F,(0,e.prepend)(A))}e.cons=Ae;var we=function(A,F){return(0,c.pipe)(A,he([F]))};e.snoc=we;var rt=function(A,F){return function(z){return A<0||A>z.length?f.none:f.some((0,e.unsafeInsertAt)(A,F,z))}};e.insertAt=rt,e.prependToAll=e.prependAll,e.fold=e.concatAll,e.readonlyNonEmptyArray={URI:e.URI,of:e.of,map:We,mapWithIndex:de,ap:Ye,chain:e.flatMap,extend:be,extract:e.extract,reduce:_e,foldMap:$e,reduceRight:Se,traverse:Ce,sequence:e.sequence,reduceWithIndex:lt,foldMapWithIndex:Xe,reduceRightWithIndex:pt,traverseWithIndex:ft,alt:De}}}),ov=je({"node_modules/fp-ts/lib/NonEmptyArray.js"(e){var r=e&&e.__createBinding||(Object.create?function(S,d,p,R){R===void 0&&(R=p);var x=Object.getOwnPropertyDescriptor(d,p);(!x||("get"in x?!d.__esModule:x.writable||x.configurable))&&(x={enumerable:!0,get:function(){return d[p]}}),Object.defineProperty(S,R,x)}:function(S,d,p,R){R===void 0&&(R=p),S[R]=d[p]}),n=e&&e.__setModuleDefault||(Object.create?function(S,d){Object.defineProperty(S,"default",{enumerable:!0,value:d})}:function(S,d){S.default=d}),i=e&&e.__importStar||function(S){if(S&&S.__esModule)return S;var d={};if(S!=null)for(var p in S)p!=="default"&&Object.prototype.hasOwnProperty.call(S,p)&&r(d,S,p);return n(d,S),d},a=e&&e.__spreadArray||function(S,d,p){if(p||arguments.length===2)for(var R=0,x=d.length,K;R<x;R++)(K||!(R in d))&&(K||(K=Array.prototype.slice.call(d,0,R)),K[R]=d[R]);return S.concat(K||Array.prototype.slice.call(d))};Object.defineProperty(e,"__esModule",{value:!0}),e.mapWithIndex=e.map=e.flatten=e.duplicate=e.extend=e.flatMap=e.ap=e.alt=e.altW=e.chunksOf=e.splitAt=e.chop=e.chainWithIndex=e.foldMap=e.foldMapWithIndex=e.intersperse=e.prependAll=e.unzip=e.zip=e.zipWith=e.of=e.copy=e.modifyAt=e.updateAt=e.insertAt=e.sort=e.groupBy=e.group=e.reverse=e.concat=e.concatW=e.unappend=e.unprepend=e.range=e.replicate=e.makeBy=e.fromArray=e.fromReadonlyNonEmptyArray=e.rotate=e.union=e.sortBy=e.uniq=e.unsafeUpdateAt=e.unsafeInsertAt=e.append=e.appendW=e.prepend=e.prependW=e.isOutOfBound=e.isNonEmpty=void 0,e.chain=e.intercalate=e.updateLast=e.modifyLast=e.updateHead=e.modifyHead=e.matchRight=e.matchLeft=e.concatAll=e.max=e.min=e.init=e.last=e.tail=e.head=e.apS=e.bind=e.let=e.bindTo=e.Do=e.Comonad=e.Alt=e.TraversableWithIndex=e.Traversable=e.FoldableWithIndex=e.Foldable=e.Monad=e.chainFirst=e.Chain=e.Applicative=e.apSecond=e.apFirst=e.Apply=e.FunctorWithIndex=e.Pointed=e.flap=e.Functor=e.getUnionSemigroup=e.getEq=e.getSemigroup=e.getShow=e.URI=e.extract=e.traverseWithIndex=e.sequence=e.traverse=e.reduceRightWithIndex=e.reduceRight=e.reduceWithIndex=e.reduce=void 0,e.nonEmptyArray=e.fold=e.prependToAll=e.snoc=e.cons=e.unsnoc=e.uncons=e.filterWithIndex=e.filter=e.groupSort=void 0;var u=Hi(),o=Gn(),s=Ft(),c=Yn(),l=i(Mr()),f=Xn(),h=i(Ru()),y=function(S){return S.length>0};e.isNonEmpty=y;var D=function(S,d){return S<0||S>=d.length};e.isOutOfBound=D;var P=function(S){return function(d){return a([S],d,!0)}};e.prependW=P,e.prepend=e.prependW;var q=function(S){return function(d){return a(a([],d,!0),[S],!1)}};e.appendW=q,e.append=e.appendW;var N=function(S,d,p){if((0,e.isNonEmpty)(p)){var R=(0,e.fromReadonlyNonEmptyArray)(p);return R.splice(S,0,d),R}return[d]};e.unsafeInsertAt=N;var b=function(S,d,p){var R=(0,e.fromReadonlyNonEmptyArray)(p);return R[S]=d,R};e.unsafeUpdateAt=b;var M=function(S){return function(d){if(d.length===1)return(0,e.copy)(d);for(var p=[(0,e.head)(d)],R=(0,e.tail)(d),x=function(Ae){p.every(function(we){return!S.equals(we,Ae)})&&p.push(Ae)},K=0,ee=R;K<ee.length;K++){var ue=ee[K];x(ue)}return p}};e.uniq=M;var B=function(S){if((0,e.isNonEmpty)(S)){var d=(0,f.getMonoid)();return(0,e.sort)(S.reduce(d.concat,d.empty))}return e.copy};e.sortBy=B;var L=function(S){var d=(0,e.uniq)(S);return function(p){return function(R){return d((0,s.pipe)(R,ge(p)))}}};e.union=L;var W=function(S){return function(d){var p=d.length,R=Math.round(S)%p;if((0,e.isOutOfBound)(Math.abs(R),d)||R===0)return(0,e.copy)(d);if(R<0){var x=(0,e.splitAt)(-R)(d),K=x[0],ee=x[1];return(0,s.pipe)(ee,ge(K))}else return(0,e.rotate)(R-p)(d)}};e.rotate=W,e.fromReadonlyNonEmptyArray=l.fromReadonlyNonEmptyArray;var $=function(S){return(0,e.isNonEmpty)(S)?l.some(S):l.none};e.fromArray=$;var E=function(S){return function(d){for(var p=Math.max(0,Math.floor(d)),R=[S(0)],x=1;x<p;x++)R.push(S(x));return R}};e.makeBy=E;var I=function(S){return(0,e.makeBy)(function(){return S})};e.replicate=I;var H=function(S,d){return S<=d?(0,e.makeBy)(function(p){return S+p})(d-S+1):[S]};e.range=H;var U=function(S){return[(0,e.head)(S),(0,e.tail)(S)]};e.unprepend=U;var Q=function(S){return[(0,e.init)(S),(0,e.last)(S)]};e.unappend=Q;function ae(S){return function(d){return d.concat(S)}}e.concatW=ae;function ge(S,d){return d?S.concat(d):function(p){return p.concat(S)}}e.concat=ge;var he=function(S){return a([(0,e.last)(S)],S.slice(0,-1).reverse(),!0)};e.reverse=he;function ze(S){return function(d){var p=d.length;if(p===0)return[];for(var R=[],x=d[0],K=[x],ee=1;ee<p;ee++){var ue=d[ee];S.equals(ue,x)?K.push(ue):(R.push(K),x=ue,K=[x])}return R.push(K),R}}e.group=ze;var st=function(S){return function(d){for(var p={},R=0,x=d;R<x.length;R++){var K=x[R],ee=S(K);l.has.call(p,ee)?p[ee].push(K):p[ee]=[K]}return p}};e.groupBy=st;var ct=function(S){return function(d){return d.slice().sort(S.compare)}};e.sort=ct;var xt=function(S,d){return function(p){return S<0||S>p.length?l.none:l.some((0,e.unsafeInsertAt)(S,d,p))}};e.insertAt=xt;var ir=function(S,d){return(0,e.modifyAt)(S,function(){return d})};e.updateAt=ir;var ar=function(S,d){return function(p){return(0,e.isOutOfBound)(S,p)?l.none:l.some((0,e.unsafeUpdateAt)(S,d(p[S]),p))}};e.modifyAt=ar,e.copy=e.fromReadonlyNonEmptyArray;var ur=function(S){return[S]};e.of=ur;var Ht=function(S,d,p){for(var R=[p(S[0],d[0])],x=Math.min(S.length,d.length),K=1;K<x;K++)R[K]=p(S[K],d[K]);return R};e.zipWith=Ht;function Wt(S,d){return d===void 0?function(p){return Wt(p,S)}:(0,e.zipWith)(S,d,function(p,R){return[p,R]})}e.zip=Wt;var or=function(S){for(var d=[S[0][0]],p=[S[0][1]],R=1;R<S.length;R++)d[R]=S[R][0],p[R]=S[R][1];return[d,p]};e.unzip=or;var Kt=function(S){return function(d){for(var p=[S,d[0]],R=1;R<d.length;R++)p.push(S,d[R]);return p}};e.prependAll=Kt;var Jt=function(S){return function(d){var p=(0,e.tail)(d);return(0,e.isNonEmpty)(p)?(0,s.pipe)(p,(0,e.prependAll)(S),(0,e.prepend)((0,e.head)(d))):(0,e.copy)(d)}};e.intersperse=Jt,e.foldMapWithIndex=h.foldMapWithIndex,e.foldMap=h.foldMap;var sr=function(S){return function(d){for(var p=(0,e.fromReadonlyNonEmptyArray)(S(0,(0,e.head)(d))),R=1;R<d.length;R++)p.push.apply(p,S(R,d[R]));return p}};e.chainWithIndex=sr;var cr=function(S){return function(d){for(var p=S(d),R=p[0],x=p[1],K=[R],ee=x;(0,e.isNonEmpty)(ee);){var ue=S(ee),Ae=ue[0],we=ue[1];K.push(Ae),ee=we}return K}};e.chop=cr;var lr=function(S){return function(d){var p=Math.max(1,S);return p>=d.length?[(0,e.copy)(d),[]]:[(0,s.pipe)(d.slice(1,p),(0,e.prepend)((0,e.head)(d))),d.slice(p)]}};e.splitAt=lr;var We=function(S){return(0,e.chop)((0,e.splitAt)(S))};e.chunksOf=We;var de=function(S,d){return(0,s.pipe)(S,(0,e.map)(d))},Ye=function(S,d){return(0,s.pipe)(S,(0,e.mapWithIndex)(d))},be=function(S,d){return(0,s.pipe)(S,(0,e.ap)(d))},_e=function(S,d){return(0,s.pipe)(S,(0,e.extend)(d))},$e=function(S,d,p){return(0,s.pipe)(S,(0,e.reduce)(d,p))},Se=function(S){var d=(0,e.foldMap)(S);return function(p,R){return(0,s.pipe)(p,d(R))}},Ce=function(S,d,p){return(0,s.pipe)(S,(0,e.reduceRight)(d,p))},De=function(S){var d=(0,e.traverse)(S);return function(p,R){return(0,s.pipe)(p,d(R))}},lt=function(S,d){return(0,s.pipe)(S,(0,e.alt)(d))},Xe=function(S,d,p){return(0,s.pipe)(S,(0,e.reduceWithIndex)(d,p))},pt=function(S){var d=(0,e.foldMapWithIndex)(S);return function(p,R){return(0,s.pipe)(p,d(R))}},ft=function(S,d,p){return(0,s.pipe)(S,(0,e.reduceRightWithIndex)(d,p))},se=function(S){var d=(0,e.traverseWithIndex)(S);return function(p,R){return(0,s.pipe)(p,d(R))}},oe=function(S){return function(d){return(0,s.pipe)(d,ae(S()))}};e.altW=oe,e.alt=e.altW;var wt=function(S){return(0,e.flatMap)(function(d){return(0,s.pipe)(S,(0,e.map)(d))})};e.ap=wt,e.flatMap=(0,s.dual)(2,function(S,d){return(0,s.pipe)(S,(0,e.chainWithIndex)(function(p,R){return d(R,p)}))});var Ze=function(S){return function(d){for(var p=(0,e.tail)(d),R=[S(d)];(0,e.isNonEmpty)(p);)R.push(S(p)),p=(0,e.tail)(p);return R}};e.extend=Ze,e.duplicate=(0,e.extend)(s.identity),e.flatten=(0,e.flatMap)(s.identity);var ce=function(S){return(0,e.mapWithIndex)(function(d,p){return S(p)})};e.map=ce;var ht=function(S){return function(d){for(var p=[S(0,(0,e.head)(d))],R=1;R<d.length;R++)p.push(S(R,d[R]));return p}};e.mapWithIndex=ht,e.reduce=h.reduce,e.reduceWithIndex=h.reduceWithIndex,e.reduceRight=h.reduceRight,e.reduceRightWithIndex=h.reduceRightWithIndex;var Ue=function(S){var d=(0,e.traverseWithIndex)(S);return function(p){return d(function(R,x){return p(x)})}};e.traverse=Ue;var T=function(S){return(0,e.traverseWithIndex)(S)(function(d,p){return p})};e.sequence=T;var Et=function(S){return function(d){return function(p){for(var R=S.map(d(0,(0,e.head)(p)),e.of),x=1;x<p.length;x++)R=S.ap(S.map(R,function(K){return function(ee){return(0,s.pipe)(K,(0,e.append)(ee))}}),d(x,p[x]));return R}}};e.traverseWithIndex=Et,e.extract=h.head,e.URI="NonEmptyArray",e.getShow=h.getShow;var ve=function(){return{concat:ge}};e.getSemigroup=ve,e.getEq=h.getEq;var He=function(S){var d=(0,e.union)(S);return{concat:function(p,R){return d(R)(p)}}};e.getUnionSemigroup=He,e.Functor={URI:e.URI,map:de},e.flap=(0,c.flap)(e.Functor),e.Pointed={URI:e.URI,of:e.of},e.FunctorWithIndex={URI:e.URI,map:de,mapWithIndex:Ye},e.Apply={URI:e.URI,map:de,ap:be},e.apFirst=(0,u.apFirst)(e.Apply),e.apSecond=(0,u.apSecond)(e.Apply),e.Applicative={URI:e.URI,map:de,ap:be,of:e.of},e.Chain={URI:e.URI,map:de,ap:be,chain:e.flatMap},e.chainFirst=(0,o.chainFirst)(e.Chain),e.Monad={URI:e.URI,map:de,ap:be,of:e.of,chain:e.flatMap},e.Foldable={URI:e.URI,reduce:$e,foldMap:Se,reduceRight:Ce},e.FoldableWithIndex={URI:e.URI,reduce:$e,foldMap:Se,reduceRight:Ce,reduceWithIndex:Xe,foldMapWithIndex:pt,reduceRightWithIndex:ft},e.Traversable={URI:e.URI,map:de,reduce:$e,foldMap:Se,reduceRight:Ce,traverse:De,sequence:e.sequence},e.TraversableWithIndex={URI:e.URI,map:de,mapWithIndex:Ye,reduce:$e,foldMap:Se,reduceRight:Ce,traverse:De,sequence:e.sequence,reduceWithIndex:Xe,foldMapWithIndex:pt,reduceRightWithIndex:ft,traverseWithIndex:se},e.Alt={URI:e.URI,map:de,alt:lt},e.Comonad={URI:e.URI,map:de,extend:_e,extract:e.extract},e.Do=(0,e.of)(l.emptyRecord),e.bindTo=(0,c.bindTo)(e.Functor);var St=(0,c.let)(e.Functor);e.let=St,e.bind=(0,o.bind)(e.Chain),e.apS=(0,u.apS)(e.Apply),e.head=h.head;var Mt=function(S){return S.slice(1)};e.tail=Mt,e.last=h.last;var dt=function(S){return S.slice(0,-1)};e.init=dt,e.min=h.min,e.max=h.max;var It=function(S){return function(d){return d.reduce(S.concat)}};e.concatAll=It;var vt=function(S){return function(d){return S((0,e.head)(d),(0,e.tail)(d))}};e.matchLeft=vt;var tt=function(S){return function(d){return S((0,e.init)(d),(0,e.last)(d))}};e.matchRight=tt;var ne=function(S){return function(d){return a([S((0,e.head)(d))],(0,e.tail)(d),!0)}};e.modifyHead=ne;var Pe=function(S){return(0,e.modifyHead)(function(){return S})};e.updateHead=Pe;var Re=function(S){return function(d){return(0,s.pipe)((0,e.init)(d),(0,e.append)(S((0,e.last)(d))))}};e.modifyLast=Re;var yt=function(S){return(0,e.modifyLast)(function(){return S})};e.updateLast=yt,e.intercalate=h.intercalate,e.chain=e.flatMap;function it(S){var d=(0,e.sort)(S),p=ze(S);return function(R){return(0,e.isNonEmpty)(R)?p(d(R)):[]}}e.groupSort=it;function Qe(S){return(0,e.filterWithIndex)(function(d,p){return S(p)})}e.filter=Qe;var Dt=function(S){return function(d){return(0,e.fromArray)(d.filter(function(p,R){return S(R,p)}))}};e.filterWithIndex=Dt,e.uncons=e.unprepend,e.unsnoc=e.unappend;function kt(S,d){return d===void 0?(0,e.prepend)(S):(0,s.pipe)(d,(0,e.prepend)(S))}e.cons=kt;var Ot=function(S,d){return(0,s.pipe)(S,(0,e.append)(d))};e.snoc=Ot,e.prependToAll=e.prependAll,e.fold=h.concatAll,e.nonEmptyArray={URI:e.URI,of:e.of,map:de,mapWithIndex:Ye,ap:be,chain:e.flatMap,extend:_e,extract:e.extract,reduce:$e,foldMap:Se,reduceRight:Ce,traverse:De,sequence:e.sequence,reduceWithIndex:Xe,foldMapWithIndex:pt,reduceRightWithIndex:ft,traverseWithIndex:se,alt:lt}}}),Qs=je({"node_modules/fp-ts/lib/number.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Field=e.MonoidProduct=e.MonoidSum=e.SemigroupProduct=e.SemigroupSum=e.MagmaSub=e.Show=e.Bounded=e.Ord=e.Eq=e.isNumber=void 0;var r=function(n){return typeof n=="number"};e.isNumber=r,e.Eq={equals:function(n,i){return n===i}},e.Ord={equals:e.Eq.equals,compare:function(n,i){return n<i?-1:n>i?1:0}},e.Bounded={equals:e.Eq.equals,compare:e.Ord.compare,top:1/0,bottom:-1/0},e.Show={show:function(n){return JSON.stringify(n)}},e.MagmaSub={concat:function(n,i){return n-i}},e.SemigroupSum={concat:function(n,i){return n+i}},e.SemigroupProduct={concat:function(n,i){return n*i}},e.MonoidSum={concat:e.SemigroupSum.concat,empty:0},e.MonoidProduct={concat:e.SemigroupProduct.concat,empty:1},e.Field={add:e.SemigroupSum.concat,zero:0,mul:e.SemigroupProduct.concat,one:1,sub:e.MagmaSub.concat,degree:function(n){return 1},div:function(n,i){return n/i},mod:function(n,i){return n%i}}}}),ec=je({"node_modules/fp-ts/lib/Separated.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.right=e.left=e.flap=e.Functor=e.Bifunctor=e.URI=e.bimap=e.mapLeft=e.map=e.separated=void 0;var r=Ft(),n=Yn(),i=function(y,D){return{left:y,right:D}};e.separated=i;var a=function(y,D){return(0,r.pipe)(y,(0,e.map)(D))},u=function(y,D){return(0,r.pipe)(y,(0,e.mapLeft)(D))},o=function(y,D,P){return(0,r.pipe)(y,(0,e.bimap)(D,P))},s=function(y){return function(D){return(0,e.separated)((0,e.left)(D),y((0,e.right)(D)))}};e.map=s;var c=function(y){return function(D){return(0,e.separated)(y((0,e.left)(D)),(0,e.right)(D))}};e.mapLeft=c;var l=function(y,D){return function(P){return(0,e.separated)(y((0,e.left)(P)),D((0,e.right)(P)))}};e.bimap=l,e.URI="Separated",e.Bifunctor={URI:e.URI,mapLeft:u,bimap:o},e.Functor={URI:e.URI,map:a},e.flap=(0,n.flap)(e.Functor);var f=function(y){return y.left};e.left=f;var h=function(y){return y.right};e.right=h}}),tc=je({"node_modules/fp-ts/lib/Witherable.js"(e){var r=e&&e.__createBinding||(Object.create?function(c,l,f,h){h===void 0&&(h=f);var y=Object.getOwnPropertyDescriptor(l,f);(!y||("get"in y?!l.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return l[f]}}),Object.defineProperty(c,h,y)}:function(c,l,f,h){h===void 0&&(h=f),c[h]=l[f]}),n=e&&e.__setModuleDefault||(Object.create?function(c,l){Object.defineProperty(c,"default",{enumerable:!0,value:l})}:function(c,l){c.default=l}),i=e&&e.__importStar||function(c){if(c&&c.__esModule)return c;var l={};if(c!=null)for(var f in c)f!=="default"&&Object.prototype.hasOwnProperty.call(c,f)&&r(l,c,f);return n(l,c),l};Object.defineProperty(e,"__esModule",{value:!0}),e.filterE=e.witherDefault=e.wiltDefault=void 0;var a=i(Mr());function u(c,l){return function(f){var h=c.traverse(f);return function(y,D){return f.map(h(y,D),l.separate)}}}e.wiltDefault=u;function o(c,l){return function(f){var h=c.traverse(f);return function(y,D){return f.map(h(y,D),l.compact)}}}e.witherDefault=o;function s(c){return function(l){var f=c.wither(l);return function(h){return function(y){return f(y,function(D){return l.map(h(D),function(P){return P?a.some(D):a.none})})}}}}e.filterE=s}}),rc=je({"node_modules/fp-ts/lib/Zero.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.guard=void 0;function r(n,i){return function(a){return a?i.of(void 0):n.zero()}}e.guard=r}}),sv=je({"node_modules/fp-ts/lib/ReadonlyArray.js"(e){var r=e&&e.__createBinding||(Object.create?function(v,m,w,k){k===void 0&&(k=w);var G=Object.getOwnPropertyDescriptor(m,w);(!G||("get"in G?!m.__esModule:G.writable||G.configurable))&&(G={enumerable:!0,get:function(){return m[w]}}),Object.defineProperty(v,k,G)}:function(v,m,w,k){k===void 0&&(k=w),v[k]=m[w]}),n=e&&e.__setModuleDefault||(Object.create?function(v,m){Object.defineProperty(v,"default",{enumerable:!0,value:m})}:function(v,m){v.default=m}),i=e&&e.__importStar||function(v){if(v&&v.__esModule)return v;var m={};if(v!=null)for(var w in v)w!=="default"&&Object.prototype.hasOwnProperty.call(v,w)&&r(m,v,w);return n(m,v),m},a=e&&e.__spreadArray||function(v,m,w){if(w||arguments.length===2)for(var k=0,G=m.length,X;k<G;k++)(X||!(k in m))&&(X||(X=Array.prototype.slice.call(m,0,k)),X[k]=m[k]);return v.concat(X||Array.prototype.slice.call(m))};Object.defineProperty(e,"__esModule",{value:!0}),e.sort=e.lefts=e.rights=e.reverse=e.modifyAt=e.deleteAt=e.updateAt=e.insertAt=e.findLastIndex=e.findLastMap=e.findLast=e.findFirstMap=e.findFirst=e.findIndex=e.dropLeftWhile=e.dropRight=e.dropLeft=e.spanLeft=e.takeLeftWhile=e.takeRight=e.takeLeft=e.init=e.tail=e.last=e.head=e.lookup=e.isOutOfBound=e.size=e.scanRight=e.scanLeft=e.chainWithIndex=e.foldRight=e.matchRight=e.matchRightW=e.foldLeft=e.matchLeft=e.matchLeftW=e.match=e.matchW=e.fromEither=e.fromOption=e.fromPredicate=e.replicate=e.makeBy=e.appendW=e.append=e.prependW=e.prepend=e.isNonEmpty=e.isEmpty=void 0,e.sequence=e.traverse=e.reduceRightWithIndex=e.reduceRight=e.reduceWithIndex=e.foldMap=e.reduce=e.foldMapWithIndex=e.duplicate=e.extend=e.filterWithIndex=e.partitionMapWithIndex=e.partitionMap=e.partitionWithIndex=e.partition=e.compact=e.filterMap=e.filterMapWithIndex=e.filter=e.separate=e.mapWithIndex=e.map=e.flatten=e.flatMap=e.ap=e.alt=e.altW=e.zero=e.of=e._chainRecBreadthFirst=e._chainRecDepthFirst=e.difference=e.intersection=e.union=e.concat=e.concatW=e.comprehension=e.fromOptionK=e.chunksOf=e.splitAt=e.chop=e.sortBy=e.uniq=e.elem=e.rotate=e.intersperse=e.prependAll=e.unzip=e.zip=e.zipWith=void 0,e.toArray=e.unsafeDeleteAt=e.unsafeUpdateAt=e.unsafeInsertAt=e.fromEitherK=e.FromEither=e.filterE=e.Witherable=e.ChainRecBreadthFirst=e.chainRecBreadthFirst=e.ChainRecDepthFirst=e.chainRecDepthFirst=e.TraversableWithIndex=e.Traversable=e.FoldableWithIndex=e.Foldable=e.FilterableWithIndex=e.Filterable=e.Compactable=e.Extend=e.Alternative=e.guard=e.Zero=e.Alt=e.Unfoldable=e.chainFirst=e.Monad=e.Chain=e.Applicative=e.apSecond=e.apFirst=e.Apply=e.FunctorWithIndex=e.Pointed=e.flap=e.Functor=e.getDifferenceMagma=e.getIntersectionSemigroup=e.getUnionMonoid=e.getUnionSemigroup=e.getOrd=e.getEq=e.getMonoid=e.getSemigroup=e.getShow=e.URI=e.unfold=e.wilt=e.wither=e.traverseWithIndex=void 0,e.readonlyArray=e.prependToAll=e.snoc=e.cons=e.range=e.chain=e.apS=e.bind=e.let=e.bindTo=e.Do=e.intercalate=e.exists=e.some=e.every=e.empty=e.fromArray=void 0;var u=Hi(),o=Gn(),s=Pu(),c=Zs(),l=Ft(),f=Yn(),h=i(Mr()),y=i(Qs()),D=Xn(),P=i(Ru()),q=ec(),N=tc(),b=rc(),M=function(v){return v.length===0};e.isEmpty=M,e.isNonEmpty=P.isNonEmpty,e.prepend=P.prepend,e.prependW=P.prependW,e.append=P.append,e.appendW=P.appendW;var B=function(v,m){return v<=0?e.empty:P.makeBy(m)(v)};e.makeBy=B;var L=function(v,m){return(0,e.makeBy)(v,function(){return m})};e.replicate=L;function W(v){return function(m){return v(m)?[m]:e.empty}}e.fromPredicate=W;var $=function(v){return h.isNone(v)?e.empty:[v.value]};e.fromOption=$;var E=function(v){return h.isLeft(v)?e.empty:[v.right]};e.fromEither=E;var I=function(v,m){return function(w){return(0,e.isNonEmpty)(w)?m(w):v()}};e.matchW=I,e.match=e.matchW;var H=function(v,m){return function(w){return(0,e.isNonEmpty)(w)?m(P.head(w),P.tail(w)):v()}};e.matchLeftW=H,e.matchLeft=e.matchLeftW,e.foldLeft=e.matchLeft;var U=function(v,m){return function(w){return(0,e.isNonEmpty)(w)?m(P.init(w),P.last(w)):v()}};e.matchRightW=U,e.matchRight=e.matchRightW,e.foldRight=e.matchRight;var Q=function(v){return function(m){if((0,e.isEmpty)(m))return e.empty;for(var w=[],k=0;k<m.length;k++)w.push.apply(w,v(k,m[k]));return w}};e.chainWithIndex=Q;var ae=function(v,m){return function(w){var k=w.length,G=new Array(k+1);G[0]=v;for(var X=0;X<k;X++)G[X+1]=m(G[X],w[X]);return G}};e.scanLeft=ae;var ge=function(v,m){return function(w){var k=w.length,G=new Array(k+1);G[k]=v;for(var X=k-1;X>=0;X--)G[X]=m(w[X],G[X+1]);return G}};e.scanRight=ge;var he=function(v){return v.length};e.size=he,e.isOutOfBound=P.isOutOfBound;function ze(v,m){return m===void 0?function(w){return ze(v,w)}:(0,e.isOutOfBound)(v,m)?h.none:h.some(m[v])}e.lookup=ze;var st=function(v){return(0,e.isNonEmpty)(v)?h.some(P.head(v)):h.none};e.head=st;var ct=function(v){return(0,e.isNonEmpty)(v)?h.some(P.last(v)):h.none};e.last=ct;var xt=function(v){return(0,e.isNonEmpty)(v)?h.some(P.tail(v)):h.none};e.tail=xt;var ir=function(v){return(0,e.isNonEmpty)(v)?h.some(P.init(v)):h.none};e.init=ir;var ar=function(v){return function(m){return(0,e.isOutOfBound)(v,m)?m:v===0?e.empty:m.slice(0,v)}};e.takeLeft=ar;var ur=function(v){return function(m){return(0,e.isOutOfBound)(v,m)?m:v===0?e.empty:m.slice(-v)}};e.takeRight=ur;function Ht(v){return function(m){for(var w=[],k=0,G=m;k<G.length;k++){var X=G[k];if(!v(X))break;w.push(X)}var Oe=w.length;return Oe===m.length?m:Oe===0?e.empty:w}}e.takeLeftWhile=Ht;var Wt=function(v,m){for(var w=v.length,k=0;k<w&&m(v[k]);k++);return k};function or(v){return function(m){var w=(0,e.splitAt)(Wt(m,v))(m),k=w[0],G=w[1];return{init:k,rest:G}}}e.spanLeft=or;var Kt=function(v){return function(m){return v<=0||(0,e.isEmpty)(m)?m:v>=m.length?e.empty:m.slice(v,m.length)}};e.dropLeft=Kt;var Jt=function(v){return function(m){return v<=0||(0,e.isEmpty)(m)?m:v>=m.length?e.empty:m.slice(0,m.length-v)}};e.dropRight=Jt;function sr(v){return function(m){var w=Wt(m,v);return w===0?m:w===m.length?e.empty:m.slice(w)}}e.dropLeftWhile=sr;var cr=function(v){return function(m){for(var w=0;w<m.length;w++)if(v(m[w]))return h.some(w);return h.none}};e.findIndex=cr;function lr(v){return function(m){for(var w=0;w<m.length;w++)if(v(m[w]))return h.some(m[w]);return h.none}}e.findFirst=lr;var We=function(v){return function(m){for(var w=0;w<m.length;w++){var k=v(m[w]);if(h.isSome(k))return k}return h.none}};e.findFirstMap=We;function de(v){return function(m){for(var w=m.length-1;w>=0;w--)if(v(m[w]))return h.some(m[w]);return h.none}}e.findLast=de;var Ye=function(v){return function(m){for(var w=m.length-1;w>=0;w--){var k=v(m[w]);if(h.isSome(k))return k}return h.none}};e.findLastMap=Ye;var be=function(v){return function(m){for(var w=m.length-1;w>=0;w--)if(v(m[w]))return h.some(w);return h.none}};e.findLastIndex=be;var _e=function(v,m){return function(w){return v<0||v>w.length?h.none:h.some(P.unsafeInsertAt(v,m,w))}};e.insertAt=_e;var $e=function(v,m){return(0,e.modifyAt)(v,function(){return m})};e.updateAt=$e;var Se=function(v){return function(m){return(0,e.isOutOfBound)(v,m)?h.none:h.some((0,e.unsafeDeleteAt)(v,m))}};e.deleteAt=Se;var Ce=function(v,m){return function(w){return(0,e.isOutOfBound)(v,w)?h.none:h.some((0,e.unsafeUpdateAt)(v,m(w[v]),w))}};e.modifyAt=Ce;var De=function(v){return v.length<=1?v:v.slice().reverse()};e.reverse=De;var lt=function(v){for(var m=[],w=0;w<v.length;w++){var k=v[w];k._tag==="Right"&&m.push(k.right)}return m};e.rights=lt;var Xe=function(v){for(var m=[],w=0;w<v.length;w++){var k=v[w];k._tag==="Left"&&m.push(k.left)}return m};e.lefts=Xe;var pt=function(v){return function(m){return m.length<=1?m:m.slice().sort(v.compare)}};e.sort=pt;var ft=function(v,m,w){for(var k=[],G=Math.min(v.length,m.length),X=0;X<G;X++)k[X]=w(v[X],m[X]);return k};e.zipWith=ft;function se(v,m){return m===void 0?function(w){return se(w,v)}:(0,e.zipWith)(v,m,function(w,k){return[w,k]})}e.zip=se;var oe=function(v){for(var m=[],w=[],k=0;k<v.length;k++)m[k]=v[k][0],w[k]=v[k][1];return[m,w]};e.unzip=oe;var wt=function(v){var m=P.prependAll(v);return function(w){return(0,e.isNonEmpty)(w)?m(w):w}};e.prependAll=wt;var Ze=function(v){var m=P.intersperse(v);return function(w){return(0,e.isNonEmpty)(w)?m(w):w}};e.intersperse=Ze;var ce=function(v){var m=P.rotate(v);return function(w){return(0,e.isNonEmpty)(w)?m(w):w}};e.rotate=ce;function ht(v){return function(m,w){if(w===void 0){var k=ht(v);return function(Oe){return k(m,Oe)}}for(var G=function(Oe){return v.equals(Oe,m)},X=0;X<w.length;X++)if(G(w[X]))return!0;return!1}}e.elem=ht;var Ue=function(v){var m=P.uniq(v);return function(w){return(0,e.isNonEmpty)(w)?m(w):w}};e.uniq=Ue;var T=function(v){var m=P.sortBy(v);return function(w){return(0,e.isNonEmpty)(w)?m(w):w}};e.sortBy=T;var Et=function(v){var m=P.chop(v);return function(w){return(0,e.isNonEmpty)(w)?m(w):e.empty}};e.chop=Et;var ve=function(v){return function(m){return v>=1&&(0,e.isNonEmpty)(m)?P.splitAt(v)(m):(0,e.isEmpty)(m)?[m,e.empty]:[e.empty,m]}};e.splitAt=ve;var He=function(v){var m=P.chunksOf(v);return function(w){return(0,e.isNonEmpty)(w)?m(w):e.empty}};e.chunksOf=He;var St=function(v){return function(){for(var m=[],w=0;w<arguments.length;w++)m[w]=arguments[w];return(0,e.fromOption)(v.apply(void 0,m))}};e.fromOptionK=St;function Mt(v,m,w){w===void 0&&(w=function(){return!0});var k=function(G,X){return(0,e.isNonEmpty)(X)?(0,e.flatMap)(P.head(X),function(Oe){return k((0,l.pipe)(G,(0,e.append)(Oe)),P.tail(X))}):w.apply(void 0,G)?[m.apply(void 0,G)]:e.empty};return k(e.empty,v)}e.comprehension=Mt;var dt=function(v){return function(m){return(0,e.isEmpty)(m)?v:(0,e.isEmpty)(v)?m:m.concat(v)}};e.concatW=dt,e.concat=e.concatW;function It(v){var m=P.union(v);return function(w,k){if(k===void 0){var G=It(v);return function(X){return G(X,w)}}return(0,e.isNonEmpty)(w)&&(0,e.isNonEmpty)(k)?m(k)(w):(0,e.isNonEmpty)(w)?w:k}}e.union=It;function vt(v){var m=ht(v);return function(w,k){if(k===void 0){var G=vt(v);return function(X){return G(X,w)}}return w.filter(function(X){return m(X,k)})}}e.intersection=vt;function tt(v){var m=ht(v);return function(w,k){if(k===void 0){var G=tt(v);return function(X){return G(X,w)}}return w.filter(function(X){return!m(X,k)})}}e.difference=tt;var ne=function(v,m){return(0,l.pipe)(v,(0,e.map)(m))},Pe=function(v,m){return(0,l.pipe)(v,(0,e.mapWithIndex)(m))},Re=function(v,m){return(0,l.pipe)(v,(0,e.ap)(m))},yt=function(v,m){return(0,l.pipe)(v,(0,e.filter)(m))},it=function(v,m){return(0,l.pipe)(v,(0,e.filterMap)(m))},Qe=function(v,m){return(0,l.pipe)(v,(0,e.partition)(m))},Dt=function(v,m){return(0,l.pipe)(v,(0,e.partitionMap)(m))},kt=function(v,m){return(0,l.pipe)(v,(0,e.partitionWithIndex)(m))},Ot=function(v,m){return(0,l.pipe)(v,(0,e.partitionMapWithIndex)(m))},S=function(v,m){return(0,l.pipe)(v,(0,e.alt)(m))},d=function(v,m,w){return(0,l.pipe)(v,(0,e.reduce)(m,w))},p=function(v){var m=(0,e.foldMap)(v);return function(w,k){return(0,l.pipe)(w,m(k))}},R=function(v,m,w){return(0,l.pipe)(v,(0,e.reduceRight)(m,w))},x=function(v,m,w){return(0,l.pipe)(v,(0,e.reduceWithIndex)(m,w))},K=function(v){var m=(0,e.foldMapWithIndex)(v);return function(w,k){return(0,l.pipe)(w,m(k))}},ee=function(v,m,w){return(0,l.pipe)(v,(0,e.reduceRightWithIndex)(m,w))},ue=function(v,m){return(0,l.pipe)(v,(0,e.filterMapWithIndex)(m))},Ae=function(v,m){return(0,l.pipe)(v,(0,e.filterWithIndex)(m))},we=function(v,m){return(0,l.pipe)(v,(0,e.extend)(m))},rt=function(v){var m=(0,e.traverse)(v);return function(w,k){return(0,l.pipe)(w,m(k))}},A=function(v){var m=(0,e.traverseWithIndex)(v);return function(w,k){return(0,l.pipe)(w,m(k))}},F=function(v,m){return(0,l.pipe)(v,(0,e.chainRecDepthFirst)(m))};e._chainRecDepthFirst=F;var z=function(v,m){return(0,l.pipe)(v,(0,e.chainRecBreadthFirst)(m))};e._chainRecBreadthFirst=z,e.of=P.of;var j=function(){return e.empty};e.zero=j;var te=function(v){return function(m){return m.concat(v())}};e.altW=te,e.alt=e.altW;var le=function(v){return(0,e.flatMap)(function(m){return(0,l.pipe)(v,(0,e.map)(m))})};e.ap=le,e.flatMap=(0,l.dual)(2,function(v,m){return(0,l.pipe)(v,(0,e.chainWithIndex)(function(w,k){return m(k,w)}))}),e.flatten=(0,e.flatMap)(l.identity);var Me=function(v){return function(m){return m.map(function(w){return v(w)})}};e.map=Me;var mt=function(v){return function(m){return m.map(function(w,k){return v(k,w)})}};e.mapWithIndex=mt;var Gt=function(v){for(var m=[],w=[],k=0,G=v;k<G.length;k++){var X=G[k];X._tag==="Left"?m.push(X.left):w.push(X.right)}return(0,q.separated)(m,w)};e.separate=Gt;var me=function(v){return function(m){return m.filter(v)}};e.filter=me;var Te=function(v){return function(m){for(var w=[],k=0;k<m.length;k++){var G=v(k,m[k]);h.isSome(G)&&w.push(G.value)}return w}};e.filterMapWithIndex=Te;var fe=function(v){return(0,e.filterMapWithIndex)(function(m,w){return v(w)})};e.filterMap=fe,e.compact=(0,e.filterMap)(l.identity);var ke=function(v){return(0,e.partitionWithIndex)(function(m,w){return v(w)})};e.partition=ke;var at=function(v){return function(m){for(var w=[],k=[],G=0;G<m.length;G++){var X=m[G];v(G,X)?k.push(X):w.push(X)}return(0,q.separated)(w,k)}};e.partitionWithIndex=at;var qe=function(v){return(0,e.partitionMapWithIndex)(function(m,w){return v(w)})};e.partitionMap=qe;var Lt=function(v){return function(m){for(var w=[],k=[],G=0;G<m.length;G++){var X=v(G,m[G]);X._tag==="Left"?w.push(X.left):k.push(X.right)}return(0,q.separated)(w,k)}};e.partitionMapWithIndex=Lt;var bt=function(v){return function(m){return m.filter(function(w,k){return v(k,w)})}};e.filterWithIndex=bt;var _t=function(v){return function(m){return m.map(function(w,k){return v(m.slice(k))})}};e.extend=_t,e.duplicate=(0,e.extend)(l.identity);var $t=function(v){return function(m){return function(w){return w.reduce(function(k,G,X){return v.concat(k,m(X,G))},v.empty)}}};e.foldMapWithIndex=$t;var Dr=function(v,m){return(0,e.reduceWithIndex)(v,function(w,k,G){return m(k,G)})};e.reduce=Dr;var zr=function(v){var m=(0,e.foldMapWithIndex)(v);return function(w){return m(function(k,G){return w(G)})}};e.foldMap=zr;var Mn=function(v,m){return function(w){for(var k=w.length,G=v,X=0;X<k;X++)G=m(X,G,w[X]);return G}};e.reduceWithIndex=Mn;var _a=function(v,m){return(0,e.reduceRightWithIndex)(v,function(w,k,G){return m(k,G)})};e.reduceRight=_a;var Pa=function(v,m){return function(w){return w.reduceRight(function(k,G,X){return m(X,G,k)},v)}};e.reduceRightWithIndex=Pa;var Ra=function(v){var m=(0,e.traverseWithIndex)(v);return function(w){return m(function(k,G){return w(G)})}};e.traverse=Ra;var Ba=function(v){return function(m){return d(m,v.of((0,e.zero)()),function(w,k){return v.ap(v.map(w,function(G){return function(X){return(0,l.pipe)(G,(0,e.append)(X))}}),k)})}};e.sequence=Ba;var g=function(v){return function(m){return(0,e.reduceWithIndex)(v.of((0,e.zero)()),function(w,k,G){return v.ap(v.map(k,function(X){return function(Oe){return(0,l.pipe)(X,(0,e.append)(Oe))}}),m(w,G))})}};e.traverseWithIndex=g;var C=function(v){var m=za(v);return function(w){return function(k){return m(k,w)}}};e.wither=C;var _=function(v){var m=Wa(v);return function(w){return function(k){return m(k,w)}}};e.wilt=_;var V=function(v,m){for(var w=[],k=v;;){var G=m(k);if(h.isSome(G)){var X=G.value,Oe=X[0],kr=X[1];w.push(Oe),k=kr}else break}return w};e.unfold=V,e.URI="ReadonlyArray";var re=function(v){return{show:function(m){return"[".concat(m.map(v.show).join(", "),"]")}}};e.getShow=re;var ie=function(){return{concat:function(v,m){return(0,e.isEmpty)(v)?m:(0,e.isEmpty)(m)?v:v.concat(m)}}};e.getSemigroup=ie;var Wr=function(){return{concat:(0,e.getSemigroup)().concat,empty:e.empty}};e.getMonoid=Wr;var Na=function(v){return(0,s.fromEquals)(function(m,w){return m.length===w.length&&m.every(function(k,G){return v.equals(k,w[G])})})};e.getEq=Na;var N0=function(v){return(0,D.fromCompare)(function(m,w){for(var k=m.length,G=w.length,X=Math.min(k,G),Oe=0;Oe<X;Oe++){var kr=v.compare(m[Oe],w[Oe]);if(kr!==0)return kr}return y.Ord.compare(k,G)})};e.getOrd=N0;var z0=function(v){var m=It(v);return{concat:function(w,k){return m(k)(w)}}};e.getUnionSemigroup=z0;var W0=function(v){return{concat:(0,e.getUnionSemigroup)(v).concat,empty:e.empty}};e.getUnionMonoid=W0;var k0=function(v){var m=vt(v);return{concat:function(w,k){return m(k)(w)}}};e.getIntersectionSemigroup=k0;var O0=function(v){var m=tt(v);return{concat:function(w,k){return m(k)(w)}}};e.getDifferenceMagma=O0,e.Functor={URI:e.URI,map:ne},e.flap=(0,f.flap)(e.Functor),e.Pointed={URI:e.URI,of:e.of},e.FunctorWithIndex={URI:e.URI,map:ne,mapWithIndex:Pe},e.Apply={URI:e.URI,map:ne,ap:Re},e.apFirst=(0,u.apFirst)(e.Apply),e.apSecond=(0,u.apSecond)(e.Apply),e.Applicative={URI:e.URI,map:ne,ap:Re,of:e.of},e.Chain={URI:e.URI,map:ne,ap:Re,chain:e.flatMap},e.Monad={URI:e.URI,map:ne,ap:Re,of:e.of,chain:e.flatMap},e.chainFirst=(0,o.chainFirst)(e.Chain),e.Unfoldable={URI:e.URI,unfold:e.unfold},e.Alt={URI:e.URI,map:ne,alt:S},e.Zero={URI:e.URI,zero:e.zero},e.guard=(0,b.guard)(e.Zero,e.Pointed),e.Alternative={URI:e.URI,map:ne,ap:Re,of:e.of,alt:S,zero:e.zero},e.Extend={URI:e.URI,map:ne,extend:we},e.Compactable={URI:e.URI,compact:e.compact,separate:e.separate},e.Filterable={URI:e.URI,map:ne,compact:e.compact,separate:e.separate,filter:yt,filterMap:it,partition:Qe,partitionMap:Dt},e.FilterableWithIndex={URI:e.URI,map:ne,mapWithIndex:Pe,compact:e.compact,separate:e.separate,filter:yt,filterMap:it,partition:Qe,partitionMap:Dt,partitionMapWithIndex:Ot,partitionWithIndex:kt,filterMapWithIndex:ue,filterWithIndex:Ae},e.Foldable={URI:e.URI,reduce:d,foldMap:p,reduceRight:R},e.FoldableWithIndex={URI:e.URI,reduce:d,foldMap:p,reduceRight:R,reduceWithIndex:x,foldMapWithIndex:K,reduceRightWithIndex:ee},e.Traversable={URI:e.URI,map:ne,reduce:d,foldMap:p,reduceRight:R,traverse:rt,sequence:e.sequence},e.TraversableWithIndex={URI:e.URI,map:ne,mapWithIndex:Pe,reduce:d,foldMap:p,reduceRight:R,reduceWithIndex:x,foldMapWithIndex:K,reduceRightWithIndex:ee,traverse:rt,sequence:e.sequence,traverseWithIndex:A};var L0=function(v){return function(m){for(var w=a([],v(m),!0),k=[];w.length>0;){var G=w.shift();h.isLeft(G)?w.unshift.apply(w,v(G.left)):k.push(G.right)}return k}};e.chainRecDepthFirst=L0,e.ChainRecDepthFirst={URI:e.URI,map:ne,ap:Re,chain:e.flatMap,chainRec:e._chainRecDepthFirst};var $0=function(v){return function(m){var w=v(m),k=[],G=[];function X(ka){h.isLeft(ka)?v(ka.left).forEach(function(G0){return k.push(G0)}):G.push(ka.right)}for(var Oe=0,kr=w;Oe<kr.length;Oe++){var J0=kr[Oe];X(J0)}for(;k.length>0;)X(k.shift());return G}};e.chainRecBreadthFirst=$0,e.ChainRecBreadthFirst={URI:e.URI,map:ne,ap:Re,chain:e.flatMap,chainRec:e._chainRecBreadthFirst};var za=(0,N.witherDefault)(e.Traversable,e.Compactable),Wa=(0,N.wiltDefault)(e.Traversable,e.Compactable);e.Witherable={URI:e.URI,map:ne,compact:e.compact,separate:e.separate,filter:yt,filterMap:it,partition:Qe,partitionMap:Dt,reduce:d,foldMap:p,reduceRight:R,traverse:rt,sequence:e.sequence,wither:za,wilt:Wa},e.filterE=(0,N.filterE)(e.Witherable),e.FromEither={URI:e.URI,fromEither:e.fromEither},e.fromEitherK=(0,c.fromEitherK)(e.FromEither),e.unsafeInsertAt=P.unsafeInsertAt;var T0=function(v,m,w){return(0,e.isNonEmpty)(w)?P.unsafeUpdateAt(v,m,w):w};e.unsafeUpdateAt=T0;var q0=function(v,m){var w=m.slice();return w.splice(v,1),w};e.unsafeDeleteAt=q0;var j0=function(v){return v.slice()};e.toArray=j0;var U0=function(v){return(0,e.isEmpty)(v)?e.empty:v.slice()};e.fromArray=U0,e.empty=P.empty;function V0(v){return function(m){return m.every(v)}}e.every=V0;var x0=function(v){return function(m){return m.some(v)}};e.some=x0,e.exists=e.some;var H0=function(v){var m=P.intercalate(v);return function(w){return(0,e.match)(function(){return v.empty},m(w))}};e.intercalate=H0,e.Do=(0,e.of)(h.emptyRecord),e.bindTo=(0,f.bindTo)(e.Functor);var K0=(0,f.let)(e.Functor);e.let=K0,e.bind=(0,o.bind)(e.Chain),e.apS=(0,u.apS)(e.Apply),e.chain=e.flatMap,e.range=P.range,e.cons=P.cons,e.snoc=P.snoc,e.prependToAll=e.prependAll,e.readonlyArray={URI:e.URI,compact:e.compact,separate:e.separate,map:ne,ap:Re,of:e.of,chain:e.flatMap,filter:yt,filterMap:it,partition:Qe,partitionMap:Dt,mapWithIndex:Pe,partitionMapWithIndex:Ot,partitionWithIndex:kt,filterMapWithIndex:ue,filterWithIndex:Ae,alt:S,zero:e.zero,unfold:e.unfold,reduce:d,foldMap:p,reduceRight:R,traverse:rt,sequence:e.sequence,reduceWithIndex:x,foldMapWithIndex:K,reduceRightWithIndex:ee,traverseWithIndex:A,extend:we,wither:za,wilt:Wa}}}),cv=je({"node_modules/fp-ts/lib/Array.js"(e){var r=e&&e.__createBinding||(Object.create?function(g,C,_,V){V===void 0&&(V=_);var re=Object.getOwnPropertyDescriptor(C,_);(!re||("get"in re?!C.__esModule:re.writable||re.configurable))&&(re={enumerable:!0,get:function(){return C[_]}}),Object.defineProperty(g,V,re)}:function(g,C,_,V){V===void 0&&(V=_),g[V]=C[_]}),n=e&&e.__setModuleDefault||(Object.create?function(g,C){Object.defineProperty(g,"default",{enumerable:!0,value:C})}:function(g,C){g.default=C}),i=e&&e.__importStar||function(g){if(g&&g.__esModule)return g;var C={};if(g!=null)for(var _ in g)_!=="default"&&Object.prototype.hasOwnProperty.call(g,_)&&r(C,g,_);return n(C,g),C};Object.defineProperty(e,"__esModule",{value:!0}),e.lefts=e.rights=e.reverse=e.modifyAt=e.deleteAt=e.updateAt=e.insertAt=e.copy=e.findLastIndex=e.findLastMap=e.findLast=e.findFirstMap=e.findFirst=e.findIndex=e.dropLeftWhile=e.dropRight=e.dropLeft=e.spanLeft=e.takeLeftWhile=e.takeRight=e.takeLeft=e.init=e.tail=e.last=e.head=e.lookup=e.isOutOfBound=e.size=e.scanRight=e.scanLeft=e.chainWithIndex=e.foldRight=e.matchRight=e.matchRightW=e.foldLeft=e.matchLeft=e.matchLeftW=e.match=e.matchW=e.fromEither=e.fromOption=e.fromPredicate=e.replicate=e.makeBy=e.appendW=e.append=e.prependW=e.prepend=e.isNonEmpty=e.isEmpty=void 0,e.traverseWithIndex=e.sequence=e.traverse=e.reduceRightWithIndex=e.reduceRight=e.reduceWithIndex=e.reduce=e.foldMapWithIndex=e.foldMap=e.duplicate=e.extend=e.filterWithIndex=e.alt=e.altW=e.partitionMapWithIndex=e.partitionMap=e.partitionWithIndex=e.partition=e.filter=e.separate=e.compact=e.filterMap=e.filterMapWithIndex=e.mapWithIndex=e.flatten=e.flatMap=e.ap=e.map=e.zero=e.of=e.difference=e.intersection=e.union=e.concat=e.concatW=e.comprehension=e.fromOptionK=e.chunksOf=e.splitAt=e.chop=e.sortBy=e.uniq=e.elem=e.rotate=e.intersperse=e.prependAll=e.unzip=e.zip=e.zipWith=e.sort=void 0,e.some=e.every=e.unsafeDeleteAt=e.unsafeUpdateAt=e.unsafeInsertAt=e.fromEitherK=e.FromEither=e.filterE=e.ChainRecBreadthFirst=e.chainRecBreadthFirst=e.ChainRecDepthFirst=e.chainRecDepthFirst=e.Witherable=e.TraversableWithIndex=e.Traversable=e.FoldableWithIndex=e.Foldable=e.FilterableWithIndex=e.Filterable=e.Compactable=e.Extend=e.Alternative=e.guard=e.Zero=e.Alt=e.Unfoldable=e.Monad=e.chainFirst=e.Chain=e.Applicative=e.apSecond=e.apFirst=e.Apply=e.FunctorWithIndex=e.Pointed=e.flap=e.Functor=e.getDifferenceMagma=e.getIntersectionSemigroup=e.getUnionMonoid=e.getUnionSemigroup=e.getOrd=e.getEq=e.getMonoid=e.getSemigroup=e.getShow=e.URI=e.unfold=e.wilt=e.wither=void 0,e.array=e.prependToAll=e.snoc=e.cons=e.empty=e.range=e.chain=e.apS=e.bind=e.let=e.bindTo=e.Do=e.intercalate=e.exists=void 0;var a=Hi(),u=Gn(),o=Zs(),s=Ft(),c=Yn(),l=i(Mr()),f=i(ov()),h=i(sv()),y=ec(),D=tc(),P=rc(),q=function(g){return g.length===0};e.isEmpty=q,e.isNonEmpty=f.isNonEmpty,e.prepend=f.prepend,e.prependW=f.prependW,e.append=f.append,e.appendW=f.appendW;var N=function(g,C){return g<=0?[]:f.makeBy(C)(g)};e.makeBy=N;var b=function(g,C){return(0,e.makeBy)(g,function(){return C})};e.replicate=b;function M(g){return function(C){return g(C)?[C]:[]}}e.fromPredicate=M;var B=function(g){return l.isNone(g)?[]:[g.value]};e.fromOption=B;var L=function(g){return l.isLeft(g)?[]:[g.right]};e.fromEither=L;var W=function(g,C){return function(_){return(0,e.isNonEmpty)(_)?C(_):g()}};e.matchW=W,e.match=e.matchW;var $=function(g,C){return function(_){return(0,e.isNonEmpty)(_)?C(f.head(_),f.tail(_)):g()}};e.matchLeftW=$,e.matchLeft=e.matchLeftW,e.foldLeft=e.matchLeft;var E=function(g,C){return function(_){return(0,e.isNonEmpty)(_)?C(f.init(_),f.last(_)):g()}};e.matchRightW=E,e.matchRight=e.matchRightW,e.foldRight=e.matchRight;var I=function(g){return function(C){for(var _=[],V=0;V<C.length;V++)_.push.apply(_,g(V,C[V]));return _}};e.chainWithIndex=I;var H=function(g,C){return function(_){var V=_.length,re=new Array(V+1);re[0]=g;for(var ie=0;ie<V;ie++)re[ie+1]=C(re[ie],_[ie]);return re}};e.scanLeft=H;var U=function(g,C){return function(_){var V=_.length,re=new Array(V+1);re[V]=g;for(var ie=V-1;ie>=0;ie--)re[ie]=C(_[ie],re[ie+1]);return re}};e.scanRight=U;var Q=function(g){return g.length};e.size=Q,e.isOutOfBound=f.isOutOfBound,e.lookup=h.lookup,e.head=h.head,e.last=h.last;var ae=function(g){return(0,e.isNonEmpty)(g)?l.some(f.tail(g)):l.none};e.tail=ae;var ge=function(g){return(0,e.isNonEmpty)(g)?l.some(f.init(g)):l.none};e.init=ge;var he=function(g){return function(C){return(0,e.isOutOfBound)(g,C)?(0,e.copy)(C):C.slice(0,g)}};e.takeLeft=he;var ze=function(g){return function(C){return(0,e.isOutOfBound)(g,C)?(0,e.copy)(C):g===0?[]:C.slice(-g)}};e.takeRight=ze;function st(g){return function(C){for(var _=[],V=0,re=C;V<re.length;V++){var ie=re[V];if(!g(ie))break;_.push(ie)}return _}}e.takeLeftWhile=st;var ct=function(g,C){for(var _=g.length,V=0;V<_&&C(g[V]);V++);return V};function xt(g){return function(C){var _=(0,e.splitAt)(ct(C,g))(C),V=_[0],re=_[1];return{init:V,rest:re}}}e.spanLeft=xt;var ir=function(g){return function(C){return g<=0||(0,e.isEmpty)(C)?(0,e.copy)(C):g>=C.length?[]:C.slice(g,C.length)}};e.dropLeft=ir;var ar=function(g){return function(C){return g<=0||(0,e.isEmpty)(C)?(0,e.copy)(C):g>=C.length?[]:C.slice(0,C.length-g)}};e.dropRight=ar;function ur(g){return function(C){return C.slice(ct(C,g))}}e.dropLeftWhile=ur,e.findIndex=h.findIndex;function Ht(g){return h.findFirst(g)}e.findFirst=Ht,e.findFirstMap=h.findFirstMap;function Wt(g){return h.findLast(g)}e.findLast=Wt,e.findLastMap=h.findLastMap,e.findLastIndex=h.findLastIndex;var or=function(g){return g.slice()};e.copy=or;var Kt=function(g,C){return function(_){return g<0||g>_.length?l.none:l.some((0,e.unsafeInsertAt)(g,C,_))}};e.insertAt=Kt;var Jt=function(g,C){return(0,e.modifyAt)(g,function(){return C})};e.updateAt=Jt;var sr=function(g){return function(C){return(0,e.isOutOfBound)(g,C)?l.none:l.some((0,e.unsafeDeleteAt)(g,C))}};e.deleteAt=sr;var cr=function(g,C){return function(_){return(0,e.isOutOfBound)(g,_)?l.none:l.some((0,e.unsafeUpdateAt)(g,C(_[g]),_))}};e.modifyAt=cr;var lr=function(g){return(0,e.isEmpty)(g)?[]:g.slice().reverse()};e.reverse=lr;var We=function(g){for(var C=[],_=0;_<g.length;_++){var V=g[_];V._tag==="Right"&&C.push(V.right)}return C};e.rights=We;var de=function(g){for(var C=[],_=0;_<g.length;_++){var V=g[_];V._tag==="Left"&&C.push(V.left)}return C};e.lefts=de;var Ye=function(g){return function(C){return C.length<=1?(0,e.copy)(C):C.slice().sort(g.compare)}};e.sort=Ye;var be=function(g,C,_){for(var V=[],re=Math.min(g.length,C.length),ie=0;ie<re;ie++)V[ie]=_(g[ie],C[ie]);return V};e.zipWith=be;function _e(g,C){return C===void 0?function(_){return _e(_,g)}:(0,e.zipWith)(g,C,function(_,V){return[_,V]})}e.zip=_e;var $e=function(g){for(var C=[],_=[],V=0;V<g.length;V++)C[V]=g[V][0],_[V]=g[V][1];return[C,_]};e.unzip=$e;var Se=function(g){var C=f.prependAll(g);return function(_){return(0,e.isNonEmpty)(_)?C(_):[]}};e.prependAll=Se;var Ce=function(g){var C=f.intersperse(g);return function(_){return(0,e.isNonEmpty)(_)?C(_):(0,e.copy)(_)}};e.intersperse=Ce;var De=function(g){var C=f.rotate(g);return function(_){return(0,e.isNonEmpty)(_)?C(_):(0,e.copy)(_)}};e.rotate=De,e.elem=h.elem;var lt=function(g){var C=f.uniq(g);return function(_){return(0,e.isNonEmpty)(_)?C(_):(0,e.copy)(_)}};e.uniq=lt;var Xe=function(g){var C=f.sortBy(g);return function(_){return(0,e.isNonEmpty)(_)?C(_):(0,e.copy)(_)}};e.sortBy=Xe;var pt=function(g){var C=f.chop(g);return function(_){return(0,e.isNonEmpty)(_)?C(_):[]}};e.chop=pt;var ft=function(g){return function(C){return g>=1&&(0,e.isNonEmpty)(C)?f.splitAt(g)(C):(0,e.isEmpty)(C)?[(0,e.copy)(C),[]]:[[],(0,e.copy)(C)]}};e.splitAt=ft;var se=function(g){var C=f.chunksOf(g);return function(_){return(0,e.isNonEmpty)(_)?C(_):[]}};e.chunksOf=se;var oe=function(g){return function(){for(var C=[],_=0;_<arguments.length;_++)C[_]=arguments[_];return(0,e.fromOption)(g.apply(void 0,C))}};e.fromOptionK=oe;function wt(g,C,_){_===void 0&&(_=function(){return!0});var V=function(re,ie){return(0,e.isNonEmpty)(ie)?(0,e.flatMap)(f.head(ie),function(Wr){return V((0,s.pipe)(re,(0,e.append)(Wr)),f.tail(ie))}):_.apply(void 0,re)?[C.apply(void 0,re)]:[]};return V([],g)}e.comprehension=wt;var Ze=function(g){return function(C){return(0,e.isEmpty)(C)?(0,e.copy)(g):(0,e.isEmpty)(g)?(0,e.copy)(C):C.concat(g)}};e.concatW=Ze,e.concat=e.concatW;function ce(g){var C=f.union(g);return function(_,V){if(V===void 0){var re=ce(g);return function(ie){return re(ie,_)}}return(0,e.isNonEmpty)(_)&&(0,e.isNonEmpty)(V)?C(V)(_):(0,e.isNonEmpty)(_)?(0,e.copy)(_):(0,e.copy)(V)}}e.union=ce;function ht(g){var C=(0,e.elem)(g);return function(_,V){if(V===void 0){var re=ht(g);return function(ie){return re(ie,_)}}return _.filter(function(ie){return C(ie,V)})}}e.intersection=ht;function Ue(g){var C=(0,e.elem)(g);return function(_,V){if(V===void 0){var re=Ue(g);return function(ie){return re(ie,_)}}return _.filter(function(ie){return!C(ie,V)})}}e.difference=Ue;var T=function(g,C){return(0,s.pipe)(g,(0,e.map)(C))},Et=function(g,C){return(0,s.pipe)(g,(0,e.mapWithIndex)(C))},ve=function(g,C){return(0,s.pipe)(g,(0,e.ap)(C))},He=function(g,C){return(0,s.pipe)(g,(0,e.filter)(C))},St=function(g,C){return(0,s.pipe)(g,(0,e.filterMap)(C))},Mt=function(g,C){return(0,s.pipe)(g,(0,e.partition)(C))},dt=function(g,C){return(0,s.pipe)(g,(0,e.partitionMap)(C))},It=function(g,C){return(0,s.pipe)(g,(0,e.partitionWithIndex)(C))},vt=function(g,C){return(0,s.pipe)(g,(0,e.partitionMapWithIndex)(C))},tt=function(g,C){return(0,s.pipe)(g,(0,e.alt)(C))},ne=function(g,C,_){return(0,s.pipe)(g,(0,e.reduce)(C,_))},Pe=function(g){var C=(0,e.foldMap)(g);return function(_,V){return(0,s.pipe)(_,C(V))}},Re=function(g,C,_){return(0,s.pipe)(g,(0,e.reduceRight)(C,_))},yt=function(g,C,_){return(0,s.pipe)(g,(0,e.reduceWithIndex)(C,_))},it=function(g){var C=(0,e.foldMapWithIndex)(g);return function(_,V){return(0,s.pipe)(_,C(V))}},Qe=function(g,C,_){return(0,s.pipe)(g,(0,e.reduceRightWithIndex)(C,_))},Dt=function(g,C){return(0,s.pipe)(g,(0,e.filterMapWithIndex)(C))},kt=function(g,C){return(0,s.pipe)(g,(0,e.filterWithIndex)(C))},Ot=function(g,C){return(0,s.pipe)(g,(0,e.extend)(C))},S=function(g){var C=(0,e.traverse)(g);return function(_,V){return(0,s.pipe)(_,C(V))}},d=function(g){var C=(0,e.traverseWithIndex)(g);return function(_,V){return(0,s.pipe)(_,C(V))}},p=h._chainRecDepthFirst,R=h._chainRecBreadthFirst;e.of=f.of;var x=function(){return[]};e.zero=x;var K=function(g){return function(C){return C.map(function(_){return g(_)})}};e.map=K;var ee=function(g){return(0,e.flatMap)(function(C){return(0,s.pipe)(g,(0,e.map)(C))})};e.ap=ee,e.flatMap=(0,s.dual)(2,function(g,C){return(0,s.pipe)(g,(0,e.chainWithIndex)(function(_,V){return C(V,_)}))}),e.flatten=(0,e.flatMap)(s.identity);var ue=function(g){return function(C){return C.map(function(_,V){return g(V,_)})}};e.mapWithIndex=ue;var Ae=function(g){return function(C){for(var _=[],V=0;V<C.length;V++){var re=g(V,C[V]);l.isSome(re)&&_.push(re.value)}return _}};e.filterMapWithIndex=Ae;var we=function(g){return(0,e.filterMapWithIndex)(function(C,_){return g(_)})};e.filterMap=we,e.compact=(0,e.filterMap)(s.identity);var rt=function(g){for(var C=[],_=[],V=0,re=g;V<re.length;V++){var ie=re[V];ie._tag==="Left"?C.push(ie.left):_.push(ie.right)}return(0,y.separated)(C,_)};e.separate=rt;var A=function(g){return function(C){return C.filter(g)}};e.filter=A;var F=function(g){return(0,e.partitionWithIndex)(function(C,_){return g(_)})};e.partition=F;var z=function(g){return function(C){for(var _=[],V=[],re=0;re<C.length;re++){var ie=C[re];g(re,ie)?V.push(ie):_.push(ie)}return(0,y.separated)(_,V)}};e.partitionWithIndex=z;var j=function(g){return(0,e.partitionMapWithIndex)(function(C,_){return g(_)})};e.partitionMap=j;var te=function(g){return function(C){for(var _=[],V=[],re=0;re<C.length;re++){var ie=g(re,C[re]);ie._tag==="Left"?_.push(ie.left):V.push(ie.right)}return(0,y.separated)(_,V)}};e.partitionMapWithIndex=te;var le=function(g){return function(C){return C.concat(g())}};e.altW=le,e.alt=e.altW;var Me=function(g){return function(C){return C.filter(function(_,V){return g(V,_)})}};e.filterWithIndex=Me;var mt=function(g){return function(C){return C.map(function(_,V){return g(C.slice(V))})}};e.extend=mt,e.duplicate=(0,e.extend)(s.identity),e.foldMap=h.foldMap,e.foldMapWithIndex=h.foldMapWithIndex,e.reduce=h.reduce,e.reduceWithIndex=h.reduceWithIndex,e.reduceRight=h.reduceRight,e.reduceRightWithIndex=h.reduceRightWithIndex;var Gt=function(g){var C=(0,e.traverseWithIndex)(g);return function(_){return C(function(V,re){return _(re)})}};e.traverse=Gt;var me=function(g){return function(C){return ne(C,g.of((0,e.zero)()),function(_,V){return g.ap(g.map(_,function(re){return function(ie){return(0,s.pipe)(re,(0,e.append)(ie))}}),V)})}};e.sequence=me;var Te=function(g){return function(C){return(0,e.reduceWithIndex)(g.of((0,e.zero)()),function(_,V,re){return g.ap(g.map(V,function(ie){return function(Wr){return(0,s.pipe)(ie,(0,e.append)(Wr))}}),C(_,re))})}};e.traverseWithIndex=Te;var fe=function(g){var C=zr(g);return function(_){return function(V){return C(V,_)}}};e.wither=fe;var ke=function(g){var C=Mn(g);return function(_){return function(V){return C(V,_)}}};e.wilt=ke;var at=function(g,C){for(var _=[],V=g;;){var re=C(V);if(l.isSome(re)){var ie=re.value,Wr=ie[0],Na=ie[1];_.push(Wr),V=Na}else break}return _};e.unfold=at,e.URI="Array",e.getShow=h.getShow;var qe=function(){return{concat:function(g,C){return g.concat(C)}}};e.getSemigroup=qe;var Lt=function(){return{concat:(0,e.getSemigroup)().concat,empty:[]}};e.getMonoid=Lt,e.getEq=h.getEq,e.getOrd=h.getOrd;var bt=function(g){var C=ce(g);return{concat:function(_,V){return C(V)(_)}}};e.getUnionSemigroup=bt;var _t=function(g){return{concat:(0,e.getUnionSemigroup)(g).concat,empty:[]}};e.getUnionMonoid=_t;var $t=function(g){var C=ht(g);return{concat:function(_,V){return C(V)(_)}}};e.getIntersectionSemigroup=$t;var Dr=function(g){var C=Ue(g);return{concat:function(_,V){return C(V)(_)}}};e.getDifferenceMagma=Dr,e.Functor={URI:e.URI,map:T},e.flap=(0,c.flap)(e.Functor),e.Pointed={URI:e.URI,of:e.of},e.FunctorWithIndex={URI:e.URI,map:T,mapWithIndex:Et},e.Apply={URI:e.URI,map:T,ap:ve},e.apFirst=(0,a.apFirst)(e.Apply),e.apSecond=(0,a.apSecond)(e.Apply),e.Applicative={URI:e.URI,map:T,ap:ve,of:e.of},e.Chain={URI:e.URI,map:T,ap:ve,chain:e.flatMap},e.chainFirst=(0,u.chainFirst)(e.Chain),e.Monad={URI:e.URI,map:T,ap:ve,of:e.of,chain:e.flatMap},e.Unfoldable={URI:e.URI,unfold:e.unfold},e.Alt={URI:e.URI,map:T,alt:tt},e.Zero={URI:e.URI,zero:e.zero},e.guard=(0,P.guard)(e.Zero,e.Pointed),e.Alternative={URI:e.URI,map:T,ap:ve,of:e.of,alt:tt,zero:e.zero},e.Extend={URI:e.URI,map:T,extend:Ot},e.Compactable={URI:e.URI,compact:e.compact,separate:e.separate},e.Filterable={URI:e.URI,map:T,compact:e.compact,separate:e.separate,filter:He,filterMap:St,partition:Mt,partitionMap:dt},e.FilterableWithIndex={URI:e.URI,map:T,mapWithIndex:Et,compact:e.compact,separate:e.separate,filter:He,filterMap:St,partition:Mt,partitionMap:dt,partitionMapWithIndex:vt,partitionWithIndex:It,filterMapWithIndex:Dt,filterWithIndex:kt},e.Foldable={URI:e.URI,reduce:ne,foldMap:Pe,reduceRight:Re},e.FoldableWithIndex={URI:e.URI,reduce:ne,foldMap:Pe,reduceRight:Re,reduceWithIndex:yt,foldMapWithIndex:it,reduceRightWithIndex:Qe},e.Traversable={URI:e.URI,map:T,reduce:ne,foldMap:Pe,reduceRight:Re,traverse:S,sequence:e.sequence},e.TraversableWithIndex={URI:e.URI,map:T,mapWithIndex:Et,reduce:ne,foldMap:Pe,reduceRight:Re,reduceWithIndex:yt,foldMapWithIndex:it,reduceRightWithIndex:Qe,traverse:S,sequence:e.sequence,traverseWithIndex:d};var zr=(0,D.witherDefault)(e.Traversable,e.Compactable),Mn=(0,D.wiltDefault)(e.Traversable,e.Compactable);e.Witherable={URI:e.URI,map:T,compact:e.compact,separate:e.separate,filter:He,filterMap:St,partition:Mt,partitionMap:dt,reduce:ne,foldMap:Pe,reduceRight:Re,traverse:S,sequence:e.sequence,wither:zr,wilt:Mn},e.chainRecDepthFirst=h.chainRecDepthFirst,e.ChainRecDepthFirst={URI:e.URI,map:T,ap:ve,chain:e.flatMap,chainRec:p},e.chainRecBreadthFirst=h.chainRecBreadthFirst,e.ChainRecBreadthFirst={URI:e.URI,map:T,ap:ve,chain:e.flatMap,chainRec:R},e.filterE=(0,D.filterE)(e.Witherable),e.FromEither={URI:e.URI,fromEither:e.fromEither},e.fromEitherK=(0,o.fromEitherK)(e.FromEither),e.unsafeInsertAt=f.unsafeInsertAt;var _a=function(g,C,_){return(0,e.isNonEmpty)(_)?f.unsafeUpdateAt(g,C,_):[]};e.unsafeUpdateAt=_a;var Pa=function(g,C){var _=C.slice();return _.splice(g,1),_};e.unsafeDeleteAt=Pa,e.every=h.every;var Ra=function(g){return function(C){return C.some(g)}};e.some=Ra,e.exists=e.some,e.intercalate=h.intercalate,e.Do=(0,e.of)(l.emptyRecord),e.bindTo=(0,c.bindTo)(e.Functor);var Ba=(0,c.let)(e.Functor);e.let=Ba,e.bind=(0,u.bind)(e.Chain),e.apS=(0,a.apS)(e.Apply),e.chain=e.flatMap,e.range=f.range,e.empty=[],e.cons=f.cons,e.snoc=f.snoc,e.prependToAll=e.prependAll,e.array={URI:e.URI,compact:e.compact,separate:e.separate,map:T,ap:ve,of:e.of,chain:e.flatMap,filter:He,filterMap:St,partition:Mt,partitionMap:dt,mapWithIndex:Et,partitionMapWithIndex:vt,partitionWithIndex:It,filterMapWithIndex:Dt,filterWithIndex:kt,alt:tt,zero:e.zero,unfold:e.unfold,reduce:ne,foldMap:Pe,reduceRight:Re,traverse:S,sequence:e.sequence,reduceWithIndex:yt,foldMapWithIndex:it,reduceRightWithIndex:Qe,traverseWithIndex:d,extend:Ot,wither:zr,wilt:Mn}}}),lv=je({"node_modules/fp-ts/lib/string.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.endsWith=e.startsWith=e.includes=e.split=e.size=e.isEmpty=e.slice=e.trimRight=e.trimLeft=e.trim=e.replace=e.toLowerCase=e.toUpperCase=e.isString=e.Show=e.Ord=e.Monoid=e.empty=e.Semigroup=e.Eq=void 0;var r=Ru();e.Eq={equals:function(N,b){return N===b}},e.Semigroup={concat:function(N,b){return N+b}},e.empty="",e.Monoid={concat:e.Semigroup.concat,empty:e.empty},e.Ord={equals:e.Eq.equals,compare:function(N,b){return N<b?-1:N>b?1:0}},e.Show={show:function(N){return JSON.stringify(N)}};var n=function(N){return typeof N=="string"};e.isString=n;var i=function(N){return N.toUpperCase()};e.toUpperCase=i;var a=function(N){return N.toLowerCase()};e.toLowerCase=a;var u=function(N,b){return function(M){return M.replace(N,b)}};e.replace=u;var o=function(N){return N.trim()};e.trim=o;var s=function(N){return N.trimLeft()};e.trimLeft=s;var c=function(N){return N.trimRight()};e.trimRight=c;var l=function(N,b){return function(M){return M.slice(N,b)}};e.slice=l;var f=function(N){return N.length===0};e.isEmpty=f;var h=function(N){return N.length};e.size=h;var y=function(N){return function(b){var M=b.split(N);return(0,r.isNonEmpty)(M)?M:[b]}};e.split=y;var D=function(N,b){return function(M){return M.includes(N,b)}};e.includes=D;var P=function(N,b){return function(M){return M.startsWith(N,b)}};e.startsWith=P;var q=function(N,b){return function(M){return M.endsWith(N,b)}};e.endsWith=q}}),fv=je({"node_modules/json5/dist/index.js"(e,r){(function(n,i){typeof e=="object"&&typeof r<"u"?r.exports=i():typeof define=="function"&&define.amd?define(i):n.JSON5=i()})(e,function(){function n(d,p){return p={exports:{}},d(p,p.exports),p.exports}var i=n(function(d){var p=d.exports=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=p)}),a=n(function(d){var p=d.exports={version:"2.6.5"};typeof __e=="number"&&(__e=p)});a.version;var u=function(d){return typeof d=="object"?d!==null:typeof d=="function"},o=function(d){if(!u(d))throw TypeError(d+" is not an object!");return d},s=function(d){try{return!!d()}catch{return!0}},c=!s(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),l=i.document,f=u(l)&&u(l.createElement),h=function(d){return f?l.createElement(d):{}},y=!c&&!s(function(){return Object.defineProperty(h("div"),"a",{get:function(){return 7}}).a!=7}),D=function(d,p){if(!u(d))return d;var R,x;if(p&&typeof(R=d.toString)=="function"&&!u(x=R.call(d))||typeof(R=d.valueOf)=="function"&&!u(x=R.call(d))||!p&&typeof(R=d.toString)=="function"&&!u(x=R.call(d)))return x;throw TypeError("Can't convert object to primitive value")},P=Object.defineProperty,q=c?Object.defineProperty:function(p,R,x){if(o(p),R=D(R,!0),o(x),y)try{return P(p,R,x)}catch{}if("get"in x||"set"in x)throw TypeError("Accessors not supported!");return"value"in x&&(p[R]=x.value),p},N={f:q},b=function(d,p){return{enumerable:!(d&1),configurable:!(d&2),writable:!(d&4),value:p}},M=c?function(d,p,R){return N.f(d,p,b(1,R))}:function(d,p,R){return d[p]=R,d},B={}.hasOwnProperty,L=function(d,p){return B.call(d,p)},W=0,$=Math.random(),E=function(d){return"Symbol(".concat(d===void 0?"":d,")_",(++W+$).toString(36))},I=n(function(d){var p="__core-js_shared__",R=i[p]||(i[p]={});(d.exports=function(x,K){return R[x]||(R[x]=K!==void 0?K:{})})("versions",[]).push({version:a.version,mode:"global",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})}),H=I("native-function-to-string",Function.toString),U=n(function(d){var p=E("src"),R="toString",x=(""+H).split(R);a.inspectSource=function(K){return H.call(K)},(d.exports=function(K,ee,ue,Ae){var we=typeof ue=="function";we&&(L(ue,"name")||M(ue,"name",ee)),K[ee]!==ue&&(we&&(L(ue,p)||M(ue,p,K[ee]?""+K[ee]:x.join(String(ee)))),K===i?K[ee]=ue:Ae?K[ee]?K[ee]=ue:M(K,ee,ue):(delete K[ee],M(K,ee,ue)))})(Function.prototype,R,function(){return typeof this=="function"&&this[p]||H.call(this)})}),Q=function(d){if(typeof d!="function")throw TypeError(d+" is not a function!");return d},ae=function(d,p,R){if(Q(d),p===void 0)return d;switch(R){case 1:return function(x){return d.call(p,x)};case 2:return function(x,K){return d.call(p,x,K)};case 3:return function(x,K,ee){return d.call(p,x,K,ee)}}return function(){return d.apply(p,arguments)}},ge="prototype",he=function(d,p,R){var x=d&he.F,K=d&he.G,ee=d&he.S,ue=d&he.P,Ae=d&he.B,we=K?i:ee?i[p]||(i[p]={}):(i[p]||{})[ge],rt=K?a:a[p]||(a[p]={}),A=rt[ge]||(rt[ge]={}),F,z,j,te;K&&(R=p);for(F in R)z=!x&&we&&we[F]!==void 0,j=(z?we:R)[F],te=Ae&&z?ae(j,i):ue&&typeof j=="function"?ae(Function.call,j):j,we&&U(we,F,j,d&he.U),rt[F]!=j&&M(rt,F,te),ue&&A[F]!=j&&(A[F]=j)};i.core=a,he.F=1,he.G=2,he.S=4,he.P=8,he.B=16,he.W=32,he.U=64,he.R=128;var ze=he,st=Math.ceil,ct=Math.floor,xt=function(d){return isNaN(d=+d)?0:(d>0?ct:st)(d)},ir=function(d){if(d==null)throw TypeError("Can't call method on  "+d);return d},ar=function(d){return function(p,R){var x=String(ir(p)),K=xt(R),ee=x.length,ue,Ae;return K<0||K>=ee?d?"":void 0:(ue=x.charCodeAt(K),ue<55296||ue>56319||K+1===ee||(Ae=x.charCodeAt(K+1))<56320||Ae>57343?d?x.charAt(K):ue:d?x.slice(K,K+2):(ue-55296<<10)+(Ae-56320)+65536)}},ur=ar(!1);ze(ze.P,"String",{codePointAt:function(p){return ur(this,p)}}),a.String.codePointAt;var Ht=Math.max,Wt=Math.min,or=function(d,p){return d=xt(d),d<0?Ht(d+p,0):Wt(d,p)},Kt=String.fromCharCode,Jt=String.fromCodePoint;ze(ze.S+ze.F*(!!Jt&&Jt.length!=1),"String",{fromCodePoint:function(p){for(var R=arguments,x=[],K=arguments.length,ee=0,ue;K>ee;){if(ue=+R[ee++],or(ue,1114111)!==ue)throw RangeError(ue+" is not a valid code point");x.push(ue<65536?Kt(ue):Kt(((ue-=65536)>>10)+55296,ue%1024+56320))}return x.join("")}}),a.String.fromCodePoint;var sr=/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,cr=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,lr=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/,We={Space_Separator:sr,ID_Start:cr,ID_Continue:lr},de={isSpaceSeparator:function(p){return typeof p=="string"&&We.Space_Separator.test(p)},isIdStartChar:function(p){return typeof p=="string"&&(p>="a"&&p<="z"||p>="A"&&p<="Z"||p==="$"||p==="_"||We.ID_Start.test(p))},isIdContinueChar:function(p){return typeof p=="string"&&(p>="a"&&p<="z"||p>="A"&&p<="Z"||p>="0"&&p<="9"||p==="$"||p==="_"||p==="\u200C"||p==="\u200D"||We.ID_Continue.test(p))},isDigit:function(p){return typeof p=="string"&&/[0-9]/.test(p)},isHexDigit:function(p){return typeof p=="string"&&/[0-9A-Fa-f]/.test(p)}},Ye,be,_e,$e,Se,Ce,De,lt,Xe,pt=function(p,R){Ye=String(p),be="start",_e=[],$e=0,Se=1,Ce=0,De=void 0,lt=void 0,Xe=void 0;do De=ht(),It[be]();while(De.type!=="eof");return typeof R=="function"?ft({"":Xe},"",R):Xe};function ft(d,p,R){var x=d[p];if(x!=null&&typeof x=="object")if(Array.isArray(x))for(var K=0;K<x.length;K++){var ee=String(K),ue=ft(x,ee,R);ue===void 0?delete x[ee]:Object.defineProperty(x,ee,{value:ue,writable:!0,enumerable:!0,configurable:!0})}else for(var Ae in x){var we=ft(x,Ae,R);we===void 0?delete x[Ae]:Object.defineProperty(x,Ae,{value:we,writable:!0,enumerable:!0,configurable:!0})}return R.call(d,p,x)}var se,oe,wt,Ze,ce;function ht(){for(se="default",oe="",wt=!1,Ze=1;;){ce=Ue();var d=Et[se]();if(d)return d}}function Ue(){if(Ye[$e])return String.fromCodePoint(Ye.codePointAt($e))}function T(){var d=Ue();return d===`
`?(Se++,Ce=0):d?Ce+=d.length:Ce++,d&&($e+=d.length),d}var Et={default:function(){switch(ce){case"	":case"\v":case"\f":case" ":case"\xA0":case"\uFEFF":case`
`:case"\r":case"\u2028":case"\u2029":T();return;case"/":T(),se="comment";return;case void 0:return T(),ve("eof")}if(de.isSpaceSeparator(ce)){T();return}return Et[be]()},comment:function(){switch(ce){case"*":T(),se="multiLineComment";return;case"/":T(),se="singleLineComment";return}throw ne(T())},multiLineComment:function(){switch(ce){case"*":T(),se="multiLineCommentAsterisk";return;case void 0:throw ne(T())}T()},multiLineCommentAsterisk:function(){switch(ce){case"*":T();return;case"/":T(),se="default";return;case void 0:throw ne(T())}T(),se="multiLineComment"},singleLineComment:function(){switch(ce){case`
`:case"\r":case"\u2028":case"\u2029":T(),se="default";return;case void 0:return T(),ve("eof")}T()},value:function(){switch(ce){case"{":case"[":return ve("punctuator",T());case"n":return T(),He("ull"),ve("null",null);case"t":return T(),He("rue"),ve("boolean",!0);case"f":return T(),He("alse"),ve("boolean",!1);case"-":case"+":T()==="-"&&(Ze=-1),se="sign";return;case".":oe=T(),se="decimalPointLeading";return;case"0":oe=T(),se="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":oe=T(),se="decimalInteger";return;case"I":return T(),He("nfinity"),ve("numeric",1/0);case"N":return T(),He("aN"),ve("numeric",NaN);case'"':case"'":wt=T()==='"',oe="",se="string";return}throw ne(T())},identifierNameStartEscape:function(){if(ce!=="u")throw ne(T());T();var p=dt();switch(p){case"$":case"_":break;default:if(!de.isIdStartChar(p))throw Re();break}oe+=p,se="identifierName"},identifierName:function(){switch(ce){case"$":case"_":case"\u200C":case"\u200D":oe+=T();return;case"\\":T(),se="identifierNameEscape";return}if(de.isIdContinueChar(ce)){oe+=T();return}return ve("identifier",oe)},identifierNameEscape:function(){if(ce!=="u")throw ne(T());T();var p=dt();switch(p){case"$":case"_":case"\u200C":case"\u200D":break;default:if(!de.isIdContinueChar(p))throw Re();break}oe+=p,se="identifierName"},sign:function(){switch(ce){case".":oe=T(),se="decimalPointLeading";return;case"0":oe=T(),se="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":oe=T(),se="decimalInteger";return;case"I":return T(),He("nfinity"),ve("numeric",Ze*(1/0));case"N":return T(),He("aN"),ve("numeric",NaN)}throw ne(T())},zero:function(){switch(ce){case".":oe+=T(),se="decimalPoint";return;case"e":case"E":oe+=T(),se="decimalExponent";return;case"x":case"X":oe+=T(),se="hexadecimal";return}return ve("numeric",Ze*0)},decimalInteger:function(){switch(ce){case".":oe+=T(),se="decimalPoint";return;case"e":case"E":oe+=T(),se="decimalExponent";return}if(de.isDigit(ce)){oe+=T();return}return ve("numeric",Ze*Number(oe))},decimalPointLeading:function(){if(de.isDigit(ce)){oe+=T(),se="decimalFraction";return}throw ne(T())},decimalPoint:function(){switch(ce){case"e":case"E":oe+=T(),se="decimalExponent";return}if(de.isDigit(ce)){oe+=T(),se="decimalFraction";return}return ve("numeric",Ze*Number(oe))},decimalFraction:function(){switch(ce){case"e":case"E":oe+=T(),se="decimalExponent";return}if(de.isDigit(ce)){oe+=T();return}return ve("numeric",Ze*Number(oe))},decimalExponent:function(){switch(ce){case"+":case"-":oe+=T(),se="decimalExponentSign";return}if(de.isDigit(ce)){oe+=T(),se="decimalExponentInteger";return}throw ne(T())},decimalExponentSign:function(){if(de.isDigit(ce)){oe+=T(),se="decimalExponentInteger";return}throw ne(T())},decimalExponentInteger:function(){if(de.isDigit(ce)){oe+=T();return}return ve("numeric",Ze*Number(oe))},hexadecimal:function(){if(de.isHexDigit(ce)){oe+=T(),se="hexadecimalInteger";return}throw ne(T())},hexadecimalInteger:function(){if(de.isHexDigit(ce)){oe+=T();return}return ve("numeric",Ze*Number(oe))},string:function(){switch(ce){case"\\":T(),oe+=St();return;case'"':if(wt)return T(),ve("string",oe);oe+=T();return;case"'":if(!wt)return T(),ve("string",oe);oe+=T();return;case`
`:case"\r":throw ne(T());case"\u2028":case"\u2029":yt(ce);break;case void 0:throw ne(T())}oe+=T()},start:function(){switch(ce){case"{":case"[":return ve("punctuator",T())}se="value"},beforePropertyName:function(){switch(ce){case"$":case"_":oe=T(),se="identifierName";return;case"\\":T(),se="identifierNameStartEscape";return;case"}":return ve("punctuator",T());case'"':case"'":wt=T()==='"',se="string";return}if(de.isIdStartChar(ce)){oe+=T(),se="identifierName";return}throw ne(T())},afterPropertyName:function(){if(ce===":")return ve("punctuator",T());throw ne(T())},beforePropertyValue:function(){se="value"},afterPropertyValue:function(){switch(ce){case",":case"}":return ve("punctuator",T())}throw ne(T())},beforeArrayValue:function(){if(ce==="]")return ve("punctuator",T());se="value"},afterArrayValue:function(){switch(ce){case",":case"]":return ve("punctuator",T())}throw ne(T())},end:function(){throw ne(T())}};function ve(d,p){return{type:d,value:p,line:Se,column:Ce}}function He(d){for(var p=0,R=d;p<R.length;p+=1){var x=R[p],K=Ue();if(K!==x)throw ne(T());T()}}function St(){var d=Ue();switch(d){case"b":return T(),"\b";case"f":return T(),"\f";case"n":return T(),`
`;case"r":return T(),"\r";case"t":return T(),"	";case"v":return T(),"\v";case"0":if(T(),de.isDigit(Ue()))throw ne(T());return"\0";case"x":return T(),Mt();case"u":return T(),dt();case`
`:case"\u2028":case"\u2029":return T(),"";case"\r":return T(),Ue()===`
`&&T(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":throw ne(T());case void 0:throw ne(T())}return T()}function Mt(){var d="",p=Ue();if(!de.isHexDigit(p)||(d+=T(),p=Ue(),!de.isHexDigit(p)))throw ne(T());return d+=T(),String.fromCodePoint(parseInt(d,16))}function dt(){for(var d="",p=4;p-- >0;){var R=Ue();if(!de.isHexDigit(R))throw ne(T());d+=T()}return String.fromCodePoint(parseInt(d,16))}var It={start:function(){if(De.type==="eof")throw Pe();vt()},beforePropertyName:function(){switch(De.type){case"identifier":case"string":lt=De.value,be="afterPropertyName";return;case"punctuator":tt();return;case"eof":throw Pe()}},afterPropertyName:function(){if(De.type==="eof")throw Pe();be="beforePropertyValue"},beforePropertyValue:function(){if(De.type==="eof")throw Pe();vt()},beforeArrayValue:function(){if(De.type==="eof")throw Pe();if(De.type==="punctuator"&&De.value==="]"){tt();return}vt()},afterPropertyValue:function(){if(De.type==="eof")throw Pe();switch(De.value){case",":be="beforePropertyName";return;case"}":tt()}},afterArrayValue:function(){if(De.type==="eof")throw Pe();switch(De.value){case",":be="beforeArrayValue";return;case"]":tt()}},end:function(){}};function vt(){var d;switch(De.type){case"punctuator":switch(De.value){case"{":d={};break;case"[":d=[];break}break;case"null":case"boolean":case"numeric":case"string":d=De.value;break}if(Xe===void 0)Xe=d;else{var p=_e[_e.length-1];Array.isArray(p)?p.push(d):Object.defineProperty(p,lt,{value:d,writable:!0,enumerable:!0,configurable:!0})}if(d!==null&&typeof d=="object")_e.push(d),Array.isArray(d)?be="beforeArrayValue":be="beforePropertyName";else{var R=_e[_e.length-1];R==null?be="end":Array.isArray(R)?be="afterArrayValue":be="afterPropertyValue"}}function tt(){_e.pop();var d=_e[_e.length-1];d==null?be="end":Array.isArray(d)?be="afterArrayValue":be="afterPropertyValue"}function ne(d){return Qe(d===void 0?"JSON5: invalid end of input at "+Se+":"+Ce:"JSON5: invalid character '"+it(d)+"' at "+Se+":"+Ce)}function Pe(){return Qe("JSON5: invalid end of input at "+Se+":"+Ce)}function Re(){return Ce-=5,Qe("JSON5: invalid identifier character at "+Se+":"+Ce)}function yt(d){console.warn("JSON5: '"+it(d)+"' in strings is not valid ECMAScript; consider escaping")}function it(d){var p={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(p[d])return p[d];if(d<" "){var R=d.charCodeAt(0).toString(16);return"\\x"+("00"+R).substring(R.length)}return d}function Qe(d){var p=new SyntaxError(d);return p.lineNumber=Se,p.columnNumber=Ce,p}var Dt=function(p,R,x){var K=[],ee="",ue,Ae,we="",rt;if(R!=null&&typeof R=="object"&&!Array.isArray(R)&&(x=R.space,rt=R.quote,R=R.replacer),typeof R=="function")Ae=R;else if(Array.isArray(R)){ue=[];for(var A=0,F=R;A<F.length;A+=1){var z=F[A],j=void 0;typeof z=="string"?j=z:(typeof z=="number"||z instanceof String||z instanceof Number)&&(j=String(z)),j!==void 0&&ue.indexOf(j)<0&&ue.push(j)}}return x instanceof Number?x=Number(x):x instanceof String&&(x=String(x)),typeof x=="number"?x>0&&(x=Math.min(10,Math.floor(x)),we="          ".substr(0,x)):typeof x=="string"&&(we=x.substr(0,10)),te("",{"":p});function te(me,Te){var fe=Te[me];switch(fe!=null&&(typeof fe.toJSON5=="function"?fe=fe.toJSON5(me):typeof fe.toJSON=="function"&&(fe=fe.toJSON(me))),Ae&&(fe=Ae.call(Te,me,fe)),fe instanceof Number?fe=Number(fe):fe instanceof String?fe=String(fe):fe instanceof Boolean&&(fe=fe.valueOf()),fe){case null:return"null";case!0:return"true";case!1:return"false"}if(typeof fe=="string")return le(fe);if(typeof fe=="number")return String(fe);if(typeof fe=="object")return Array.isArray(fe)?Gt(fe):Me(fe)}function le(me){for(var Te={"'":.1,'"':.2},fe={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"},ke="",at=0;at<me.length;at++){var qe=me[at];switch(qe){case"'":case'"':Te[qe]++,ke+=qe;continue;case"\0":if(de.isDigit(me[at+1])){ke+="\\x00";continue}}if(fe[qe]){ke+=fe[qe];continue}if(qe<" "){var Lt=qe.charCodeAt(0).toString(16);ke+="\\x"+("00"+Lt).substring(Lt.length);continue}ke+=qe}var bt=rt||Object.keys(Te).reduce(function(_t,$t){return Te[_t]<Te[$t]?_t:$t});return ke=ke.replace(new RegExp(bt,"g"),fe[bt]),bt+ke+bt}function Me(me){if(K.indexOf(me)>=0)throw TypeError("Converting circular structure to JSON5");K.push(me);var Te=ee;ee=ee+we;for(var fe=ue||Object.keys(me),ke=[],at=0,qe=fe;at<qe.length;at+=1){var Lt=qe[at],bt=te(Lt,me);if(bt!==void 0){var _t=mt(Lt)+":";we!==""&&(_t+=" "),_t+=bt,ke.push(_t)}}var $t;if(ke.length===0)$t="{}";else{var Dr;if(we==="")Dr=ke.join(","),$t="{"+Dr+"}";else{var zr=`,
`+ee;Dr=ke.join(zr),$t=`{
`+ee+Dr+`,
`+Te+"}"}}return K.pop(),ee=Te,$t}function mt(me){if(me.length===0)return le(me);var Te=String.fromCodePoint(me.codePointAt(0));if(!de.isIdStartChar(Te))return le(me);for(var fe=Te.length;fe<me.length;fe++)if(!de.isIdContinueChar(String.fromCodePoint(me.codePointAt(fe))))return le(me);return me}function Gt(me){if(K.indexOf(me)>=0)throw TypeError("Converting circular structure to JSON5");K.push(me);var Te=ee;ee=ee+we;for(var fe=[],ke=0;ke<me.length;ke++){var at=te(String(ke),me);fe.push(at!==void 0?at:"null")}var qe;if(fe.length===0)qe="[]";else if(we===""){var Lt=fe.join(",");qe="["+Lt+"]"}else{var bt=`,
`+ee,_t=fe.join(bt);qe=`[
`+ee+_t+`,
`+Te+"]"}return K.pop(),ee=Te,qe}},kt={parse:pt,stringify:Dt},Ot=kt,S=Ot;return S})}}),hv={};Z(hv,{afterMatch:()=>QA,between:()=>ZA,betweenChomp:()=>P0,countCharsFromStart:()=>nC,htmlEntities:()=>aC,indexOfCharCode:()=>Hn,lineSpan:()=>tC,omitChars:()=>Kn,random:()=>ds,splitByLength:()=>R0,splitRanges:()=>rC,startsEnds:()=>iC,untilMatch:()=>B0,unwrap:()=>eC});var Y=(e,r="",n="?")=>{if(typeof e>"u")throw new Error(`Parameter ${n} is undefined`);if(Number.isNaN(e))throw new Error(`Parameter '${n}' is NaN`);if(typeof e!="number")throw new Error(`Parameter '${n}' is not a number (${e})`);switch(r){case"positive":if(e<0)throw new Error(`Parameter '${n}' must be at least zero (${e})`);break;case"negative":if(e>0)throw new Error(`Parameter '${n}' must be zero or lower (${e})`);break;case"aboveZero":if(e<=0)throw new Error(`Parameter '${n}' must be above zero (${e})`);break;case"belowZero":if(e>=0)throw new Error(`Parameter '${n}' must be below zero (${e})`);break;case"percentage":if(e>1||e<0)throw new Error(`Parameter '${n}' must be in percentage range (0 to 1). (${e})`);break;case"nonZero":if(e===0)throw new Error(`Parameter '${n}' must non-zero. (${e})`);break;case"bipolar":if(e>1||e<-1)throw new Error(`Parameter '${n}' must be in bipolar percentage range (-1 to 1). (${e})`);break}return!0},jt=(e,r="?")=>{if(typeof e>"u")throw new Error(`${r} param is undefined`);if(e===null)throw new Error(`${r} param is null`)},dv=(e,r="?")=>Y(e,"percentage",r),Ee=(e,r="",n="?")=>{if(Y(e,r,n),!Number.isInteger(e))throw new Error(`Parameter ${n} is not an integer`)},vv=(e,r="",n=Number.NaN)=>{if(e===void 0||e===null)return n;try{Ee(Number.parseInt(e),r,"parsed")}catch{return n}return parseInt(e)},yv=e=>Array.isArray(e)?e.find(r=>typeof r!="string")===void 0:!1,mv=(e,r="?")=>{if(!Array.isArray(e))throw new Error(`Parameter '${r}' is expected to be an array'`)},gv={};Z(gv,{arrayElement:()=>cs,arrayIndex:()=>ss,defaultRandom:()=>et,float:()=>S0,floatFn:()=>hs,gaussian:()=>JA,gaussianFn:()=>C0,hue:()=>po,integer:()=>F0,integerFn:()=>fs,integerUniqueGen:()=>_0,minutesMs:()=>YA,minutesMsFn:()=>M0,secondsMs:()=>XA,secondsMsFn:()=>I0,shortGuid:()=>GA,string:()=>ds,weighted:()=>HA,weightedFn:()=>b0,weightedInteger:()=>KA,weightedIntegerFn:()=>A0});var Vt={};Z(Vt,{areValuesIdentical:()=>os,average:()=>jo,averageWeighted:()=>qo,chunks:()=>qA,dotProduct:()=>DD,ensureLength:()=>WA,filterAB:()=>VA,filterBetween:()=>w0,flatten:()=>NA,groupBy:()=>$A,guardArray:()=>Sn,guardIndex:()=>xi,interleave:()=>zA,intersection:()=>BA,max:()=>Hh,maxFast:()=>Jh,maxIndex:()=>bD,mergeByKey:()=>jA,min:()=>Vh,minFast:()=>Uo,minIndex:()=>xh,minMaxAvg:()=>pa,pushUnique:()=>D0,randomElement:()=>cs,randomIndex:()=>ss,randomPluck:()=>kA,reducePairwise:()=>UA,remove:()=>LA,sample:()=>TA,shuffle:()=>_u,sortByNumericProperty:()=>E0,total:()=>Kh,totalFast:()=>Gh,unique:()=>xA,until:()=>OA,validNumbers:()=>mn,weight:()=>Uh,without:()=>ls,zip:()=>p0});var pv={};Z(pv,{Debug:()=>wc,IterableAsync:()=>so,defaultComparer:()=>us,defaultKeyer:()=>ui,getFieldByPath:()=>Ia,getFieldPaths:()=>as,ifNaN:()=>Iu,isEqualDefault:()=>xe,isEqualValueDefault:()=>g0,isPowerOfTwo:()=>y0,mapObject:()=>_A,relativeDifference:()=>PA,roundUpToMultiple:()=>m0,runningiOS:()=>RA,toStringDefault:()=>xn});var wv={};Z(wv,{Elapsed:()=>ac,StateMachine:()=>Bu,TaskQueue:()=>MA,completionMs:()=>dc,continuously:()=>Nu,debounce:()=>Rv,delay:()=>Nv,delayIterable:()=>pc,delayLoop:()=>Wu,everyNth:()=>Wv,forEach:()=>d0,forEachAsync:()=>v0,frequencyTimer:()=>pr,frequencyTimerSource:()=>vc,hasElapsedMs:()=>hc,interval:()=>uc,intervalToMs:()=>rn,iterableFromPoll:()=>Jc,msElapsedTimer:()=>rr,relativeTimer:()=>Gr,relativeTimerMs:()=>yc,relativeTimerTicks:()=>mc,repeat:()=>is,repeatReduce:()=>IA,retryWithBackOff:()=>ns,runOnce:()=>kv,sleep:()=>Zt,throttle:()=>Bv,ticksElapsedTimer:()=>Ki,timeout:()=>gc,updateOutdated:()=>_v,waitFor:()=>zu});var Zt=e=>{typeof e=="number"&&(e={millis:e});const r=rn(e),n=e.signal,i=e.value;return Y(r,"positive","timeoutMs"),r===0?new Promise(a=>requestAnimationFrame(u=>{a(i)})):new Promise((a,u)=>{n&&n.addEventListener("abort",()=>{u(n.reason)}),setTimeout(()=>{if(n?.aborted){u(n.reason);return}a(i)},r)})},Bu={};Z(Bu,{StateMachine:()=>Jr,bidirectionalDescriptionFromList:()=>lc,create:()=>Fv,descriptionFromList:()=>cc,drive:()=>Sv,fromList:()=>Av,fromListBidirectional:()=>Cv});var Ev={};Z(Ev,{SimpleEventEmitter:()=>tr});var Dv=(e,r,n=xe)=>{for(const i of e.entries()){const a=i[1];for(const u of a)if(n(u,r))return i}},bv=class{map;groupBy;valueEq;constructor(e=ui,r=xe,n=[]){this.groupBy=e,this.valueEq=r,this.map=new Map(n)}*entriesFlat(){for(const e of this.map.keys())for(const r of this.map.get(e))yield[e,r]}*entries(){for(const[e,r]of this.map.entries())yield[e,[...r]]}firstKeyByValue(e,r=xe){const n=Dv(this,e,r);if(n)return n[0]}*get(e){const r=this.map.get(e);!r||(yield*r.values())}*keys(){yield*this.map.keys()}*values(){for(const e of this.map)yield*e[1]}*keysAndCounts(){for(const e of this.map)yield[e[0],e[1].length]}has(e){return this.map.has(e)}hasKeyValue(e,r){const n=this.map.get(e);if(!n)return!1;for(const i of n)if(this.valueEq(i,r))return!0;return!1}debugString(){let e="";return Array.from(this.map.keys()).every(n=>{const i=this.map.get(n);i!==void 0&&(e+=n+` (${i.length}) = ${JSON.stringify(i)}\r
`)}),e}get isEmpty(){return this.map.size===0}count(e){const r=this.map.get(e);return r?r.length:0}},nc=class extends bv{addKeyedValues(e,...r){const n=this.map.get(e);n===void 0?this.map.set(e,r):this.map.set(e,[...n,...r])}addValue(...e){for(const r of e){const n=this.groupBy(r);this.addKeyedValues(n,r)}}deleteKeyValue(e,r){const n=this.map.get(e);if(n===void 0)return!1;const i=n.filter(a=>!this.valueEq(a,r));return this.map.set(e,i),i.length<n.length}deleteByValue(e){let r=!1;for(const n of[...this.map.entries()])for(const i of n[1])this.valueEq(i,e)&&(r=!0,this.deleteKeyValue(n[0],e));return r}delete(e){const r=this.map.get(e);return!r||r.length===0?!1:(this.map.delete(e),!0)}clear(){this.map.clear()}},ic=(e=ui,r=xe)=>new nc(e,r),tr=class{#e=ic();fireEvent(e,r){const n=this.#e.values(e);for(const i of n)i(r,this)}addEventListener(e,r){this.#e.addKeyedValues(e,r)}removeEventListener(e,r){this.#e.deleteKeyValue(e,r)}clearEventListeners(){this.#e.clear()}},ac={};Z(ac,{infinity:()=>oc,since:()=>bi,toString:()=>sc});var rn=(e,r)=>{if(typeof e>"u")return r;if(typeof e=="number")return e;let n=e.millis??0;return n+=(e.hrs??0)*60*60*1e3,n+=(e.mins??0)*60*1e3,n+=(e.secs??0)*1e3,n},uc=async function*(e,r={}){let n=!1;const i=r.signal,a=r.delay??"before";let u=rn(r.fixedIntervalMs)??rn(r.minIntervalMs,0),o=performance.now();const s=rn(r.minIntervalMs),c=async()=>{const l=performance.now()-o;if(typeof s<"u"&&(u=Math.max(0,s-l)),u&&await Zt({millis:u,signal:i}),o=performance.now(),i?.aborted)throw new Error(`Signal aborted ${i?.reason}`)};try{for(;!n;){if(a==="before"&&await c(),n)return;if(typeof e=="function")yield await e();else if(typeof e=="object")if("next"in e&&"return"in e&&"throw"in e){const l=await e.next();if(l.done)return;yield l.value}else throw new Error("interval: produce param does not seem to be a generator?");else throw new Error("produce param does not seem to return a value/Promise and is not a generator?");a==="after"&&await c()}}finally{n=!0}},bi=()=>{const e=Date.now();return()=>Date.now()-e},oc=()=>()=>Number.POSITIVE_INFINITY,sc=e=>{const r=typeof e=="number"?e:e();let n=rn(r);return n?n<1e3?`${n}ms`:(n/=1e3,n<120?`${n.toFixed(2)}secs`:(n/=60,n<60?`${n.toFixed(2)}mins`:(n/=60,`${n.toFixed(2)}hrs`))):"(undefined)"},Jr=class yi extends tr{#e;#t;#r;#n;#i;#a=oc();constructor(r,n,i={debug:!1}){super();const[a,u]=yi.validate(r,n);if(!a)throw new Error(u);this.#i=r,this.#r=n,this.#t=i.debug??!1,this.#e=r,this.#n=!1}get states(){return Object.keys(this.#r)}static validate(r,n){const i=Object.keys(n),a=new Set,u=new Set;for(let c=0;c<i.length;c++){const l=i[c];if(a.has(l))return[!1,`Key ${l} is already used`];if(a.add(l),typeof i[c]!="string")return[!1,`Key[${c}] is not a string`];const f=n[l];if(f===void 0)return[!1,`Key ${l} value is undefined`];if(typeof f=="string"){if(u.add(f),f===l)return[!1,`Loop present for ${l}`]}else if(Array.isArray(f)){if(!yv(f))return[!1,`Key ${l} value is not an array of strings`];if(f.forEach(h=>u.add(h)),f.find(h=>h===l))return[!1,`Loop present for ${l}`]}else if(f!==null)return[!1,`Key ${l} has a value that is neither null, string or array`]}const s=Array.from(u).find(c=>!a.has(c));return s?[!1,`Potential state '${s}' does not exist as a top-level state`]:n[r]===void 0?[!1,`Initial state ${r} not present`]:[!0,""]}next(){const r=this.#r[this.#e];if(r===null)return null;if(Array.isArray(r))if(typeof r[0]=="string")this.state=r[0];else throw new Error("Error in machine description. Potential state array does not contain strings");else if(typeof r=="string")this.state=r;else throw new Error("Error in machine description. Potential state is neither array nor string");return this.state}get isDone(){return this.#n}reset(){this.#n=!1,this.#e=this.#i,this.#a=bi()}static isValid(r,n,i){if(i[n]===void 0)return[!1,`Machine cannot change to non-existent state ${n}`];const a=i[r];if(Array.isArray(a)){if(!a.includes(n))return[!1,`Machine cannot change '${r} -> ${n}'. Allowed transitions: ${a.join(", ")}`]}else if(n!==a&&a!=="*")return[!1,`Machine cannot '${r} -> ${n}'. Allowed transition: ${a}`];return[!0,"ok"]}isValid(r){return yi.isValid(this.state,r,this.#r)}set state(r){const n=this.#e;if(r===n)return;const[i,a]=yi.isValid(n,r,this.#r);if(!i)throw new Error(a);this.#t&&console.log(`StateMachine: ${n} -> ${r}`),this.#e=r,this.#r[r]===null&&(this.#n=!0),this.#a=bi(),setTimeout(()=>{this.fireEvent("change",{newState:r,priorState:n}),this.isDone&&this.fireEvent("stop",{state:r})},1)}get state(){return this.#e}get changedAt(){return this.#a()}get elapsed(){return this.#a()}},Av=(...e)=>new Jr(e[0],cc(...e)),Cv=(...e)=>new Jr(e[0],lc(...e)),Fv=(e,r,n={debug:!1})=>new Jr(e,r,n),Sv=(e,r)=>{const n="first",i={};for(const c of Object.keys(r)){const l=r[c];Mv(l)?i[c]=Iv(l):Array.isArray(l)?i[c]={select:n,expressions:l,tryAll:!0}:i[c]={select:n,tryAll:!0,expressions:[l]}}const a=c=>{try{if(typeof c.next<"u"&&c.next)e.next();else if(typeof c.state<"u")e.state=c.state;else if(typeof c.reset<"u"&&c.reset)e.reset();else throw new Error("Result has neither 'reset', 'next' nor 'state' properties needed to drive state machine");return!0}catch(l){return console.warn(l),!1}},u=(c,l)=>{for(const f of l){if(a(f))return!0;if(!c.tryAll)break}return!1},o=(c,l)=>{if(!c)return!1;let f=!1;switch(c.select){case"first":for(const h of c.expressions){const y=h(l);if(!!y&&a(y)){f=!0;break}}break;case"highest":f=u(c,[...vs(c.expressions.map(h=>h(l)))]);break;case"lowest":f=u(c,[...vs(c.expressions.map(h=>h(l)))].reverse());break;default:throw new Error(`Unknown select type: ${c.select}. Expected first, highest or lowest`)}return f};return c=>{let l=i[e.state];!l&&e.isDone,l||(l=i.__default);let f=o(l,c);f||(l=i.__fallback,f=o(l,c))}},Mv=e=>Array.isArray(e)?!1:typeof e.expressions<"u",cc=(...e)=>{const r={};for(let n=0;n<e.length;n++)n===e.length-1?r[e[n]]=null:r[e[n]]=e[n+1];return r},lc=(...e)=>{const r={};for(let n=0;n<e.length;n++)r[e[n]]=[];for(let n=0;n<e.length;n++){const i=r[e[n]];n===e.length-1?e.length>1?i.push(e[n-1]):r[e[n]]=null:(i.push(e[n+1]),n>0&&i.push(e[n-1]))}return r},Iv=e=>{const r=e.select??"first",n=Array.isArray(e.expressions)?e.expressions:[e.expressions];return{select:r,expressions:n,tryAll:e.tryAll??!0}},vs=(e=[])=>{const r=e.filter(n=>n!==void 0);return r.sort((n,i)=>{const a=n.score??0,u=i.score??0;return a===u?0:a>u?-1:1}),r},fc={};Z(fc,{completionMs:()=>dc,frequencyTimer:()=>pr,frequencyTimerSource:()=>vc,hasElapsedMs:()=>hc,msElapsedTimer:()=>rr,relativeTimer:()=>Gr,relativeTimerMs:()=>yc,relativeTimerTicks:()=>mc,ticksElapsedTimer:()=>Ki});var Rt=(e,r=0,n=1)=>{if(Number.isNaN(e))throw new Error("v parameter is NaN");if(Number.isNaN(r))throw new Error("min parameter is NaN");if(Number.isNaN(n))throw new Error("max parameter is NaN");return e<r?r:e>n?n:e},Qa=(e,r)=>{if(!Number.isInteger(e))throw new Error(`v parameter must be an integer (${e})`);const n=Array.isArray(r)?r.length:r;if(!Number.isInteger(n))throw new Error(`length parameter must be an integer (${n}, ${typeof n})`);return e=Math.round(e),e<0?0:e>=n?n-1:e};function hc(e){const r=Gr(e,rr());return()=>r.isDone}function dc(e){const r=Gr(e,rr());return()=>r.elapsed}var vc=e=>()=>pr(e,rr()),Gr=(e,r,n=!0)=>{let i=!1,a=1;return{mod(u){a=u},get isDone(){return i},reset:()=>{i=!1,r.reset()},get elapsed(){let u=r.elapsed/(e*a);return n&&(u=Rt(u)),u>=1&&(i=!0),u}}},yc=(e,r=!0)=>Gr(e,rr(),r),mc=(e,r=!0)=>Gr(e,Ki(),r),pr=(e,r=rr())=>{const n=e/1e3;let i=1;return{mod:a=>{i=a},reset:()=>{r.reset()},get elapsed(){const a=r.elapsed*(n*i),u=a-Math.floor(a);if(u<0)throw new Error(`Unexpected cycle fraction less than 0. Elapsed: ${a} f: ${u}`);if(u>1)throw new Error(`Unexpected cycle fraction more than 1. Elapsed: ${a} f: ${u}`);return u}}},rr=()=>{let e=performance.now();return{reset:()=>{e=performance.now()},get elapsed(){return performance.now()-e}}},Ki=()=>{let e=0;return{reset:()=>{e=0},get elapsed(){return++e}}},gc=(e,r)=>{if(e===void 0)throw new Error("callback parameter is undefined");Ee(r,"aboveZero","timeoutMs");let n=0,i=0;const a=async(o=r,s)=>new Promise((l,f)=>{i=performance.now();try{Ee(o,"aboveZero","altTimeoutMs")}catch(h){f(h);return}n!==0&&u(),n=window.setTimeout(async()=>{await e(performance.now()-i,...s),n=0,l(void 0)},o)}),u=()=>{n!==0&&(i=0,window.clearTimeout(n))};return{start:a,cancel:u,get isDone(){return n!==0}}},_v=(e,r,n="slow")=>{let i=0,a,u=r;return()=>new Promise(async(o,s)=>{const c=performance.now()-i;if(a===void 0||c>u)try{i=performance.now(),a=await e(c),u=r}catch(l){n==="fast"?(a=void 0,i=0):n==="backoff"&&(u=Math.floor(u*1.2)),s(l);return}o(a)})},Pv=typeof window<"u"?e=>window.requestAnimationFrame(e):e=>window.setTimeout(e,1),Nu=(e,r,n={})=>{r!==void 0&&Ee(r,"positive","intervalMs");const i=n.fireBeforeWait??!1,a=n.onStartCalled;let u=!1,o=!1,s=0,c=performance.now(),l=r===void 0?0:r,f=0;const h=l===0?Pv:b=>window.setTimeout(b,l),y=l===0?b=>{}:b=>window.clearTimeout(b),D=()=>{!o||(o=!1,s=0,f!==0&&y(f),f=0)},P=async()=>{if(!o)return;const b=e(s++,performance.now()-c);let M;if(typeof b=="object"?M=await b:M=b,M!==void 0&&!M){D();return}f=h(P)},q=()=>{if(u)throw new Error("Disposed");if(a!==void 0){const b=a(s,performance.now()-c);if(b==="cancel"){D();return}else if(b==="reset"){N();return}else if(b==="dispose"){u=!0,D();return}}o||(c=performance.now(),o=!0,i?P():f=h(P))},N=()=>{if(u)throw new Error("Disposed");o&&D(),q()};return{start:q,reset:N,cancel:D,get intervalMs(){return l},set intervalMs(b){Ee(b,"positive","ms"),l=b},get isDone(){return!o},get isDisposed(){return u},get ticks(){return s},get elapsedMs(){return performance.now()-c}}},Rv=(e,r)=>{const n=gc(e,r);return(...i)=>n.start(void 0,i)},Bv=(e,r)=>{let n=0;return async(...i)=>{const a=performance.now()-n;if(a>=r){const u=e(a,...i);typeof u=="object"&&await u,n=performance.now()}}},zu=(e,r,n)=>{let i=!1;const a=o=>{u!==0&&(window.clearTimeout(u),u=0),o?r(o):i=!0,n!==void 0&&n(i)};let u=window.setTimeout(()=>{u=0;try{r(`Timeout after ${e}ms`)}finally{n!==void 0&&n(i)}},e);return a},Nv=async(e,r)=>(await Zt(r),Promise.resolve(await e()));async function*pc(e,r){const n=r.intervalMs,i=r.delay,a=r.signal;for await(const u of e)if((i==="before"||i==="both")&&(await Zt({millis:n,signal:a}),a?.aborted)||(yield u,(i==="after"||i==="both")&&(await Zt({millis:n,signal:a}),a?.aborted)))break}async function*zv(){let e,r=new Promise(a=>e=a),n=0;const i=()=>{e(),r=new Promise(a=>e=a)};try{for(;;)n=window.requestAnimationFrame(i),yield await r}finally{e(),window.cancelAnimationFrame(n)}}async function*Wu(e){if(e===0)return yield*zv();let r,n=new Promise(u=>r=u),i=0;const a=()=>{r(),n=new Promise(u=>r=u)};try{for(;;)i=window.setTimeout(a,e),yield await n}finally{r(),window.clearTimeout(i)}}var Wv=(e,r)=>{Ee(e,"positive","nth");let n=0;return(...i)=>++n===e?(n=0,r&&r(...i),!0):!1},kv=e=>{let r=!1,n=!1;return()=>(r||(r=!0,n=e()),n)},wc={};Z(wc,{logSet:()=>f0,logger:()=>Qr,resolveLogOption:()=>l0});var Ec={};Z(Ec,{ExpiringMap:()=>Ic,MapOfMutableImpl:()=>Ma,MapOfSimpleMutable:()=>nc,addKeepingExisting:()=>Ac,addObject:()=>tu,deleteByValue:()=>$v,expiringMap:()=>Yv,filter:()=>Sc,find:()=>Mc,firstEntryByIterablePredicate:()=>Tv,firstEntryByIterableValue:()=>qv,fromIterable:()=>Uv,fromObject:()=>Vv,getClosestIntegerKey:()=>Ov,getOrGenerate:()=>Dc,getOrGenerateSync:()=>bc,hasAnyValue:()=>Fc,hasKeyValue:()=>Lv,immutable:()=>Zr,mapOfSimpleMutable:()=>ic,mapToArray:()=>Jv,mapToObjTransform:()=>xv,mergeByKey:()=>Gv,mutable:()=>AA,ofArrayMutable:()=>c0,ofCircularMutable:()=>s0,ofSetMutable:()=>CA,sortByValue:()=>jv,sortByValueProperty:()=>Cc,toArray:()=>eu,toObject:()=>Kv,transformMap:()=>Hv,zipKeyValue:()=>ku});var Ov=(e,r)=>{if(r=Math.round(r),e.has(r))return r;{let n=1;for(;n<1e3;){if(e.has(r-n))return r-n;if(e.has(r+n))return r+n;n++}throw new Error(`Could not find target ${r}`)}},Lv=(e,r,n,i)=>e.has(r)?Array.from(e.values()).some(u=>i(u,n)):!1,$v=(e,r,n=xe)=>{for(const i of Object.entries(e))n(i[1],r)&&e.delete(i[0])},Dc=(e,r)=>async(n,i)=>{let a=e.get(n);if(a!==void 0)return Promise.resolve(a);if(a=await r(n,i),a===void 0)throw new Error("fn returned undefined");return e.set(n,a),a},Tv=(e,r)=>{for(const n of e.entries())if(r(n[1],n[0]))return n},qv=(e,r,n=xe)=>{for(const i of e.entries())if(n(i[1],r))return i},bc=(e,r)=>(n,i)=>{let a=e.get(n);return a!==void 0||(a=r(n,i),e.set(n,a)),a},Ac=(e,r,...n)=>{const i=e===void 0?new Map:new Map(e);return n.forEach(a=>{const u=r(a);i.has(u)||i.set(u,a)}),i},jv=(e,r)=>{const n=r??us;[...e.entries()].sort((i,a)=>n(i[1],a[1]))},Cc=(e,r,n)=>{const i=typeof n>"u"?us:n;return[...e.entries()].sort((a,u)=>{const o=a[1],s=u[1];return i(o[r],s[r])})},Fc=(e,r,n)=>Array.from(e.entries()).some(a=>n(a[1],r));function*Sc(e,r){for(const n of e.values())r(n)&&(yield n)}var eu=e=>Array.from(e.values()),Uv=(e,r,n=!1)=>{const i=new Map;for(const a of e){const u=r(a);if(i.has(u)&&!n)throw new Error(`id ${u} is already used and new data will overwrite it. `);i.set(u,a)}return i},Vv=e=>{const r=new Map;return Array.isArray(e)?e.forEach(n=>tu(r,n)):tu(r,e),r},tu=(e,r)=>{const n=Object.entries(r);for(const[i,a]of n)e.set(i,a)},Mc=(e,r)=>Array.from(e.values()).find(r),xv=(e,r)=>Array.from(e).reduce((n,[i,a])=>{const u=r(a);return n[i]=u,n},{}),ku=(e,r)=>{if(e.length!==r.length)throw new Error("Keys and values arrays should be same length");return Object.fromEntries(e.map((n,i)=>[n,r[i]]))},Hv=(e,r)=>new Map(Array.from(e,n=>[n[0],r(n[1],n[0])])),Kv=e=>Array.from(e).reduce((r,[n,i])=>(r[n]=i,r),{}),Jv=(e,r)=>Array.from(e.entries()).map(n=>r(n[0],n[1])),Gv=(e,...r)=>{const n=new Map;for(const i of r)for(const[a,u]of i){let o=n.get(a);o?o=e(o,u):o=u,n.set(a,o)}return n},Yv=(e={})=>new Ic(e),Ic=class extends tr{capacity;store;keyCount;evictPolicy;autoDeleteElapsedMs;autoDeletePolicy;constructor(e={}){super();if(this.capacity=e.capacity??-1,Ee(this.capacity,"nonZero","capacity"),this.store=new Map,this.keyCount=0,e.evictPolicy&&this.capacity<=0)throw new Error("evictPolicy is set, but no capacity limit is set");this.evictPolicy=e.evictPolicy??"none",this.autoDeleteElapsedMs=e.autoDeleteElapsedMs??-1,this.autoDeletePolicy=e.autoDeletePolicy??"none",this.autoDeleteElapsedMs>0&&setInterval(()=>this.#e(),Math.max(1e3,this.autoDeleteElapsedMs*2))}get keyLength(){return this.keyCount}*entries(){for(const e of this.store.entries())yield[e[0],e[1].value]}*values(){for(const e of this.store.values())yield e.value}*keys(){yield*this.store.keys()}elapsedSet(e){const r=this.store.get(e);return r&&Date.now()-r.lastSet}elapsedGet(e){const r=this.store.get(e);return r&&Date.now()-r.lastGet}has(e){return this.store.has(e)}get(e){const r=this.store.get(e);if(r)return r.value}delete(e){const r=this.store.get(e);if(!r)return!1;const n=this.store.delete(e);return this.keyCount=this.keyCount-1,this.fireEvent("removed",{key:e,value:r.value}),n}touch(e){const r=this.store.get(e);return r?(this.store.set(e,{...r,lastSet:Date.now(),lastGet:Date.now()}),!0):!1}findEvicteeKey(){if(this.evictPolicy==="none")return null;let e="";if(this.evictPolicy==="oldestGet")e="lastGet";else if(this.evictPolicy==="oldestSet")e="lastSet";else throw Error(`Unknown eviction policy ${this.evictPolicy}`);return Cc(this.store,e)[0][0]}#e(){this.autoDeletePolicy!=="none"&&this.deleteWithElapsed(this.autoDeleteElapsedMs,this.autoDeletePolicy)}deleteWithElapsed(e,r){const n=[...this.store.entries()],i=[],a=Date.now();for(const u of n){const o=a-u[1].lastGet,s=a-u[1].lastSet;(r==="get"?o:r==="set"?s:Math.max(o,s))>=e&&i.push([u[0],u[1].value])}for(const u of i){this.store.delete(u[0]),this.keyCount=this.keyCount-1;const o={key:u[0],value:u[1]};this.fireEvent("expired",o),this.fireEvent("removed",o)}return i}set(e,r){const n=this.store.get(e);if(n){this.store.set(e,{...n,lastSet:performance.now()});return}if(this.keyCount===this.capacity&&this.capacity>0){const i=this.findEvicteeKey();if(!i)throw new Error(`ExpiringMap full (capacity: ${this.capacity})`);const a=this.store.get(i);if(this.store.delete(i),this.keyCount=this.keyCount-1,a){const u={key:i,value:a.value};this.fireEvent("expired",u),this.fireEvent("removed",u)}}this.keyCount++,this.store.set(e,{lastGet:0,lastSet:Date.now(),value:r}),this.fireEvent("newKey",{key:e,value:r})}},Xv={};Z(Xv,{Arrays:()=>Vt,Maps:()=>Ec,Queues:()=>Ks,Sets:()=>dh,Stacks:()=>Rc,Trees:()=>kc,circularArray:()=>Pc,stack:()=>Ai,stackMutable:()=>Ou});var Zv=class _c extends Array{#e;#t;constructor(r=0){super();Ee(r,"positive","capacity"),this.#e=r,this.#t=0}add(r){const n=_c.from(this);return n[this.#t]=r,n.#e=this.#e,this.#e>0?n.#t=this.#t+1===this.#e?0:this.#t+1:n.#t=this.#t+1,n}get pointer(){return this.#t}get isFull(){return this.#e===0?!1:this.length===this.#e}},Pc=e=>new Zv(e),Rc={};Z(Rc,{stack:()=>Ai,stackMutable:()=>Ou});var Qv=(e,r,n)=>{const i=r.length+n.length,a=e.discardPolicy??"additions",u=e.capacity??i,o=i-u;switch(e.debug&&console.log(`Stack.push: stackLen: ${r.length} potentialLen: ${i} toRemove: ${o} policy: ${a}`),a){case"additions":return e.debug&&console.log(`Stack.push:DiscardAdditions: stackLen: ${r.length} slice: ${i-u} toAddLen: ${n.length}`),r.length===e.capacity?r:[...r,...n.slice(0,n.length-o)];case"newer":return o>=r.length?n.slice(Math.max(0,n.length-u),Math.min(n.length,u)+1):(e.debug&&console.log(` from orig: ${r.slice(0,r.length-o)}`),[...r.slice(0,r.length-o),...n.slice(0,Math.min(n.length,u-o+1))]);case"older":return[...r,...n].slice(o);default:throw new Error(`Unknown discard policy ${a}`)}},Bc=(e,r,...n)=>{const i=r.length+n.length;return e.capacity&&i>e.capacity?Qv(e,r,n):[...r,...n]},Nc=(e,r)=>{if(r.length===0)throw new Error("Stack is empty");return r.slice(0,r.length-1)},ru=(e,r)=>r[r.length-1],zc=(e,r)=>r.length===0,Wc=(e,r)=>e.capacity?r.length>=e.capacity:!1,ey=class nu{opts;data;constructor(r,n){this.opts=r,this.data=n}push(...r){return new nu(this.opts,Bc(this.opts,this.data,...r))}pop(){return new nu(this.opts,Nc(this.opts,this.data))}forEach(r){this.data.forEach(r)}forEachFromTop(r){[...this.data].reverse().forEach(r)}get isEmpty(){return zc(this.opts,this.data)}get isFull(){return Wc(this.opts,this.data)}get peek(){return ru(this.opts,this.data)}get length(){return this.data.length}},ty=class{opts;data;constructor(e,r){this.opts=e,this.data=r}push(...e){return this.data=Bc(this.opts,this.data,...e),this.data.length}forEach(e){this.data.forEach(e)}forEachFromTop(e){[...this.data].reverse().forEach(e)}pop(){const e=ru(this.opts,this.data);return this.data=Nc(this.opts,this.data),e}get isEmpty(){return zc(this.opts,this.data)}get isFull(){return Wc(this.opts,this.data)}get peek(){return ru(this.opts,this.data)}get length(){return this.data.length}},Ai=(e={},...r)=>new ey({...e},[...r]),Ou=(e={},...r)=>new ty({...e},[...r]),kc={};Z(kc,{TreeNodeMutable:()=>t0,breadthFirst:()=>pA,couldAddChild:()=>Mu,depthFirst:()=>gA,directChildren:()=>Fn,getByPath:()=>i0,getLengthChildren:()=>mA,hasAnyChild:()=>Vi,hasAnyParent:()=>u0,hasChild:()=>Sa,hasParent:()=>rs,isTreeNode:()=>ts,prettyPrint:()=>n0,traceByPath:()=>a0,treeNodeMutable:()=>yA});var Oc={};Z(Oc,{Direction:()=>Qd,QuadTreeNode:()=>vA});var ry={};Z(ry,{Arcs:()=>Lu,Beziers:()=>Zn,Circles:()=>At,Compound:()=>Go,Convolve2d:()=>Hd,Ellipses:()=>fo,Grids:()=>Oo,Layouts:()=>Vd,Lines:()=>Ke,Paths:()=>nn,Points:()=>O,Polar:()=>Ve,QuadTree:()=>Oc,Rects:()=>ye,Scaler:()=>Ui,Shapes:()=>Aa,Spheres:()=>Gb,SurfacePoints:()=>Xd,Triangles:()=>Tr,Vectors:()=>qi,Waypoints:()=>jd,degreeToRadian:()=>Fr,radianToDegree:()=>Ca,radiansFromAxisX:()=>Zd});var Lu={};Z(Lu,{bbox:()=>Rd,distanceCenter:()=>hb,fromDegrees:()=>lb,guard:()=>Ko,interpolate:()=>Jo,isArc:()=>Id,isEqual:()=>db,isPositioned:()=>vr,length:()=>Pd,point:()=>Ti,toLine:()=>_d,toPath:()=>fb,toSvg:()=>Bd});var O={};Z(O,{Empty:()=>gn,Placeholder:()=>gd,abs:()=>jD,angle:()=>ln,apply:()=>JD,bbox:()=>UD,centroid:()=>pd,clamp:()=>sb,clampMagnitude:()=>Md,compare:()=>eb,compareByX:()=>Fd,convexHull:()=>QD,distance:()=>Bt,distanceToCenter:()=>qD,distanceToExterior:()=>TD,divide:()=>Cd,divideFn:()=>XD,dotProduct:()=>md,findMinimum:()=>$r,from:()=>KD,fromNumbers:()=>Ed,getPointParam:()=>ut,guard:()=>pe,guardNonZeroPoint:()=>Ho,interpolate:()=>HD,invert:()=>ub,isEmpty:()=>pi,isEqual:()=>kn,isNaN:()=>OD,isNull:()=>kD,isPlaceholder:()=>wi,isPoint:()=>Fe,isPoint3d:()=>pn,leftmost:()=>LD,multiply:()=>ba,multiplyScalar:()=>YD,normalise:()=>Sd,normaliseByRect:()=>nb,pipeline:()=>Dd,pipelineApply:()=>GD,progressBetween:()=>cb,project:()=>Fu,quantiseEvery:()=>ZD,random:()=>ib,reduce:()=>bd,relation:()=>Su,rightmost:()=>$D,rotate:()=>Vr,rotatePointArray:()=>tb,subtract:()=>Nr,sum:()=>Ad,toArray:()=>VD,toIntegerValues:()=>ob,toString:()=>wd,withinRange:()=>xD,wrap:()=>ab});var Ke={};Z(Ke,{Empty:()=>AD,Placeholder:()=>CD,angleRadian:()=>MD,apply:()=>Zh,asPoints:()=>ND,bbox:()=>vd,distance:()=>cd,divide:()=>ed,extendFromA:()=>RD,fromFlatArray:()=>zD,fromNumbers:()=>$i,fromPoints:()=>Da,fromPointsToPath:()=>WD,getPointsParam:()=>Ea,guard:()=>wa,interpolate:()=>Sr,isEmpty:()=>FD,isEqual:()=>Xh,isLine:()=>Br,isPlaceholder:()=>SD,isPolyLine:()=>Yh,joinPointsToLines:()=>dd,length:()=>yr,midpoint:()=>id,multiply:()=>Qh,nearest:()=>Vo,normaliseByRect:()=>ID,parallel:()=>sd,perpendicularPoint:()=>od,pointAtX:()=>PD,pointsOf:()=>BD,rotate:()=>yd,scaleFromMidpoint:()=>_D,slope:()=>xo,subtract:()=>rd,sum:()=>td,toFlatArray:()=>fd,toPath:()=>hr,toString:()=>ld,toSvgString:()=>hd,withinRange:()=>nd});var $u={};Z($u,{crossfade:()=>mD,fromCubicBezier:()=>yD,functions:()=>To,gaussian:()=>jh,get:()=>ga,getEasings:()=>gD,mix:()=>qh,tick:()=>vD,time:()=>dD});var ny={};Z(ny,{Correlate:()=>Nh,FrequencyMutable:()=>_h,IntervalTracker:()=>Rh,Normalise:()=>Lc,NumberTracker:()=>Uu,PointTracker:()=>Lo,Pool:()=>Wh,TrackedPointMap:()=>Sh,TrackedValueMap:()=>jc,TrackerBase:()=>ju,clamp:()=>Rt,clampIndex:()=>Qa,flip:()=>gi,frequencyMutable:()=>aD,interpolate:()=>$o,interpolateAngle:()=>$h,intervalTracker:()=>sD,movingAverage:()=>oD,movingAverageLight:()=>Ph,movingAverageTimed:()=>uD,numberTracker:()=>Wn,piPi:()=>Au,pointTracker:()=>tD,pointsTracker:()=>Mh,scale:()=>Qt,scaleClamped:()=>iy,scalePercent:()=>uy,scalePercentages:()=>ay,wrap:()=>Li,wrapInteger:()=>Bh,wrapRange:()=>cD});var Lc={};Z(Lc,{array:()=>sy,stream:()=>oy});var Qt=(e,r,n,i,a,u)=>{if(a===void 0&&(a=1),i===void 0&&(i=0),r===n)return a;let o=(e-r)/(n-r);return u!==void 0&&(o=u(o)),o*(a-i)+i},iy=(e,r,n,i,a,u)=>{if(a===void 0&&(a=1),i===void 0&&(i=0),r===n)return a;const o=Qt(e,r,n,i,a,u);return Rt(o,i,a)},ay=(e,r,n=1)=>(Y(e,"percentage","v"),Y(r,"percentage","outMin"),Y(n,"percentage","outMax"),Qt(e,0,1,r,n)),uy=(e,r,n)=>(Y(e,"percentage","v"),Qt(e,0,1,r,n)),oy=(e,r)=>{let n=e??Number.MAX_SAFE_INTEGER,i=r??Number.MIN_SAFE_INTEGER;return Y(e),Y(r),a=>(Y(a),n=Math.min(n,a),i=Math.max(i,a),Qt(a,n,i))},sy=(e,r,n)=>{if(!Array.isArray(e))throw new Error("values param should be an array");const i=pa(e),a=r??i.min,u=n??i.max;return e.map(o=>Rt(Qt(o,a,u)))},$c={};Z($c,{byValueString:()=>Tc,getSorter:()=>qc,minMaxAvg:()=>hy,sortByKey:()=>iu,sortByValueNumber:()=>au,sortByValueString:()=>fy});var Tu=wn(cv(),1),qu=wn(Ft(),1),Ci=wn(lv(),1),ys=wn(Qs(),1),fn=wn(Xn(),1),cy=(e=!1)=>(0,qu.pipe)(e?(0,fn.reverse)(Ci.Ord):Ci.Ord,(0,fn.contramap)(r=>r[0])),Tc=(e=!1)=>(0,qu.pipe)(e?(0,fn.reverse)(Ci.Ord):Ci.Ord,(0,fn.contramap)(r=>r[1])),ly=(e=!1)=>(0,qu.pipe)(e?(0,fn.reverse)(ys.Ord):ys.Ord,(0,fn.contramap)(r=>r[1])),iu=(e=!1)=>(0,Tu.sort)(cy(e)),fy=(e=!1)=>(0,Tu.sort)(Tc(e)),au=(e=!1)=>(0,Tu.sort)(ly(e)),qc=e=>{switch(e){case"value":return au(!1);case"valueReverse":return au(!0);case"key":return iu(!1);case"keyReverse":return iu(!0);default:throw new Error(`Unknown sorting value '${e}'. Expecting: value, valueReverse, key or keyReverse`)}},hy=(e,r)=>{r===void 0&&(r=i=>i[1]);const n=e.map(r);return pa(n)},dy={};Z(dy,{average:()=>_m,averageWeighted:()=>Pm,filter:()=>Wm,isValid:()=>Al,linearSpace:()=>Cl,max:()=>Bm,min:()=>Rm,quantiseEvery:()=>lu,round:()=>km,rounder:()=>to,total:()=>Nm,tracker:()=>zm});var jc=class{store;gog;constructor(e){this.store=new Map,this.gog=Dc(this.store,e)}get size(){return this.store.size}has(e){return this.store.has(e)}async seen(e,...r){return(await this.getTrackedValue(e,...r)).seen(...r)}async getTrackedValue(e,...r){if(e===null)throw new Error("id parameter cannot be null");if(e===void 0)throw new Error("id parameter cannot be undefined");return await this.gog(e,r[0])}delete(e){this.store.delete(e)}reset(){this.store=new Map}*ids(){yield*this.store.keys()}*tracked(){yield*this.store.values()}*trackedByAge(){const e=Array.from(this.store.values());e.sort((r,n)=>{const i=r.elapsed,a=n.elapsed;return i===a?0:i>a?-1:1});for(const r of e)yield r}*valuesByAge(){for(const e of this.trackedByAge())yield e.last}*last(){for(const e of this.store.values())yield e.last}*initialValues(){for(const e of this.store.values())yield e.initial}get(e){return this.store.get(e)}},ju=class{seenCount;storeIntermediate;resetAfterSamples;sampleLimit;id;constructor(e={}){this.id=e.id??"tracker",this.sampleLimit=e.sampleLimit??-1,this.resetAfterSamples=e.resetAfterSamples??-1,this.storeIntermediate=e.storeIntermediate??(this.sampleLimit>-1||this.resetAfterSamples>-1),this.seenCount=0}reset(){this.seenCount=0,this.onReset()}seen(...e){this.resetAfterSamples>0&&this.seenCount>this.resetAfterSamples?this.reset():this.sampleLimit>0&&this.seenCount>this.sampleLimit*2&&(this.seenCount=this.trimStore(this.sampleLimit),this.onTrimmed()),this.seenCount+=e.length;const r=this.seenImpl(e);this.onSeen(r)}onSeen(e){}},vy=class extends ju{values;timestamps;constructor(e){super(e);this.values=[],this.timestamps=[]}trimStore(e){return e>=this.values.length?this.values.length:(this.values=this.values.slice(-e),this.timestamps=this.timestamps.slice(-e),this.values.length)}onTrimmed(){}get last(){return this.values.at(-1)}get initial(){return this.values.at(0)}get size(){return this.values.length}get elapsed(){if(this.values.length<0)throw new Error("No values seen yet");return Date.now()-this.timestamps[0]}onReset(){this.values=[],this.timestamps=[]}seenImpl(e){const r=e.at(-1),n=Date.now();return this.storeIntermediate?(this.values.push(...e),this.timestamps.push(...is(e.length,()=>n))):this.values.length===0?(this.values.push(r),this.timestamps.push(n)):this.values.length===2?(this.values[1]=r,this.timestamps[1]=n):this.values.length===1&&(this.values.push(r),this.timestamps.push(n)),e}},Uu=class extends vy{total=0;min=Number.MAX_SAFE_INTEGER;max=Number.MIN_SAFE_INTEGER;get avg(){return this.total/this.seenCount}difference(){if(this.last!==void 0&&this.initial!==void 0)return this.last-this.initial}relativeDifference(){if(this.last!==void 0&&this.initial!==void 0)return this.last/this.initial}onReset(){this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER,this.total=0,super.onReset()}onTrimmed(){this.min=Uo(this.values),this.max=Jh(this.values),this.total=Gh(this.values)}onSeen(e){if(e.some(r=>Number.isNaN(r)))throw Error("Cannot add NaN");this.total=e.reduce((r,n)=>r+n,this.total),this.min=Math.min(...e,this.min),this.max=Math.max(...e,this.max)}getMinMaxAvg(){return{min:this.min,max:this.max,avg:this.avg}}},Wn=(e={})=>new Uu(e),yy={};Z(yy,{Easings:()=>$u,Forces:()=>Hu,Oscillators:()=>Qu,adsr:()=>xu,adsrIterable:()=>Yc,defaultAdsrOpts:()=>Gc,jitter:()=>Dl,pingPong:()=>eo,pingPongPercent:()=>bl});var Uc={};Z(Uc,{adsr:()=>xu,adsrIterable:()=>Yc,defaultAdsrOpts:()=>Gc});var nn={};Z(nn,{getEnd:()=>gy,getStart:()=>my});var my=function(e){if(Zn.isQuadraticBezier(e))return e.a;if(Ke.isLine(e))return e.a;throw new Error(`Unknown path type ${JSON.stringify(e)}`)},gy=function(e){if(Zn.isQuadraticBezier(e))return e.b;if(Ke.isLine(e))return e.b;throw new Error(`Unknown path type ${JSON.stringify(e)}`)},Zn={};Z(Zn,{computeQuadraticSimple:()=>Sy,cubic:()=>My,isCubicBezier:()=>Vu,isQuadraticBezier:()=>Gi,quadratic:()=>Kc,quadraticBend:()=>Fy,quadraticSimple:()=>an,quadraticToSvgString:()=>Hc,toPath:()=>mi});var{abs:In,cos:fr,sin:Xr,acos:py,atan2:_n,sqrt:br,pow:Pt}=Math;function Pn(e){return e<0?-Pt(-e,1/3):Pt(e,1/3)}var Vc=Math.PI,si=2*Vc,Ar=Vc/2,wy=1e-6,Oa=Number.MAX_SAFE_INTEGER||9007199254740991,La=Number.MIN_SAFE_INTEGER||-9007199254740991,Ey={x:0,y:0,z:0},J={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(e,r){const n=r(e);let i=n.x*n.x+n.y*n.y;return typeof n.z<"u"&&(i+=n.z*n.z),br(i)},compute:function(e,r,n){if(e===0)return r[0].t=0,r[0];const i=r.length-1;if(e===1)return r[i].t=1,r[i];const a=1-e;let u=r;if(i===0)return r[0].t=e,r[0];if(i===1){const s={x:a*u[0].x+e*u[1].x,y:a*u[0].y+e*u[1].y,t:e};return n&&(s.z=a*u[0].z+e*u[1].z),s}if(i<4){let s=a*a,c=e*e,l,f,h,y=0;i===2?(u=[u[0],u[1],u[2],Ey],l=s,f=a*e*2,h=c):i===3&&(l=s*a,f=s*e*3,h=a*c*3,y=e*c);const D={x:l*u[0].x+f*u[1].x+h*u[2].x+y*u[3].x,y:l*u[0].y+f*u[1].y+h*u[2].y+y*u[3].y,t:e};return n&&(D.z=l*u[0].z+f*u[1].z+h*u[2].z+y*u[3].z),D}const o=JSON.parse(JSON.stringify(r));for(;o.length>1;){for(let s=0;s<o.length-1;s++)o[s]={x:o[s].x+(o[s+1].x-o[s].x)*e,y:o[s].y+(o[s+1].y-o[s].y)*e},typeof o[s].z<"u"&&(o[s].z=o[s].z+(o[s+1].z-o[s].z)*e);o.splice(o.length-1,1)}return o[0].t=e,o[0]},computeWithRatios:function(e,r,n,i){const a=1-e,u=n,o=r;let s=u[0],c=u[1],l=u[2],f=u[3],h;if(s*=a,c*=e,o.length===2)return h=s+c,{x:(s*o[0].x+c*o[1].x)/h,y:(s*o[0].y+c*o[1].y)/h,z:i?(s*o[0].z+c*o[1].z)/h:!1,t:e};if(s*=a,c*=2*a,l*=e*e,o.length===3)return h=s+c+l,{x:(s*o[0].x+c*o[1].x+l*o[2].x)/h,y:(s*o[0].y+c*o[1].y+l*o[2].y)/h,z:i?(s*o[0].z+c*o[1].z+l*o[2].z)/h:!1,t:e};if(s*=a,c*=1.5*a,l*=3*a,f*=e*e*e,o.length===4)return h=s+c+l+f,{x:(s*o[0].x+c*o[1].x+l*o[2].x+f*o[3].x)/h,y:(s*o[0].y+c*o[1].y+l*o[2].y+f*o[3].y)/h,z:i?(s*o[0].z+c*o[1].z+l*o[2].z+f*o[3].z)/h:!1,t:e}},derive:function(e,r){const n=[];for(let i=e,a=i.length,u=a-1;a>1;a--,u--){const o=[];for(let s=0,c;s<u;s++)c={x:u*(i[s+1].x-i[s].x),y:u*(i[s+1].y-i[s].y)},r&&(c.z=u*(i[s+1].z-i[s].z)),o.push(c);n.push(o),i=o}return n},between:function(e,r,n){return r<=e&&e<=n||J.approximately(e,r)||J.approximately(e,n)},approximately:function(e,r,n){return In(e-r)<=(n||wy)},length:function(e){const n=J.Tvalues.length;let i=0;for(let a=0,u;a<n;a++)u=.5*J.Tvalues[a]+.5,i+=J.Cvalues[a]*J.arcfn(u,e);return .5*i},map:function(e,r,n,i,a){const u=n-r,o=a-i,s=e-r,c=s/u;return i+o*c},lerp:function(e,r,n){const i={x:r.x+e*(n.x-r.x),y:r.y+e*(n.y-r.y)};return r.z!==void 0&&n.z!==void 0&&(i.z=r.z+e*(n.z-r.z)),i},pointToString:function(e){let r=e.x+"/"+e.y;return typeof e.z<"u"&&(r+="/"+e.z),r},pointsToString:function(e){return"["+e.map(J.pointToString).join(", ")+"]"},copy:function(e){return JSON.parse(JSON.stringify(e))},angle:function(e,r,n){const i=r.x-e.x,a=r.y-e.y,u=n.x-e.x,o=n.y-e.y,s=i*o-a*u,c=i*u+a*o;return _n(s,c)},round:function(e,r){const n=""+e,i=n.indexOf(".");return parseFloat(n.substring(0,i+1+r))},dist:function(e,r){const n=e.x-r.x,i=e.y-r.y;return br(n*n+i*i)},closest:function(e,r){let n=Pt(2,63),i,a;return e.forEach(function(u,o){a=J.dist(r,u),a<n&&(n=a,i=o)}),{mdist:n,mpos:i}},abcratio:function(e,r){if(r!==2&&r!==3)return!1;if(typeof e>"u")e=.5;else if(e===0||e===1)return e;const n=Pt(e,r)+Pt(1-e,r),i=n-1;return In(i/n)},projectionratio:function(e,r){if(r!==2&&r!==3)return!1;if(typeof e>"u")e=.5;else if(e===0||e===1)return e;const n=Pt(1-e,r),i=Pt(e,r)+n;return n/i},lli8:function(e,r,n,i,a,u,o,s){const c=(e*i-r*n)*(a-o)-(e-n)*(a*s-u*o),l=(e*i-r*n)*(u-s)-(r-i)*(a*s-u*o),f=(e-n)*(u-s)-(r-i)*(a-o);return f==0?!1:{x:c/f,y:l/f}},lli4:function(e,r,n,i){const a=e.x,u=e.y,o=r.x,s=r.y,c=n.x,l=n.y,f=i.x,h=i.y;return J.lli8(a,u,o,s,c,l,f,h)},lli:function(e,r){return J.lli4(e,e.c,r,r.c)},makeline:function(e,r){return new Ji(e.x,e.y,(e.x+r.x)/2,(e.y+r.y)/2,r.x,r.y)},findbbox:function(e){let r=Oa,n=Oa,i=La,a=La;return e.forEach(function(u){const o=u.bbox();r>o.x.min&&(r=o.x.min),n>o.y.min&&(n=o.y.min),i<o.x.max&&(i=o.x.max),a<o.y.max&&(a=o.y.max)}),{x:{min:r,mid:(r+i)/2,max:i,size:i-r},y:{min:n,mid:(n+a)/2,max:a,size:a-n}}},shapeintersections:function(e,r,n,i,a){if(!J.bboxoverlap(r,i))return[];const u=[],o=[e.startcap,e.forward,e.back,e.endcap],s=[n.startcap,n.forward,n.back,n.endcap];return o.forEach(function(c){c.virtual||s.forEach(function(l){if(l.virtual)return;const f=c.intersects(l,a);f.length>0&&(f.c1=c,f.c2=l,f.s1=e,f.s2=n,u.push(f))})}),u},makeshape:function(e,r,n){const i=r.points.length,a=e.points.length,u=J.makeline(r.points[i-1],e.points[0]),o=J.makeline(e.points[a-1],r.points[0]),s={startcap:u,forward:e,back:r,endcap:o,bbox:J.findbbox([u,e,r,o])};return s.intersections=function(c){return J.shapeintersections(s,s.bbox,c,c.bbox,n)},s},getminmax:function(e,r,n){if(!n)return{min:0,max:0};let i=Oa,a=La,u,o;n.indexOf(0)===-1&&(n=[0].concat(n)),n.indexOf(1)===-1&&n.push(1);for(let s=0,c=n.length;s<c;s++)u=n[s],o=e.get(u),o[r]<i&&(i=o[r]),o[r]>a&&(a=o[r]);return{min:i,mid:(i+a)/2,max:a,size:a-i}},align:function(e,r){const n=r.p1.x,i=r.p1.y,a=-_n(r.p2.y-i,r.p2.x-n),u=function(o){return{x:(o.x-n)*fr(a)-(o.y-i)*Xr(a),y:(o.x-n)*Xr(a)+(o.y-i)*fr(a)}};return e.map(u)},roots:function(e,r){r=r||{p1:{x:0,y:0},p2:{x:1,y:0}};const n=e.length-1,i=J.align(e,r),a=function(E){return 0<=E&&E<=1};if(n===2){const E=i[0].y,I=i[1].y,H=i[2].y,U=E-2*I+H;if(U!==0){const Q=-br(I*I-E*H),ae=-E+I,ge=-(Q+ae)/U,he=-(-Q+ae)/U;return[ge,he].filter(a)}else if(I!==H&&U===0)return[(2*I-H)/(2*I-2*H)].filter(a);return[]}const u=i[0].y,o=i[1].y,s=i[2].y,c=i[3].y;let l=-u+3*o-3*s+c,f=3*u-6*o+3*s,h=-3*u+3*o,y=u;if(J.approximately(l,0)){if(J.approximately(f,0))return J.approximately(h,0)?[]:[-y/h].filter(a);const E=br(h*h-4*f*y),I=2*f;return[(E-h)/I,(-h-E)/I].filter(a)}f/=l,h/=l,y/=l;const D=(3*h-f*f)/3,P=D/3,q=(2*f*f*f-9*f*h+27*y)/27,N=q/2,b=N*N+P*P*P;let M,B,L,W,$;if(b<0){const E=-D/3,I=E*E*E,H=br(I),U=-q/(2*H),Q=U<-1?-1:U>1?1:U,ae=py(Q),ge=Pn(H),he=2*ge;return L=he*fr(ae/3)-f/3,W=he*fr((ae+si)/3)-f/3,$=he*fr((ae+2*si)/3)-f/3,[L,W,$].filter(a)}else{if(b===0)return M=N<0?Pn(-N):-Pn(N),L=2*M-f/3,W=-M-f/3,[L,W].filter(a);{const E=br(b);return M=Pn(-N+E),B=Pn(N+E),[M-B-f/3].filter(a)}}},droots:function(e){if(e.length===3){const r=e[0],n=e[1],i=e[2],a=r-2*n+i;if(a!==0){const u=-br(n*n-r*i),o=-r+n,s=-(u+o)/a,c=-(-u+o)/a;return[s,c]}else if(n!==i&&a===0)return[(2*n-i)/(2*(n-i))];return[]}if(e.length===2){const r=e[0],n=e[1];return r!==n?[r/(r-n)]:[]}return[]},curvature:function(e,r,n,i,a){let u,o,s,c,l=0,f=0;const h=J.compute(e,r),y=J.compute(e,n),D=h.x*h.x+h.y*h.y;if(i?(u=br(Pt(h.y*y.z-y.y*h.z,2)+Pt(h.z*y.x-y.z*h.x,2)+Pt(h.x*y.y-y.x*h.y,2)),o=Pt(D+h.z*h.z,3/2)):(u=h.x*y.y-h.y*y.x,o=Pt(D,3/2)),u===0||o===0)return{k:0,r:0};if(l=u/o,f=o/u,!a){const P=J.curvature(e-.001,r,n,i,!0).k,q=J.curvature(e+.001,r,n,i,!0).k;c=(q-l+(l-P))/2,s=(In(q-l)+In(l-P))/2}return{k:l,r:f,dk:c,adk:s}},inflections:function(e){if(e.length<4)return[];const r=J.align(e,{p1:e[0],p2:e.slice(-1)[0]}),n=r[2].x*r[1].y,i=r[3].x*r[1].y,a=r[1].x*r[2].y,u=r[3].x*r[2].y,o=18*(-3*n+2*i+3*a-u),s=18*(3*n-i-3*a),c=18*(a-n);if(J.approximately(o,0)){if(!J.approximately(s,0)){let y=-c/s;if(0<=y&&y<=1)return[y]}return[]}const l=2*o;if(J.approximately(l,0))return[];const f=s*s-4*o*c;if(f<0)return[];const h=Math.sqrt(f);return[(h-s)/l,-(s+h)/l].filter(function(y){return 0<=y&&y<=1})},bboxoverlap:function(e,r){const n=["x","y"],i=n.length;for(let a=0,u,o,s,c;a<i;a++)if(u=n[a],o=e[u].mid,s=r[u].mid,c=(e[u].size+r[u].size)/2,In(o-s)>=c)return!1;return!0},expandbox:function(e,r){r.x.min<e.x.min&&(e.x.min=r.x.min),r.y.min<e.y.min&&(e.y.min=r.y.min),r.z&&r.z.min<e.z.min&&(e.z.min=r.z.min),r.x.max>e.x.max&&(e.x.max=r.x.max),r.y.max>e.y.max&&(e.y.max=r.y.max),r.z&&r.z.max>e.z.max&&(e.z.max=r.z.max),e.x.mid=(e.x.min+e.x.max)/2,e.y.mid=(e.y.min+e.y.max)/2,e.z&&(e.z.mid=(e.z.min+e.z.max)/2),e.x.size=e.x.max-e.x.min,e.y.size=e.y.max-e.y.min,e.z&&(e.z.size=e.z.max-e.z.min)},pairiteration:function(e,r,n){const i=e.bbox(),a=r.bbox(),u=1e5,o=n||.5;if(i.x.size+i.y.size<o&&a.x.size+a.y.size<o)return[(u*(e._t1+e._t2)/2|0)/u+"/"+(u*(r._t1+r._t2)/2|0)/u];let s=e.split(.5),c=r.split(.5),l=[{left:s.left,right:c.left},{left:s.left,right:c.right},{left:s.right,right:c.right},{left:s.right,right:c.left}];l=l.filter(function(h){return J.bboxoverlap(h.left.bbox(),h.right.bbox())});let f=[];return l.length===0||(l.forEach(function(h){f=f.concat(J.pairiteration(h.left,h.right,o))}),f=f.filter(function(h,y){return f.indexOf(h)===y})),f},getccenter:function(e,r,n){const i=r.x-e.x,a=r.y-e.y,u=n.x-r.x,o=n.y-r.y,s=i*fr(Ar)-a*Xr(Ar),c=i*Xr(Ar)+a*fr(Ar),l=u*fr(Ar)-o*Xr(Ar),f=u*Xr(Ar)+o*fr(Ar),h=(e.x+r.x)/2,y=(e.y+r.y)/2,D=(r.x+n.x)/2,P=(r.y+n.y)/2,q=h+s,N=y+c,b=D+l,M=P+f,B=J.lli8(h,y,q,N,D,P,b,M),L=J.dist(B,e);let W=_n(e.y-B.y,e.x-B.x),$=_n(r.y-B.y,r.x-B.x),E=_n(n.y-B.y,n.x-B.x),I;return W<E?((W>$||$>E)&&(W+=si),W>E&&(I=E,E=W,W=I)):E<$&&$<W?(I=E,E=W,W=I):E+=si,B.s=W,B.e=E,B.r=L,B},numberSort:function(e,r){return e-r}},$a=class xc{constructor(r){this.curves=[],this._3d=!1,r&&(this.curves=r,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(r){return J.pointsToString(r.points)}).join(", ")+"]"}addCurve(r){this.curves.push(r),this._3d=this._3d||r._3d}length(){return this.curves.map(function(r){return r.length()}).reduce(function(r,n){return r+n})}curve(r){return this.curves[r]}bbox(){const r=this.curves;for(var n=r[0].bbox(),i=1;i<r.length;i++)J.expandbox(n,r[i].bbox());return n}offset(r){const n=[];return this.curves.forEach(function(i){n.push(...i.offset(r))}),new xc(n)}},{abs:Rn,min:ms,max:gs,cos:Dy,sin:by,acos:Ay,sqrt:Bn}=Math,Cy=Math.PI,Ji=class Be{constructor(r){let n=r&&r.forEach?r:Array.from(arguments).slice(),i=!1;if(typeof n[0]=="object"){i=n.length;const D=[];n.forEach(function(P){["x","y","z"].forEach(function(q){typeof P[q]<"u"&&D.push(P[q])})}),n=D}let a=!1;const u=n.length;if(i){if(i>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");a=!0}}else if(u!==6&&u!==8&&u!==9&&u!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const o=this._3d=!a&&(u===9||u===12)||r&&r[0]&&typeof r[0].z<"u",s=this.points=[];for(let D=0,P=o?3:2;D<u;D+=P){var c={x:n[D],y:n[D+1]};o&&(c.z=n[D+2]),s.push(c)}const l=this.order=s.length-1,f=this.dims=["x","y"];o&&f.push("z"),this.dimlen=f.length;const h=J.align(s,{p1:s[0],p2:s[l]}),y=J.dist(s[0],s[l]);this._linear=h.reduce((D,P)=>D+Rn(P.y),0)<y/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(r,n,i,a){if(typeof a>"u"&&(a=.5),a===0)return new Be(n,n,i);if(a===1)return new Be(r,n,n);const u=Be.getABC(2,r,n,i,a);return new Be(r,u.A,i)}static cubicFromPoints(r,n,i,a,u){typeof a>"u"&&(a=.5);const o=Be.getABC(3,r,n,i,a);typeof u>"u"&&(u=J.dist(n,o.C));const s=u*(1-a)/a,c=J.dist(r,i),l=(i.x-r.x)/c,f=(i.y-r.y)/c,h=u*l,y=u*f,D=s*l,P=s*f,q={x:n.x-h,y:n.y-y},N={x:n.x+D,y:n.y+P},b=o.A,M={x:b.x+(q.x-b.x)/(1-a),y:b.y+(q.y-b.y)/(1-a)},B={x:b.x+(N.x-b.x)/a,y:b.y+(N.y-b.y)/a},L={x:r.x+(M.x-r.x)/a,y:r.y+(M.y-r.y)/a},W={x:i.x+(B.x-i.x)/(1-a),y:i.y+(B.y-i.y)/(1-a)};return new Be(r,L,W,i)}static getUtils(){return J}getUtils(){return Be.getUtils()}static get PolyBezier(){return $a}valueOf(){return this.toString()}toString(){return J.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const r=this.points,n=r[0].x,i=r[0].y,a=["M",n,i,this.order===2?"Q":"C"];for(let u=1,o=r.length;u<o;u++)a.push(r[u].x),a.push(r[u].y);return a.join(" ")}setRatios(r){if(r.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=r,this._lut=[]}verify(){const r=this.coordDigest();r!==this._print&&(this._print=r,this.update())}coordDigest(){return this.points.map(function(r,n){return""+n+r.x+r.y+(r.z?r.z:0)}).join("")}update(){this._lut=[],this.dpoints=J.derive(this.points,this._3d),this.computedirection()}computedirection(){const r=this.points,n=J.angle(r[0],r[this.order],r[1]);this.clockwise=n>0}length(){return J.length(this.derivative.bind(this))}static getABC(r=2,n,i,a,u=.5){const o=J.projectionratio(u,r),s=1-o,c={x:o*n.x+s*a.x,y:o*n.y+s*a.y},l=J.abcratio(u,r);return{A:{x:i.x+(i.x-c.x)/l,y:i.y+(i.y-c.y)/l},B:i,C:c,S:n,E:a}}getABC(r,n){n=n||this.get(r);let i=this.points[0],a=this.points[this.order];return Be.getABC(this.order,i,n,a,r)}getLUT(r){if(this.verify(),r=r||100,this._lut.length===r+1)return this._lut;this._lut=[],r++,this._lut=[];for(let n=0,i,a;n<r;n++)a=n/(r-1),i=this.compute(a),i.t=a,this._lut.push(i);return this._lut}on(r,n){n=n||5;const i=this.getLUT(),a=[];for(let u=0,o,s=0;u<i.length;u++)o=i[u],J.dist(o,r)<n&&(a.push(o),s+=u/i.length);return a.length?t/=a.length:!1}project(r){const n=this.getLUT(),i=n.length-1,a=J.closest(n,r),u=a.mpos,o=(u-1)/i,s=(u+1)/i,c=.1/i;let l=a.mdist,f=o,h=f,y;l+=1;for(let D;f<s+c;f+=c)y=this.compute(f),D=J.dist(r,y),D<l&&(l=D,h=f);return h=h<0?0:h>1?1:h,y=this.compute(h),y.t=h,y.d=l,y}get(r){return this.compute(r)}point(r){return this.points[r]}compute(r){return this.ratios?J.computeWithRatios(r,this.points,this.ratios,this._3d):J.compute(r,this.points,this._3d,this.ratios)}raise(){const r=this.points,n=[r[0]],i=r.length;for(let a=1,u,o;a<i;a++)u=r[a],o=r[a-1],n[a]={x:(i-a)/i*u.x+a/i*o.x,y:(i-a)/i*u.y+a/i*o.y};return n[i]=r[i-1],new Be(n)}derivative(r){return J.compute(r,this.dpoints[0],this._3d)}dderivative(r){return J.compute(r,this.dpoints[1],this._3d)}align(){let r=this.points;return new Be(J.align(r,{p1:r[0],p2:r[r.length-1]}))}curvature(r){return J.curvature(r,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return J.inflections(this.points)}normal(r){return this._3d?this.__normal3(r):this.__normal2(r)}__normal2(r){const n=this.derivative(r),i=Bn(n.x*n.x+n.y*n.y);return{t:r,x:-n.y/i,y:n.x/i}}__normal3(r){const n=this.derivative(r),i=this.derivative(r+.01),a=Bn(n.x*n.x+n.y*n.y+n.z*n.z),u=Bn(i.x*i.x+i.y*i.y+i.z*i.z);n.x/=a,n.y/=a,n.z/=a,i.x/=u,i.y/=u,i.z/=u;const o={x:i.y*n.z-i.z*n.y,y:i.z*n.x-i.x*n.z,z:i.x*n.y-i.y*n.x},s=Bn(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=s,o.y/=s,o.z/=s;const c=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{t:r,x:c[0]*n.x+c[1]*n.y+c[2]*n.z,y:c[3]*n.x+c[4]*n.y+c[5]*n.z,z:c[6]*n.x+c[7]*n.y+c[8]*n.z}}hull(r){let n=this.points,i=[],a=[],u=0;for(a[u++]=n[0],a[u++]=n[1],a[u++]=n[2],this.order===3&&(a[u++]=n[3]);n.length>1;){i=[];for(let o=0,s,c=n.length-1;o<c;o++)s=J.lerp(r,n[o],n[o+1]),a[u++]=s,i.push(s);n=i}return a}split(r,n){if(r===0&&!!n)return this.split(n).left;if(n===1)return this.split(r).right;const i=this.hull(r),a={left:this.order===2?new Be([i[0],i[3],i[5]]):new Be([i[0],i[4],i[7],i[9]]),right:this.order===2?new Be([i[5],i[4],i[2]]):new Be([i[9],i[8],i[6],i[3]]),span:i};return a.left._t1=J.map(0,0,1,this._t1,this._t2),a.left._t2=J.map(r,0,1,this._t1,this._t2),a.right._t1=J.map(r,0,1,this._t1,this._t2),a.right._t2=J.map(1,0,1,this._t1,this._t2),n?(n=J.map(n,r,1,0,1),a.right.split(n).left):a}extrema(){const r={};let n=[];return this.dims.forEach(function(i){let a=function(o){return o[i]},u=this.dpoints[0].map(a);r[i]=J.droots(u),this.order===3&&(u=this.dpoints[1].map(a),r[i]=r[i].concat(J.droots(u))),r[i]=r[i].filter(function(o){return o>=0&&o<=1}),n=n.concat(r[i].sort(J.numberSort))}.bind(this)),r.values=n.sort(J.numberSort).filter(function(i,a){return n.indexOf(i)===a}),r}bbox(){const r=this.extrema(),n={};return this.dims.forEach(function(i){n[i]=J.getminmax(this,i,r[i])}.bind(this)),n}overlaps(r){const n=this.bbox(),i=r.bbox();return J.bboxoverlap(n,i)}offset(r,n){if(typeof n<"u"){const i=this.get(r),a=this.normal(r),u={c:i,n:a,x:i.x+a.x*n,y:i.y+a.y*n};return this._3d&&(u.z=i.z+a.z*n),u}if(this._linear){const i=this.normal(0),a=this.points.map(function(u){const o={x:u.x+r*i.x,y:u.y+r*i.y};return u.z&&i.z&&(o.z=u.z+r*i.z),o});return[new Be(a)]}return this.reduce().map(function(i){return i._linear?i.offset(r)[0]:i.scale(r)})}simple(){if(this.order===3){const a=J.angle(this.points[0],this.points[3],this.points[1]),u=J.angle(this.points[0],this.points[3],this.points[2]);if(a>0&&u<0||a<0&&u>0)return!1}const r=this.normal(0),n=this.normal(1);let i=r.x*n.x+r.y*n.y;return this._3d&&(i+=r.z*n.z),Rn(Ay(i))<Cy/3}reduce(){let r,n=0,i=0,a=.01,u,o=[],s=[],c=this.extrema().values;for(c.indexOf(0)===-1&&(c=[0].concat(c)),c.indexOf(1)===-1&&c.push(1),n=c[0],r=1;r<c.length;r++)i=c[r],u=this.split(n,i),u._t1=n,u._t2=i,o.push(u),n=i;return o.forEach(function(l){for(n=0,i=0;i<=1;)for(i=n+a;i<=1+a;i+=a)if(u=l.split(n,i),!u.simple()){if(i-=a,Rn(n-i)<a)return[];u=l.split(n,i),u._t1=J.map(n,0,1,l._t1,l._t2),u._t2=J.map(i,0,1,l._t1,l._t2),s.push(u),n=i;break}n<1&&(u=l.split(n,1),u._t1=J.map(n,0,1,l._t1,l._t2),u._t2=l._t2,s.push(u))}),s}translate(r,n,i){i=typeof i=="number"?i:n;const a=this.order;let u=this.points.map((o,s)=>(1-s/a)*n+s/a*i);return new Be(this.points.map((o,s)=>({x:o.x+r.x*u[s],y:o.y+r.y*u[s]})))}scale(r){const n=this.order;let i=!1;if(typeof r=="function"&&(i=r),i&&n===2)return this.raise().scale(i);const a=this.clockwise,u=this.points;if(this._linear)return this.translate(this.normal(0),i?i(0):r,i?i(1):r);const o=i?i(0):r,s=i?i(1):r,c=[this.offset(0,10),this.offset(1,10)],l=[],f=J.lli4(c[0],c[0].c,c[1],c[1].c);if(!f)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(h){const y=l[h*n]=J.copy(u[h*n]);y.x+=(h?s:o)*c[h].n.x,y.y+=(h?s:o)*c[h].n.y}),i?([0,1].forEach(function(h){if(!(n===2&&!!h)){var y=u[h+1],D={x:y.x-f.x,y:y.y-f.y},P=i?i((h+1)/n):r;i&&!a&&(P=-P);var q=Bn(D.x*D.x+D.y*D.y);D.x/=q,D.y/=q,l[h+1]={x:y.x+P*D.x,y:y.y+P*D.y}}}),new Be(l)):([0,1].forEach(h=>{if(n===2&&!!h)return;const y=l[h*n],D=this.derivative(h),P={x:y.x+D.x,y:y.y+D.y};l[h+1]=J.lli4(y,P,f,u[h+1])}),new Be(l))}outline(r,n,i,a){if(n=n===void 0?r:n,this._linear){const W=this.normal(0),$=this.points[0],E=this.points[this.points.length-1];let I,H,U;i===void 0&&(i=r,a=n),I={x:$.x+W.x*r,y:$.y+W.y*r},U={x:E.x+W.x*i,y:E.y+W.y*i},H={x:(I.x+U.x)/2,y:(I.y+U.y)/2};const Q=[I,H,U];I={x:$.x-W.x*n,y:$.y-W.y*n},U={x:E.x-W.x*a,y:E.y-W.y*a},H={x:(I.x+U.x)/2,y:(I.y+U.y)/2};const ae=[U,H,I],ge=J.makeline(ae[2],Q[0]),he=J.makeline(Q[2],ae[0]),ze=[ge,new Be(Q),he,new Be(ae)];return new $a(ze)}const u=this.reduce(),o=u.length,s=[];let c=[],l,f=0,h=this.length();const y=typeof i<"u"&&typeof a<"u";function D(W,$,E,I,H){return function(U){const Q=I/E,ae=(I+H)/E,ge=$-W;return J.map(U,0,1,W+Q*ge,W+ae*ge)}}u.forEach(function(W){const $=W.length();y?(s.push(W.scale(D(r,i,h,f,$))),c.push(W.scale(D(-n,-a,h,f,$)))):(s.push(W.scale(r)),c.push(W.scale(-n))),f+=$}),c=c.map(function(W){return l=W.points,l[3]?W.points=[l[3],l[2],l[1],l[0]]:W.points=[l[2],l[1],l[0]],W}).reverse();const P=s[0].points[0],q=s[o-1].points[s[o-1].points.length-1],N=c[o-1].points[c[o-1].points.length-1],b=c[0].points[0],M=J.makeline(N,P),B=J.makeline(q,b),L=[M].concat(s).concat([B]).concat(c);return new $a(L)}outlineshapes(r,n,i){n=n||r;const a=this.outline(r,n).curves,u=[];for(let o=1,s=a.length;o<s/2;o++){const c=J.makeshape(a[o],a[s-o],i);c.startcap.virtual=o>1,c.endcap.virtual=o<s/2-1,u.push(c)}return u}intersects(r,n){return r?r.p1&&r.p2?this.lineIntersects(r):(r instanceof Be&&(r=r.reduce()),this.curveintersects(this.reduce(),r,n)):this.selfintersects(n)}lineIntersects(r){const n=ms(r.p1.x,r.p2.x),i=ms(r.p1.y,r.p2.y),a=gs(r.p1.x,r.p2.x),u=gs(r.p1.y,r.p2.y);return J.roots(this.points,r).filter(o=>{var s=this.get(o);return J.between(s.x,n,a)&&J.between(s.y,i,u)})}selfintersects(r){const n=this.reduce(),i=n.length-2,a=[];for(let u=0,o,s,c;u<i;u++)s=n.slice(u,u+1),c=n.slice(u+2),o=this.curveintersects(s,c,r),a.push(...o);return a}curveintersects(r,n,i){const a=[];r.forEach(function(o){n.forEach(function(s){o.overlaps(s)&&a.push({left:o,right:s})})});let u=[];return a.forEach(function(o){const s=J.pairiteration(o.left,o.right,i);s.length>0&&(u=u.concat(s))}),u}arcs(r){return r=r||.5,this._iterate(r,[])}_error(r,n,i,a){const u=(a-i)/4,o=this.get(i+u),s=this.get(a-u),c=J.dist(r,n),l=J.dist(r,o),f=J.dist(r,s);return Rn(l-c)+Rn(f-c)}_iterate(r,n){let i=0,a=1,u;do{u=0,a=1;let o=this.get(i),s,c,l,f,h=!1,y=!1,D,P=a,q=1;do if(y=h,f=l,P=(i+a)/2,s=this.get(P),c=this.get(a),l=J.getccenter(o,s,c),l.interval={start:i,end:a},h=this._error(l,o,i,a)<=r,D=y&&!h,D||(q=a),h){if(a>=1){if(l.interval.end=q=1,f=l,a>1){let b={x:l.x+l.r*Dy(l.e),y:l.y+l.r*by(l.e)};l.e+=J.angle({x:l.x,y:l.y},b,this.get(1))}break}a=a+(a-i)/2}else a=P;while(!D&&u++<100);if(u>=100)break;f=f||l,n.push(f),i=q}while(a<1);return n}},Gi=e=>e.quadratic!==void 0,Vu=e=>e.cubic1!==void 0&&e.cubic2!==void 0,Fy=(e,r,n=0)=>an(e,r,n),an=(e,r,n=0)=>{if(isNaN(n))throw Error("bend is NaN");if(n<-1||n>1)throw Error("Expects bend range of -1 to 1");const i=Ke.interpolate(.5,e,r);let a=i;r.y<e.y?a=n>0?{x:Math.min(e.x,r.x),y:Math.min(e.y,r.y)}:{x:Math.max(e.x,r.x),y:Math.max(e.y,r.y)}:a=n>0?{x:Math.max(e.x,r.x),y:Math.min(e.y,r.y)}:{x:Math.min(e.x,r.x),y:Math.max(e.y,r.y)};const u=Ke.interpolate(Math.abs(n),i,a);return Kc(e,r,u)},Sy=(e,r,n,i)=>{const a=an(e,r,n);return new Ji(a.a,a.quadratic,a.b).compute(i)},Hc=(e,r,n)=>[`M ${e.x} ${e.y} Q ${n.x} ${n.y} ${r.x} ${r.y}`],mi=e=>{if(Vu(e))return Iy(e);if(Gi(e))return _y(e);throw new Error("Unknown bezier type")},My=(e,r,n,i)=>({a:Object.freeze(e),b:Object.freeze(r),cubic1:Object.freeze(n),cubic2:Object.freeze(i)}),Iy=e=>{const{a:r,cubic1:n,cubic2:i,b:a}=e,u=new Ji(r,n,i,a);return Object.freeze({...e,length:()=>u.length(),interpolate:o=>u.compute(o),nearest:o=>{throw new Error("not implemented")},bbox:()=>{const{x:o,y:s}=u.bbox(),c=o.size,l=s.size;if(c===void 0)throw new Error("x.size not present on calculated bbox");if(l===void 0)throw new Error("x.size not present on calculated bbox");return ye.fromTopLeft({x:o.min,y:s.min},c,l)},toString:()=>u.toString(),toSvgString:()=>["brrup"],kind:"bezier/cubic"})},Kc=(e,r,n)=>({a:Object.freeze(e),b:Object.freeze(r),quadratic:Object.freeze(n)}),_y=e=>{const{a:r,b:n,quadratic:i}=e,a=new Ji(r,i,n);return Object.freeze({...e,length:()=>a.length(),interpolate:u=>a.compute(u),nearest:u=>{throw new Error("not implemented")},bbox:()=>{const{x:u,y:o}=a.bbox(),s=u.size,c=o.size;if(s===void 0)throw new Error("x.size not present on calculated bbox");if(c===void 0)throw new Error("x.size not present on calculated bbox");return ye.fromTopLeft({x:u.min,y:o.min},s,c)},toString:()=>a.toString(),toSvgString:()=>Hc(r,n,i),kind:"bezier/quadratic"})};async function*Jc(e,r){const n=typeof r=="number"?r:r.sampleRateMs,i=typeof r=="number"?void 0:r.signal;for(;;){const a=e();if(typeof a>"u")return;if(yield a,await Zt({millis:n,signal:i}),i?.aborted)throw new Error("Cancelling due to signal")}}var Gc=()=>({attackBend:-1,decayBend:-.3,releaseBend:-.3,peakLevel:1,initialLevel:0,sustainLevel:.6,releaseLevel:0,attackDuration:600,decayDuration:200,releaseDuration:800,shouldLoop:!1}),Py=class extends tr{#e;#t;#r;#n;#i;attackDuration;decayDuration;releaseDuration;decayDurationTotal;shouldLoop;constructor(e){super();this.attackDuration=e.attackDuration??300,this.decayDuration=e.decayDuration??500,this.releaseDuration=e.releaseDuration??1e3,this.shouldLoop=e.shouldLoop??!1;const r={attack:["decay","release"],decay:["sustain","release"],sustain:["release"],release:["complete"],complete:null};this.#e=new Jr("attack",r),this.#e.addEventListener("change",n=>{n.newState==="release"&&this.#i&&this.#r?.reset(),super.fireEvent("change",n)}),this.#e.addEventListener("stop",n=>{super.fireEvent("complete",n)}),this.#t=rr,this.#n=this.#i=!1,this.decayDurationTotal=this.attackDuration+this.decayDuration}switchState(){if(this.#r===void 0)return!1;let e=this.#r.elapsed;const r=this.#i&&!this.#n;let n=!1;do switch(n=!1,this.#e.state){case"attack":(e>this.attackDuration||r)&&(this.#e.next(),n=!0);break;case"decay":(e>this.decayDurationTotal||r)&&(this.#e.next(),n=!0);break;case"sustain":(!this.#n||r)&&(e=0,this.#e.next(),this.#r?.reset(),n=!0);break;case"release":e>this.releaseDuration&&(this.#e.next(),n=!0);break;case"complete":this.shouldLoop&&this.trigger(this.#i)}while(n);return n}computeRaw(e=!0){if(this.#r===void 0)return[void 0,0,this.#e.state];e&&this.switchState();const r=this.#e.state,n=this.#r.elapsed;let i=0;const a=this.#e.state;switch(a){case"attack":i=n/this.attackDuration;break;case"decay":i=(n-this.attackDuration)/this.decayDuration;break;case"sustain":i=1;break;case"release":i=Math.min(n/this.releaseDuration,1);break;case"complete":return[void 0,1,r];default:throw new Error(`State machine in unknown state: ${a}`)}return[a,i,r]}get isDone(){return this.#e.isDone}onTrigger(){}trigger(e=!1){this.onTrigger(),this.#e.reset(),this.#r=this.#t(),this.#n=e,this.#i=e}compute(){}release(){this.isDone||!this.#i||(this.#n=!1,this.compute())}},Ry=class extends Py{attackPath;decayPath;releasePath;initialLevel;peakLevel;releaseLevel;sustainLevel;attackBend;decayBend;releaseBend;initialLevelOverride;retrigger;releasedAt;constructor(e){super(e);this.initialLevel=e.initialLevel??0,this.peakLevel=e.peakLevel??1,this.releaseLevel=e.releaseLevel??0,this.sustainLevel=e.sustainLevel??.75,this.retrigger=e.retrigger??!0,this.attackBend=e.attackBend??0,this.releaseBend=e.releaseBend??0,this.decayBend=e.decayBend??0;const r=1;this.attackPath=mi(an({x:0,y:this.initialLevel},{x:r,y:this.peakLevel},-this.attackBend)),this.decayPath=mi(an({x:0,y:this.peakLevel},{x:r,y:this.sustainLevel},-this.decayBend)),this.releasePath=mi(an({x:0,y:this.sustainLevel},{x:r,y:this.releaseLevel},-this.releaseBend))}onTrigger(){if(this.initialLevelOverride=void 0,!this.retrigger){const[e,r,n]=this.compute();!Number.isNaN(r)&&r>0&&(this.initialLevelOverride=r)}}get value(){return this.compute(!0)[1]}compute(e=!0){const[r,n]=super.computeRaw(e);if(r===void 0)return[void 0,NaN,NaN];let i;switch(r){case"attack":i=this.attackPath.interpolate(n).y,this.initialLevelOverride!==void 0&&(i=Qt(i,0,1,this.initialLevelOverride,1)),this.releasedAt=i;break;case"decay":i=this.decayPath.interpolate(n).y,this.releasedAt=i;break;case"sustain":i=this.sustainLevel,this.releasedAt=i;break;case"release":i=this.releasePath.interpolate(n).y,this.releasedAt!==void 0&&(i=Qt(i,0,this.sustainLevel,0,this.releasedAt));break;case"complete":i=this.releaseLevel,this.releasedAt=void 0;break;default:throw new Error(`Unknown state: ${r}`)}return[r,i,n]}},xu=e=>new Ry(e);async function*Yc(e){const r=xu(e.env),n=e.sampleRateMs??100;r.trigger(),yield*Jc(()=>r.isDone?void 0:r.value,{sampleRateMs:n,signal:e.signal})}var Hu={};Z(Hu,{accelerationForce:()=>dm,angleFromAccelerationForce:()=>ml,angleFromVelocityForce:()=>gl,angularForce:()=>yl,apply:()=>hm,attractionForce:()=>lm,computeAccelerationToTarget:()=>pl,computeAttractionForce:()=>vl,computePositionFromAngle:()=>wl,computePositionFromVelocity:()=>Zu,computeVelocity:()=>Xu,constrainBounce:()=>cm,guard:()=>sm,magnitudeForce:()=>vm,nullForce:()=>ym,orientationForce:()=>Dm,pendulumForce:()=>pm,springForce:()=>gm,targetForce:()=>fm,velocityForce:()=>mm});var ye={};Z(ye,{area:()=>im,cardinal:()=>Mi,center:()=>hl,corners:()=>Yu,distanceFromCenter:()=>Yy,distanceFromExterior:()=>Gy,edges:()=>dl,empty:()=>Ty,emptyPositioned:()=>cl,fromCenter:()=>Jy,fromElement:()=>jy,fromNumbers:()=>Vy,fromTopLeft:()=>Zy,getEdgeX:()=>su,getEdgeY:()=>cu,guard:()=>nr,intersectsPoint:()=>$n,isEmpty:()=>qy,isEqual:()=>ll,isEqualSize:()=>Uy,isIntersecting:()=>am,isPlaceholder:()=>Ln,isPositioned:()=>gt,isRect:()=>Cr,isRectPositioned:()=>Si,lengths:()=>rm,maxFromCorners:()=>Xy,multiply:()=>em,multiplyScalar:()=>tm,normaliseByRect:()=>Qy,perimeter:()=>nm,placeholder:()=>Gu,placeholderPositioned:()=>ou,random:()=>um,randomPoint:()=>om,subtract:()=>Hy,sum:()=>Ky,toArray:()=>xy});var At={};Z(At,{area:()=>Ny,bbox:()=>rl,center:()=>By,circumference:()=>tl,distanceCenter:()=>Ku,distanceFromExterior:()=>Oy,interpolate:()=>Qc,intersectionLine:()=>$y,intersections:()=>al,isCircle:()=>Qn,isCirclePositioned:()=>Yi,isContainedBy:()=>nl,isEqual:()=>ul,isIntersecting:()=>il,isNaN:()=>zy,isPositioned:()=>nt,length:()=>el,multiplyScalar:()=>ky,nearest:()=>sl,point:()=>Zc,randomPoint:()=>Wy,toPath:()=>Ly,toPositioned:()=>Ju,toSvg:()=>ol});var Xc=(e,r)=>{const n=e.x-Math.max(r.x,Math.min(e.x,r.x+r.width)),i=e.y-Math.max(r.y,Math.min(e.y,r.y+r.height));return n*n+i*i<e.radius*e.radius},ps=(e,r)=>al(e,r).length===2,Fi=Math.PI*2,nt=e=>e.x!==void 0&&e.y!==void 0,Qn=e=>e.radius!==void 0,Yi=e=>Qn(e)&&nt(e),Zc=(e,r,n)=>(n===void 0&&(nt(e)?n=e:n={x:0,y:0}),{x:Math.cos(-r)*e.radius+n.x,y:Math.sin(-r)*e.radius+n.y}),Xi=(e,r="circle")=>{if(nt(e)&&pe(e,"circle"),Number.isNaN(e.radius))throw new Error(`${r}.radius is NaN`);if(e.radius<=0)throw new Error(`${r}.radius must be greater than zero`)},uu=(e,r="circle")=>{if(!nt(e))throw new Error("Expected a positioned circle with x,y");return Xi(e,r)},By=e=>nt(e)?Object.freeze({x:e.x,y:e.y}):Object.freeze({x:e.radius,y:e.radius}),Qc=(e,r)=>Zc(e,r*Fi),el=e=>tl(e),tl=e=>(Xi(e),Fi*e.radius),Ny=e=>(Xi(e),Math.PI*e.radius*e.radius),rl=e=>nt(e)?ye.fromCenter(e,e.radius*2,e.radius*2):{width:e.radius*2,height:e.radius*2},nl=(e,r,n)=>{const i=Ku(e,r);if(Qn(r))return i<Math.abs(e.radius-r.radius);if(O.isPoint(r))return n!==void 0?i<Math.abs(e.radius-n):i<=e.radius;throw new Error("b parameter is expected to be CirclePositioned or Point")},zy=e=>!!(Number.isNaN(e.radius)||nt(e)&&(Number.isNaN(e.x)||Number.isNaN(e.y))),il=(e,r,n)=>O.isEqual(e,r)||nl(e,r,n)?!0:Qn(r)?ps(e,r):ye.isRectPositioned(r)?Xc(e,r):O.isPoint(r)&&n!==void 0?ps(e,{...r,radius:n}):!1,al=(e,r)=>{const n=O.subtract(r,e),i=Math.sqrt(n.y*n.y+n.x*n.x);if(i>e.radius+r.radius)return[];if(i<Math.abs(e.radius-r.radius))return[];if(ul(e,r))return[];const a=(e.radius*e.radius-r.radius*r.radius+i*i)/(2*i),u={x:e.x+n.x*a/i,y:e.y+n.y*a/i},o=Math.sqrt(e.radius*e.radius-a*a),s={x:-n.y*(o/i),y:n.x*(o/i)};return[O.sum(u,s),O.subtract(u,s)]},ul=(e,r)=>e.radius!==r.radius?!1:nt(e)&&nt(r)?!(e.x!==r.x||e.y!==r.y||e.z!==r.z):(!nt(e)&&!nt(r),!1),Wy=(e,r={})=>{const n=nt(e)?e:{x:0,y:0},i=r.strategy??"uniform",a=r.randomSource??et;switch(i){case"naive":return O.sum(n,Ve.toCartesian(a()*e.radius,a()*Fi));case"uniform":return O.sum(n,Ve.toCartesian(Math.sqrt(a())*e.radius,a()*Fi));default:throw new Error(`Unknown strategy ${i}`)}};function ky(e,r){if(nt(e)){const n=O.multiplyScalar(e,r);return Object.freeze({...e,...n,radius:e.radius*r})}else return Object.freeze({...e,radius:e.radius*r})}var Ku=(e,r)=>(uu(e,"a"),Yi(r)&&uu(r,"b"),O.distance(e,r)),Oy=(e,r)=>{if(uu(e,"a"),Yi(r))return Math.max(0,Ku(e,r)-e.radius-r.radius);if(O.isPoint(r)){const n=O.distance(e,r);return n<e.radius?0:n}else throw new Error("Second parameter invalid type")},ol=(e,r,n)=>{if(Qn(e)){if(n!==void 0)return Ta(e.radius,n,r);if(nt(e))return Ta(e.radius,e,r);throw new Error("origin parameter needed for non-positioned circle")}else{if(n!==void 0)return Ta(e,n,r);throw new Error("origin parameter needed")}},Ta=(e,r,n)=>{const{x:i,y:a}=r,u=n?"1":"0";return`
    M ${i}, ${a}
    m -${e}, 0
    a ${e},${e} 0 1,${u} ${e*2},0
    a ${e},${e} 0 1,${u} -${e*2},0
  `.split(`
`)},sl=(e,r)=>{const n=i=>{const a=Math.sqrt(Math.pow(r.x-i.x,2)+Math.pow(r.y-i.y,2)),u=i.x+i.radius*((r.x-i.x)/a),o=i.y+i.radius*((r.y-i.y)/a);return{x:u,y:o}};if(Array.isArray(e)){const i=e.map(u=>n(u)),a=i.map(u=>O.distance(u,r));return Object.freeze(i[Vt.minIndex(...a)])}else return Object.freeze(n(e))},Ju=(e,r,n)=>{if(nt(e))return e;const i=O.getPointParam(r,n);return Object.freeze({...e,...i})},Ly=e=>(Xi(e),Object.freeze({...e,nearest:r=>sl(e,r),interpolate:r=>Qc(e,r),bbox:()=>rl(e),length:()=>el(e),toSvgString:(r=!0)=>ol(e,r),kind:"circular"})),$y=(e,r)=>{const n={x:r.b.x-r.a.x,y:r.b.y-r.a.y},i={x:r.a.x-e.x,y:r.a.y-e.y},a=(n.x*i.x+n.y*i.y)*-2,u=2*(n.x*n.x+n.y*n.y),o=Math.sqrt(a*a-2*u*(i.x*i.x+i.y*i.y-e.radius*e.radius));if(Number.isNaN(o))return[];const s=(a-o)/u,c=(a+o)/u,l=[];return s<=1&&s>=0&&l.push({x:r.a.x+n.x*s,y:r.a.y+n.y*s}),c<=1&&c>=0&&l.push({x:r.a.x+n.x*c,y:r.a.y+n.y*c}),l},Ty=Object.freeze({width:0,height:0}),cl=Object.freeze({x:0,y:0,width:0,height:0}),Gu=Object.freeze({width:Number.NaN,height:Number.NaN}),ou=Object.freeze({x:Number.NaN,y:Number.NaN,width:Number.NaN,height:Number.NaN}),qy=e=>e.width===0&&e.height===0,Ln=e=>Number.isNaN(e.width)&&Number.isNaN(e.height),gt=e=>e.x!==void 0&&e.y!==void 0,Cr=e=>!(e===void 0||e.width===void 0||e.height===void 0),Si=e=>Cr(e)&&gt(e),jy=e=>({width:e.clientWidth,height:e.clientHeight}),Uy=(e,r)=>{if(e===void 0)throw new Error("a undefined");if(r===void 0)throw new Error("b undefined");return e.width===r.width&&e.height===r.height};function Vy(e,r,n,i){if(n===void 0||i===void 0){if(typeof e!="number")throw new Error("width is not an number");if(typeof r!="number")throw new Error("height is not an number");return Object.freeze({width:e,height:r})}if(typeof e!="number")throw new Error("x is not an number");if(typeof r!="number")throw new Error("y is not an number");if(typeof n!="number")throw new Error("width is not an number");if(typeof i!="number")throw new Error("height is not an number");return Object.freeze({x:e,y:r,width:n,height:i})}function xy(e){if(gt(e))return[e.x,e.y,e.width,e.height];if(Cr(e))return[e.width,e.height];throw new Error(`rect param is not a rectangle. Got: ${JSON.stringify(e)}`)}var ll=(e,r)=>gt(e)&&gt(r)?O.isEqual(e,r)?e.width===r.width&&e.height===r.height:!1:!gt(e)&&!gt(r)?e.width===r.width&&e.height===r.height:!1;function Hy(e,r,n){if(e===void 0)throw new Error("First parameter undefined");if(typeof r=="number"){const i=n===void 0?0:n;return Object.freeze({...e,width:e.width-r,height:e.height-i})}else return Object.freeze({...e,width:e.width-r.width,height:e.height-r.height})}function Ky(e,r,n){if(e===void 0)throw new Error("First parameter undefined");if(typeof r=="number"){const i=n===void 0?0:n;return Object.freeze({...e,width:e.width+r,height:e.height+i})}else return Object.freeze({...e,width:e.width+r.width,height:e.height+r.height})}function $n(e,r,n){nr(e,"rect");let i=0,a=0;if(typeof r=="number"){if(n===void 0)throw new Error("x and y coordinate needed");i=r,a=n}else i=r.x,a=r.y;if(gt(e)){if(i-e.x>e.width||i<e.x||a-e.y>e.height||a<e.y)return!1}else if(i>e.width||i<0||a>e.height||a<0)return!1;return!0}var Jy=(e,r,n)=>{O.guard(e,"origin"),hn(r,"width"),hn(n,"height");const i=r/2,a=n/2;return{x:e.x-i,y:e.y-a,width:r,height:n}},Gy=(e,r)=>{if(fl(e,"rect"),O.guard(r,"pt"),$n(e,r))return 0;const n=Math.max(e.x-r.x,0,r.x-e.x+e.width),i=Math.max(e.y-r.y,0,r.y-e.y+e.height);return Math.sqrt(n*n+i*i)},Yy=(e,r)=>O.distance(hl(e),r),Xy=(e,r,n,i)=>{if(e.y>n.y)throw new Error("topLeft.y greater than bottomRight.y");if(e.y>i.y)throw new Error("topLeft.y greater than bottomLeft.y");const a=r.x-e.x,u=n.x-i.x,o=Math.abs(i.y-e.y),s=Math.abs(n.y-r.y);return{x:Math.min(e.x,i.x),y:Math.min(r.y,e.y),width:Math.max(a,u),height:Math.max(o,s)}},hn=(e,r="Dimension")=>{if(e===void 0)throw Error(`${r} is undefined`);if(isNaN(e))throw Error(`${r} is NaN`);if(e<0)throw Error(`${r} cannot be negative`)},nr=(e,r="rect")=>{if(e===void 0)throw Error("{$name} undefined");gt(e)&&O.guard(e,r),hn(e.width,r+".width"),hn(e.height,r+".height")},fl=(e,r="rect")=>{if(!gt(e))throw new Error(`Expected ${r} to have x,y`);nr(e,r)},Zy=(e,r,n)=>(hn(r,"width"),hn(n,"height"),O.guard(e,"origin"),{x:e.x,y:e.y,width:r,height:n}),Yu=(e,r)=>{if(nr(e),r===void 0&&O.isPoint(e))r=e;else if(r===void 0)throw new Error("Unpositioned rect needs origin param");return[{x:r.x,y:r.y},{x:r.x+e.width,y:r.y},{x:r.x+e.width,y:r.y+e.height},{x:r.x,y:r.y+e.height}]},Mi=(e,r)=>{const{x:n,y:i,width:a,height:u}=e;switch(r){case"nw":return Object.freeze({x:n,y:i});case"n":return Object.freeze({x:n+a/2,y:i});case"ne":return Object.freeze({x:n+a,y:i});case"sw":return Object.freeze({x:n,y:i+u});case"s":return Object.freeze({x:n+a/2,y:i+u});case"se":return Object.freeze({x:n+a,y:i+u});case"w":return Object.freeze({x:n,y:i+u/2});case"e":return Object.freeze({x:n+a,y:i+u/2});case"center":return Object.freeze({x:n+a/2,y:i+u/2});default:throw new Error(`Unknown direction: ${r}`)}},su=(e,r)=>{switch(nr(e),r){case"top":return O.isPoint(e)?e.x:0;case"bottom":return O.isPoint(e)?e.x:0;case"left":return O.isPoint(e)?e.y:0;case"right":return O.isPoint(e)?e.x+e.width:e.width}},cu=(e,r)=>{switch(nr(e),r){case"top":return O.isPoint(e)?e.y:0;case"bottom":return O.isPoint(e)?e.y+e.height:e.height;case"left":return O.isPoint(e)?e.y:0;case"right":return O.isPoint(e)?e.y:0}},Qy=(e,r,n)=>{let i;if(n===void 0)if(Cr(r))n=r.height,i=r.width;else throw new Error("Expects rectangle or width and height parameters for normaliseBy");else if(typeof r=="number")i=r;else throw new Error("Expects rectangle or width and height parameters for normaliseBy");return gt(e)?Object.freeze({x:e.x/i,y:e.y/n,width:e.width/i,height:e.height/n}):Object.freeze({width:e.width/i,height:e.height/n})};function em(e,r,n){if(nr(e,"a"),Cr(r))return Si(e)?Object.freeze({...e,x:e.x*r.width,y:e.y*r.height,width:e.width*r.width,height:e.height*r.height}):Object.freeze({...e,width:e.width*r.width,height:e.height*r.height});if(typeof r!="number")throw new Error(`Expected second parameter of type Rect or number. Got ${JSON.stringify(r)}`);return n===void 0&&(n=r),Si(e)?Object.freeze({...e,x:e.x*r,y:e.y*n,width:e.width*r,height:e.height*n}):Object.freeze({...e,width:e.width*r,height:e.height*n})}function tm(e,r){return gt(e)?Object.freeze({...e,x:e.x*r,y:e.y*r,width:e.width*r,height:e.height*r}):Object.freeze({...e,width:e.width*r,height:e.height*r})}var hl=(e,r)=>(nr(e),r===void 0&&O.isPoint(e)?r=e:r===void 0&&(r={x:0,y:0}),Object.freeze({x:r.x+e.width/2,y:r.y+e.height/2})),rm=e=>(fl(e,"rect"),dl(e).map(r=>Ke.length(r))),dl=(e,r)=>{const n=Yu(e,r);return Ke.joinPointsToLines(...n,n[0])},nm=e=>(nr(e),e.height+e.height+e.width+e.width),im=e=>(nr(e),e.height*e.width),am=(e,r)=>{if(!Si(e))throw new Error("a parameter should be RectPositioned");if(Yi(r))return Xc(r,e);if(O.isPoint(r))return $n(e,r);throw new Error(`Unknown shape for b: ${JSON.stringify(r)}`)},um=e=>(e===void 0&&(e=et),Object.freeze({x:e(),y:e(),width:e(),height:e()})),om=(e,r={})=>{const n=r.randomSource??et,i=r.margin??{x:0,y:0},a=n()*(e.width-i.x-i.x),u=n()*(e.height-i.y-i.y),o={x:a+i.x,y:u+i.y};return gt(e)?O.sum(o,e):Object.freeze(o)},sm=(e,r="t")=>{if(e===void 0)throw new Error(`Parameter ${r} is undefined. Expected ForceAffected`);if(e===null)throw new Error(`Parameter ${r} is null. Expected ForceAffected`);if(typeof e!="object")throw new Error(`Parameter ${r} is type ${typeof e}. Expected object of shape ForceAffected`)},cm=(e={width:1,height:1},r=1)=>{const n=su(e,"left"),i=su(e,"right"),a=cu(e,"top"),u=cu(e,"bottom");return o=>{const s=Zu(o.position??O.Empty,o.velocity??O.Empty);let c=o.velocity??O.Empty,{x:l,y:f}=s;return l>i?(l=i,c=O.invert(O.multiply(c,r),"x")):l<n&&(l=n,c=O.invert(O.multiply(c,r),"x")),f>u?(f=u,c=O.multiply(O.invert(c,"y"),r)):s.y<a&&(f=a,c=O.invert(O.multiply(c,r),"y")),Object.freeze({...o,position:{x:l,y:f},velocity:c})}},lm=(e,r,n={})=>i=>{let a=i.acceleration??O.Empty;return e.forEach(u=>{if(u===i)return;const o=vl(u,i,r,n);a=O.sum(a,o)}),{...i,acceleration:a}},vl=(e,r,n,i={})=>{if(e.position===void 0)throw new Error("attractor.position not set");if(r.position===void 0)throw new Error("attractee.position not set");const a=i.min??.01,u=i.max??.7,o=O.normalise(O.subtract(e.position,r.position)),s=Rt(O.distance(o),a,u);return O.multiply(o,n*(e.mass??1)*(r.mass??1)/(s*s))},fm=(e,r={})=>i=>{const a=pl(e,i.position??{x:.5,y:.5},r);return{...i,acceleration:O.sum(i.acceleration??O.Empty,a)}},hm=(e,...r)=>{if(e===void 0)throw new Error("t parameter is undefined");r.forEach(u=>{u!=null&&(typeof u=="function"?e=u(e):e={...e,acceleration:O.sum(e.acceleration??O.Empty,u)})});const n=Xu(e.acceleration??O.Empty,e.velocity??O.Empty),i=Zu(e.position??O.Empty,n);return{...e,position:i,velocity:n,acceleration:O.Empty}},dm=(e,r="ignored")=>n=>Object.freeze({...n,acceleration:Zi(e,n,r)}),Zi=(e,r,n="ignored")=>{let i;if(n==="dampen")i=a=>O.divide(e,a,a);else if(n==="multiply")i=a=>O.multiply(e,a,a);else if(n==="ignored")i=a=>e;else throw new Error(`Unknown 'mass' parameter '${n}. Expected 'dampen', 'multiply' or 'ignored'`);return O.sum(r.acceleration??O.Empty,i(r.mass??1))},vm=(e,r="ignored")=>n=>{if(n.velocity===void 0)return n;const i=O.distance(O.normalise(n.velocity)),a=e*i*i,u=O.multiply(O.invert(n.velocity),a);return Object.freeze({...n,acceleration:Zi(u,n,r)})},ym=e=>e,mm=(e,r)=>{const n=O.pipeline(O.invert,i=>O.multiply(i,e));return i=>{if(i.velocity===void 0)return i;const a=n(i.velocity);return Object.freeze({...i,acceleration:Zi(a,i,r)})}},yl=()=>e=>{const r=e.angularAcceleration??0,n=e.angularVelocity??0,i=e.angle??0,a=n+r,u=i+a;return Object.freeze({...e,angle:u,angularVelocity:a,angularAcceleration:0})},ml=(e=20)=>r=>{const n=r.acceleration??O.Empty;return Object.freeze({...r,angularAcceleration:n.x*e})},gl=(e=1)=>r=>{const n=O.angle(r.velocity??O.Empty);return Object.freeze({...r,angle:e<1?$h(e,r.angle??0,n):n})},gm=(e,r=.5,n=2e-4,i=.999)=>a=>{const u=O.subtract(a.position??O.Empty,e),o=O.distance(u),s=Math.abs(r-o),c=O.pipelineApply(u,O.normalise,y=>O.multiply(y,-n*s)),l=Zi(c,a,"dampen"),f=Xu(l??O.Empty,a.velocity??O.Empty),h=O.multiply(f,i,i);return{...a,velocity:h,acceleration:O.Empty}},pm=(e={x:.5,y:0},r={})=>n=>{const i=r.length??O.distance(e,n.position??O.Empty),a=r.speed??.001,u=r.damping??.995;let o=n.angle;o===void 0&&(n.position?o=O.angle(e,n.position)-Math.PI/2:o=0);const s=-1*a/i*Math.sin(o),c=(n.angularVelocity??0)+s;return o+=c,Object.freeze({angularVelocity:c*u,angle:o,position:wl(i,o+Math.PI/2,e)})},Xu=(e,r,n)=>{const i=O.sum(r,e);return n!==void 0?O.clampMagnitude(i,n):i},pl=(e,r,n={})=>{const i=n.diminishBy??.001,a=O.subtract(e,r);return n.range&&O.compare(O.abs(a),n.range)===-2?O.Empty:O.multiply(a,i)},Zu=(e,r)=>O.sum(e,r),wl=(e,r,n)=>Ve.toCartesian(e,r,n),wm=yl(),Em=ml(),Dm=(e=.5)=>{const r=gl(e);return n=>(n=wm(n),n=Em(n),n=r(n),n)},Qu={};Z(Qu,{saw:()=>Mm,sine:()=>Cm,sineBipolar:()=>Fm,spring:()=>Am,square:()=>Im,triangle:()=>Sm});var El=Math.PI*2,bm=(e={},r=0,n=1)=>{const i=e.mass??1,a=e.stiffness??100,u=e.soft??!1,o=e.damping??10,s=e.velocity??.1,c=n-r;if(u===!0||1<=o/(2*Math.sqrt(a*i))){const l=-Math.sqrt(a/i),f=-l*c-s;return h=>n-(c+h*f)*Math.E**(h*l)}else{const l=Math.sqrt(4*i*a-o**2),f=(o*c-2*i*s)/l,h=.5*l/i,y=-(.5*o)/i;return D=>n-(Math.cos(D*h)*c+Math.sin(D*h)*f)*Math.E**(D*y)}};function*Am(e={},r){r===void 0?r=rr():typeof r=="number"&&(r=pr(r));const n=bm(e,0,1);let i=e.countdown??10;for(;i>0;){const a=n(r.elapsed/1e3);yield a,a===1?i--:i=100}}function*Cm(e){for(typeof e=="number"&&(e=pr(e));;)yield(Math.sin(e.elapsed*El)+1)/2}function*Fm(e){for(typeof e=="number"&&(e=pr(e));;)yield Math.sin(e.elapsed*El)}function*Sm(e){for(typeof e=="number"&&(e=pr(e));;){let r=e.elapsed;r<.5?r*=2:r=2-r*2,yield r}}function*Mm(e){for(typeof e=="number"&&(e=pr(e));;)yield e.elapsed}function*Im(e){for(typeof e=="number"&&(e=pr(e));;)yield e.elapsed<.5?0:1}var Dl=(e={})=>{const r=e.clamped??!0;let n=a=>0;if(typeof e.absolute<"u"){Y(e.absolute,r?"percentage":"bipolar","opts.absolute");const a=hs({min:-e.absolute,max:e.absolute,source:e.source});n=u=>u+a()}else if(typeof e.relative<"u")Y(e.relative,r?"percentage":"bipolar","opts.relative"),n=a=>a+S0({min:-e.relative*a,max:e.relative*a,source:e.source});else throw new Error("Either absolute or relative jitter amount is required.");return a=>{Y(a,r?"percentage":"bipolar","value");let u=n(a);return r&&(u=Rt(u)),u}},bl=function(e=.1,r,n,i,a){return r===void 0&&(r=0),n===void 0&&(n=1),i===void 0&&(i=r),Y(e,"bipolar","interval"),Y(n,"bipolar","end"),Y(i,"bipolar","offset"),Y(r,"bipolar","start"),eo(e,r,n,i,a)},eo=function*(e,r,n,i,a){if(r===void 0)throw new Error("Parameter 'lower' is undefined");if(e===void 0)throw new Error("Parameter 'interval' is undefined");if(n===void 0)throw new Error("Parameter 'upper' is undefined");if(a===void 0&&e<=1&&e>=0?a=10/e:a===void 0&&(a=1234),Number.isNaN(e))throw new Error("interval parameter is NaN");if(Number.isNaN(r))throw new Error("lower parameter is NaN");if(Number.isNaN(n))throw new Error("upper parameter is NaN");if(Number.isNaN(i))throw new Error("upper parameter is NaN");if(r>=n)throw new Error("lower must be less than upper");if(e===0)throw new Error("Interval cannot be zero");const u=n-r;if(Math.abs(e)>=u)throw new Error(`Interval should be between -${u} and ${u}`);let o=e>0;if(n=Math.floor(n*a),r=Math.floor(r*a),e=Math.floor(Math.abs(e*a)),e===0)throw new Error(`Interval is zero (rounding: ${a})`);if(i===void 0?i=r:i=Math.floor(i*a),i>n||i<r)throw new Error(`Start (${i/a}) must be within lower (${r/a}) and upper (${n/a})`);let s=i;yield s/a;let c=!0;for(;;)s=s+(o?e:-e),o&&s>=n?(o=!1,s=n,s===n&&c&&(s=r,o=!0)):!o&&s<=r&&(o=!0,s=r,s===r&&c&&(s=n,o=!1)),yield s/a,c=!1};try{typeof window<"u"&&(window.ixfx={...window.ixfx,Modulation:{Forces:Hu,jitter:Dl,Envelopes:Uc,Oscillators:Qu,Easings:$u}})}catch{}var _m=(...e)=>jo(e),Pm=(e,...r)=>qo(r,e),Rm=(...e)=>Vh(e),Bm=(...e)=>Hh(e),Nm=(...e)=>Kh(e),Al=e=>!(typeof e!="number"||Number.isNaN(e)),zm=e=>Wn(e);function*Wm(e){for(const r of e)Al(r)&&(yield r)}var lu=(e,r,n=!0)=>{Y(e,"","v"),Ee(r,"","every");let i=e/r;const a=i%1;return i=Math.floor(i),(a===.5&&n||a>.5)&&i++,r*i};function*Cl(e,r,n,i){Y(e,"","start"),Y(r,"","end"),Y(n,"","steps");const a=i?to(i):o=>o,u=(r-e)/(n-1);if(Y(u,"","step"),!Number.isFinite(u))throw new Error("Calculated step value is infinite");for(let o=0;o<n;o++){const s=e+u*o;yield a(s)}}var km=(e,r=0)=>(Y(e,"","v"),to(r)(e)),to=(e=0)=>{if(Ee(e,"positive","decimalPlaces"),e===0)return Math.round;const r=Math.pow(10,e);return n=>Math.floor(n*r)/r},Om={};Z(Om,{AudioAnalysers:()=>Ml,AudioVisualisers:()=>Il,Bluetooth:()=>Fl,Camera:()=>Wl,Codec:()=>ro,Espruino:()=>Pl,FrameProcessor:()=>Zm,Serial:()=>Rl,StringReceiveBuffer:()=>no,StringWriteBuffer:()=>io,VideoFile:()=>Ol});var Fl={};Z(Fl,{NordicBleDevice:()=>Sl,defaultOpts:()=>Qi});var ro=class{enc=new TextEncoder;dec=new TextDecoder("utf-8");toBuffer(e){return this.enc.encode(e)}fromBuffer(e){return this.dec.decode(e)}},no=class{constructor(e,r=`
`){this.onData=e,this.separator=r}buffer="";stream;async close(){const e=this.stream;!e||(await e.abort(),await e.close())}clear(){this.buffer=""}writable(){return this.stream===void 0&&(this.stream=this.createWritable()),this.stream}createWritable(){const e=this;return new WritableStream({write(r){e.add(r)},close(){e.clear()}})}addImpl(e){const r=e.indexOf(this.separator);if(r<0)return this.buffer+=e,"";const n=e.substring(0,r);try{this.onData(this.buffer+n),e=e.substring(n.length+this.separator.length)}catch(i){console.warn(i)}return this.buffer="",e}add(e){for(;e.length>0;)e=this.addImpl(e)}},io=class{constructor(e,r=-1){this.onData=e,this.chunkSize=r,this.intervalMs=10,this.writer=Nu(()=>this.onWrite(),this.intervalMs)}paused=!1;queue=xr();writer;intervalMs;stream;async close(){const e=this.stream?.getWriter();e?.releaseLock(),await e?.close()}clear(){this.queue=xr()}writable(){return this.stream===void 0&&(this.stream=this.createWritable()),this.stream}createWritable(){const e=this;return new WritableStream({write(r){e.add(r)},close(){e.clear()}})}async onWrite(){if(this.queue.isEmpty)return!1;if(this.paused)return console.warn("WriteBuffer.onWrite: paused..."),!0;const e=this.queue.dequeue();return e===void 0?!1:(await this.onData(e),!0)}add(e){this.chunkSize>0?this.queue.enqueue(...R0(e,this.chunkSize)):this.queue.enqueue(e),this.writer.start()}},Lm=class extends tr{constructor(e,r){super();this.device=e,this.config=r,this.verboseLogging=r.debug,this.txBuffer=new io(async n=>{await this.writeInternal(n)},r.chunkSize),this.rxBuffer=new no(n=>{this.fireEvent("data",{data:n})}),this.codec=new ro,this.states=new Jr("ready",{ready:"connecting",connecting:["connected","closed"],connected:["closed"],closed:"connecting"}),this.states.addEventListener("change",n=>{this.fireEvent("change",n),this.verbose(`${n.priorState} -> ${n.newState}`),n.priorState==="connected"&&(this.rxBuffer.clear(),this.txBuffer.clear())}),e.addEventListener("gattserverdisconnected",()=>{this.isClosed||(this.verbose("GATT server disconnected"),this.states.state="closed")}),this.verbose(`ctor ${e.name} ${e.id}`)}states;codec;rx;tx;gatt;verboseLogging=!1;rxBuffer;txBuffer;get isConnected(){return this.states.state==="connected"}get isClosed(){return this.states.state==="closed"}write(e){if(this.states.state!=="connected")throw new Error(`Cannot write while state is ${this.states.state}`);this.txBuffer.add(e)}async writeInternal(e){this.verbose(`writeInternal ${e}`);const r=this.tx;if(r===void 0)throw new Error("Unexpectedly without tx characteristic");try{await r.writeValue(this.codec.toBuffer(e))}catch(n){this.warn(n)}}disconnect(){this.states.state==="connected"&&this.gatt?.disconnect()}async connect(){const e=this.config.connectAttempts??3;this.states.state="connecting",this.verbose("connect");const r=this.device.gatt;if(r===void 0)throw new Error("Gatt not available on device");await ns(async()=>{const n=await r.connect();this.verbose("Getting primary service");const i=await n.getPrimaryService(this.config.service);this.verbose("Getting characteristics");const a=await i.getCharacteristic(this.config.rxGattCharacteristic),u=await i.getCharacteristic(this.config.txGattCharacteristic);return a.addEventListener("characteristicvaluechanged",o=>this.onRx(o)),this.rx=a,this.tx=u,this.gatt=r,this.states.state="connected",await a.startNotifications(),!0},{count:e,startMs:200})}onRx(e){if(this.rx===void 0)return;const n=e.target.value;if(n===void 0)return;let i=this.codec.fromBuffer(n.buffer);const a=Hn(i,19),u=Hn(i,17);u&&a<u&&(this.verbose("Tx plz start"),i=Kn(i,u,1),this.txBuffer.paused=!1),a&&a>u&&(this.verbose("Tx plz stop"),i=Kn(i,a,1),this.txBuffer.paused=!0),this.rxBuffer.add(i)}verbose(e){this.verboseLogging&&console.info(`${this.config.name} `,e)}log(e){console.log(`${this.config.name} `,e)}warn(e){console.warn(`${this.config.name} `,e)}},Qi={chunkSize:20,service:"6e400001-b5a3-f393-e0a9-e50e24dcca9e",txGattCharacteristic:"6e400002-b5a3-f393-e0a9-e50e24dcca9e",rxGattCharacteristic:"6e400003-b5a3-f393-e0a9-e50e24dcca9e",name:"NordicDevice",connectAttempts:5,debug:!1},Sl=class extends Lm{constructor(e,r={}){super(e,{...Qi,...r})}},Ml={};Z(Ml,{AudioAnalyser:()=>ea,basic:()=>$m,freq:()=>Tm,peakLevel:()=>qm});var Il={};Z(Il,{default:()=>_l});var _l=class{freqMaxRange=200;audio;parent;lastPointer={x:0,y:0};pointerDown=!1;pointerClicking=!1;pointerClickDelayMs=100;pointerDelaying=!1;waveTracker;freqTracker;el;constructor(e,r){this.audio=r,this.parent=e,this.waveTracker=Wn(),this.freqTracker=Wn(),e.innerHTML=`
    <section>
      <button id="rendererComponentToggle">\u{1F53C}</button>
      <div>
        <h1>Visualiser</h1>
        <div style="display:flex; flex-wrap: wrap">
          <div class="visPanel">
            <h2>Frequency distribution</h2>
            <br />
            <canvas id="rendererComponentFreqData" height="200" width="400"></canvas>
          </div>
          <div class="visPanel">
            <h2>Waveform</h2>
            <button id="rendererComponentWaveReset">Reset</button>
            <div>
              Press and hold on wave to measure
            </div>
            <br />
            <canvas id="rendererComponentWaveData" height="200" width="400"></canvas>
          </div>
        </div>
      </div>
    </section>
    `,this.el=e.children[0],document.getElementById("rendererComponentToggle")?.addEventListener("click",()=>{this.setExpanded(!this.isExpanded())}),this.el.addEventListener("pointermove",n=>this.onPointer(n)),this.el.addEventListener("pointerup",()=>{this.pointerDelaying=!1,this.pointerDown=!1}),this.el.addEventListener("pointerdown",()=>{this.pointerDelaying=!0,setTimeout(()=>{this.pointerDelaying&&(this.pointerDelaying=!1,this.pointerDown=!0)},this.pointerClickDelayMs)}),this.el.addEventListener("pointerleave",()=>{this.pointerDelaying=!1,this.pointerDown=!1}),document.getElementById("rendererComponentWaveReset")?.addEventListener("click",()=>{this.clear()})}renderFreq(e){if(!this.isExpanded()||!e)return;const r=document.getElementById("rendererComponentFreqData");if(r===null)throw new Error("Cannot find canvas element");const n=r.getContext("2d");if(n===null)throw new Error("Cannot create drawing context");const i=e.length,a=r.clientWidth,u=r.clientHeight;n.clearRect(0,0,a,u);const o=this.getPointerRelativeTo(r),s=a/i,c=Vt.minMaxAvg(e);for(let l=0;l<i;l++){if(!Number.isFinite(e[l]))continue;const h=(e[l]-c.min)/this.freqMaxRange,y=Math.abs(u*h),D=u-y,P=l/i*360,q=l*s;if(n.fillStyle="hsl("+P+", 100%, 50%)",o.y>0&&o.y<=u&&o.x>=q&&o.x<=q+s){this.freqTracker.id!==l.toString()&&(this.freqTracker=Wn({id:l.toString()})),this.freqTracker.seen(e[l]);const N=this.freqTracker.getMinMaxAvg();n.fillStyle="black",this.audio&&n.fillText(`Frequency (${l}) at pointer: ${this.audio.getFrequencyAtIndex(l).toLocaleString("en")} - ${this.audio.getFrequencyAtIndex(l+1).toLocaleString("en")}`,2,10),n.fillText(`Raw value: ${e[l].toFixed(2)}`,2,20),n.fillText(`Min: ${N.min.toFixed(2)}`,2,40),n.fillText(`Max: ${N.max.toFixed(2)}`,60,40),n.fillText(`Avg: ${N.avg.toFixed(2)}`,120,40)}n.fillRect(q,D,s,y)}}isExpanded(){const e=this.el.querySelector("div");if(e===null)throw new Error("contents div not found");return e.style.display===""}setExpanded(e){const r=this.el.querySelector("div"),n=this.el.querySelector("button");if(n===null)throw new Error("Button element not found");if(r===null)throw new Error("Contents element not found");e?(r.style.display="",n.innerText="\u{1F53C}"):(r.style.display="none",n.innerText="\u{1F53D}")}clear(){this.clearCanvas(document.getElementById("rendererComponentFreqData")),this.clearCanvas(document.getElementById("rendererComponentWaveData"))}clearCanvas(e){if(e===null)throw new Error("Canvas is null");const r=e.getContext("2d");if(r===null)throw new Error("Cannot create drawing context");r.fillStyle="white",r.fillRect(0,0,e.clientWidth,e.clientHeight)}renderWave(e,r=!0){if(!this.isExpanded()||!e)return;const n=document.getElementById("rendererComponentWaveData");if(n===null)throw new Error("Cannot find wave canvas");const i=n.getContext("2d");if(i===null)throw new Error("Cannot create drawing context for wave");const a=n.clientWidth,u=n.clientHeight,o=this.getPointerRelativeTo(n),s=20,c=60,l=e.length;i.fillStyle="white",i.fillRect(0,0,c,s);const f=a/l;i.fillStyle="rgba(255, 255, 255, 0.03)",i.fillRect(0,20,a,u),i.fillStyle="red",r?i.fillRect(0,u/2,a,1):i.fillRect(0,u-1,a,1),i.lineWidth=1,i.strokeStyle="black",i.beginPath();let h=0;for(let y=0;y<l;y++){const D=e[y]*u,P=r?u/2-D:u-D;y===0?i.moveTo(h,P):i.lineTo(h,P),h+=f,this.pointerDown&&this.waveTracker.seen(e[y])}if(i.lineTo(a,r?u/2:u),i.stroke(),this.pointerDown){const y=this.waveTracker.getMinMaxAvg();i.fillStyle="rgba(255,255,0,1)",i.fillRect(c,0,150,20),i.fillStyle="black",i.fillText("Min: "+y.min.toFixed(2),60,10),i.fillText("Max: "+y.max.toFixed(2),110,10),i.fillText("Avg: "+y.avg.toFixed(2),160,10)}else this.waveTracker.reset();o.y>0&&o.y<=u&&o.x>=0&&o.x<=a&&(i.fillStyle="black",i.fillText("Level: "+(1-o.y/u).toFixed(2),2,10))}getPointerRelativeTo(e){const r=e.getBoundingClientRect();return{x:this.lastPointer.x-r.left-window.scrollX,y:this.lastPointer.y-r.top-window.scrollY}}onPointer(e){this.lastPointer={x:e.pageX,y:e.pageY},e.preventDefault()}},$m=(e,r={})=>new ea((n,i)=>{const a=new Float32Array(n.frequencyBinCount),u=new Float32Array(n.fftSize);n.getFloatFrequencyData(a),n.getFloatTimeDomainData(u),e(a,u,i)},r),Tm=(e,r={})=>new ea((n,i)=>{const a=new Float32Array(n.frequencyBinCount);n.getFloatFrequencyData(a),e(a,i)},r),qm=(e,r={})=>new ea((n,i)=>{const a=new Float32Array(n.fftSize);n.getFloatTimeDomainData(a),e(Vt.maxFast(a),i)},r),ea=class{showVis;fftSize;smoothingTimeConstant;#e=!1;debug;#t=!1;visualiser;audioCtx;analyserNode;analyse;constructor(e,r={}){if(this.showVis=r.showVis??!1,this.fftSize=r.fftSize??1024,this.debug=r.debug??!1,this.smoothingTimeConstant=r.smoothingTimeConstant??.8,Ee(this.fftSize,"positive","opts.fftSize"),Y(this.smoothingTimeConstant,"percentage","opts.smoothingTimeConstant"),!y0(this.fftSize))throw new Error(`fftSize must be a power of two from 32 to 32768 (${this.fftSize})`);if(this.fftSize<32)throw new Error("fftSize must be at least 32");if(this.fftSize>32768)throw new Error("fftSize must be no greater than 32768");this.analyse=e,this.paused=!1,this.init();const n=document.getElementById("audio-visualiser");if(n){const i=new _l(n,this);i.setExpanded(this.showVis),this.visualiser=i}}init(){if(this.#t){this.debug&&console.debug("Init already in progress");return}this.#t=!0,navigator.mediaDevices.getUserMedia({audio:!0}).then(e=>{this.onMicSuccess(e)}).catch(e=>{this.#t=!1,console.error(e)})}get paused(){return this.#e}set paused(e){e!==this.#e&&(this.#e=e,e?this.debug&&console.log("Paused"):(this.debug&&console.log("Unpaused"),window.requestAnimationFrame(this.analyseLoop.bind(this))))}setup(e,r){const n=e.createAnalyser();return n.fftSize=this.fftSize,n.smoothingTimeConstant=this.smoothingTimeConstant,e.createMediaStreamSource(r).connect(n),n}onMicSuccess(e){try{const r=new AudioContext;r.addEventListener("statechange",()=>{this.debug&&console.log(`Audio context state: ${r.state}`)}),this.audioCtx=r,this.analyserNode=this.setup(r,e),window.requestAnimationFrame(this.analyseLoop.bind(this))}catch(r){this.#t=!1,console.error(r)}}analyseLoop(){if(this.paused){this.debug&&console.log("Paused");return}const e=this.analyserNode;if(e===void 0){console.warn("Analyser undefined");return}try{this.analyse(e,this)}catch(r){console.error(r)}window.requestAnimationFrame(this.analyseLoop.bind(this))}getFrequencyRangeMax(e,r,n){const i=this.sliceByFrequency(e,r,n);return Vt.max(i)}sliceByFrequency(e,r,n){const i=this.getIndexForFrequency(e),a=this.getIndexForFrequency(r);return n.slice(i,a)}getFrequencyAtIndex(e){const r=this.analyserNode,n=this.audioCtx;if(r===void 0)throw new Error("Analyser not available");if(n===void 0)throw new Error("Audio context not available");if(Ee(e,"positive","index"),e>r.frequencyBinCount)throw new Error(`Index ${e} exceeds frequency bin count ${r.frequencyBinCount}`);return e*n.sampleRate/(r.frequencyBinCount*2)}getIndexForFrequency(e){const r=this.analyserNode;if(r===void 0)throw new Error("Analyser not available");const n=r.context.sampleRate/2,i=Math.round(e/n*r.frequencyBinCount);return i<0?0:i>=r.frequencyBinCount?r.frequencyBinCount-1:i}},Pl={};Z(Pl,{EspruinoBleDevice:()=>ao,EspruinoSerialDevice:()=>Nl,connectBle:()=>xm,deviceEval:()=>uo,puck:()=>Um,serial:()=>Vm});var ao=class extends Sl{evalTimeoutMs;evalReplyBluetooth=!0;constructor(e,r={}){super(e,r);this.evalTimeoutMs=r.evalTimeoutMs??5*1e3}async writeScript(e){this.write(`reset();
`),this.write(`${e}
`)}async eval(e,r={},n){const i=r.debug??!1;return uo(e,r,this,"Bluetooth.println",i,n??(u=>this.warn(u)))}},Rl={};Z(Rl,{Device:()=>Bl});var jm=class extends tr{states;codec;verboseLogging=!1;name;connectAttempts;chunkSize;rxBuffer;txBuffer;constructor(e={}){super();this.verboseLogging=e.debug??!1,this.chunkSize=e.chunkSize??1024,this.connectAttempts=e.connectAttempts??3,this.name=e.name??"JsonDevice",this.txBuffer=new io(async r=>{await this.writeInternal(r)},e.chunkSize),this.rxBuffer=new no(r=>{this.fireEvent("data",{data:r})}),this.codec=new ro,this.states=new Jr("ready",{ready:"connecting",connecting:["connected","closed"],connected:["closed"],closed:"connecting"}),this.states.addEventListener("change",r=>{this.fireEvent("change",r),this.verbose(`${r.priorState} -> ${r.newState}`),r.priorState==="connected"&&(this.rxBuffer.clear(),this.txBuffer.clear())})}get isConnected(){return this.states.state==="connected"}get isClosed(){return this.states.state==="closed"}write(e){if(this.states.state!=="connected")throw new Error(`Cannot write while state is ${this.states.state}`);this.txBuffer.add(e)}async close(){this.states.state==="connected"&&this.onClosed()}async connect(){const e=this.connectAttempts;this.states.state="connecting",await this.onPreConnect(),await ns(async()=>(await this.onConnectAttempt(),this.states.state="connected",!0),{count:e,startMs:200})}onRx(e){const r=e.target.value;if(r===void 0)return;let n=this.codec.fromBuffer(r.buffer);const i=Hn(n,19),a=Hn(n,17);a&&i<a&&(this.verbose("Tx plz start"),n=Kn(n,a,1),this.txBuffer.paused=!1),i&&i>a&&(this.verbose("Tx plz stop"),n=Kn(n,i,1),this.txBuffer.paused=!0),this.rxBuffer.add(n)}verbose(e){this.verboseLogging&&console.info(`${this.name} `,e)}log(e){console.log(`${this.name} `,e)}warn(e){console.warn(`${this.name} `,e)}},Bl=class extends jm{constructor(e={}){super(e);this.config=e,this.abort=new AbortController;const r=e.eol??`\r
`;this.baudRate=e.baudRate??9600,e.name===void 0&&(super.name="Serial.Device"),this.rxBuffer.separator=r}port;tx;abort;baudRate;async writeInternal(e){if(this.tx===void 0)throw new Error("tx not ready");try{this.tx.write(e)}catch(r){this.warn(r)}}onClosed(){this.tx?.releaseLock(),this.abort.abort("closing port"),this.states.state="closed"}onPreConnect(){return Promise.resolve()}async onConnectAttempt(){let e={};const r={baudRate:this.baudRate};this.config.filters&&(e={filters:[...this.config.filters]}),this.port=await navigator.serial.requestPort(e),this.port.addEventListener("disconnect",o=>{this.close()}),await this.port.open(r);const n=this.port.writable,i=new TextEncoderStream;n!==null&&(i.readable.pipeTo(n,{signal:this.abort.signal}).catch(o=>{console.log("Serial.onConnectAttempt txText pipe:"),console.log(o)}),this.tx=i.writable.getWriter());const a=this.port.readable,u=new TextDecoderStream;a!==null&&(a.pipeTo(u.writable,{signal:this.abort.signal}).catch(o=>{console.log("Serial.onConnectAttempt rxR pipe:"),console.log(o)}),u.readable.pipeTo(this.rxBuffer.writable(),{signal:this.abort.signal}).catch(o=>{console.log("Serial.onConnectAttempt rxText pipe:"),console.log(o);try{this.port?.close()}catch(s){console.log(s)}}))}},Nl=class extends Bl{evalTimeoutMs;evalReplyBluetooth=!1;constructor(e){super(e);e===void 0&&(e={}),this.evalTimeoutMs=e.evalTimeoutMs??5*1e3}async disconnect(){return super.close()}async writeScript(e){this.write(`reset();
`),this.write(`${e}
`)}async eval(e,r={},n){const i=r.debug??!1;return uo(e,r,this,"USB.println",i,n??(u=>this.warn(u)))}},Um=async(e={})=>{const r=e.name??"Puck",n=e.debug??!1,i=await navigator.bluetooth.requestDevice({filters:zl(e),optionalServices:[Qi.service]});console.log(i.name);const a=new ao(i,{name:r,debug:n});return await a.connect(),a},Vm=async(e={})=>{const r=new Nl(e);return await r.connect(),r},zl=e=>{const r=[];return e.filters?r.push(...e.filters):e.name?(r.push({name:e.name}),console.info(`Filtering Bluetooth devices by name '${e.name}'`)):r.push({namePrefix:"Puck.js"}),r},xm=async(e={})=>{const r=await navigator.bluetooth.requestDevice({filters:zl(e),optionalServices:[Qi.service]}),n=new ao(r,{name:"Espruino"});return await n.connect(),n},uo=async(e,r={},n,i,a,u)=>{const o=r.timeoutMs??n.evalTimeoutMs,s=r.assumeExclusive??!0;if(typeof e!="string")throw new Error("code parameter should be a string");return new Promise((c,l)=>{const f=ds(5),h=q=>{try{let N=q.data;N.startsWith(">{")&&N.endsWith("}")&&(N=N.substring(1));const b=JSON.parse(N);"reply"in b?b.reply===f?(D(),"result"in b&&c(b.result)):u(`Expected reply ${f}, got ${b.reply}`):u(`Expected packet, missing 'reply' field. Got: ${q.data}`)}catch(N){s?D(q.data):u(N)}},y=q=>{q.newState!=="connected"&&D(`State changed to '${q.newState}', aborting`)};n.addEventListener("data",h),n.addEventListener("change",y);const D=zu(o,q=>{l(q)},()=>{n.removeEventListener("data",h),n.removeEventListener("change",y)}),P=`${i}(JSON.stringify({reply:"${f}", result:JSON.stringify(${e})}))
`;a&&u(P),n.write(P)})},Wl={};Z(Wl,{dumpDevices:()=>Km,start:()=>kl});var Hm=1e4,Km=async(e="videoinput")=>{(await navigator.mediaDevices.enumerateDevices()).forEach(n=>{n.kind===e&&(console.log(n.label),console.log(` Kind: ${n.kind}`),console.log(` Device id: ${n.deviceId}`))})},kl=async(e={})=>{const r=document.createElement("VIDEO");r.style.display="none",r.playsInline=!0,r.muted=!0,r.classList.add("ixfx-camera"),document.body.appendChild(r);let n=()=>{};const i=()=>{try{n()}catch{}r.remove()};try{return n=(await Jm(r,e)).dispose,{videoEl:r,dispose:i}}catch(a){throw console.error(a),i(),a}},Jm=async(e,r={})=>{if(e===void 0)throw new Error("videoEl undefined");if(e===null)throw new Error("videoEl null");const n=r.max,i=r.min,a=r.ideal,u={audio:!1,video:{width:{},height:{}}};r.facingMode==="front"&&(r={...r,facingMode:"user"}),r.facingMode==="back"&&(r={...r,facingMode:"environment"}),r.facingMode&&(u.video.facingMode=r.facingMode),r.deviceId&&(u.video.deviceId=r.deviceId),a&&(u.video.width={...u.video.width,ideal:a.width},u.video.height={...u.video.height,ideal:a.height}),n&&(u.video.width={...u.video.width,max:n.width},u.video.height={...u.video.height,max:n.height}),i&&(u.video.width={...u.video.width,min:i.width},u.video.height={...u.video.height,min:i.height});const o=zu(r.startTimeoutMs??Hm,s=>{throw new Error(`Camera getUserMedia failed: ${s}`)});try{const s=await navigator.mediaDevices.getUserMedia(u),c=()=>{e.pause(),s.getTracks().forEach(y=>y.stop())};e.srcObject=s,o();const l={videoEl:e,dispose:c};return new Promise((h,y)=>{e.addEventListener("loadedmetadata",()=>{e.play().then(()=>{h(l)}).catch(D=>{y(D)})})})}catch(s){throw o(s.toString()),s}},Ol={};Z(Ol,{start:()=>Ll});var Ll=async e=>{const r=document.createElement("VIDEO");r.style.display="none",r.playsInline=!0,r.muted=!0,r.classList.add("ixfx-video"),document.body.appendChild(r);let n=()=>{};const i=()=>{try{n()}catch{}r.remove()};try{return n=(await Gm(r,e)).dispose,{videoEl:r,dispose:i}}catch(a){throw console.error(a),i(),a}},Gm=async(e,r)=>{if(e===void 0)throw new Error("videoEl undefined");if(e===null)throw new Error("videoEl null");const n=URL.createObjectURL(r);e.src=n,e.loop=!0;const a={videoEl:e,dispose:()=>{e.pause()}};return new Promise((o,s)=>{e.addEventListener("loadedmetadata",()=>{e.play().then(()=>{o(a)}).catch(c=>{s(c)})})})},oo={};Z(oo,{capture:()=>Xm,frames:()=>Ym,manualCapture:()=>$l});async function*Ym(e,r={}){const n=r.maxIntervalMs??0,i=r.showCanvas??!1;let a=r.canvasEl,u,o;u=o=0,a===void 0&&(a=document.createElement("CANVAS"),a.classList.add("ixfx-frames"),i||(a.style.display="none"),document.body.appendChild(a));const s=()=>{a!==void 0&&(u=e.videoWidth,o=e.videoHeight,a.width=u,a.height=o)};let c=null;const l=Wu(n);for await(const f of l){if((u===0||o===0)&&s(),u===0||o===0)continue;if(c===null&&(c=a.getContext("2d")),c===null)return;c.drawImage(e,0,0,u,o),yield c.getImageData(0,0,u,o)}}var Xm=(e,r={})=>{const n=r.maxIntervalMs??0,i=r.showCanvas??!1,a=r.onFrame,u=e.videoWidth,o=e.videoHeight,s=document.createElement("CANVAS");s.classList.add("ixfx-capture"),i||(s.style.display="none"),s.width=u,s.height=o;let c=null,l;r.workerScript&&(l=new Worker(r.workerScript));const f=l||a;!f&&!i&&console.warn("Video will be captured to hidden element without any processing. Is this what you want?");const h=Nu(()=>{if(c===null&&(c=s.getContext("2d")),c===null)return;c.drawImage(e,0,0,u,o);let y;if(f&&(y=c.getImageData(0,0,u,o)),l&&l.postMessage({pixels:y.data.buffer,width:u,height:o,channels:4},[y.data.buffer]),a)try{a(y)}catch(D){console.error(D)}},n);return{start:()=>h.start(),cancel:()=>h.cancel(),canvasEl:s}},$l=(e,r={})=>{const n=r.showCanvas??!1,i=e.videoWidth,a=e.videoHeight,u=r.canvasEl!==void 0;let o=r.canvasEl;return o||(o=document.createElement("CANVAS"),o.classList.add("ixfx-capture"),document.body.append(o),n||(o.style.display="none")),o.width=i,o.height=a,{canvasEl:o,capture:()=>{let f;if(f||(f=o?.getContext("2d",{willReadFrequently:!0})),!f)throw new Error("Could not create graphics context");f.drawImage(e,0,0,i,a);const h=f.getImageData(0,0,i,a);return h.currentTime=e.currentTime,r.postCaptureDraw&&r.postCaptureDraw(f,i,a),h},dispose:()=>{if(!u)try{o?.remove()}catch{}}}},Zm=class{_source;_state;_teardownNeeded=!1;_cameraConstraints;_cameraStartResult;_videoSourceCapture;_videoFile;_videoStartResult;_showCanvas;_showPreview;_postCaptureDraw;_timer;_captureCanvasEl;constructor(e={}){this._state="ready",this._source="",this._timer=performance.now(),this._showCanvas=e.showCanvas??!1,this._showPreview=e.showPreview??!1,this._cameraConstraints=e.cameraConstraints??void 0,this._captureCanvasEl=e.captureCanvasEl??void 0,this._postCaptureDraw=e.postCaptureDraw}showPreview(e){if(this._state==="disposed")throw new Error("Disposed");let r;switch(this._source){case"camera":r=this._cameraStartResult?.videoEl,r!==void 0&&(r.style.display=e?"block":"none");break}this._showPreview=e}showCanvas(e){if(this._state==="disposed")throw new Error("Disposed");let r;if(this._source==="camera"||this._source==="video")r=this._videoSourceCapture?.canvasEl,r!==void 0&&(r.style.display=e?"block":"none");else throw new Error(`Source not implemented: ${this._source}`);this._showCanvas=e}getCapturer(){if(this._state==="disposed")throw new Error("Disposed");if(this._source==="camera"||this._source==="video")return this._videoSourceCapture;throw new Error(`Source kind not supported ${this._source}`)}async useCamera(e){if(this._state==="disposed")throw new Error("Disposed");this._source="camera",this._teardownNeeded&&this.teardown(),e&&this._cameraConstraints,await this.init()}async useVideo(e){if(this._state==="disposed")throw new Error("Disposed");this._source="video",this._teardownNeeded&&this.teardown(),this._videoFile=e,await this.init()}async initCamera(){const e=await kl(this._cameraConstraints);if(e===void 0)throw new Error("Could not start camera");this._cameraStartResult=e,this.postInit(e)}async initVideo(){if(!this._videoFile)throw new Error("Video file not defined");const e=await Ll(this._videoFile);this._videoStartResult=e,this.postInit(e)}async postInit(e){this._showPreview&&(e.videoEl.style.display="block"),this._videoSourceCapture=$l(e.videoEl,{postCaptureDraw:this._postCaptureDraw,showCanvas:this._showCanvas,canvasEl:this._captureCanvasEl}),this._teardownNeeded=!0,this._cameraStartResult=e}dispose(){this._state!=="disposed"&&(this.teardown(),this._state="disposed")}async init(){switch(this._timer=performance.now(),this._source){case"camera":await this.initCamera();break;case"video":await this.initVideo();break}this._state="initialised"}teardown(){if(!!this._teardownNeeded){switch((this._source==="camera"||this._source==="video")&&this._videoSourceCapture?.dispose(),this._source){case"camera":this._cameraStartResult?.dispose();break;case"video":this._videoStartResult?.dispose();break}this._teardownNeeded=!1}}getFrame(){if(this._state==="disposed")throw new Error("Disposed");switch(this._source){case"camera":return this.getFrameCamera();case"video":return this.getFrameCamera();default:throw new Error(`source type unhandled ${this._source}`)}}getTimestamp(){return performance.now()-this._timer}getFrameCamera(){return this._videoSourceCapture?.capture()}},Qm={};Z(Qm,{Async:()=>so,Sync:()=>Tl,count:()=>Ug,delayIterable:()=>pc,delayLoop:()=>Wu,interval:()=>uc,numericPercent:()=>Vg,numericRange:()=>Ul,numericRangeRaw:()=>jg,pingPong:()=>eo,pingPongPercent:()=>bl,randomUniqueInteger:()=>_0});var so={};Z(so,{chunks:()=>eg,concat:()=>tg,dropWhile:()=>rg,equals:()=>ng,every:()=>ig,fill:()=>ag,filter:()=>ug,find:()=>og,flatten:()=>sg,forEach:()=>cg,map:()=>lg,max:()=>fg,min:()=>hg,range:()=>dg,reduce:()=>vg,slice:()=>yg,some:()=>mg,takeWhile:()=>gg,toArray:()=>pg,unique:()=>wg,zip:()=>Eg});async function*eg(e,r){let n=[];for await(const i of e)n.push(i),n.length===r&&(yield n,n=[]);n.length>0&&(yield n)}async function*tg(...e){for await(const r of e)yield*r}async function*rg(e,r){for await(const n of e)if(!r(n)){yield n;break}yield*e}async function ng(e,r,n){const i=e[Symbol.iterator](),a=r[Symbol.iterator]();for(;;){const u=await i.next(),o=await a.next();if(n!==void 0){if(!n(u.value,o.value))return!1}else if(u.value!==o.value)return!1;if(u.done||o.done)return u.done&&o.done}}async function ig(e,r){let n=!0;for await(const i of e)n=n&&r(i);return n}async function*ag(e,r){for await(const n of e)yield r}async function*ug(e,r){for await(const n of e)!r(n)||(yield n)}async function og(e,r){for await(const n of e)if(r(n))return n}async function*sg(e){for await(const r of e)Symbol.asyncIterator in r?yield*r:yield r}async function cg(e,r){for await(const n of e)r(n)}async function*lg(e,r){for await(const n of e)yield r(n)}async function fg(e,r=(n,i)=>n>i){let n;for await(const i of e){if(!n){n=i;continue}n=r(n,i)?n:i}return n}async function hg(e,r=(n,i)=>n>i){let n;for await(const i of e){if(!n){n=i;continue}n=r(n,i)?i:n}return n}async function*dg(e,r){for(let n=0;n<r;n++)yield e++}async function vg(e,r,n){for await(const i of e)n=r(n,i);return n}async function*yg(e,r=0,n=Number.POSITIVE_INFINITY){const i=e[Symbol.asyncIterator]();for(;r>0;r--,n--)await i.next();for await(const a of e)if(n-- >0)yield a;else break}async function mg(e,r){for await(const n of e)if(r(n))return!0;return!1}async function*gg(e,r){for await(const n of e){if(!r(n))return;yield n}}async function pg(e,r=1/0){const n=[],i=e[Symbol.asyncIterator]();for(;n.length<r;){const{value:a,done:u}=await i.next();if(u)break;n.push(a)}return n}async function*wg(e,r=n=>n){const n=[];for await(const i of e){const a=r(i);n.indexOf(a)===-1&&(n.push(a),yield i)}}async function*Eg(...e){const r=e.map(n=>n[Symbol.asyncIterator]());for(;;){const n=await Promise.all(r.map(i=>i.next()));if(n.some(i=>i.done))return;yield n.map(i=>i.value)}}var Tl={};Z(Tl,{chunks:()=>Ag,chunksOverlapping:()=>bg,concat:()=>Cg,dropWhile:()=>Fg,equals:()=>Sg,every:()=>Mg,fill:()=>Ig,filter:()=>Pg,find:()=>Rg,first:()=>Dg,flatten:()=>Bg,forEach:()=>_g,last:()=>ql,map:()=>Ng,max:()=>zg,min:()=>Wg,range:()=>jl,reduce:()=>kg,slice:()=>Og,some:()=>Lg,takeWhile:()=>$g,unique:()=>Tg,zip:()=>qg});function Dg(e){for(const r of e)return r}function ql(e){let r;for(const n of e)r=n;return r}function*bg(e,r){if(r<=1)throw new Error("Size should be at least 2");let n=[];for(const i of e)n.push(i),n.length===r&&(yield n,n=[n.at(-1)]);n.length<=1||n.length>0&&(yield n)}function*Ag(e,r){let n=[];for(const i of e)n.push(i),n.length===r&&(yield n,n=[]);n.length>0&&(yield n)}function*Cg(...e){for(const r of e)yield*r}function*Fg(e,r){for(const n of e)if(!r(n)){yield n;break}yield*e}function Sg(e,r,n){for(;;){const i=e.next(),a=r.next();if(n!==void 0){if(!n(i.value,a.value))return!1}else if(i.value!==a.value)return!1;if(i.done||a.done)return i.done&&a.done}}function Mg(e,r){let n=!0;for(const i of e)n=n&&r(i);return n}function*Ig(e,r){for(const n of e)yield r}function _g(e,r){for(const n of e)r(n)}function*Pg(e,r){for(const n of e)!r(n)||(yield n)}function Rg(e,r){for(const n of e)if(r(n))return n}function*Bg(e){for(const r of e)Symbol.iterator in r?yield*r:yield r}function*Ng(e,r){for(const n of e)yield r(n)}function zg(e,r=(n,i)=>n>i){let n;for(const i of e){if(!n){n=i;continue}n=r(n,i)?n:i}return n}function Wg(e,r=(n,i)=>n>i){let n;for(const i of e){if(!n){n=i;continue}n=r(n,i)?i:n}return n}function*jl(e,r){for(let n=0;n<r;n++)yield e++}function kg(e,r,n){for(const i of e)n=r(n,i);return n}function*Og(e,r=0,n=Number.POSITIVE_INFINITY){const i=e[Symbol.iterator]();for(;r>0;r--,n--)i.next();for(const a of e)if(n-- >0)yield a;else break}function Lg(e,r){for(const n of e)if(r(n))return!0;return!1}function*$g(e,r){for(const n of e){if(!r(n))return;yield n}}function*Tg(e,r=n=>n){const n=[];for(const i of e){const a=r(i);n.indexOf(a)===-1&&(n.push(a),yield i)}}function*qg(...e){const r=e.map(n=>n[Symbol.iterator]());for(;;){const n=r.map(i=>i.next());if(n.some(i=>i.done))return;yield n.map(i=>i.value)}}var jg=function*(e,r=0,n,i=!1){if(e<=0)throw new Error("Interval is expected to be above zero");n===void 0&&(n=Number.MAX_SAFE_INTEGER);let a=r;do for(;a<n;)yield a,a+=e;while(i)},Ul=function*(e,r=0,n,i=!1,a){Y(e,"nonZero");const u=e<0;if(n!==void 0){if(u&&r<n)throw new Error(`Interval of ${e} will never go from ${r} to ${n}`);if(!u&&r>n)throw new Error(`Interval of ${e} will never go from ${r} to ${n}`)}a=a??1e3,n===void 0?n=Number.MAX_SAFE_INTEGER:n*=a,e=e*a;do{let o=r*a;for(;!u&&o<=n||u&&o>=n;)yield o/a,o+=e}while(i)},Ug=function*(e,r=0){if(Ee(e,"","amount"),Ee(r,"","offset"),e===0)return;let n=0;do e<0?yield-n+r:yield n+r;while(n++<Math.abs(e)-1)},Vg=function(e=.01,r=!1,n=0,i=1){return Y(e,"percentage","interval"),Y(n,"percentage","start"),Y(i,"percentage","end"),Ul(e,n,i,r)},xg={};Z(xg,{Colour:()=>ti,Drawing:()=>ta,ImageDataGrid:()=>ko,Palette:()=>Wo,Plot:()=>Ro,Plot2:()=>No,SceneGraph:()=>zo,Svg:()=>Io,Video:()=>oo});var ta={};Z(ta,{arc:()=>Wf,bezier:()=>Lf,circle:()=>kf,connectedPoints:()=>fa,copyToImg:()=>G1,dot:()=>qt,drawingStack:()=>en,ellipse:()=>K1,getCtx:()=>zf,line:()=>Mo,lineThroughPoints:()=>H1,makeHelper:()=>U1,paths:()=>Of,pointLabels:()=>ha,rect:()=>Tf,textBlock:()=>qf,textBlockAligned:()=>Z1,textWidth:()=>tn,translatePoint:()=>J1,triangle:()=>X1});var Tr={};Z(Tr,{Empty:()=>Sp,Equilateral:()=>Vl,Isosceles:()=>Hl,Placeholder:()=>Mp,Right:()=>xl,angles:()=>ei,anglesDegrees:()=>Np,apply:()=>Pp,area:()=>Xl,barycentricCoord:()=>Ql,barycentricToCartestian:()=>Hp,bbox:()=>Zl,centroid:()=>ua,corners:()=>fu,edges:()=>aa,equilateralFromVertex:()=>Up,fromFlatArray:()=>xp,fromPoints:()=>lo,fromRadius:()=>qp,guard:()=>zt,innerCircle:()=>$p,intersectsPoint:()=>Kp,isAcute:()=>Op,isEmpty:()=>Ip,isEqual:()=>Bp,isEquilateral:()=>zp,isIsosceles:()=>Wp,isOblique:()=>kp,isObtuse:()=>Lp,isPlaceholder:()=>_p,isRightAngle:()=>Gl,isTriangle:()=>Rp,lengths:()=>co,outerCircle:()=>Tp,perimeter:()=>Yl,rotate:()=>Jp,rotateByVertex:()=>jp,toFlatArray:()=>Vp});var Vl={};Z(Vl,{area:()=>Zg,centerFromA:()=>Kg,centerFromB:()=>Jg,centerFromC:()=>Gg,circumcircle:()=>Qg,fromCenter:()=>Hg,height:()=>Yg,incircle:()=>ra,perimeter:()=>Xg});var ws=Math.PI*4/3,Es=Math.PI*2/3,Ir=e=>typeof e=="number"?e:e.length,Hg=(e,r={x:0,y:0},n)=>{const i=Ir(e)/Math.sqrt(3),a=n??Math.PI*1.5,u={x:i*Math.cos(a)+r.x,y:i*Math.sin(a)+r.y},o={x:i*Math.cos(a+ws)+r.x,y:i*Math.sin(a+ws)+r.y},s={x:i*Math.cos(a+Es)+r.x,y:i*Math.sin(a+Es)+r.y};return Object.freeze({a:o,b:u,c:s})},Kg=(e,r={x:0,y:0})=>{const n=Ir(e),{radius:i}=ra(e);return{x:r.x+n/2,y:r.y-i}},Jg=(e,r={x:0,y:0})=>{const{radius:n}=ra(e);return{x:r.x,y:r.y+n*2}},Gg=(e,r={x:0,y:0})=>{const n=Ir(e),{radius:i}=ra(e);return{x:r.x-n/2,y:r.y-i}},Yg=e=>Math.sqrt(3)/2*Ir(e),Xg=e=>Ir(e)*3,Zg=e=>Math.pow(Ir(e),2)*Math.sqrt(3)/4,Qg=e=>({radius:Math.sqrt(3)/3*Ir(e)}),ra=e=>({radius:Math.sqrt(3)/6*Ir(e)}),xl={};Z(xl,{adjacentFromHypotenuse:()=>hp,adjacentFromOpposite:()=>dp,angleAtPointA:()=>ap,angleAtPointB:()=>up,area:()=>ip,circumcircle:()=>sp,fromA:()=>ep,fromB:()=>tp,fromC:()=>rp,height:()=>na,hypotenuseFromAdjacent:()=>yp,hypotenuseFromOpposite:()=>vp,hypotenuseSegments:()=>ia,incircle:()=>cp,medians:()=>op,oppositeFromAdjacent:()=>lp,oppositeFromHypotenuse:()=>fp,perimeter:()=>np,resolveLengths:()=>Nt});var ep=(e,r={x:0,y:0})=>{const n=Nt(e),i=ia(e),a=na(e),u={x:r.x,y:r.y},o={x:r.x+n.hypotenuse,y:r.y},s={x:r.x+i[1],y:r.y-a};return{a:u,b:o,c:s}},tp=(e,r={x:0,y:0})=>{const n=Nt(e),i=ia(e),a=na(e),u={x:r.x,y:r.y},o={x:r.x-n.hypotenuse,y:r.y},s={x:r.x-i[0],y:r.y-a};return{a:o,b:u,c:s}},rp=(e,r={x:0,y:0})=>{const n=ia(e),i=na(e),a={x:r.x,y:r.y},u={x:r.x-n[1],y:r.y+i},o={x:r.x+n[0],y:r.y+i};return{a:u,b:o,c:a}},Nt=e=>{const r=e.adjacent,n=e.opposite,i=e.hypotenuse;if(r!==void 0&&n!==void 0)return{...e,adjacent:r,opposite:n,hypotenuse:Math.sqrt(r*r+n*n)};if(r&&i)return{...e,adjacent:r,hypotenuse:i,opposite:i*i-r*r};if(n&&i)return{...e,hypotenuse:i,opposite:n,adjacent:i*i-n*n};if(e.opposite&&e.hypotenuse&&e.adjacent)return e;throw new Error("Missing at least two edges")},na=e=>{const r=Nt(e),n=r.opposite*r.opposite/r.hypotenuse,i=r.adjacent*r.adjacent/r.hypotenuse;return Math.sqrt(n*i)},ia=e=>{const r=Nt(e),n=r.opposite*r.opposite/r.hypotenuse,i=r.adjacent*r.adjacent/r.hypotenuse;return[n,i]},np=e=>{const r=Nt(e);return r.adjacent+r.hypotenuse+r.opposite},ip=e=>{const r=Nt(e);return r.opposite*r.adjacent/2},ap=e=>{const r=Nt(e);return Math.acos((r.adjacent*r.adjacent+r.hypotenuse*r.hypotenuse-r.opposite*r.opposite)/(2*r.adjacent*r.hypotenuse))},up=e=>{const r=Nt(e);return Math.acos((r.opposite*r.opposite+r.hypotenuse*r.hypotenuse-r.adjacent*r.adjacent)/(2*r.opposite*r.hypotenuse))},op=e=>{const r=Nt(e),n=r.adjacent*r.adjacent,i=r.hypotenuse*r.hypotenuse,a=r.opposite*r.opposite;return[Math.sqrt(2*(n+i)-a)/2,Math.sqrt(2*(i+a)-n)/2,Math.sqrt(2*(a+n)-i)/2]},sp=e=>({radius:Nt(e).hypotenuse/2}),cp=e=>{const r=Nt(e);return{radius:(r.adjacent+r.opposite-r.hypotenuse)/2}},lp=(e,r)=>Math.tan(e)*r,fp=(e,r)=>Math.sin(e)*r,hp=(e,r)=>Math.cos(e)*r,dp=(e,r)=>r/Math.tan(e),vp=(e,r)=>r/Math.sin(e),yp=(e,r)=>r/Math.cos(e),Hl={};Z(Hl,{apexAngle:()=>mp,area:()=>wp,baseAngle:()=>Kl,circumcircle:()=>Ep,fromA:()=>Ap,fromB:()=>Cp,fromC:()=>Fp,fromCenter:()=>bp,height:()=>_r,incircle:()=>Jl,legHeights:()=>gp,medians:()=>Dp,perimeter:()=>pp});var Kl=e=>Math.acos(e.base/(2*e.legs)),mp=e=>{const r=e.legs*e.legs,n=e.base*e.base;return Math.acos((2*r-n)/(2*r))},_r=e=>{const r=e.legs*e.legs,n=e.base*e.base;return Math.sqrt((4*r-n)/4)},gp=e=>{const r=Kl(e);return e.base*Math.sin(r)},pp=e=>2*e.legs+e.base,wp=e=>_r(e)*e.base/2,Ep=e=>{const r=_r(e),n=r*r,i=e.base*e.base;return{radius:(4*n+i)/(8*r)}},Jl=e=>{const r=_r(e);return{radius:e.base*r/(2*e.legs+e.base)}},Dp=e=>{const r=e.legs*e.legs,n=e.base*e.base,i=Math.sqrt(r+2*n)/2,a=Math.sqrt(4*r-n)/2;return[i,i,a]},bp=(e,r={x:0,y:0})=>{const n=_r(e),i=Jl(e).radius,a=n-i,u={x:r.x-e.base/2,y:r.y+i},o={x:r.x+e.base/2,y:r.y+i},s={x:r.x,y:r.y-a};return{a:u,b:o,c:s}},Ap=(e,r={x:0,y:0})=>{const n=_r(e),i={x:r.x,y:r.y},a={x:r.x+e.base,y:r.y},u={x:r.x+e.base/2,y:r.y-n};return{a:i,b:a,c:u}},Cp=(e,r={x:0,y:0})=>{const n=_r(e),i={x:r.x,y:r.y},a={x:r.x-e.base,y:r.y},u={x:r.x-e.base/2,y:r.y-n};return{a,b:i,c:u}},Fp=(e,r={x:0,y:0})=>{const n=_r(e),i={x:r.x,y:r.y},a={x:r.x-e.base/2,y:r.y+n},u={x:r.x+e.base/2,y:r.y+n};return{a,b:u,c:i}},Ds=Math.PI*2,Sp=Object.freeze({a:{x:0,y:0},b:{x:0,y:0},c:{x:0,y:0}}),Mp=Object.freeze({a:{x:NaN,y:NaN},b:{x:NaN,y:NaN},c:{x:NaN,y:NaN}}),Ip=e=>pi(e.a)&&pi(e.b)&&pi(e.c),_p=e=>wi(e.a)&&wi(e.b)&&wi(e.c),Pp=(e,r)=>Object.freeze({...e,a:r(e.a,"a"),b:r(e.b,"b"),c:r(e.c,"c")}),zt=(e,r="t")=>{if(e===void 0)throw Error("{$name} undefined");pe(e.a,r+".a"),pe(e.b,r+".b"),pe(e.c,r+".c")},Rp=e=>{if(e===void 0)return!1;const r=e;return!(!Fe(r.a)||!Fe(r.b)||!Fe(r.c))},Bp=(e,r)=>kn(e.a,r.a)&&kn(e.b,r.b)&&kn(e.c,r.c),fu=e=>(zt(e),[e.a,e.b,e.c]),aa=e=>(zt(e),Ke.joinPointsToLines(e.a,e.b,e.c,e.a)),co=e=>(zt(e),[Bt(e.a,e.b),Bt(e.b,e.c),Bt(e.c,e.a)]),ei=e=>(zt(e),[ln(e.a,e.b),ln(e.b,e.c),ln(e.c,e.a)]),Np=e=>(zt(e),Ca(ei(e))),zp=e=>{zt(e);const[r,n,i]=co(e);return r===n&&n===i},Wp=e=>{const[r,n,i]=co(e);return r===n||n===i||i===r},Gl=e=>ei(e).some(r=>r===Math.PI/2),kp=e=>!Gl(e),Op=e=>!ei(e).some(r=>r>=Math.PI/2),Lp=e=>ei(e).some(r=>r>Math.PI/2),ua=e=>{zt(e);const r=bd([e.a,e.b,e.c],(i,a)=>({x:i.x+a.x,y:i.y+a.y}));return{x:r.x/3,y:r.y/3}},Yl=e=>(zt(e),aa(e).reduce((r,n)=>r+Ke.length(n),0)),Xl=e=>{zt(e,"t");const r=aa(e).map(i=>Ke.length(i)),n=(r[0]+r[1]+r[2])/2;return Math.sqrt(n*(n-r[0])*(n-r[1])*(n-r[2]))},$p=e=>{const r=ua(e),n=Yl(e)/2;return{radius:Xl(e)/n,...r}},Tp=e=>{const[r,n,i]=aa(e).map(o=>Ke.length(o)),a=ua(e);return{radius:r*n*i/Math.sqrt((r+n+i)*(-r+n+i)*(r-n+i)*(r+n-i)),...a}},qp=(e,r,n={})=>{Y(r,"positive","radius"),pe(e,"origin");const i=n.initialAngleRadian??0,u=[i,i+Ds*1/3,i+Ds*2/3].map(o=>Ve.toCartesian(r,o,e));return lo(u)},jp=(e,r,n="b")=>{const i=n==="a"?e.a:n==="b"?e.b:e.c;return Object.freeze({a:Vr(e.a,r,i),b:Vr(e.b,r,i),c:Vr(e.c,r,i)})},Up=(e={x:0,y:0},r=10,n=Math.PI/2)=>{const i=Fu(e,r,Math.PI- -n/2),a=Fu(e,r,Math.PI-n/2);return{a:i,b:e,c:a}},Vp=e=>(zt(e),[e.a.x,e.a.y,e.b.x,e.b.y,e.c.x,e.c.y]),xp=e=>{if(!Array.isArray(e))throw new Error("coords expected as array");if(e.length!==6)throw new Error(`coords array expected with 6 elements. Got ${e.length}`);return lo(Ed(...e))},lo=e=>{if(!Array.isArray(e))throw new Error("points expected as array");if(e.length!==3)throw new Error(`points array expected with 3 elements. Got ${e.length}`);return{a:e[0],b:e[1],c:e[2]}},Zl=(e,r=0)=>{const{a:n,b:i,c:a}=e,u=Math.min(n.x,i.x,a.x)-r,o=Math.max(n.x,i.x,a.x)+r,s=Math.min(n.y,i.y,a.y)-r,c=Math.max(n.y,i.y,a.y)+r;return{x:u,y:s,width:o-u,height:c-s}},Ql=(e,r,n)=>{const i=ut(r,n),a=(c,l,f,h)=>(f.y-h.y)*c+(h.x-f.x)*l+f.x*h.y-h.x*f.y,u=a(i.x,i.y,e.b,e.c)/a(e.a.x,e.a.y,e.b,e.c),o=a(i.x,i.y,e.c,e.a)/a(e.b.x,e.b.y,e.c,e.a),s=a(i.x,i.y,e.a,e.b)/a(e.c.x,e.c.y,e.a,e.b);return{a:u,b:o,c:s}},Hp=(e,r)=>{zt(e);const{a:n,b:i,c:a}=e,u=n.x*r.a+i.x*r.b+a.x*r.c,o=n.y*r.a+i.y*r.b+a.y*r.c;if(n.z&&i.z&&a.z){const s=n.z*r.a+i.z*r.b+a.z*r.c;return Object.freeze({x:u,y:o,z:s})}else return Object.freeze({x:u,y:o})},Kp=(e,r,n)=>{const i=Zl(e),a=ut(r,n);if(!ye.intersectsPoint(i,a))return!1;const u=Ql(e,a);return 0<=u.a&&u.a<=1&&0<=u.b&&u.b<=1&&0<=u.c&&u.c<=1},Jp=(e,r,n)=>r===void 0||r===0?e:(n===void 0&&(n=ua(e)),Object.freeze({...e,a:Vr(e.a,r,n),b:Vr(e.b,r,n),c:Vr(e.c,r,n)})),fo={};Z(fo,{fromDegrees:()=>Gp});var Gp=(e,r,n=0,i=0,a=360)=>({radiusX:e,radiusY:r,rotation:Fr(n),startAngle:Fr(i),endAngle:Fr(a)}),ti={};Z(ti,{getCssVariable:()=>pf,goldenAngleColour:()=>mf,interpolate:()=>_w,opacity:()=>jn,randomHue:()=>po,scale:()=>Pw,toHex:()=>Iw,toHsl:()=>Mw,toRgb:()=>gf});function En(e,r,n){e.prototype=r.prototype=n,n.constructor=e}function ri(e,r){var n=Object.create(e.prototype);for(var i in r)n[i]=r[i];return n}function Pr(){}var Hr=.7,dn=1/Hr,un="\\s*([+-]?\\d+)\\s*",Tn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Yt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Yp=/^#([0-9a-f]{3,8})$/,Xp=new RegExp(`^rgb\\(${un},${un},${un}\\)$`),Zp=new RegExp(`^rgb\\(${Yt},${Yt},${Yt}\\)$`),Qp=new RegExp(`^rgba\\(${un},${un},${un},${Tn}\\)$`),ew=new RegExp(`^rgba\\(${Yt},${Yt},${Yt},${Tn}\\)$`),tw=new RegExp(`^hsl\\(${Tn},${Yt},${Yt}\\)$`),rw=new RegExp(`^hsla\\(${Tn},${Yt},${Yt},${Tn}\\)$`),bs={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};En(Pr,vn,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:As,formatHex:As,formatHex8:nw,formatHsl:iw,formatRgb:Cs,toString:Cs});function As(){return this.rgb().formatHex()}function nw(){return this.rgb().formatHex8()}function iw(){return ef(this).formatHsl()}function Cs(){return this.rgb().formatRgb()}function vn(e){var r,n;return e=(e+"").trim().toLowerCase(),(r=Yp.exec(e))?(n=r[1].length,r=parseInt(r[1],16),n===6?Fs(r):n===3?new Je(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):n===8?ci(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):n===4?ci(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=Xp.exec(e))?new Je(r[1],r[2],r[3],1):(r=Zp.exec(e))?new Je(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=Qp.exec(e))?ci(r[1],r[2],r[3],r[4]):(r=ew.exec(e))?ci(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=tw.exec(e))?Is(r[1],r[2]/100,r[3]/100,1):(r=rw.exec(e))?Is(r[1],r[2]/100,r[3]/100,r[4]):bs.hasOwnProperty(e)?Fs(bs[e]):e==="transparent"?new Je(NaN,NaN,NaN,0):null}function Fs(e){return new Je(e>>16&255,e>>8&255,e&255,1)}function ci(e,r,n,i){return i<=0&&(e=r=n=NaN),new Je(e,r,n,i)}function ho(e){return e instanceof Pr||(e=vn(e)),e?(e=e.rgb(),new Je(e.r,e.g,e.b,e.opacity)):new Je}function Ii(e,r,n,i){return arguments.length===1?ho(e):new Je(e,r,n,i??1)}function Je(e,r,n,i){this.r=+e,this.g=+r,this.b=+n,this.opacity=+i}En(Je,Ii,ri(Pr,{brighter(e){return e=e==null?dn:Math.pow(dn,e),new Je(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Hr:Math.pow(Hr,e),new Je(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Je(qr(this.r),qr(this.g),qr(this.b),_i(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ss,formatHex:Ss,formatHex8:aw,formatRgb:Ms,toString:Ms}));function Ss(){return`#${Lr(this.r)}${Lr(this.g)}${Lr(this.b)}`}function aw(){return`#${Lr(this.r)}${Lr(this.g)}${Lr(this.b)}${Lr((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ms(){const e=_i(this.opacity);return`${e===1?"rgb(":"rgba("}${qr(this.r)}, ${qr(this.g)}, ${qr(this.b)}${e===1?")":`, ${e})`}`}function _i(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function qr(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Lr(e){return e=qr(e),(e<16?"0":"")+e.toString(16)}function Is(e,r,n,i){return i<=0?e=r=n=NaN:n<=0||n>=1?e=r=NaN:r<=0&&(e=NaN),new Tt(e,r,n,i)}function ef(e){if(e instanceof Tt)return new Tt(e.h,e.s,e.l,e.opacity);if(e instanceof Pr||(e=vn(e)),!e)return new Tt;if(e instanceof Tt)return e;e=e.rgb();var r=e.r/255,n=e.g/255,i=e.b/255,a=Math.min(r,n,i),u=Math.max(r,n,i),o=NaN,s=u-a,c=(u+a)/2;return s?(r===u?o=(n-i)/s+(n<i)*6:n===u?o=(i-r)/s+2:o=(r-n)/s+4,s/=c<.5?u+a:2-u-a,o*=60):s=c>0&&c<1?0:o,new Tt(o,s,c,e.opacity)}function Pi(e,r,n,i){return arguments.length===1?ef(e):new Tt(e,r,n,i??1)}function Tt(e,r,n,i){this.h=+e,this.s=+r,this.l=+n,this.opacity=+i}En(Tt,Pi,ri(Pr,{brighter(e){return e=e==null?dn:Math.pow(dn,e),new Tt(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Hr:Math.pow(Hr,e),new Tt(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,r=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*r,a=2*n-i;return new Je(qa(e>=240?e-240:e+120,a,i),qa(e,a,i),qa(e<120?e+240:e-120,a,i),this.opacity)},clamp(){return new Tt(_s(this.h),li(this.s),li(this.l),_i(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=_i(this.opacity);return`${e===1?"hsl(":"hsla("}${_s(this.h)}, ${li(this.s)*100}%, ${li(this.l)*100}%${e===1?")":`, ${e})`}`}}));function _s(e){return e=(e||0)%360,e<0?e+360:e}function li(e){return Math.max(0,Math.min(1,e||0))}function qa(e,r,n){return(e<60?r+(n-r)*e/60:e<180?n:e<240?r+(n-r)*(240-e)/60:r)*255}var tf=Math.PI/180,rf=180/Math.PI,Ri=18,nf=.96422,af=1,uf=.82521,of=4/29,on=6/29,sf=3*on*on,uw=on*on*on;function cf(e){if(e instanceof Xt)return new Xt(e.l,e.a,e.b,e.opacity);if(e instanceof dr)return lf(e);e instanceof Je||(e=ho(e));var r=xa(e.r),n=xa(e.g),i=xa(e.b),a=ja((.2225045*r+.7168786*n+.0606169*i)/af),u,o;return r===n&&n===i?u=o=a:(u=ja((.4360747*r+.3850649*n+.1430804*i)/nf),o=ja((.0139322*r+.0971045*n+.7141733*i)/uf)),new Xt(116*a-16,500*(u-a),200*(a-o),e.opacity)}function hu(e,r,n,i){return arguments.length===1?cf(e):new Xt(e,r,n,i??1)}function Xt(e,r,n,i){this.l=+e,this.a=+r,this.b=+n,this.opacity=+i}En(Xt,hu,ri(Pr,{brighter(e){return new Xt(this.l+Ri*(e??1),this.a,this.b,this.opacity)},darker(e){return new Xt(this.l-Ri*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,r=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return r=nf*Ua(r),e=af*Ua(e),n=uf*Ua(n),new Je(Va(3.1338561*r-1.6168667*e-.4906146*n),Va(-.9787684*r+1.9161415*e+.033454*n),Va(.0719453*r-.2289914*e+1.4052427*n),this.opacity)}}));function ja(e){return e>uw?Math.pow(e,1/3):e/sf+of}function Ua(e){return e>on?e*e*e:sf*(e-of)}function Va(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function xa(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ow(e){if(e instanceof dr)return new dr(e.h,e.c,e.l,e.opacity);if(e instanceof Xt||(e=cf(e)),e.a===0&&e.b===0)return new dr(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var r=Math.atan2(e.b,e.a)*rf;return new dr(r<0?r+360:r,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function du(e,r,n,i){return arguments.length===1?ow(e):new dr(e,r,n,i??1)}function dr(e,r,n,i){this.h=+e,this.c=+r,this.l=+n,this.opacity=+i}function lf(e){if(isNaN(e.h))return new Xt(e.l,0,0,e.opacity);var r=e.h*tf;return new Xt(e.l,Math.cos(r)*e.c,Math.sin(r)*e.c,e.opacity)}En(dr,du,ri(Pr,{brighter(e){return new dr(this.h,this.c,this.l+Ri*(e??1),this.opacity)},darker(e){return new dr(this.h,this.c,this.l-Ri*(e??1),this.opacity)},rgb(){return lf(this).rgb()}}));var ff=-.14861,vo=1.78277,yo=-.29227,oa=-.90649,qn=1.97294,Ps=qn*oa,Rs=qn*vo,Bs=vo*yo-oa*ff;function sw(e){if(e instanceof jr)return new jr(e.h,e.s,e.l,e.opacity);e instanceof Je||(e=ho(e));var r=e.r/255,n=e.g/255,i=e.b/255,a=(Bs*i+Ps*r-Rs*n)/(Bs+Ps-Rs),u=i-a,o=(qn*(n-a)-yo*u)/oa,s=Math.sqrt(o*o+u*u)/(qn*a*(1-a)),c=s?Math.atan2(o,u)*rf-120:NaN;return new jr(c<0?c+360:c,s,a,e.opacity)}function vu(e,r,n,i){return arguments.length===1?sw(e):new jr(e,r,n,i??1)}function jr(e,r,n,i){this.h=+e,this.s=+r,this.l=+n,this.opacity=+i}En(jr,vu,ri(Pr,{brighter(e){return e=e==null?dn:Math.pow(dn,e),new jr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Hr:Math.pow(Hr,e),new jr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*tf,r=+this.l,n=isNaN(this.s)?0:this.s*r*(1-r),i=Math.cos(e),a=Math.sin(e);return new Je(255*(r+n*(ff*i+vo*a)),255*(r+n*(yo*i+oa*a)),255*(r+n*(qn*i)),this.opacity)}}));var sa=e=>()=>e;function hf(e,r){return function(n){return e+n*r}}function cw(e,r,n){return e=Math.pow(e,n),r=Math.pow(r,n)-e,n=1/n,function(i){return Math.pow(e+i*r,n)}}function mo(e,r){var n=r-e;return n?hf(e,n>180||n<-180?n-360*Math.round(n/360):n):sa(isNaN(e)?r:e)}function lw(e){return(e=+e)==1?Ge:function(r,n){return n-r?cw(r,n,e):sa(isNaN(r)?n:r)}}function Ge(e,r){var n=r-e;return n?hf(e,n):sa(isNaN(e)?r:e)}var Bi=function e(r){var n=lw(r);function i(a,u){var o=n((a=Ii(a)).r,(u=Ii(u)).r),s=n(a.g,u.g),c=n(a.b,u.b),l=Ge(a.opacity,u.opacity);return function(f){return a.r=o(f),a.g=s(f),a.b=c(f),a.opacity=l(f),a+""}}return i.gamma=e,i}(1);function fw(e,r){r||(r=[]);var n=e?Math.min(r.length,e.length):0,i=r.slice(),a;return function(u){for(a=0;a<n;++a)i[a]=e[a]*(1-u)+r[a]*u;return i}}function hw(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function dw(e,r){var n=r?r.length:0,i=e?Math.min(n,e.length):0,a=new Array(i),u=new Array(n),o;for(o=0;o<i;++o)a[o]=go(e[o],r[o]);for(;o<n;++o)u[o]=r[o];return function(s){for(o=0;o<i;++o)u[o]=a[o](s);return u}}function vw(e,r){var n=new Date;return e=+e,r=+r,function(i){return n.setTime(e*(1-i)+r*i),n}}function yu(e,r){return e=+e,r=+r,function(n){return e*(1-n)+r*n}}function yw(e,r){var n={},i={},a;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(a in r)a in e?n[a]=go(e[a],r[a]):i[a]=r[a];return function(u){for(a in n)i[a]=n[a](u);return i}}var mu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ha=new RegExp(mu.source,"g");function mw(e){return function(){return e}}function gw(e){return function(r){return e(r)+""}}function pw(e,r){var n=mu.lastIndex=Ha.lastIndex=0,i,a,u,o=-1,s=[],c=[];for(e=e+"",r=r+"";(i=mu.exec(e))&&(a=Ha.exec(r));)(u=a.index)>n&&(u=r.slice(n,u),s[o]?s[o]+=u:s[++o]=u),(i=i[0])===(a=a[0])?s[o]?s[o]+=a:s[++o]=a:(s[++o]=null,c.push({i:o,x:yu(i,a)})),n=Ha.lastIndex;return n<r.length&&(u=r.slice(n),s[o]?s[o]+=u:s[++o]=u),s.length<2?c[0]?gw(c[0].x):mw(r):(r=c.length,function(l){for(var f=0,h;f<r;++f)s[(h=c[f]).i]=h.x(l);return s.join("")})}function go(e,r){var n=typeof r,i;return r==null||n==="boolean"?sa(r):(n==="number"?yu:n==="string"?(i=vn(r))?(r=i,Bi):pw:r instanceof vn?Bi:r instanceof Date?vw:hw(r)?fw:Array.isArray(r)?dw:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?yw:yu)(e,r)}function df(e){return function(r,n){var i=e((r=Pi(r)).h,(n=Pi(n)).h),a=Ge(r.s,n.s),u=Ge(r.l,n.l),o=Ge(r.opacity,n.opacity);return function(s){return r.h=i(s),r.s=a(s),r.l=u(s),r.opacity=o(s),r+""}}}var ww=df(mo),Ew=df(Ge);function Dw(e,r){var n=Ge((e=hu(e)).l,(r=hu(r)).l),i=Ge(e.a,r.a),a=Ge(e.b,r.b),u=Ge(e.opacity,r.opacity);return function(o){return e.l=n(o),e.a=i(o),e.b=a(o),e.opacity=u(o),e+""}}function vf(e){return function(r,n){var i=e((r=du(r)).h,(n=du(n)).h),a=Ge(r.c,n.c),u=Ge(r.l,n.l),o=Ge(r.opacity,n.opacity);return function(s){return r.h=i(s),r.c=a(s),r.l=u(s),r.opacity=o(s),r+""}}}var bw=vf(mo),Aw=vf(Ge);function yf(e){return function r(n){n=+n;function i(a,u){var o=e((a=vu(a)).h,(u=vu(u)).h),s=Ge(a.s,u.s),c=Ge(a.l,u.l),l=Ge(a.opacity,u.opacity);return function(f){return a.h=o(f),a.s=s(f),a.l=c(Math.pow(f,n)),a.opacity=l(f),a+""}}return i.gamma=r,i}(1)}var Cw=yf(mo),Fw=yf(Ge);function Sw(e,r){r===void 0&&(r=e,e=go);for(var n=0,i=r.length-1,a=r[0],u=new Array(i<0?0:i);n<i;)u[n]=e(a,a=r[++n]);return function(o){var s=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return u[s](o-s)}}var Mw=e=>{const r=gf(e),n=Nw(r.r,r.b,r.g);return r.opacity?{...n,opacity:r.opacity}:n},mf=(e,r=.5,n=.75,i=1)=>{Y(e,"positive","index"),Y(r,"percentage","saturation"),Y(n,"percentage","lightness"),Y(i,"percentage","alpha");const a=e*137.508;return i===1?`hsl(${a},${r*100}%,${n*100}%)`:`hsl(${a},${r*100}%,${n*100}%,${i*100}%)`},po=(e=et)=>e()*360,gf=e=>{const r=wo(e),n=r.rgb();return r.opacity<1?{r:n.r,g:n.g,b:n.b,opacity:r.opacity}:{r:n.r,g:n.g,b:n.b}},wo=e=>{if(typeof e=="string"){const r=vn(e);if(r!==null)return r}else{if(Rw(e))return Pi(e.h,e.s,e.l);if(Bw(e))return Ii(e.r,e.g,e.b)}throw new Error(`Could not resolve colour ${JSON.stringify(e)}`)},Iw=e=>wo(e).formatHex(),jn=(e,r)=>{const n=wo(e);return n.opacity*=r,n.toString()},pf=(e,r="black",n)=>{n===void 0&&(n=document.body);const i=getComputedStyle(n).getPropertyValue(`--${e}`).trim();return i===void 0||i.length===0?r:i},_w=(e,r,n,i)=>{if(Y(e,"percentage","amount"),typeof r!="string")throw new Error("Expected string for 'from' param");if(typeof n!="string")throw new Error("Expected string for 'to' param");let a;typeof i>"u"?a={}:typeof i=="string"?a={space:i}:a=i;const u=wf(a,[r,n]);if(u===void 0)throw new Error("Could not handle colour/space");return u(e)},wf=(e,r)=>{if(!Array.isArray(r))throw new Error("Expected one or more colours as parameters");let n;if(typeof e>"u"?n={}:typeof e=="string"?n={space:e}:n=e,!Array.isArray(r))throw new Error("Expected array for colours parameter");if(r.length<2)throw new Error("Interpolation expects at least two colours");const{space:i="rgb",long:a=!1}=n;let u;switch(i){case"lab":u=Dw;break;case"hsl":u=a?Ew:ww;break;case"hcl":u=a?Aw:bw;break;case"cubehelix":u=a?Fw:Cw;break;case"rgb":u=Bi;default:u=Bi}return n.gamma&&(i==="rgb"||i==="cubehelix")&&(u=u.gamma(n.gamma)),r.length>2?Sw(u,r):u(r[0],r[1])},Pw=(e,r,...n)=>{if(Y(e,"aboveZero","steps"),!Array.isArray(n))throw new Error("Expected one or more colours as parameters");const i=wf(r,n);if(i===void 0)throw new Error("Could not handle colour/space");const a=1/(e-1),u=[];let o=0;for(let s=0;s<e;s++)u.push(i(o)),o+=a,o>1&&(o=1);return u},Rw=e=>!(e.h===void 0||e.s===void 0||e.l===void 0),Bw=e=>!(e.r===void 0||e.g===void 0||e.b===void 0),Nw=(e,r,n)=>{e/=255,r/=255,n/=255;var i=Math.min(e,r,n),a=Math.max(e,r,n),u=a-i,o,s,c;return o=0,a===i?o=0:e===a?o=(r-n)/u:r===a?o=2+(n-e)/u:n===a&&(o=4+(e-r)/u),o=Math.min(o*60,360),o<0&&(o+=360),c=(i+a)/2,a===i?s=0:c<=.5?s=u/(a+i):s=u/(2-a-i),{h:o,s,l:c}},gu=function(e,r){return gu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},gu(e,r)};function Dn(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");gu(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}function zw(e,r,n,i){function a(u){return u instanceof n?u:new n(function(o){o(u)})}return new(n||(n=Promise))(function(u,o){function s(f){try{l(i.next(f))}catch(h){o(h)}}function c(f){try{l(i.throw(f))}catch(h){o(h)}}function l(f){f.done?u(f.value):a(f.value).then(s,c)}l((i=i.apply(e,r||[])).next())})}function Ef(e,r){var n={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},i,a,u,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(f){return c([l,f])}}function c(l){if(i)throw new TypeError("Generator is already executing.");for(;n;)try{if(i=1,a&&(u=l[0]&2?a.return:l[0]?a.throw||((u=a.return)&&u.call(a),0):a.next)&&!(u=u.call(a,l[1])).done)return u;switch(a=0,u&&(l=[l[0]&2,u.value]),l[0]){case 0:case 1:u=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,a=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(u=n.trys,!(u=u.length>0&&u[u.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!u||l[1]>u[0]&&l[1]<u[3])){n.label=l[1];break}if(l[0]===6&&n.label<u[1]){n.label=u[1],u=l;break}if(u&&n.label<u[2]){n.label=u[2],n.ops.push(l);break}u[2]&&n.ops.pop(),n.trys.pop();continue}l=r.call(e,n)}catch(f){l=[6,f],a=0}finally{i=u=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Un(e){var r=typeof Symbol=="function"&&Symbol.iterator,n=r&&e[r],i=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function yn(e,r){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var i=n.call(e),a,u=[],o;try{for(;(r===void 0||r-- >0)&&!(a=i.next()).done;)u.push(a.value)}catch(s){o={error:s}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return u}function Vn(e,r,n){if(n||arguments.length===2)for(var i=0,a=r.length,u;i<a;i++)(u||!(i in r))&&(u||(u=Array.prototype.slice.call(r,0,i)),u[i]=r[i]);return e.concat(u||Array.prototype.slice.call(r))}function sn(e){return this instanceof sn?(this.v=e,this):new sn(e)}function Ww(e,r,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(e,r||[]),a,u=[];return a={},o("next"),o("throw"),o("return"),a[Symbol.asyncIterator]=function(){return this},a;function o(y){i[y]&&(a[y]=function(D){return new Promise(function(P,q){u.push([y,D,P,q])>1||s(y,D)})})}function s(y,D){try{c(i[y](D))}catch(P){h(u[0][3],P)}}function c(y){y.value instanceof sn?Promise.resolve(y.value.v).then(l,f):h(u[0][2],y)}function l(y){s("next",y)}function f(y){s("throw",y)}function h(y,D){y(D),u.shift(),u.length&&s(u[0][0],u[0][1])}}function kw(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=e[Symbol.asyncIterator],n;return r?r.call(e):(e=typeof Un=="function"?Un(e):e[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(u){n[u]=e[u]&&function(o){return new Promise(function(s,c){o=e[u](o),a(s,c,o.done,o.value)})}}function a(u,o,s,c){Promise.resolve(c).then(function(l){u({value:l,done:s})},o)}}function Ie(e){return typeof e=="function"}function Ow(e){var r=function(i){Error.call(i),i.stack=new Error().stack},n=e(r);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Ka=Ow(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(i,a){return a+1+") "+i.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function pu(e,r){if(e){var n=e.indexOf(r);0<=n&&e.splice(n,1)}}var ca=function(){function e(r){this.initialTeardown=r,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var r,n,i,a,u;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var s=Un(o),c=s.next();!c.done;c=s.next()){var l=c.value;l.remove(this)}}catch(q){r={error:q}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}else o.remove(this);var f=this.initialTeardown;if(Ie(f))try{f()}catch(q){u=q instanceof Ka?q.errors:[q]}var h=this._finalizers;if(h){this._finalizers=null;try{for(var y=Un(h),D=y.next();!D.done;D=y.next()){var P=D.value;try{Ns(P)}catch(q){u=u??[],q instanceof Ka?u=Vn(Vn([],yn(u)),yn(q.errors)):u.push(q)}}}catch(q){i={error:q}}finally{try{D&&!D.done&&(a=y.return)&&a.call(y)}finally{if(i)throw i.error}}}if(u)throw new Ka(u)}},e.prototype.add=function(r){var n;if(r&&r!==this)if(this.closed)Ns(r);else{if(r instanceof e){if(r.closed||r._hasParent(this))return;r._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(r)}},e.prototype._hasParent=function(r){var n=this._parentage;return n===r||Array.isArray(n)&&n.includes(r)},e.prototype._addParent=function(r){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(r),n):n?[n,r]:r},e.prototype._removeParent=function(r){var n=this._parentage;n===r?this._parentage=null:Array.isArray(n)&&pu(n,r)},e.prototype.remove=function(r){var n=this._finalizers;n&&pu(n,r),r instanceof e&&r._removeParent(this)},e.EMPTY=function(){var r=new e;return r.closed=!0,r}(),e}();ca.EMPTY;function Df(e){return e instanceof ca||e&&"closed"in e&&Ie(e.remove)&&Ie(e.add)&&Ie(e.unsubscribe)}function Ns(e){Ie(e)?e():e.unsubscribe()}var bf={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Lw={setTimeout:function(e,r){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setTimeout.apply(void 0,Vn([e,r],yn(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function Af(e){Lw.setTimeout(function(){throw e})}function zs(){}function $w(e){e()}var Eo=function(e){Dn(r,e);function r(n){var i=e.call(this)||this;return i.isStopped=!1,n?(i.destination=n,Df(n)&&n.add(i)):i.destination=Uw,i}return r.create=function(n,i,a){return new wu(n,i,a)},r.prototype.next=function(n){this.isStopped||this._next(n)},r.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},r.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},r.prototype._next=function(n){this.destination.next(n)},r.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},r.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},r}(ca),Tw=Function.prototype.bind;function Ja(e,r){return Tw.call(e,r)}var qw=function(){function e(r){this.partialObserver=r}return e.prototype.next=function(r){var n=this.partialObserver;if(n.next)try{n.next(r)}catch(i){fi(i)}},e.prototype.error=function(r){var n=this.partialObserver;if(n.error)try{n.error(r)}catch(i){fi(i)}else fi(r)},e.prototype.complete=function(){var r=this.partialObserver;if(r.complete)try{r.complete()}catch(n){fi(n)}},e}(),wu=function(e){Dn(r,e);function r(n,i,a){var u=e.call(this)||this,o;if(Ie(n)||!n)o={next:n??void 0,error:i??void 0,complete:a??void 0};else{var s;u&&bf.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=function(){return u.unsubscribe()},o={next:n.next&&Ja(n.next,s),error:n.error&&Ja(n.error,s),complete:n.complete&&Ja(n.complete,s)}):o=n}return u.destination=new qw(o),u}return r}(Eo);function fi(e){Af(e)}function jw(e){throw e}var Uw={closed:!0,next:zs,error:jw,complete:zs},Do=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Vw(e){return e}function xw(e){return e.length===0?Vw:e.length===1?e[0]:function(n){return e.reduce(function(i,a){return a(i)},n)}}var wr=function(){function e(r){r&&(this._subscribe=r)}return e.prototype.lift=function(r){var n=new e;return n.source=this,n.operator=r,n},e.prototype.subscribe=function(r,n,i){var a=this,u=Kw(r)?r:new wu(r,n,i);return $w(function(){var o=a,s=o.operator,c=o.source;u.add(s?s.call(u,c):c?a._subscribe(u):a._trySubscribe(u))}),u},e.prototype._trySubscribe=function(r){try{return this._subscribe(r)}catch(n){r.error(n)}},e.prototype.forEach=function(r,n){var i=this;return n=Ws(n),new n(function(a,u){var o=new wu({next:function(s){try{r(s)}catch(c){u(c),o.unsubscribe()}},error:u,complete:a});i.subscribe(o)})},e.prototype._subscribe=function(r){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(r)},e.prototype[Do]=function(){return this},e.prototype.pipe=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return xw(r)(this)},e.prototype.toPromise=function(r){var n=this;return r=Ws(r),new r(function(i,a){var u;n.subscribe(function(o){return u=o},function(o){return a(o)},function(){return i(u)})})},e.create=function(r){return new e(r)},e}();function Ws(e){var r;return(r=e??bf.Promise)!==null&&r!==void 0?r:Promise}function Hw(e){return e&&Ie(e.next)&&Ie(e.error)&&Ie(e.complete)}function Kw(e){return e&&e instanceof Eo||Hw(e)&&Df(e)}function Jw(e){return Ie(e?.lift)}function bo(e){return function(r){if(Jw(r))return r.lift(function(n){try{return e(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ni(e,r,n,i,a){return new Gw(e,r,n,i,a)}var Gw=function(e){Dn(r,e);function r(n,i,a,u,o,s){var c=e.call(this,n)||this;return c.onFinalize=o,c.shouldUnsubscribe=s,c._next=i?function(l){try{i(l)}catch(f){n.error(f)}}:e.prototype._next,c._error=u?function(l){try{u(l)}catch(f){n.error(f)}finally{this.unsubscribe()}}:e.prototype._error,c._complete=a?function(){try{a()}catch(l){n.error(l)}finally{this.unsubscribe()}}:e.prototype._complete,c}return r.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var i=this.closed;e.prototype.unsubscribe.call(this),!i&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},r}(Eo),Yw={now:function(){return Date.now()},delegate:void 0},Xw=function(e){Dn(r,e);function r(n,i){return e.call(this)||this}return r.prototype.schedule=function(n,i){return this},r}(ca),ks={setInterval:function(e,r){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setInterval.apply(void 0,Vn([e,r],yn(n)))},clearInterval:function(e){return clearInterval(e)},delegate:void 0},Zw=function(e){Dn(r,e);function r(n,i){var a=e.call(this,n,i)||this;return a.scheduler=n,a.work=i,a.pending=!1,a}return r.prototype.schedule=function(n,i){var a;if(i===void 0&&(i=0),this.closed)return this;this.state=n;var u=this.id,o=this.scheduler;return u!=null&&(this.id=this.recycleAsyncId(o,u,i)),this.pending=!0,this.delay=i,this.id=(a=this.id)!==null&&a!==void 0?a:this.requestAsyncId(o,this.id,i),this},r.prototype.requestAsyncId=function(n,i,a){return a===void 0&&(a=0),ks.setInterval(n.flush.bind(n,this),a)},r.prototype.recycleAsyncId=function(n,i,a){if(a===void 0&&(a=0),a!=null&&this.delay===a&&this.pending===!1)return i;i!=null&&ks.clearInterval(i)},r.prototype.execute=function(n,i){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var a=this._execute(n,i);if(a)return a;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},r.prototype._execute=function(n,i){var a=!1,u;try{this.work(n)}catch(o){a=!0,u=o||new Error("Scheduled action threw falsy error")}if(a)return this.unsubscribe(),u},r.prototype.unsubscribe=function(){if(!this.closed){var n=this,i=n.id,a=n.scheduler,u=a.actions;this.work=this.state=this.scheduler=null,this.pending=!1,pu(u,this),i!=null&&(this.id=this.recycleAsyncId(a,i,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},r}(Xw),Os=function(){function e(r,n){n===void 0&&(n=e.now),this.schedulerActionCtor=r,this.now=n}return e.prototype.schedule=function(r,n,i){return n===void 0&&(n=0),new this.schedulerActionCtor(this,r).schedule(i,n)},e.now=Yw.now,e}(),Qw=function(e){Dn(r,e);function r(n,i){i===void 0&&(i=Os.now);var a=e.call(this,n,i)||this;return a.actions=[],a._active=!1,a}return r.prototype.flush=function(n){var i=this.actions;if(this._active){i.push(n);return}var a;this._active=!0;do if(a=n.execute(n.state,n.delay))break;while(n=i.shift());if(this._active=!1,a){for(;n=i.shift();)n.unsubscribe();throw a}},r}(Os),e1=new Qw(Zw),Cf=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function t1(e){return Ie(e?.then)}function r1(e){return Ie(e[Do])}function n1(e){return Symbol.asyncIterator&&Ie(e?.[Symbol.asyncIterator])}function i1(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function a1(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var u1=a1();function o1(e){return Ie(e?.[u1])}function s1(e){return Ww(this,arguments,function(){var n,i,a,u;return Ef(this,function(o){switch(o.label){case 0:n=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,sn(n.read())];case 3:return i=o.sent(),a=i.value,u=i.done,u?[4,sn(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,sn(a)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function c1(e){return Ie(e?.getReader)}function Ao(e){if(e instanceof wr)return e;if(e!=null){if(r1(e))return l1(e);if(Cf(e))return f1(e);if(t1(e))return h1(e);if(n1(e))return Ff(e);if(o1(e))return d1(e);if(c1(e))return v1(e)}throw i1(e)}function l1(e){return new wr(function(r){var n=e[Do]();if(Ie(n.subscribe))return n.subscribe(r);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function f1(e){return new wr(function(r){for(var n=0;n<e.length&&!r.closed;n++)r.next(e[n]);r.complete()})}function h1(e){return new wr(function(r){e.then(function(n){r.closed||(r.next(n),r.complete())},function(n){return r.error(n)}).then(null,Af)})}function d1(e){return new wr(function(r){var n,i;try{for(var a=Un(e),u=a.next();!u.done;u=a.next()){var o=u.value;if(r.next(o),r.closed)return}}catch(s){n={error:s}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}r.complete()})}function Ff(e){return new wr(function(r){y1(e,r).catch(function(n){return r.error(n)})})}function v1(e){return Ff(s1(e))}function y1(e,r){var n,i,a,u;return zw(this,void 0,void 0,function(){var o,s;return Ef(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=kw(e),c.label=1;case 1:return[4,n.next()];case 2:if(i=c.sent(),!!i.done)return[3,4];if(o=i.value,r.next(o),r.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=c.sent(),a={error:s},[3,11];case 6:return c.trys.push([6,,9,10]),i&&!i.done&&(u=n.return)?[4,u.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(a)throw a.error;return[7];case 10:return[7];case 11:return r.complete(),[2]}})})}function m1(e,r,n,i,a){i===void 0&&(i=0),a===void 0&&(a=!1);var u=r.schedule(function(){n(),a?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(u),!a)return u}function zi(e,r){return bo(function(n,i){var a=0;n.subscribe(Ni(i,function(u){i.next(e.call(r,u,a++))}))})}var g1=Array.isArray;function p1(e,r){return g1(r)?e.apply(void 0,Vn([],yn(r))):e(r)}function w1(e){return zi(function(r){return p1(e,r)})}function E1(e,r,n,i,a,u,o,s){var c=[],l=0,f=0,h=!1,y=function(){h&&!c.length&&!l&&r.complete()},D=function(q){return l<i?P(q):c.push(q)},P=function(q){u&&r.next(q),l++;var N=!1;Ao(n(q,f++)).subscribe(Ni(r,function(b){a?.(b),u?D(b):r.next(b)},function(){N=!0},void 0,function(){if(N)try{l--;for(var b=function(){var M=c.shift();o?m1(r,o,function(){return P(M)}):P(M)};c.length&&l<i;)b();y()}catch(M){r.error(M)}}))};return e.subscribe(Ni(r,D,function(){h=!0,y()})),function(){s?.()}}function Sf(e,r,n){return n===void 0&&(n=1/0),Ie(r)?Sf(function(i,a){return zi(function(u,o){return r(i,u,a,o)})(Ao(e(i,a)))},n):(typeof r=="number"&&(n=r),bo(function(i,a){return E1(i,a,e,n)}))}var D1=["addListener","removeListener"],b1=["addEventListener","removeEventListener"],A1=["on","off"];function Wi(e,r,n,i){if(Ie(n)&&(i=n,n=void 0),i)return Wi(e,r,n).pipe(w1(i));var a=yn(S1(e)?b1.map(function(s){return function(c){return e[s](r,c,n)}}):C1(e)?D1.map(Ls(e,r)):F1(e)?A1.map(Ls(e,r)):[],2),u=a[0],o=a[1];if(!u&&Cf(e))return Sf(function(s){return Wi(s,r,n)})(Ao(e));if(!u)throw new TypeError("Invalid event target");return new wr(function(s){var c=function(){for(var l=[],f=0;f<arguments.length;f++)l[f]=arguments[f];return s.next(1<l.length?l:l[0])};return u(c),function(){return o(c)}})}function Ls(e,r){return function(n){return function(i){return e[n](r,i)}}}function C1(e){return Ie(e.addListener)&&Ie(e.removeListener)}function F1(e){return Ie(e.on)&&Ie(e.off)}function S1(e){return Ie(e.addEventListener)&&Ie(e.removeEventListener)}function Mf(e,r){return r===void 0&&(r=e1),bo(function(n,i){var a=null,u=null,o=null,s=function(){if(a){a.unsubscribe(),a=null;var l=u;u=null,i.next(l)}};function c(){var l=o+e,f=r.now();if(f<l){a=this.schedule(void 0,l-f),i.add(a);return}s()}n.subscribe(Ni(i,function(l){u=l,o=r.now(),a||(a=r.schedule(c,e),i.add(a))},function(){s(),i.complete()},void 0,function(){u=a=null}))})}var If=wn(fv(),1),_f=(e="viewport")=>{if(e==="viewport")return(r,n)=>{const i=ut(r,n);return Object.freeze({x:i.x/window.innerWidth,y:i.y/window.innerHeight})};if(e==="screen")return(r,n)=>{const i=ut(r,n);return Object.freeze({x:i.x/screen.width,y:i.y/screen.height})};if(e==="document")return(r,n)=>{const i=ut(r,n);return Object.freeze({x:i.x/document.body.scrollWidth,y:i.y/document.body.scrollHeight})};throw new Error(`Unknown 'reference' parameter: ${JSON.stringify(e)}`)},Pf=(e,r={})=>{const n=r.target??"viewport",i=r.relative??!1,a=r.anchor??"nw",u=Le(e),o=Rf(n);if(i){const s=_f(n);return()=>s(o(Mi(u.getBoundingClientRect(),a)))}else return()=>o(Mi(u.getBoundingClientRect(),a))},M1=(e,r="nw")=>{const n=Le(e);return Mi(n.getBoundingClientRect(),r)},I1=(e,r="viewport")=>Pf(e,{relative:!0,target:r})(),Rf=(e="viewport")=>{switch(e){case"screen":return(r,n)=>{const i=ut(r,n);return Object.freeze({x:i.x+window.screenX,y:i.y+window.screenY})};case"document":return(r,n)=>{const i=ut(r,n);return Object.freeze({x:i.x+window.scrollX,y:i.y+window.scrollY})};case"viewport":return(r,n)=>{const i=ut(r,n);return Object.freeze({x:i.x,y:i.y})};default:throw new Error(`Unexpected target coordinate space: ${e}. Expected: viewport, document or screen`)}},_1=(e,r,n="window")=>{if(!e)throw new Error("domQueryOrEl is null or undefined");const i=Le(e),a=ba(r,window.innerWidth,window.innerHeight),u=i.getBoundingClientRect(),o=Nr(a,u.width/2,u.height/2);i.style.transform=`translate(${o.x}px, ${o.y}px)`},Bf=(e,r)=>{const n=Le(e),i=la(),a=()=>{const u=window.innerWidth,o=window.innerHeight;if(n.setAttribute("width",u.toString()),n.setAttribute("height",o.toString()),r!==void 0){const s={min:Math.min(u,o),max:Math.max(u,o),width:u,height:o,center:{x:u/2,y:o/2}};r({el:n,bounds:s})}};return i.subscribe(a),a(),i},P1=(e,r)=>{if(!e)throw new Error("domQueryOrEl is null or undefined");const n=Le(e);if(n.nodeName!=="CANVAS")throw new Error(`Expected CANVAS HTML element. Got: ${n.nodeName}`);const i=r.fullSize??!0,a=Math.round(window.devicePixelRatio)||1,u=r.scaleBy??"both";let o=Ui.scaler("both");const s=f=>{o=Ui.scaler(u,f);const h=ye.multiply(f,a,a);n.width=h.width,n.height=h.height,n.style.width=f.width+"px",n.style.height=f.height+"px"},c=()=>{const f={width:window.innerWidth,height:window.innerHeight};s(f)},l=()=>{const f=n.getContext("2d");if(f===null)throw new Error("Could not create drawing context");f.scale(a,a)};return i&&la().subscribe(c),{abs:o.abs,rel:o.rel,getContext:l}},R1=(e,r,n=!1)=>{if(e==null)throw new Error("domQueryOrEl is null or undefined");const i=Le(e);if(i.nodeName!=="CANVAS")throw new Error(`Expected HTML element with node name CANVAS, not ${i.nodeName}`);const a=i.getContext("2d");if(a===null)throw new Error("Could not create drawing context");const u=()=>{const s=window.innerWidth,c=window.innerHeight;if(i.width=s,i.height=c,r!==void 0){const l={min:Math.min(s,c),max:Math.max(s,c),width:s,height:c,center:{x:s/2,y:c/2}};r({ctx:a,el:i,bounds:l})}};n||(i.style.top="0",i.style.left="0",i.style.zIndex="-100",i.style.position="fixed");const o=la();return o.subscribe(u),u(),o},B1=(e,r)=>{if(!(e===null||!e)){if(!Array.isArray(r))throw new Error("List should be an array of strings");for(let n=0;n<r.length;n++)if(e.classList.contains(r[n])){e.classList.remove(r[n]),n+1<r.length?e.classList.add(r[n+1]):e.classList.add(r[0]);return}e.classList.add(r[0])}},N1=(e,r,n=100)=>{const i=Le(e),a=i.parentElement;if(a===null)throw new Error("Element has no parent");return Fo(a,n).subscribe(o=>{const s=o.find(f=>f.target===a);if(s===void 0)return;const c=s.contentRect.width,l=s.contentRect.height;if(i.setAttribute("width",c+"px"),i.setAttribute("height",l+"px"),r!==void 0){const f={min:Math.min(c,l),max:Math.max(c,l),width:c,height:l,center:{x:c/2,y:l/2}};r({el:i,bounds:f})}})},z1=e=>{const r=Le(e),i=window.getComputedStyle(r).transform;if(i==="none"||typeof i>"u")return{x:0,y:0,z:0};const a=i.includes("3d")?"3d":"2d",u=i.match(/matrix.*\((.+)\)/)[1].split(", ");return a==="2d"?{x:parseFloat(u[4]),y:parseFloat(u[5]),z:0}:a==="3d"?{x:parseFloat(u[12]),y:parseFloat(u[13]),z:parseFloat(u[14])}:{x:0,y:0,z:0}},Co=(e,r,n=100)=>{const i=Le(e);if(i.nodeName!=="CANVAS")throw new Error(`Expected HTML element with node name CANVAS, not ${i.nodeName}`);const a=i.parentElement;if(a===null)throw new Error("Element has no parent");const u=i.getContext("2d");if(u===null)throw new Error("Could not create drawing context");return i.style.width="100%",i.style.height="100%",Fo(a,n).subscribe(s=>{const c=s.find(h=>h.target===a);if(c===void 0)return;const l=c.contentRect.width,f=c.contentRect.height;if(i.setAttribute("width",i.offsetWidth+"px"),i.setAttribute("height",i.offsetHeight+"px"),r!==void 0){const h={min:Math.min(l,f),max:Math.max(l,f),width:l,height:f,center:{x:l/2,y:f/2}};r({ctx:u,el:i,bounds:h})}})},la=(e=100)=>Wi(window,"resize").pipe(Mf(e)),Le=e=>{if(typeof e=="string"){const n=document.querySelector(e);if(n===null)throw e.startsWith("#")?new Error(`Query '${e}' did not match anything. Try '#id', 'div', or '.class'`):new Error(`Query '${e}' did not match anything. Did you mean '#${e}?`);e=n}else{if(e===null)throw new Error(`domQueryOrEl ${e} is null`);if(e===void 0)throw new Error(`domQueryOrEl ${e} is undefined`)}return e},W1=(e,r)=>{const n=document.createElement(r);return e.parentElement?.insertBefore(n,e.nextSibling),n},k1=(e,r)=>{const n=document.createElement(r);return e.appendChild(n),n},O1=(e,r)=>{const n=Le(e),i=a=>{const u=new Set;for(const[s,c]of a){const l=`table-${s}`;u.add(l);let f=n.querySelector(`#${l}`);f===null&&(f=document.createElement("table"),f.id=l,n.append(f)),Eu(f,c)}Array.from(n.querySelectorAll("table")).forEach(s=>{u.has(s.id)||s.remove()})};return r&&i(r),a=>{i(a)}},Eu=(e,r,n={})=>{const i=n.precision??2;if(r===void 0){e.innerHTML="";return}const a=new Set;for(const[o,s]of Object.entries(r)){const c=`row-${o}`;a.add(c);let l=e.querySelector(`#${c}`);if(l===null){l=document.createElement("tr"),e.append(l),l.id=c;const y=document.createElement("td");y.innerText=o,l.append(y)}let f=l.querySelector(`#${c}-val`);f===null&&(f=document.createElement("td"),f.id=`${c}-val`,l.append(f));let h;n.formatter&&(h=n.formatter(s,o)),h===void 0&&(typeof s=="object"?h=If.default.stringify(s):typeof s=="number"?n.roundNumbers?h=Math.round(s).toString():h=s.toFixed(i):h=s.toString()),f.innerHTML=h}Array.from(e.querySelectorAll("tr")).forEach(o=>{a.has(o.id)||o.remove()})},L1=(e,r,n)=>{const i=Le(e),a=document.createElement("table");return i.append(a),r&&Eu(a,r,n),u=>{Eu(a,u,n)}},$1=e=>{let r=e.lastElementChild;for(;r;)e.removeChild(r),r=e.lastElementChild},T1=()=>new wr(r=>{const n=new MutationObserver(a=>{r.next(a)}),i={attributeFilter:["class"],attributes:!0};return n.observe(document.documentElement,i),function(){n.disconnect()}}),Fo=(e,r=1e3)=>{if(e===null)throw new Error("elem parameter is null. Expected element to observe");if(e===void 0)throw new Error("elem parameter is undefined. Expected element to observe");return new wr(i=>{const a=new ResizeObserver(u=>{i.next(u)});return a.observe(e),function(){a.unobserve(e)}}).pipe(Mf(r))},q1=e=>new Promise((n,i)=>{const a=If.default.stringify(e);navigator.clipboard.writeText(JSON.stringify(a)).then(()=>{n(!0)},u=>{console.warn("Could not copy to clipboard"),console.log(a),i(u)})}),j1=(e,r,n)=>{if(e===null)throw new Error("parentEl is null");if(e===void 0)throw new Error("parentEl is undefined");const i=new Set;for(const[u,o]of r){const s=`c-${u}`,c=e.querySelector(`#${s}`),l=n(o,c);c!==l&&(l.id=s,e.append(l)),i.add(s)}const a=[];for(let u=0;u<e.children.length;u++){const o=e.children[u];i.has(o.id)||a.push(o)}a.forEach(u=>u.remove())},Nf=Math.PI*2,zf=e=>{if(e===null)throw Error("canvasElCtxOrQuery null. Must be a 2d drawing context or Canvas element");if(e===void 0)throw Error("canvasElCtxOrQuery undefined. Must be a 2d drawing context or Canvas element");const r=e instanceof CanvasRenderingContext2D?e:e instanceof HTMLCanvasElement?e.getContext("2d"):typeof e=="string"?Le(e).getContext("2d"):e;if(r===null)throw new Error("Could not create 2d context for canvas");return r},U1=(e,r)=>{const n=zf(e);return{paths(i,a){Of(n,i,a)},line(i,a){Mo(n,i,a)},rect(i,a){Tf(n,i,a)},bezier(i,a){Lf(n,i,a)},connectedPoints(i,a){fa(n,i,a)},pointLabels(i,a){ha(n,i,a)},dot(i,a){qt(n,i,a)},circle(i,a){kf(n,i,a)},arc(i,a){Wf(n,i,a)},textBlock(i,a){a.bounds===void 0&&r!==void 0&&(a={...a,bounds:{...r,x:0,y:0}}),qf(n,i,a)}}},So=e=>V1(e.strokeStyle,e.fillStyle),ot=(e,r={},...n)=>{if(e===void 0)throw Error("ctx undefined");const i=en(e).push(So(r),...n);return i.apply(),i},Wf=(e,r,n={})=>{ot(e,n);const i=a=>{e.beginPath(),e.arc(a.x,a.y,a.radius,a.startRadian,a.endRadian),e.stroke()};Array.isArray(r)?r.forEach(i):i(r)},V1=(e,r)=>i=>{r&&(i.fillStyle=r),e&&(i.strokeStyle=e)},x1=(e,r,n)=>a=>{e&&(a.lineWidth=e),r&&(a.lineJoin=r),n&&(a.lineCap=n)},en=(e,r)=>(r===void 0&&(r=Ai()),{push:(...u)=>{r===void 0&&(r=Ai());const o=r.push(...u);return u.forEach(s=>s(e)),en(e,o)},pop:()=>{const u=r?.pop();return en(e,u)},apply:()=>r===void 0?en(e):(r.forEach(u=>u(e)),en(e,r))}),H1=(e,r,n)=>{ot(e,n),e.moveTo(r[0].x,r[0].y),r.forEach((i,a)=>{if(a+2>=r.length)return;const u=r[a+1],o={x:(i.x+u.x)/2,y:(i.y+u.y)/2},s=(o.x+i.x)/2,c=(o.x+u.x)/2;e.quadraticCurveTo(s,u.y,o.x,o.y),e.quadraticCurveTo(c,u.y,u.x,u.y)})},kf=(e,r,n={})=>{ot(e,n);const i=a=>{e.beginPath(),e.arc(a.x,a.y,a.radius,0,Nf),n.strokeStyle&&e.stroke(),n.fillStyle&&e.fill()};Array.isArray(r)?r.forEach(i):i(r)},K1=(e,r,n={})=>{ot(e,n);const i=a=>{e.beginPath();const u=a.rotation??0,o=a.startAngle??0,s=a.endAngle??Nf;e.ellipse(a.x,a.y,a.radiusX,a.radiusY,u,o,s),n.strokeStyle&&e.stroke(),n.fillStyle&&e.fill()};Array.isArray(r)?r.forEach(i):i(r)},Of=(e,r,n={})=>{ot(e,n);const i=a=>{if(Gi(a))$f(e,a,n);else if(Br(a))Mo(e,a,n);else throw new Error(`Unknown path type ${JSON.stringify(a)}`)};Array.isArray(r)?r.forEach(i):i(r)},fa=(e,r,n={})=>{const i=n.loop??!1;mv(r),r.length!==0&&(r.forEach((a,u)=>pe(a,`Index ${u}`)),ot(e,n),e.beginPath(),e.moveTo(r[0].x,r[0].y),r.forEach(a=>e.lineTo(a.x,a.y)),i&&e.lineTo(r[0].x,r[0].y),(n.strokeStyle||n.strokeStyle===void 0&&n.fillStyle===void 0)&&e.stroke(),n.fillStyle&&e.fill())},ha=(e,r,n={},i)=>{r.length!==0&&(r.forEach((a,u)=>pe(a,`Index ${u}`)),ot(e,n),r.forEach((a,u)=>{const o=i!==void 0&&u<i.length?i[u]:u.toString();e.fillText(o.toString(),a.x,a.y)}))},J1=(e,r)=>{const n=e.getTransform();return{x:r.x*n.a+r.y*n.c+n.e,y:r.x*n.b+r.y*n.d+n.f}},G1=e=>{const r=document.createElement("img");return r.src=e.toDataURL("image/jpeg"),r},qt=(e,r,n)=>{n===void 0&&(n={});const i=n.radius??10;if(ot(e,n),e.beginPath(),Array.isArray(r))r.forEach(a=>{e.arc(a.x,a.y,i,0,2*Math.PI)});else{const a=r;e.arc(a.x,a.y,i,0,2*Math.PI)}(n.filled||!n.outlined)&&e.fill(),n.outlined&&e.stroke()},Lf=(e,r,n)=>{Gi(r)?$f(e,r,n):Vu(r)&&Y1(e,r,n)},Y1=(e,r,n={})=>{let i=ot(e,n);const{a,b:u,cubic1:o,cubic2:s}=r,c=n.debug??!1;e.beginPath(),e.moveTo(a.x,a.y),e.bezierCurveTo(o.x,o.y,s.x,s.y,u.x,u.y),e.stroke(),c&&(i=i.push(So({...n,strokeStyle:jn(n.strokeStyle??"silver",.6),fillStyle:jn(n.fillStyle??"yellow",.4)})),i.apply(),e.moveTo(a.x,a.y),e.lineTo(o.x,o.y),e.stroke(),e.moveTo(u.x,u.y),e.lineTo(s.x,s.y),e.stroke(),e.fillText("a",a.x+5,a.y),e.fillText("b",u.x+5,u.y),e.fillText("c1",o.x+5,o.y),e.fillText("c2",s.x+5,s.y),qt(e,o,{radius:3}),qt(e,s,{radius:3}),qt(e,a,{radius:3}),qt(e,u,{radius:3}),i=i.pop(),i.apply())},$f=(e,r,n={})=>{const{a:i,b:a,quadratic:u}=r,o=n.debug??!1;let s=ot(e,n);e.beginPath(),e.moveTo(i.x,i.y),e.quadraticCurveTo(u.x,u.y,a.x,a.y),e.stroke(),o&&(s=s.push(So({...n,strokeStyle:jn(n.strokeStyle??"silver",.6),fillStyle:jn(n.fillStyle??"yellow",.4)})),fa(e,[i,u,a]),e.fillText("a",i.x+5,i.y),e.fillText("b",a.x+5,a.y),e.fillText("h",u.x+5,u.y),qt(e,u,{radius:3}),qt(e,i,{radius:3}),qt(e,a,{radius:3}),s=s.pop(),s.apply())},Mo=(e,r,n={})=>{const i=n.debug??!1,a=x1(n.lineWidth,n.lineJoin,n.lineCap);ot(e,n,a);const u=o=>{const{a:s,b:c}=o;e.beginPath(),e.moveTo(s.x,s.y),e.lineTo(c.x,c.y),i&&(e.fillText("a",s.x,s.y),e.fillText("b",c.x,c.y),qt(e,s,{radius:5,strokeStyle:"black"}),qt(e,c,{radius:5,strokeStyle:"black"})),e.stroke()};Array.isArray(r)?r.forEach(u):u(r)},X1=(e,r,n={})=>{ot(e,n);const i=a=>{fa(e,fu(a),{...n,loop:!0}),n.debug&&ha(e,fu(a),void 0,["a","b","c"])};Array.isArray(r)?r.forEach(i):i(r)},Tf=(e,r,n={})=>{ot(e,n);const i=a=>{n.filled&&e.fillRect(a.x,a.y,a.width,a.height),(n.stroked??!0)&&e.strokeRect(a.x,a.y,a.width,a.height),n.debug&&ha(e,Yu(a),void 0,["NW","NE","SE","SW"])};Array.isArray(r)?r.forEach(i):i(r)},tn=(e,r,n=0,i)=>{if(r==null||r.length===0)return 0;const a=e.measureText(r);return i?m0(a.width,i)+n:a.width+n},qf=(e,r,n)=>{ot(e,n);const i=n.anchorPadding??0,a=n.anchor,u=n.bounds??{x:0,y:0,width:1e6,height:1e6},o=r.map(D=>e.measureText(D)),s=o.map(D=>D.width),c=o.map(D=>D.actualBoundingBoxAscent+D.actualBoundingBoxDescent),l=Math.max(...s),f=c.reduce((D,P)=>D+P,0);let{x:h,y}=a;a.x+l>u.width?h=u.width-(l+i):h-=i,h<u.x&&(h=u.x+i),a.y+f>u.height?y=u.height-(f+i):y-=i,y<u.y&&(y=u.y+i),r.forEach((D,P)=>{e.fillText(D,h,y),y+=c[P]})},Z1=(e,r,n)=>{const{bounds:i}=n,{horiz:a="left",vert:u="top"}=n;let o;typeof r=="string"?o=[r]:o=r,ot(e,n),e.save(),e.translate(i.x,i.y),e.textAlign="left",e.textBaseline="top";const s=i.width/2,c=i.height/2,l=o.map(D=>e.measureText(D)),f=l.map(D=>D.actualBoundingBoxAscent+D.actualBoundingBoxDescent),h=f.reduce((D,P)=>D+P,0);let y=0;u==="center"?y=c-h/2:u==="bottom"&&(y=i.height-h),o.forEach((D,P)=>{let q=0;a==="center"?q=s-l[P].width/2:a==="right"&&(q=i.width-l[P].width),e.fillText(o[P],q,y),y+=f[P]}),e.restore()},Io={};Z(Io,{Elements:()=>ki,applyOpts:()=>Er,applyPathOpts:()=>Po,applyStrokeOpts:()=>Rr,clear:()=>tE,createEl:()=>da,createOrResolve:()=>mr,getBounds:()=>rE,makeHelper:()=>iE,remove:()=>Zf,setBounds:()=>nE});var Q1=(e,r,n)=>{const i=da("marker",e);if(r.markerWidth&&i.setAttribute("markerWidth",r.markerWidth?.toString()),r.markerHeight&&i.setAttribute("markerHeight",r.markerHeight?.toString()),r.orient?i.setAttribute("orient",r.orient.toString()):i.setAttribute("orient","auto-start-reverse"),r.viewBox&&i.setAttribute("viewBox",r.viewBox.toString()),r.refX&&i.setAttribute("refX",r.refX.toString()),r.refY&&i.setAttribute("refY",r.refY.toString()),n){const a=n();i.appendChild(a)}return i},Ga=(e,r,n)=>{if(e===null)return"(elem null)";const i=e.ownerSVGElement;if(i===null)throw new Error("parent for elem is null");const a=mr(i,"defs","defs");let u=a.querySelector(`#${r.id}`);if(u!==null)return`url(#${r.id})`;if(r.id==="triangle")r={...r,strokeStyle:"transparent"},r.markerHeight||(r={...r,markerHeight:6}),r.markerWidth||(r={...r,markerWidth:6}),r.refX||(r={...r,refX:r.markerWidth}),r.refY||(r={...r,refY:r.markerHeight}),(!r.fillStyle||r.fillStyle==="none")&&(r={...r,fillStyle:"black"}),r.viewBox||(r={...r,viewBox:"0 0 10 10"}),u=Q1(r.id,r,()=>{const o=da("path");return o.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),r&&Er(o,r),o});else throw new Error(`Do not know how to make ${r.id}`);return u.id=r.id,a.appendChild(u),`url(#${r.id})`},ki={};Z(ki,{circle:()=>xf,circleUpdate:()=>Vf,grid:()=>Xf,group:()=>eE,groupUpdate:()=>Hf,line:()=>Oi,lineUpdate:()=>Kf,path:()=>jf,pathUpdate:()=>Uf,text:()=>Yf,textPath:()=>Gf,textPathUpdate:()=>Jf,textUpdate:()=>_o});var $s=e=>e>=0&&e<=1?e*100+"%":e.toString(),jf=(e,r,n,i)=>{const a=mr(r,"path",i),u=typeof e=="string"?e:e.join(`
`);return a.setAttributeNS(null,"d",u),r.appendChild(a),Uf(a,n)},Uf=(e,r)=>(r&&Er(e,r),r&&Rr(e,r),e),Vf=(e,r,n)=>(e.setAttributeNS(null,"cx",r.x.toString()),e.setAttributeNS(null,"cy",r.y.toString()),e.setAttributeNS(null,"r",r.radius.toString()),n&&Er(e,n),n&&Rr(e,n),e),xf=(e,r,n,i)=>{const a=mr(r,"circle",i);return Vf(a,e,n)},eE=(e,r,n)=>{const i=mr(r,"g",n);return Hf(i,e)},Hf=(e,r)=>{for(const n of r)n.parentNode!==e&&e.appendChild(n);return e},Oi=(e,r,n,i)=>{const a=mr(r,"line",i);return Kf(a,e,n)},Kf=(e,r,n)=>(e.setAttributeNS(null,"x1",r.a.x.toString()),e.setAttributeNS(null,"y1",r.a.y.toString()),e.setAttributeNS(null,"x2",r.b.x.toString()),e.setAttributeNS(null,"y2",r.b.y.toString()),n&&Er(e,n),n&&Po(e,n),n&&Rr(e,n),e),Jf=(e,r,n)=>(n?.method&&e.setAttributeNS(null,"method",n.method),n?.side&&e.setAttributeNS(null,"side",n.side),n?.spacing&&e.setAttributeNS(null,"spacing",n.spacing),n?.startOffset&&e.setAttributeNS(null,"startOffset",$s(n.startOffset)),n?.textLength&&e.setAttributeNS(null,"textLength",$s(n.textLength)),r&&(e.textContent=r),n&&Er(e,n),n&&Rr(e,n),e),Gf=(e,r,n,i,a)=>{const u=mr(n,"text",a+"-text");_o(u,void 0,void 0,i);const o=mr(u,"textPath",a);return o.setAttributeNS(null,"href",e),Jf(o,r,i)},_o=(e,r,n,i)=>(r&&(e.setAttributeNS(null,"x",r.x.toString()),e.setAttributeNS(null,"y",r.y.toString())),n&&(e.textContent=n),i&&(Er(e,i),i&&Rr(e,i),i.anchor&&e.setAttributeNS(null,"text-anchor",i.anchor),i.align&&e.setAttributeNS(null,"alignment-baseline",i.align),(i.userSelect??!0)||(e.style.userSelect="none",e.style.webkitUserSelect="none")),e),Yf=(e,r,n,i,a)=>{const u=mr(r,"text",a);return _o(u,n,e,i)},Xf=(e,r,n,i,a,u={})=>{u.strokeStyle||(u={...u,strokeStyle:pf("bg-dim","silver")}),u.strokeWidth||(u={...u,strokeWidth:1});const o=da("g");Er(o,u),Po(o,u),Rr(o,u);let s=0;for(;s<a;){const l=$i(0,s,i,s);Oi(l,o),s+=n}let c=0;for(;c<i;){const l=$i(c,0,c,a);Oi(l,o),c+=n}return e.appendChild(o),o},mr=(e,r,n)=>{let i=null;if(n!==void 0&&(typeof n=="string"?i=e.querySelector(n):i=n),i===null){const a=document.createElementNS("http://www.w3.org/2000/svg",r);return e.appendChild(a),n&&typeof n=="string"&&n.startsWith("#")&&(a.id=n.substring(1)),a}return i},Zf=(e,r)=>{if(typeof r=="string"){const n=e.querySelector(r);if(n===null)return;n.remove()}else r.remove()},tE=e=>{let r=e.lastElementChild;for(;r;)e.removeChild(r),r=e.lastElementChild},da=(e,r)=>{const n=document.createElementNS("http://www.w3.org/2000/svg",e);return r&&(n.id=r),n},Po=(e,r)=>{r.markerEnd&&e.setAttribute("marker-end",Ga(e,r.markerEnd)),r.markerStart&&e.setAttribute("marker-start",Ga(e,r.markerStart)),r.markerMid&&e.setAttribute("marker-mid",Ga(e,r.markerMid))},Er=(e,r)=>{r.fillStyle&&e.setAttributeNS(null,"fill",r.fillStyle),r.opacity&&e.setAttributeNS(null,"opacity",r.opacity.toString())},Rr=(e,r)=>{r.strokeStyle&&e.setAttributeNS(null,"stroke",r.strokeStyle),r.strokeWidth&&e.setAttributeNS(null,"stroke-width",r.strokeWidth.toString()),r.strokeDash&&e.setAttribute("stroke-dasharray",r.strokeDash),r.strokeLineCap&&e.setAttribute("stroke-linecap",r.strokeLineCap)},rE=e=>{const r=e.getAttributeNS(null,"width"),n=r===null?0:parseFloat(r),i=e.getAttributeNS(null,"height"),a=i===null?0:parseFloat(i);return{width:n,height:a}},nE=(e,r)=>{e.setAttributeNS(null,"width",r.width.toString()),e.setAttributeNS(null,"height",r.height.toString())},iE=(e,r)=>(r&&(Er(e,r),Rr(e,r)),{remove:i=>Zf(e,i),text:(i,a,u,o)=>Yf(i,e,a,u,o),textPath:(i,a,u,o)=>Gf(i,a,e,u,o),line:(i,a,u)=>Oi(i,e,a,u),circle:(i,a,u)=>xf(i,e,a,u),path:(i,a,u)=>jf(i,e,a,u),grid:(i,a,u,o,s)=>Xf(e,i,a,u,o,s),query:i=>e.querySelector(i),get width(){const i=e.getAttributeNS(null,"width");return i===null?0:parseFloat(i)},set width(i){e.setAttributeNS(null,"width",i.toString())},get parent(){return e},get height(){const i=e.getAttributeNS(null,"height");return i===null?0:parseFloat(i)},set height(i){e.setAttributeNS(null,"height",i.toString())},clear:()=>{for(;e.firstChild;)e.removeChild(e.lastChild)}}),Ro={};Z(Ro,{add:()=>Qf,calcScale:()=>Bo,defaultAxis:()=>Du,draw:()=>cn,drawValue:()=>eh,plot:()=>dE});var aE=Math.PI*2,Du=e=>({endWith:"none",lineWidth:1,namePosition:"none",name:e,showLabels:e==="y",showLine:!0,textSize:e==="y"?20:10}),Bo=(e,r,n)=>{const i=[];for(const a of e.keys()){const u=[...e.values(a)];if(u.length===0)break;let{min:o,max:s}=pa(u),c=s-o,l;n!==void 0&&(l=n[a]),l==null&&(r.defaultSeriesVariable?l=ti.getCssVariable("accent",r.defaultSeriesColour):l=r.defaultSeriesColour),c===0&&(c=o,o=o-c/2,s=s+c/2),i.push({min:o,max:s,range:c,name:a,colour:l})}return i},Qf=(e,r,n="")=>{e.addKeyedValues(n,r)},eh=(e,r,n)=>{const i={...n,translucentPlot:!0,leadingEdgeDot:!1};cn(r,i),n={...n,highlightIndex:e,leadingEdgeDot:!0,translucentPlot:!1,style:"none",clearCanvas:!1},cn(r,n)},uE=(e,r,n)=>Bo(e,n,n.seriesColours).map(i=>({...i,range:r[1]-r[0],min:r[0],max:r[1]})),cn=(e,r)=>{const{x:n,y:i,ctx:a,canvasSize:u}=r,o=r.margin,s=r.y.scaleRange?uE(e,r.y.scaleRange,r):Bo(e,r,r.seriesColours);r.clearCanvas&&a.clearRect(0,0,u.width,u.height),r.debug&&(a.strokeStyle="orange",a.strokeRect(0,0,u.width,u.height)),a.translate(o,o);const c=r.plotSize??rh(u,r),l={height:c.height+o+o,width:c.width};if((i.showLabels||i.showLine)&&(s.forEach(h=>{i.allowedSeries!==void 0&&!i.allowedSeries.includes(h.name)||oE(h,l,r)}),s.length>0&&i.showLine&&sE(l,s[0],r)),(n.showLabels||n.showLine)&&s.length>0){const h=i.labelRange?i.labelRange[0]:s[0].min;lE(c.width,Ur(h,s[0],c.height)+o+n.lineWidth,r)}const f={...r,plotSize:c};ta.translatePoint(a,r.pointer),s.forEach(h=>{const y=e.getSource(h.name);if(y===void 0)return;let D=e.typeName==="circular"?y.pointer-1:y.length-1;r.highlightIndex!==void 0&&(D=r.highlightIndex),a.save(),a.translate(0,o+o),fE(h,y,c,f,D),a.restore()}),r.showLegend&&(a.save(),a.translate(0,c.height+o+o+o),c.width,r.x.textSize+o+o,cE(s,r),a.restore()),a.resetTransform()},oE=(e,r,n)=>{const{ctx:i,y:a,digitsPrecision:u,margin:o}=n,{height:s}=r;n.debug&&(i.strokeStyle="purple",i.strokeRect(0,0,a.textSize,s+o)),i.fillStyle=e.colour.length>0?e.colour:"white",a.colour&&(i.fillStyle=a.colour);const c=a.labelRange?a.labelRange[0]:e.min,l=a.labelRange?a.labelRange[1]:e.max,f=a.labelRange?l-c:e.range,h=c+f/2,y=n.textHeight/2;i.textBaseline="top",i.fillText(c.toFixed(u),0,Ur(c,e,s)-y),i.fillText(h.toFixed(u),0,Ur(h,e,s)-y),i.fillText(l.toFixed(u),0,Ur(l,e,s)-o),i.translate(a.textSize+o,0)},sE=(e,r,n)=>{if(r===void 0)throw new Error("series undefined");const{ctx:i,y:a}=n,{height:u}=e,o=a.labelRange?a.labelRange[0]:r.min,s=a.labelRange?a.labelRange[1]:r.max,c=Ur(o,r,u),l=Ur(s,r,u);i.translate(a.lineWidth,0),i.lineWidth=a.lineWidth,i.beginPath(),i.moveTo(0,c),i.lineTo(0,l),i.strokeStyle=r.colour,a.colour&&(i.strokeStyle=a.colour),i.stroke(),i.translate(a.lineWidth,0)},cE=(e,r,n)=>{const{ctx:i}=r,a=10;let u=0;const o=r.margin*3,s=r.margin;i.lineWidth=r.lineWidth,e.forEach(c=>{i.moveTo(u,o),i.strokeStyle=c.colour,i.lineTo(u+a,o),i.stroke(),u+=a+r.margin;let l=c.name;c.lastValue&&(l+=" "+c.lastValue.toFixed(r.digitsPrecision));const f=i.measureText(l);i.fillStyle=c.colour,i.fillText(l,u,s),u+=f.width})},lE=(e,r,n)=>{const{ctx:i,x:a,y:u}=n;!a.showLine||(a.colour&&(i.strokeStyle=a.colour),i.lineWidth=a.lineWidth,i.beginPath(),i.moveTo(0,r),i.lineTo(e,r),i.stroke())},fE=(e,r,n,i,a)=>{const{ctx:u,lineWidth:o,translucentPlot:s=!1,margin:c,x:l}=i,f=i.style??"connected",h=n.height-c;let y=1;if(l.scaleRange){const b=l.scaleRange[1]-l.scaleRange[0];y=n.width/b}else i.capacity===0?y=n.width/r.length:y=n.width/i.capacity;const D=i.coalesce&&y<0?Math.floor(1/y):1;let P=0,q;i.debug&&(u.strokeStyle="green",u.strokeRect(0,0,n.width,n.height));const N=b=>s?ti.opacity(b,.2):b;f==="dots"?u.fillStyle=N(e.colour):f==="none"||(u.beginPath(),u.lineWidth=o,u.strokeStyle=N(e.colour));for(let b=0;b<r.length;b+=D){let M=Ur(r[b],e,h)-1;f==="dots"?(u.beginPath(),u.arc(P,M,o,0,aE),u.fill()):f==="none"||(b==0&&u.moveTo(P,M),u.lineTo(P,M)),b===a&&(q={x:P,y:M},e.lastValue=r[b]),P+=y}f==="connected"&&u.stroke(),q!==void 0&&i.leadingEdgeDot&&(u.beginPath(),u.fillStyle=N(e.colour),u.arc(q.x,q.y,3,0,2*Math.PI),u.fill())},Ur=(e,r,n)=>(1-(e-r.min)/r.range)*n,th=(e,r,n,i)=>{let a=e;n.showLabels&&(a+=n.textSize),n.showLine&&(a+=n.lineWidth),(n.showLabels||n.showLine)&&(a+=e+e);let u=e,o=e+e,s=e+e;return r.showLabels?s+=r.textSize:s+=e,r.showLine&&(s+=r.lineWidth),(r.showLabels||r.showLine)&&(s+=e),i&&(s+=r.textSize),{left:a,right:u,top:o,bottom:s}},rh=(e,r)=>{const{width:n,height:i}=e,a=th(r.margin,r.x,r.y,r.showLegend);return{width:n-a.left-a.right,height:i-a.top-a.bottom}},hE=(e,r)=>{const{width:n,height:i}=e,a=th(r.margin,r.x,r.y,r.showLegend);return{width:n+a.left+a.right,height:i+a.top+a.bottom}},dE=(e,r)=>{if(e===null)throw new Error("parentElOrQuery is null. Expected string or element");const n=Le(e);let i,a=!0,u=r.plotSize,o;n.nodeName==="CANVAS"?(i=n,a=!1,o={width:i.width,height:i.height}):(i=document.createElement("CANVAS"),n.append(i),u=r.plotSize,o={width:i.width,height:i.height});const s={x:0,y:0},c=b=>{s.x=b.offsetX,s.y=b.offsetY};i.addEventListener("pointermove",c);const l=i.getContext("2d"),f=r.capacity??10,h=f>0?s0({capacity:f}):c0(),y=l.measureText("Xy"),D=r.coalesce??!0;if(l===null)throw new Error("Drawing context not available");let P=Du("x");r.x&&(P={...P,...r.x});let q=Du("y");r.y&&(q={...q,...r.y});let N={...r,y:q,x:P,pointer:s,capacity:f,coalesce:D,plotSize:u,canvasSize:o,ctx:l,textHeight:r.textHeight??y.actualBoundingBoxAscent+y.actualBoundingBoxDescent,style:r.style??"connected",defaultSeriesColour:r.defaultSeriesColour??"yellow",margin:3,clearCanvas:!0,leadingEdgeDot:!0,debug:r.debug??!1,digitsPrecision:r.digitsPrecision??2,lineWidth:r.lineWidth??2,showLegend:r.showLegend??!1};if(u){const b=hE(u,N);i.width=b.width,i.height=b.height,N.canvasSize=b}return r.autoSizeCanvas&&Co(i,b=>{const M=b.bounds;N={...N,plotSize:rh(M,N),canvasSize:M},cn(h,N)}),{drawValue:b=>{eh(b,h,N)},dispose:()=>{i.removeEventListener("pointermove",c),a&&i.remove()},add:(b,M="",B=!1)=>{Qf(h,b,M),!B&&cn(h,N)},draw:()=>{cn(h,N)},clear:()=>{h.clear()}}},No={};Z(No,{AxisX:()=>lh,AxisY:()=>hh,Legend:()=>ch,Plot:()=>gE,PlotArea:()=>sh,Series:()=>oh});var zo={};Z(zo,{Box:()=>ih,CanvasBox:()=>bn,CanvasMeasureState:()=>ah,MeasureState:()=>nh});var hi=(e,r)=>e.type==="px"&&r.type==="px"?e.value===r.value:!1,vE=(e,r)=>e===void 0&&r===void 0?!0:!(e===void 0||r===void 0||e.x&&r.x&&!hi(e.x,r.x)||e.y&&r.y&&!hi(e.y,r.y)||e.width&&r.width&&!hi(e.width,r.width)||e.height&&r.height&&!hi(e.height,r.height)),nh=class{bounds;pass;measurements;constructor(e){this.bounds=e,this.pass=0,this.measurements=new Map}getSize(e){const r=this.measurements.get(e);if(r!==void 0&&!Ln(r.size))return r.size}resolveToPx(e,r){if(e===void 0)return r;if(e.type==="px")return e.value;throw new Error(`Unknown unit type ${e.type}`)}},ih=class{visual=ou;_desiredSize;_lastMeasure;children=[];_parent;_idMap=new Map;debugLayout=!1;_visible=!0;_ready=!0;takesSpaceWhenInvisible=!1;needsDrawing=!0;_needsLayout=!0;debugHue=po();id;constructor(e,r){this.id=r,this._parent=e,e?.onChildAdded(this)}hasChild(e){const r=this.children.find(i=>i===e),n=this.children.find(i=>i.id===e.id);return r!==void 0||n!==void 0}notify(e,r){this.onNotify(e,r),this.children.forEach(n=>n.notify(e,r))}onNotify(e,r){}onChildAdded(e){if(e.hasChild(this))throw new Error("Recursive");if(e===this)throw new Error("Cannot add self as child");if(this.hasChild(e))throw new Error("Child already present");this.children.push(e),this._idMap.set(e.id,e)}setReady(e,r=!1){this._ready=e,r&&this.children.forEach(n=>n.setReady(e,r))}get visible(){return this._visible}set visible(e){this._visible!==e&&(this._visible=e,this.onLayoutNeeded())}get desiredSize(){return this._desiredSize}set desiredSize(e){vE(e,this._desiredSize)||(this._desiredSize=e,this.onLayoutNeeded())}onLayoutNeeded(){this.notifyChildLayoutNeeded()}notifyChildLayoutNeeded(){this._needsLayout=!0,this.needsDrawing=!0,this._parent!==void 0?this._parent.notifyChildLayoutNeeded():this.update()}get root(){return this._parent===void 0?this:this._parent.root}measurePreflight(){}measureApply(e,r){let n=!0;return this._needsLayout=!1,ll(e.size,this.visual)&&(n=!1),gt(e.size)?this.visual=e.size:this.visual={x:0,y:0,width:e.size.width,height:e.size.height},e.children.forEach(i=>{i!==void 0&&i.ref.measureApply(i,r)}),(n||r)&&(this.needsDrawing=!0,this.root.notify("measureApplied",this)),n}debugLog(e){console.log(this.id,e)}measureStart(e,r,n){this.measurePreflight();let i={ref:this,size:Gu,children:[]};if(e.measurements.set(this.id,i),!this._visible&&!this.takesSpaceWhenInvisible)i.size=cl;else{let a=this._lastMeasure;if((this._needsLayout||this._lastMeasure===void 0)&&(a=this.measureSelf(e,n),this.root.notify("measured",this)),a===void 0)return;i.size=a,this._lastMeasure=a}if(i.children=this.children.map(a=>a.measureStart(e,r,i)),!(Vt.without(i.children,void 0).length<this.children.length))return i}measureSelf(e,r){let n=ou;if(r?r.size&&(n={x:0,y:0,width:r.size.width,height:r.size.height}):n={x:0,y:0,width:e.bounds.width,height:e.bounds.height},!Ln(n))return n}updateDone(e,r){this.onUpdateDone(e,r),this.children.forEach(n=>n.updateDone(e,r))}update(e=!1){const r=this.updateBegin(e);let n=5,i=!1;for(;n--;){const a=this.measureStart(r,e);if(a!==void 0){if(this.measureApply(a,e),!this._ready)return;i=!0}}this.updateDone(r,e),i||console.warn("Ran out of measurement attempts")}},ah=class extends nh{ctx;constructor(e,r){super(e);this.ctx=r}},bn=class extends ih{canvasEl;constructor(e,r,n){super(e,n);if(r===void 0)throw new Error("canvasEl undefined");if(r===null)throw new Error("canvasEl null");this.canvasEl=r,e===void 0&&this.designateRoot()}designateRoot(){this.canvasEl.addEventListener("pointermove",e=>{const r={x:e.offsetX,y:e.offsetY};this.notifyPointerMove(r)}),this.canvasEl.addEventListener("pointerleave",e=>{this.notifyPointerLeave()}),this.canvasEl.addEventListener("click",e=>{const r={x:e.offsetX,y:e.offsetY};this.notifyClick(r)})}onClick(e){}notifyClick(e){if(!Ln(this.visual)&&$n(this.visual,e)){const r=O.subtract(e,this.visual.x,this.visual.y);this.onClick(r),this.children.forEach(n=>n.notifyClick(r))}}notifyPointerLeave(){this.onPointerLeave(),this.children.forEach(e=>e.notifyPointerLeave())}notifyPointerMove(e){if(!Ln(this.visual)&&$n(this.visual,e)){const r=O.subtract(e,this.visual.x,this.visual.y);this.onPointerMove(r),this.children.forEach(n=>n.notifyPointerMove(r))}}onPointerLeave(){}onPointerMove(e){}updateBegin(){const e=this.canvasEl.getContext("2d");if(e===null)throw new Error("Context unavailable");const r=this.canvasEl.getBoundingClientRect();return new ah({width:r.width,height:r.height},e)}onUpdateDone(e,r){if(!this.needsDrawing&&!r)return;const n=this.canvasEl.getContext("2d");if(n===null)throw new Error("Context unavailable");n.save(),n.translate(this.visual.x,this.visual.y);const i=this.visual;this.debugLayout&&(n.lineWidth=1,n.strokeStyle=`hsl(${this.debugHue}, 100%, 50%)`,n.strokeRect(0,0,i.width,i.height),n.fillStyle=n.strokeStyle,n.fillText(this.id,10,10,i.width),n.beginPath(),n.moveTo(0,0),n.lineTo(i.width,i.height),n.stroke()),this.drawSelf(n),this.needsDrawing=!1,n.restore()}drawSelf(e){}},uh=class{data;series;dirty=!1;type="array";_range;constructor(e){this.series=e,this.data=[],this.dirty=!0}clear(){this.set([]),this._range=void 0}set(e){this.data=e,this.dirty=!0}get length(){return this.data.length}get range(){return!this.dirty&&this._range!==void 0?this._range:(this.dirty=!1,this._range=Vt.minMaxAvg(this.data),{...this._range,changed:!0})}add(e){this.data=[...this.data,e],this.dirty=!0}},yE=class extends uh{desiredDataPointMinWidth=5;constructor(e){super(e)}add(e){const r=this.series.lastPxPerPt;if(r>-1&&r<this.desiredDataPointMinWidth){const n=Math.floor(this.desiredDataPointMinWidth/r),i=[...this.data.slice(n),e];super.set(i)}else super.add(e)}},oh=class{constructor(e,r,n,i){if(this.plot=n,this.name=e,this.drawingStyle=i.drawingStyle??"line",this.colour=i.colour,this.width=i.width??3,this.axisRange=i.axisRange??{min:Number.NaN,max:Number.NaN},this._visualRange={...this.axisRange},this._visualRangeStretch=i.visualRangeStretch??!0,r==="array")this.source=new uh(this);else if(r==="stream")this.source=new yE(this);else throw new Error("Unknown sourceType. Expected array|stream")}name;colour;source;drawingStyle;width=3;dataHitPoint;tooltip;precision=2;axisRange;lastPxPerPt=-1;_visualRange;_visualRangeStretch;formatValue(e){return e.toFixed(this.precision)}get visualRange(){let e=this._visualRange;const r=this.source.range;let n=!1;if(r.changed)if(this._visualRangeStretch){const i=Math.min(Iu(e.min,r.min),r.min),a=Math.max(Iu(e.max,r.max),r.max);(i!==e.min||a!==e.max)&&(e={min:i,max:a},n=!0)}else fh(r,e)||(e=r,n=!0);return this._visualRange=e,{...e,changed:n}}scaleValue(e){if(this.source===void 0)return e;const r=this.visualRange;return r.min==r.max?.5:Qt(e,r.min,r.max)}add(e){Y(e,"","value"),this.source.add(e),this.plot.plotArea.needsDrawing=!0}clear(){this.source.clear(),this._visualRange={...this.axisRange},this.plot.plotArea.needsDrawing=!0}},sh=class extends bn{constructor(e){super(e,e.canvasEl,"PlotArea");this.plot=e}paddingPx=3;piPi=Math.PI*2;pointerDistanceThreshold=20;lastRangeChange=0;pointer;clear(){this.lastRangeChange=0,this.pointer=void 0}measureSelf(e,r){const n=e.getSize("AxisY");if(n===void 0)return;const i=e.getSize("Legend");if(i===void 0)return;const a=e.getSize("AxisX");if(a!==void 0)return{x:n.width,y:0,width:e.bounds.width-n.width,height:e.bounds.height-i.height-a.height}}onNotify(e,r){e==="measureApplied"&&r===this.plot.axisY&&(this._needsLayout=!0),e==="measureApplied"&&r===this.plot.legend&&(this._needsLayout=!0)}onPointerLeave(){[...this.plot.series.values()].forEach(r=>{r.tooltip=void 0}),this.pointer=void 0,this.plot.legend.onLayoutNeeded()}onPointerMove(e){this.pointer=e,this.plot.legend.onLayoutNeeded()}measurePreflight(){this.updateTooltip()}updateTooltip(){const e=this.pointer;if(e===void 0)return;[...this.plot.series.values()].forEach(n=>{if(e===void 0){n.tooltip=void 0;return}if(n.dataHitPoint===void 0)return;const i=n.dataHitPoint(e);i[0]!==void 0&&(i[1]>this.pointerDistanceThreshold||(n.tooltip=n.formatValue(i[0].value)))}),this.plot.legend.needsDrawing=!0}drawSelf(e){if(this.plot.frozen)return;const r=this.plot.seriesArray();e.clearRect(0,0,this.visual.width,this.visual.height),r.forEach(n=>{if(n.source.type==="array"||n.source.type==="stream"){const i=n.source;if(i.data===void 0)return;const a=[...i.data];this.drawDataSet(n,a,e)}else console.warn(`Unknown data source type ${n.source.type}`)})}computeY(e,r){const n=e.scaleValue(r);return gi(n)*this.visual.height+this.paddingPx}drawDataSet(e,r,n){const i=this.paddingPx+e.width,a=ye.subtract(this.visual,i*2,i*3.5),u=a.width/r.length;e.lastPxPerPt=u;let o=i;n.strokeStyle=e.colour,n.lineWidth=e.width;const s=[];if(e.dataHitPoint=c=>{const l=s.map(y=>O.distanceToExterior(c,y)),f=xh(...l);return[s[f],l[f]]},e.drawingStyle==="line"){let c=0;n.beginPath();for(let l=0;l<r.length;l++){const f=Rt(e.scaleValue(r[l]));c=i+this.paddingPx+a.height*gi(f),s.push({x:o,y:c,index:l,value:r[l]}),l==0?n.moveTo(o+u/2,c):n.lineTo(o+u/2,c),c>this.visual.height&&console.warn(c+" h: "+this.visual.height),o+=u}n.strokeStyle=e.colour,n.stroke()}else if(e.drawingStyle==="dotted"){let c=0;n.fillStyle=e.colour;for(let l=0;l<r.length;l++){const f=e.scaleValue(r[l]);c=i+a.height*gi(f),n.beginPath(),n.arc(o+u/2,c,e.width,0,this.piPi),n.fill(),s.push({radius:e.width,x:o,y:c,index:l,value:r[l]}),o+=u}}else if(e.drawingStyle==="bar"){n.fillStyle=e.colour;const c=Math.ceil(u*.1);for(let l=0;l<r.length;l++){const f=e.scaleValue(r[l]),h=a.height*f,y={x:o+c,y:a.height-h+i,width:u-c,height:h,index:l,value:r[l]};n.fillRect(y.x,y.y,y.width,y.height),s.push(y),o+=u}}}},ch=class extends bn{constructor(e){super(e,e.canvasEl,"Legend");this.plot=e}sampleSize={width:10,height:10};padding=3;widthSnapping=20;clear(){}measureSelf(e,r){const n=e.measurements.get("AxisY"),i=this.sampleSize,a=this.widthSnapping,u=this.padding,o=e.ctx;if(n===void 0)return;const s=e.bounds.width-n.size.width,c=this.plot.seriesArray();let l=u;for(let y=0;y<c.length;y++)l+=i.width+u,l+=tn(o,c[y].name,u,a),l+=tn(o,c[y].tooltip,u,a);const h=Math.max(1,Math.ceil(l/s))*(this.sampleSize.height+this.padding+this.padding);return{x:n.size.width,y:e.bounds.height-h,width:s,height:h}}drawSelf(e){const r=this.plot.seriesArray(),n=this.sampleSize,i=this.padding,a=this.widthSnapping;let u=i,o=i;e.clearRect(0,0,this.visual.width,this.visual.height);for(let s=0;s<r.length;s++){const c=r[s];e.fillStyle=c.colour,e.fillRect(u,o,n.width,n.height),u+=n.width+i,e.textBaseline="middle",e.fillText(c.name,u,o+n.height/2),u+=tn(e,c.name,i,a),c.tooltip&&(e.fillStyle=this.plot.axisColour,e.fillText(c.tooltip,u,o+n.height/2),u+=tn(e,c.tooltip,i,a)),u+=i,u>this.visual.width-100&&(u=i,o+=n.height+i+i)}}onNotify(e,r){e==="measureApplied"&&r===this._parent.axisY&&(this._needsLayout=!0)}},lh=class extends bn{constructor(e){super(e,e.canvasEl,"AxisX");this.plot=e}paddingPx=2;colour;clear(){}onNotify(e,r){e==="measureApplied"&&r===this.plot.axisY&&(this._needsLayout=!0),e==="measureApplied"&&r===this.plot.legend&&this.onLayoutNeeded()}drawSelf(e){const r=this.plot,n=this.visual,i=r.axisWidth,a=this.colour??r.axisColour;e.strokeStyle=a,e.clearRect(0,0,n.width,n.height),e.beginPath(),e.lineWidth=i,e.moveTo(0,i/2),e.lineTo(n.width,i/2),e.stroke()}measureSelf(e,r){const n=this.plot,i=e.measurements.get("AxisY");if(i===void 0)return;const a=e.measurements.get("Legend");if(a===void 0)return;const u=n.axisWidth+this.paddingPx;return{x:i.size.width,y:e.bounds.height-u-a.size.height,width:e.bounds.width-i.size.width,height:u}}},fh=(e,r)=>e.max===r.max&&e.min===r.min,mE=e=>e.max===e.min,hh=class extends bn{constructor(e){super(e,e.canvasEl,"AxisY");this.plot=e,this.lastRange={min:0,max:0}}_maxDigits=1;seriesToShow;paddingPx=2;colour;lastRange;lastPlotAreaHeight=0;clear(){this.lastRange={min:0,max:0},this.lastPlotAreaHeight=0}measurePreflight(){const e=this.getSeries();e!==void 0&&!fh(e.visualRange,this.lastRange)&&(this._needsLayout=!0,this.needsDrawing=!0)}onNotify(e,r){const n=this.plot.plotArea;e==="measureApplied"&&r===n&&n.visual.height!==this.lastPlotAreaHeight&&(this.lastPlotAreaHeight=n.visual.height,this.needsDrawing=!0)}measureSelf(e){const r=e,n=this.paddingPx;let i=this.plot.axisWidth+n;const a=this.getSeries();if(a!==void 0){const o=a.visualRange;this._maxDigits=Math.ceil(o.max).toString().length+a.precision+1;const s="9".repeat(this._maxDigits);i+=tn(r.ctx,s,n*2)}const u=e.resolveToPx(this.desiredSize?.width,i);return{x:0,y:0,width:u,height:e.bounds.height}}drawSelf(e){const r=this.getSeries();if(r!==void 0)this.seriesAxis(r,e);else{if(this.seriesToShow===void 0)return;console.warn(`Plot AxisY series '${this.seriesToShow}' is missing.`)}}getSeries(){return this.seriesToShow===void 0?this.plot.seriesArray()[0]:this.plot.series.get(this.seriesToShow)}seriesAxis(e,r){const n=this.plot,i=n.plotArea,a=this.visual,u=this.paddingPx,o=e.visualRange,s=n.axisWidth,c=this.colour??n.axisColour;if(r.strokeStyle=c,r.fillStyle=c,Number.isNaN(o.min)&&Number.isNaN(o.max))return;this.lastRange=o,r.clearRect(0,0,a.width,a.height),r.beginPath(),r.lineWidth=s;const l=a.width-s/2;r.moveTo(l,i.paddingPx+s),r.lineTo(l,i.visual.height+s),r.stroke(),r.textBaseline="top";const f=a.width-u*4;mE(o)?Ya(r,e.formatValue(o.max),h=>[f-h.width,i.computeY(e,o.max)-u*4]):(Ya(r,e.formatValue(o.max),h=>[f-h.width,i.computeY(e,o.max)+s/2]),Ya(r,e.formatValue(o.min),h=>[f-h.width,i.computeY(e,o.min)-5]))}},Ya=(e,r,n)=>{const i=e.measureText(r),a=n(i);e.fillText(r,a[0],a[1])},gE=class extends bn{plotArea;legend;axisX;axisY;axisColour;axisWidth;series;_frozen=!1;defaultSeriesOpts;constructor(e,r={}){if(e===void 0)throw new Error("canvasEl undefined");super(void 0,e,"Plot");r.autoSize&&Co(e,n=>{this.update(!0)}),this.axisColour=r.axisColour??"black",this.axisWidth=r.axisWidth??3,this.series=new Map,this.plotArea=new sh(this),this.legend=new ch(this),this.axisX=new lh(this),this.axisY=new hh(this)}clearSeries(){for(const e of this.series.values())e.clear()}clear(){this.series=new Map,this.plotArea.clear(),this.legend.clear(),this.axisX.clear(),this.axisY.clear(),this.update(!0)}get frozen(){return this._frozen}set frozen(e){this._frozen=e,e?(this.canvasEl.classList.add("frozen"),this.canvasEl.title="Plot frozen. Tap to unfreeze"):(this.canvasEl.title="",this.canvasEl.classList.remove("frozen"))}seriesArray(){return[...this.series.values()]}get seriesLength(){return this.series.size}plot(e){as(e).forEach(n=>{let i=this.series.get(n);i===void 0&&(i=this.createSeries(n,"stream"),i.drawingStyle="line"),i.add(Ia(e,n))})}createSeriesFromObject(e,r=""){const n=Object.keys(e),i=a=>{const u=e[a];return typeof u=="object"?this.createSeriesFromObject(u,r+a+"."):typeof u=="number"?[this.createSeries(a,"stream")]:[]};return n.flatMap(i)}createSeries(e,r="array",n){const i=this.seriesLength;if(e===void 0&&(e=`series-${i}`),this.series.has(e))throw new Error(`Series name '${e}' already in use`);let a={colour:`hsl(${i*25%360}, 70%,50%)`,...n};this.defaultSeriesOpts&&(a={...this.defaultSeriesOpts,...a});const u=new oh(e,r,this,a);return this.series.set(e,u),this.setReady(!0,!0),this.plotArea.needsDrawing=!0,u}},Wo={};Z(Wo,{create:()=>pE});var pE=e=>new wE(e),wE=class{#e=new Map;#t=new Map;fallbacks;#r=0;#n;constructor(e){e!==void 0?this.fallbacks=e:this.fallbacks=["red","blue","green","orange"],this.#n=document.body}setElementBase(e){this.#n=e}add(e,r){this.#e.set(e,r)}alias(e,r){this.#t.set(e,r)}get(e,r){const n=this.#t.get(e);n!==void 0&&(e=n);const i=this.#e.get(e);if(i!==void 0)return i;const a="--"+e;let u=getComputedStyle(this.#n).getPropertyValue(a).trim();if(u===void 0||u.length===0){if(r!==void 0)return r;u=this.fallbacks[this.#r],this.#r++,this.#r===this.fallbacks.length&&(this.#r=0)}return u}getOrAdd(e,r){if(this.has(e))return this.get(e);const n=this.get(e,r);return this.add(e,n),n}has(e){return this.#e.has(e)}},ko={};Z(ko,{accessor:()=>VE});var Oo={};Z(Oo,{access1dArray:()=>TE,allDirections:()=>va,array2dUpdater:()=>qE,asRectangles:()=>CE,cellAtPoint:()=>Dh,cellEquals:()=>ph,cellFromIndex:()=>UE,cellKeyString:()=>gh,cellMiddle:()=>ME,cells:()=>Cn,crossDirections:()=>bh,getLine:()=>IE,getVectorFromCardinal:()=>ya,guardCell:()=>er,indexFromCell:()=>ma,inside:()=>wh,isEqual:()=>AE,neighbours:()=>Ah,offset:()=>An,offsetCardinals:()=>_E,rectangleForCell:()=>Eh,rows:()=>$E,simpleLine:()=>PE,toArray:()=>FE,visitArray:()=>jE,visitFor:()=>OE,visitNeigbours:()=>SE,visitor:()=>Yr,visitorBreadth:()=>NE,visitorColumn:()=>LE,visitorDepth:()=>BE,visitorRandom:()=>WE,visitorRandomContiguous:()=>zE,visitorRow:()=>kE});var dh={};Z(dh,{MutableStringSet:()=>yh,StringSet:()=>mh,immutable:()=>EE,mutable:()=>vh});var vh=e=>new yh(e),yh=class extends tr{store=new Map;keyString;constructor(e){super();this.keyString=e??ui}get size(){return this.store.size}add(...e){e.forEach(r=>{const n=this.has(r);this.store.set(this.keyString(r),r),super.fireEvent("add",{value:r,updated:n})})}values(){return this.store.values()}clear(){this.store.clear(),super.fireEvent("clear",!0)}delete(e){const r=this.store.delete(this.keyString(e));return r&&super.fireEvent("delete",e),r}has(e){return this.store.has(this.keyString(e))}toArray(){return Array.from(this.store.values())}},mh=class bu{store;keyString;constructor(r,n){this.store=n??new Map,this.keyString=r??ui}get size(){return this.store.size}add(...r){const n=new Map(this.store);for(const i of r){const a=this.keyString(i);n.set(a,i)}return new bu(this.keyString,n)}delete(r){const n=new Map(this.store),i=this.keyString(r);return n.delete(i)?new bu(this.keyString,n):this}has(r){const n=this.keyString(r);return this.store.has(n)}toArray(){return[...this.store.values()]}*values(){yield*this.store.values()}},EE=e=>new mh(e),DE=e=>e===void 0?!1:"x"in e&&"y"in e,bE=e=>!(e===void 0||e[1]===void 0),AE=(e,r)=>{if(r===void 0||e===void 0)return!1;if("rows"in e&&"cols"in e)if("rows"in r&&"cols"in r){if(e.rows!==r.rows||e.cols!==r.cols)return!1}else return!1;if("size"in e)if("size"in r){if(e.size!==r.size)return!1}else return!1;return!0},gh=e=>`Cell{${e.x},${e.y}}`,ph=(e,r)=>r===void 0||e===void 0?!1:e.x===r.x&&e.y===r.y,er=(e,r="Param",n)=>{if(e===void 0)throw new Error(r+" is undefined. Expecting {x,y}");if(e.x===void 0)throw new Error(r+".x is undefined");if(e.y===void 0)throw new Error(r+".y is undefined");if(!Number.isInteger(e.x))throw new Error(r+".x is non-integer");if(!Number.isInteger(e.y))throw new Error(r+".y is non-integer");if(n!==void 0&&!wh(n,e))throw new Error(`${r} is outside of grid. Cell: ${e.x},${e.y} Grid: ${n.cols}, ${n.rows}`)},ni=(e,r="Param")=>{if(e===void 0)throw new Error(`${r} is undefined. Expecting grid.`);if(!("rows"in e))throw new Error(`${r}.rows is undefined`);if(!("cols"in e))throw new Error(`${r}.cols is undefined`);if(!Number.isInteger(e.rows))throw new Error(`${r}.rows is not an integer`);if(!Number.isInteger(e.cols))throw new Error(`${r}.cols is not an integer`)},wh=(e,r)=>!(r.x<0||r.y<0||r.x>=e.cols||r.y>=e.rows),Eh=(e,r)=>{er(e);const n=r.size,i=e.x*n,a=e.y*n;return ye.fromTopLeft({x:i,y:a},n,n)};function*CE(e){for(const r of Cn(e))yield Eh(r,e)}var FE=(e,r)=>{const n=[];for(let i=0;i<e.rows;i++)if(n[i]=new Array(e.cols),r)for(let a=0;a<e.cols;a++)n[i][a]=r;return n},Dh=(e,r)=>{const n=e.size;if(r.x<0||r.y<0)return;const i=Math.floor(r.x/n),a=Math.floor(r.y/n);if(!(i>=e.cols)&&!(a>=e.rows))return{x:i,y:a}},va=Object.freeze(["n","ne","nw","e","s","se","sw","w"]),bh=Object.freeze(["n","e","s","w"]),Ah=(e,r,n="undefined",i)=>{const a=i??va,u=a.map(o=>An(e,r,ya(o),n));return ku(a,u)};function*SE(e,r,n="undefined",i){const u=(i??va).map(o=>An(e,r,ya(o),n));for(const o of u)o!==void 0&&(yield o)}var ME=(e,r)=>{er(e);const n=r.size,i=e.x*n,a=e.y*n;return Object.freeze({x:i+n/2,y:a+n/2})},IE=(e,r)=>{er(e),er(r);let n=e.x,i=e.y;const a=Math.abs(r.x-n),u=Math.abs(r.y-i),o=n<r.x?1:-1,s=i<r.y?1:-1;let c=a-u;const l=[];for(;l.push(Object.freeze({x:n,y:i})),!(n===r.x&&i===r.y);){const f=2*c;f>-u&&(c-=u,n+=o),f<a&&(c+=a,i+=s)}return l},_E=(e,r,n,i="stop")=>{ni(e,"grid"),er(r,"start"),Ee(n,"aboveZero","steps");const a=va,u=a.map(s=>ya(s,n)),o=a.map((s,c)=>An(e,r,u[c],i));return ku(a,o)},ya=(e,r=1)=>{let n;switch(e){case"n":n={x:0,y:-1*r};break;case"ne":n={x:1*r,y:-1*r};break;case"e":n={x:1*r,y:0};break;case"se":n={x:1*r,y:1*r};break;case"s":n={x:0,y:1*r};break;case"sw":n={x:-1*r,y:1*r};break;case"w":n={x:-1*r,y:0};break;case"nw":n={x:-1*r,y:-1*r};break;default:n={x:0,y:0}}return Object.freeze(n)},PE=function(e,r,n=!1){const i=[];if(e.x===r.x){const a=n?r.y+1:r.y;for(let u=e.y;u<a;u++)i.push({x:e.x,y:u})}else if(e.y===r.y){const a=n?r.x+1:r.x;for(let u=e.x;u<a;u++)i.push({x:u,y:e.y})}else throw new Error(`Only does vertical and horizontal: ${e.x},${e.y} - ${r.x},${r.y}`);return i},An=function(e,r,n,i="undefined"){er(r,"start",e),er(n),ni(e,"grid");let a=r.x,u=r.y;switch(i){case"wrap":a+=n.x%e.cols,u+=n.y%e.rows,a<0?a=e.cols+a:a>=e.cols&&(a-=e.cols),u<0?u=e.rows+u:u>=e.rows&&(u-=e.rows);break;case"stop":a+=n.x,u+=n.y,a=Qa(a,e.cols),u=Qa(u,e.rows);break;case"undefined":if(a+=n.x,u+=n.y,a<0||u<0||a>=e.cols||u>=e.rows)return;break;case"unbounded":a+=n.x,u+=n.y;break;default:throw new Error(`Unknown BoundsLogic case ${i}`)}return Object.freeze({x:a,y:u})},RE=(e,r,n,i)=>{const a=Ah(e,r,i,n);return Object.entries(a).filter(bE)},Yr=function*(e,r,n,i={}){ni(r,"grid"),er(n,"start",r);const a=i.visited??vh(l=>gh(l)),u=e.options?e.options:(l,f)=>RE(l,f,bh,"undefined");if(!DE(n))throw new Error("'start' parameter is undefined or not a cell");let o=[n],s=[],c=null;for(;o.length>0;){if(c===null){const l=o.pop();if(l===void 0)break;c=l}if(!a.has(c)){a.add(c),yield c;const l=u(r,c).filter(f=>!a.has(f[1]));l.length===0?c!==null&&(o=o.filter(f=>ph(f,c))):s.push(...l)}if(s=s.filter(l=>!a.has(l[1])),s.length===0)c=null;else{const l=e.select(s);l!==void 0&&(o.push(l[1]),c=l[1])}}},BE=(e,r,n={})=>Yr({select:i=>i[i.length-1]},e,r,n),NE=(e,r,n={})=>Yr({select:i=>i[0]},e,r,n),Ch=e=>cs(e),zE=(e,r,n={})=>Yr({select:Ch},e,r,n),WE=(e,r,n={})=>Yr({options:(i,a)=>{const u=[];for(const o of Cn(i,a))u.push(["n",o]);return u},select:Ch},e,r,n),kE=(e,r={x:0,y:0},n={})=>{const{reversed:i=!1}=n;return Yr({select:s=>s.find(c=>c[0]===(i?"w":"e")),options:(s,c)=>(i?c.x>0?c={x:c.x-1,y:c.y}:c.y>0?c={x:s.cols-1,y:c.y-1}:c={x:s.cols-1,y:s.rows-1}:c.x<s.rows-1?c={x:c.x+1,y:c.y}:c.y<s.rows-1?c={x:0,y:c.y+1}:c={x:0,y:0},[[i?"w":"e",c]])},e,r,n)},OE=(e,r,n,i)=>{Ee(n,"","steps");const a={reversed:n<0};n=Math.abs(n);let u=r,o=i(e,r,a);o.next();let s=0;for(;s<n;){s++;const{value:c}=o.next();if(c)u=c,a.debug&&console.log(`stepsMade: ${s} cell: ${u.x}, ${u.y} reverse: ${a.reversed}`);else if(n>=e.cols*e.rows)n-=e.cols*e.rows,s=0,o=i(e,r,a),o.next(),u=r,a.debug&&console.log(`resetting visitor to ${n}`);else throw new Error("Value not received by visitor")}return u},LE=(e,r,n={})=>{const{reversed:i=!1}=n;return Yr({select:u=>u.find(o=>o[0]===(i?"n":"s")),options:(u,o)=>(i?o.y>0?o={x:o.x,y:o.y-1}:o.x===0?o={x:u.cols-1,y:u.rows-1}:o={x:o.x-1,y:u.rows-1}:o.y<u.rows-1?o={x:o.x,y:o.y+1}:o.x<u.cols-1?o={x:o.x+1,y:0}:o={x:0,y:0},[[i?"n":"s",o]])},e,r,n)},$E=function*(e,r={x:0,y:0}){let n=r.y,i=[];for(const a of Cn(e,r))a.y!==n?(yield i,i=[a],n=a.y):i.push(a);i.length>0&&(yield i)},Cn=function*(e,r={x:0,y:0}){ni(e,"grid"),er(r,"start",e);let{x:n,y:i}=r,a=!0;do yield{x:n,y:i},n++,n===e.cols&&(i++,n=0),i===e.rows&&(i=0,n=0),n===r.x&&i===r.y&&(a=!1);while(a)},TE=(e,r)=>{const n={cols:r,rows:Math.ceil(e.length/r)};return(a,u)=>{const o=ma(n,a,u);if(o!==void 0)return e[o]}},qE=(e,r)=>(i,a)=>{const u=Dh(e,a);if(u===void 0)throw new Error(`Position does not exist. Pos: ${JSON.stringify(a)} Grid: ${JSON.stringify(e)}`);r[u.y][u.x]=i};function*jE(e,r,n,i){if(typeof e>"u")throw Error("First parameter is undefined, expected an array");if(e===null)throw Error("First parameter is null, expected an array");if(!Array.isArray(e))throw Error("First parameter should be an array");if(Ee(r,"aboveZero","cols"),e.length===0)return;const a=i?.boundsWrap??"stop",u=Math.ceil(e.length/r),o={cols:r,rows:u};n===void 0&&(n=Cn);const s=n(o,{x:0,y:0},i);for(const c of s){const l=ma(o,c,a);if(l===void 0)return;yield[e[l],l]}}var ma=(e,r,n)=>{if(ni(e,"grid"),r.x<0)switch(n){case"stop":r={...r,x:0};break;case"unbounded":throw new Error("unbounded not supported");case"undefined":return;case"wrap":r=An(e,{x:0,y:r.y},{x:r.x,y:0},"wrap");break}if(r.y<0)switch(n){case"stop":r={...r,y:0};break;case"unbounded":throw new Error("unbounded not supported");case"undefined":return;case"wrap":r={...r,y:e.rows+r.y};break}if(r.x>=e.cols)switch(n){case"stop":r={...r,x:e.cols-1};break;case"unbounded":throw new Error("unbounded not supported");case"undefined":return;case"wrap":r={...r,x:r.x%e.cols};break}if(r.y>=e.rows)switch(n){case"stop":r={...r,y:e.rows-1};break;case"unbounded":throw new Error("unbounded not supported");case"undefined":return;case"wrap":r={...r,y:r.y%e.rows};break}return r.y*e.cols+r.x},UE=(e,r)=>{let n=0;return typeof e=="number"?n=e:n=e.cols,Ee(n,"aboveZero","colsOrGrid"),{x:r%n,y:Math.floor(r/n)}},VE=e=>{const r={rows:e.width,cols:e.height},n=e.data;return(a,u)=>{const o=ma(r,a,u);if(o===void 0)return;const s=o*4;return{r:n[s],g:n[s+1],b:n[s+2],opacity:n[s+3]}}};try{typeof window<"u"&&(window.ixfx={...window.ixfx,Visuals:{SceneGraph:zo,Plot2:No,Drawing:ta,Svg:Io,Plot:Ro,Palette:Wo,Colour:ti,Video:oo}})}catch{}var xE={};Z(xE,{DragDrop:()=>Ih,Forms:()=>Fh,canvasHelper:()=>P1,cardinalPosition:()=>M1,clear:()=>$1,copyToClipboard:()=>q1,createAfter:()=>W1,createIn:()=>k1,cycleCssClass:()=>B1,dataTable:()=>L1,dataTableList:()=>O1,defaultErrorHandler:()=>nD,fullSizeCanvas:()=>R1,fullSizeElement:()=>Bf,getTranslation:()=>z1,log:()=>KE,parentSize:()=>N1,parentSizeCanvas:()=>Co,pointScaler:()=>_f,pointerVisualise:()=>rD,positionFn:()=>Pf,positionFromMiddle:()=>_1,positionRelative:()=>I1,reconcileChildren:()=>j1,resizeObservable:()=>Fo,resolveEl:()=>Le,rx:()=>JE,themeChangeObservable:()=>T1,viewportToSpace:()=>Rf,windowResize:()=>la});var HE=(e,r)=>{const n=document.createElement("style");n.textContent=r;let i;return e.shadowRoot?(i=e.shadowRoot,i.innerHTML=""):i=e.attachShadow({mode:"open"}),i.appendChild(n),i},KE=(e,r={})=>{const{capacity:n=0,monospaced:i=!0,timestamp:a=!1,collapseDuplicates:u=!0,css:o=""}=r;let s=0,c,l=0;const f=Le(e),y=HE(f,`
  .log {
    font-family: ${i?'Consolas, "Andale Mono WT", "Andale Mono", "Lucida Console", "Lucida Sans Typewriter", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Liberation Mono", Monaco, "Courier New", Courier, monospace':"normal"};
    background-color: var(--code-background-color);
    padding: var(--padding1, 0.2em);
    overflow-y: auto;
    height:100%;
  }
  .timestamp {
    margin-right: 0.5em;
    opacity: 0.5;
    font-size: 70%;
    align-self: center;
  }
  .line {
    display: flex;
    padding-bottom: 0.1em;
    padding-top: 0.1em;
  }
  .line:hover {
  
  }
  .error {
    color: red;
  }
  .badge {
    border: 1px solid currentColor;
    align-self: center;
    font-size: 70%;
    padding-left: 0.2em;
    padding-right: 0.2em;
    border-radius: 1em;
    margin-left: 0.5em;
    margin-right: 0.5em;
  }
  .msg {
    flex: 1;
    word-break: break-word;
  }
  ${o}
  `),D=document.createElement("div");D.className="log",y.append(D);const P=L=>{const W=document.createElement("div");if(typeof L=="string")W.innerHTML=L;else if(L instanceof Error){const $=L.stack;$===void 0?W.innerHTML=L.toString():W.innerHTML=$.toString()}else W.innerHTML=L;W.classList.add("error"),b(W),c=void 0,l=0};let q=0;const N=(L="")=>{let W;const $=window.performance.now()-q;if(!(r.minIntervalMs&&$<r.minIntervalMs))if(q=window.performance.now(),typeof L=="object"?W=JSON.stringify(L):L===void 0?W="(undefined)":L===null?W="(null)":typeof L=="number"?(Number.isNaN(W)&&(W="(NaN)"),W=L.toString()):W=L,W.length===0){const E=document.createElement("hr");c=void 0,b(E)}else if(W===c&&u){const E=D.firstElementChild;let I=E.querySelector(".badge");return I===null&&(I=document.createElement("div"),I.className="badge",E.insertAdjacentElement("beforeend",I)),E!==null&&(I.textContent=(++l).toString()),E}else{const E=document.createElement("div");return E.innerText=W,b(E),c=W,E}},b=L=>{if(a){const W=document.createElement("div"),$=document.createElement("div");$.className="timestamp",$.innerText=new Date().toLocaleTimeString(),W.append($,L),L.classList.add("msg"),W.classList.add("line"),L=W}else L.classList.add("line","msg");if(r.reverse?D.appendChild(L):D.insertBefore(L,D.firstChild),n>0&&++s>n*2)for(;s>n;)D.lastChild?.remove(),s--;r.reverse&&(D.scrollTop=D.scrollHeight),l=0};return{error:P,log:N,append:b,clear:()=>{D.innerHTML="",c=void 0,l=0,s=0},dispose:()=>{D.remove()},get isEmpty(){return s===0}}},JE=(e,r,n)=>{const i=Le(e),a=Wi(i,r),u={},o=()=>{Object.keys(u).forEach(l=>{delete u[l]})},s=c=>(c.subscribe({next:l=>{Object.assign(u,l)}}),{value:u,clear:o});return n===void 0?s(a):n.pluck?s(a.pipe(zi(c=>c[n.pluck]))):n.transform?s(a.pipe(zi(c=>n.transform(c)))):s(a)},Fh={};Z(Fh,{button:()=>ZE,checkbox:()=>YE,numeric:()=>XE,select:()=>QE,textAreaKeyboard:()=>GE});var GE=e=>{e.addEventListener("keydown",r=>{const n=e.value,i=e.selectionStart,a=e.selectionEnd;if(r.key==="Tab"&&r.shiftKey)return e.value.substring(i-2,i)==="  "&&(e.value=n.substring(0,i-2)+n.substring(a)),e.selectionStart=e.selectionEnd=i-2,r.preventDefault(),!1;if(r.key==="Tab")return e.value=n.substring(0,i)+"  "+n.substring(a),e.selectionStart=e.selectionEnd=i+2,r.preventDefault(),!1})},YE=(e,r)=>{const n=Le(e);return r&&n.addEventListener("change",()=>{r(n.checked)}),{get checked(){return n.checked},set checked(i){n.checked=i}}},XE=(e,r,n)=>{const i=Le(e),a=n?"change":"input";return r&&i.addEventListener(a,()=>{r(parseInt(i.value))}),{get value(){return parseInt(i.value)},set value(u){i.value=u.toString()}}},ZE=(e,r)=>{const n=Le(e);return r&&n.addEventListener("click",i=>{r()}),{click(){r&&r()},set disabled(i){n.disabled=i}}},QE=(e,r,n={})=>{const i=Le(e),{placeholderOpt:a,shouldAddChoosePlaceholder:u=!1,autoSelectAfterChoice:o=-1}=n,s=()=>{r!==void 0&&r(i.value),o>=0&&(i.selectedIndex=o)};return r&&i.addEventListener("change",c=>{s()}),{set disabled(c){i.disabled=c},get value(){return i.value},get index(){return i.selectedIndex},get isSelectedPlaceholder(){return(u||n.placeholderOpt!==void 0)&&i.selectedIndex===0},setOpts(c,l){i.options.length=0,u?c=["-- Choose --",...c]:a!==void 0&&(c=[a,...c]);let f=0;c.forEach((h,y)=>{const D=document.createElement("option");D.value=h,D.innerHTML=h,l!==void 0&&h===l&&(f=y),i.options.add(D)}),i.selectedIndex=f},select(c=0,l=!1){i.selectedIndex=c,l&&r&&s()}}},eD=class extends ju{values;constructor(e={}){super(e);this.values=[]}onTrimmed(){}trimStore(e){return e>=this.values.length?this.values.length:(this.values=this.values.slice(-e),this.values.length)}onReset(){this.values=[]}seenImpl(e){const r=e.map(i=>"at"in i?i:{...i,at:Date.now()}),n=r.at(-1);return this.storeIntermediate?this.values.push(...r):this.values.length===0?this.values.push(n):this.values.length===2?this.values[1]=n:this.values.length===1&&this.values.push(n),r}get last(){return this.values.length===1?this.values[0]:this.values.at(-1)}get initial(){return this.values.at(0)}get size(){return this.values.length}get elapsed(){return Date.now()-this.values[0].at}},Lo=class extends eD{initialRelation;lastResult;constructor(e={}){super(e)}onTrimmed(){this.initialRelation=void 0}get x(){return this.last.x}get y(){return this.last.y}onReset(){super.onReset(),this.lastResult=void 0,this.initialRelation=void 0}seen(...e){const r=this.last;super.seen(...e);const n=this.last;if(this.initialRelation===void 0&&this.initial)this.initialRelation=Su(this.initial);else if(this.initialRelation===void 0)throw new Error("Bug: No initialRelation, and this.inital is undefined?");const i=Su(r),a={...this.initialRelation(n)},u={...i(n),speed:this.values.length<2?0:Ke.length(r,n)/(n.at-r.at)},o={fromInitial:a,fromLast:u,values:[...this.values]};return this.lastResult=o,o}get line(){return this.values.length===1?[]:Ke.joinPointsToLines(...this.values)}get vectorPolar(){return qi.fromLinePolar(this.lineStartEnd)}get vectorCartesian(){return qi.fromLineCartesian(this.lineStartEnd)}get lineStartEnd(){const e=this.initial;return this.values.length<2||!e?Ke.Empty:{a:e,b:this.last}}distanceFromStart(){const e=this.initial;return this.values.length>=2&&e!==void 0?Bt(e,this.last):0}difference(){const e=this.initial;return this.values.length>=2&&e!==void 0?Nr(this.last,e):gd}angleFromStart(){const e=this.initial;if(e!==void 0&&this.values.length>2)return ln(e,this.last)}get length(){if(this.values.length===1)return 0;const e=this.line;return Ke.length(e)}},Sh=class extends jc{constructor(e={}){super((r,n)=>{if(n===void 0)throw new Error("Requires start point");const i=new Lo({...e,id:r});return i.seen(n),i})}},Mh=(e={})=>new Sh(e),tD=(e={})=>new Lo(e),rD=(e,r={})=>{const n=r.touchRadius??45,i=r.touchRadius??20,a=r.trace??!1,u=r.hue??100,o=`hsla(${u}, 100%, 10%, 10%)`;let s=u;const c=Le(e),l=Mh({storeIntermediate:a}),f=document.createElementNS("http://www.w3.org/2000/svg","svg");f.id="pointerVis",f.style.zIndex="-1000",f.style.position="fixed",f.style.top="0",f.style.left="0",f.style.width="100%",f.style.height="100%",f.style.boxSizing="border-box",f.style.border="3px solid red",f.style.pointerEvents="none",f.style.touchAction="none",Bf(f);let h=0;const y=async P=>{const q=P.pointerId.toString();l.delete(q),s=u,f.querySelector(`#pv-start-${q}`)?.remove();for(let N=0;N<h+10;N++)f.querySelector(`#pv-progress-${q}-${N}`)?.remove();h=0},D=async P=>{const q=P.pointerId.toString(),N={x:P.x,y:P.y},b=P.pointerType;if(P.type==="pointermove"&&!l.has(q))return;const M=await l.seen(q,N);if(M.values.length===1){const W=ki.circle({...M.values[0],radius:b==="touch"?n:i},f,{fillStyle:o},`#pv-start-${q}`);W.style.pointerEvents="none",W.style.touchAction="none"}const B=`hsla(${s}, 100%, 50%, 50%)`,L=ki.circle({...N,radius:b==="touch"?n:i},f,{fillStyle:B},`#pv-progress-${q}-${M.values.length}`);return L.style.pointerEvents="none",L.style.touchAction="none",s+=1,h=M.values.length,!0};document.body.appendChild(f),c.addEventListener("pointerdown",D),c.addEventListener("pointermove",D),c.addEventListener("pointerup",y),c.addEventListener("pointerleave",y),c.addEventListener("contextmenu",P=>{P.preventDefault()})},nD=()=>{let e=!0;const r=document.createElement("div");r.style.color="black",r.style.border="2px solid red",r.style.backgroundColor="hsl(0, 80%, 90%)",r.style.padding="1em",r.style.display="none",r.style.top="1em",r.style.left="1em",r.style.position="absolute",r.style.fontFamily="monospace";const n=document.createElement("div");n.style.maxWidth="50vw",n.style.maxHeight="50vh",n.style.overflowY="scroll",r.innerHTML="<h1>Error</h1>",r.append(n);const i=c=>{c.style.padding="0.3em",c.style.marginTop="1em"},a=document.createElement("button");a.innerText="Close",a.onclick=()=>{s()};const u=document.createElement("button");u.innerText="Stop displaying errors",u.onclick=()=>{e=!1,s()},i(a),i(u),r.append(a),r.append(u),document.body.append(r);const o=c=>{r.style.display="inline",c.stack?n.innerHTML+=`<pre>${c.stack}</pre>`:n.innerHTML+=`<p>${c}</p>`},s=()=>{r.style.display="none"};return window.onerror=(c,l,f,h,y)=>{e&&(y?(console.log(y),o(y)):(console.log(c),o(c)))},window.addEventListener("unhandledrejection",c=>{console.log(c.reason),e&&o(c.reason)}),{show:o,hide:s}},Ih={};Z(Ih,{draggable:()=>iD});var iD=(e,r)=>{let n=O.Placeholder,i;const a=()=>{e.classList.contains("drag-sel")&&e.classList.remove("drag-sel")},u=h=>{e.classList.contains("drag-sel")?e.classList.remove("drag-sel"):e.classList.add("drag-sel"),h.stopPropagation()};e.ownerDocument.addEventListener("click",a),e.addEventListener("click",u);const o=()=>{e.classList.remove("drag-progress"),e.ownerDocument.removeEventListener("pointermove",c),e.ownerDocument.removeEventListener("pointerup",l),e.ownerDocument.removeEventListener("pointercancel",f)},s=()=>{console.log("drag dispose"),e.classList.contains("drag-progress")?f(null,"dispose"):o(),e.ownerDocument.removeEventListener("click",a),e.removeEventListener("click",u)},c=h=>{h.preventDefault(),h.stopPropagation();const D={delta:O.isPlaceholder(n)?{x:h.offsetX,y:h.offsetY}:{x:h.x-n.x,y:h.y-n.y},initial:n,token:i};typeof r.progress<"u"&&!r.progress(D)&&f(null,"discontinued")},l=h=>{o();const y={x:h.x-n.x,y:h.y-n.y},D={initial:n,token:i,delta:y};typeof r.success<"u"&&r.success(D)},f=(h,y="pointercancel")=>{o();const D={token:i,initial:n,delta:{x:-1,y:-1}};typeof r.abort<"u"&&r.abort(y,D)};return e.addEventListener("pointerdown",h=>{if(!e.classList.contains("drag-sel"))return;n={x:h.x,y:h.y};const D=typeof r.start<"u"?r.start():{allow:!0,token:i};!D.allow||(i=D.token,e.classList.add("drag-progress"),e.ownerDocument.addEventListener("pointermove",c),e.ownerDocument.addEventListener("pointerup",l),e.ownerDocument.addEventListener("pointercancel",f))}),s},_h=class extends tr{#e;#t;constructor(e=void 0){super();this.#e=new Map,e===void 0&&(e=r=>{if(r===void 0)throw new Error("Cannot create key for undefined");return typeof r=="string"?r:JSON.stringify(r)}),this.#t=e}clear(){this.#e.clear(),this.fireEvent("change",void 0)}keys(){return this.#e.keys()}values(){return this.#e.values()}toArray(){return Array.from(this.#e.entries())}debugString(){let e="";for(const[r,n]of this.#e.entries())e+=`${r}: ${n}, `;return e.endsWith(", ")?e.substring(0,e.length-2):e}frequencyOf(e){if(typeof e=="string")return this.#e.get(e);const r=this.#t(e);return this.#e.get(r)}relativeFrequencyOf(e){let r;if(typeof e=="string")r=this.#e.get(e);else{const i=this.#t(e);r=this.#e.get(i)}if(r===void 0)return;const n=this.minMaxAvg();return r/n.total}entries(){return Array.from(this.#e.entries())}minMaxAvg(){return $c.minMaxAvg(this.entries())}entriesSorted(e="value"){return qc(e)(this.entries())}add(...e){if(e===void 0)throw new Error("value parameter is undefined");e.map(this.#t).forEach(n=>{const i=this.#e.get(n)??0;this.#e.set(n,i+1)}),this.fireEvent("change",void 0)}},aD=e=>new _h(e),Ph=(e=3)=>{Ee(e,"aboveZero","scaling");let r=0,n=0,i=!1;return{dispose(){i=!0},get isDisposed(){return i},add(u){if(i)throw new Error("MovingAverage disposed, cannot add");return n++,r=r+(u-r)/Math.min(n,e),r},clear(){if(i)throw new Error("MovingAverage disposed, cannot clear");r=0,n=0},compute(){return r}}},uD=(e=200,r=0,n=3)=>{Ee(n,"aboveZero","scaling"),Ee(e,"aboveZero","decayRateMs");const i=Ph(n);let a=0;const u=()=>{a!==0&&clearTimeout(a),a=setTimeout(o,e)},o=()=>{i.add(r),i.isDisposed||setTimeout(o,e)};return{add(c){return u(),i.add(c)},dispose(){i.dispose()},clear:function(){i.clear()},compute:function(){return i.compute()},isDisposed:!1}},oD=(e=100,r)=>{let n=!1,i=xr({capacity:e,discardPolicy:"older"});const a=()=>{i=xr({capacity:e,discardPolicy:"older"})},u=()=>r===void 0?jo(i.data):qo(i.data,r);return{add:c=>(i.enqueue(c),u()),compute:u,clear:a,dispose:()=>{n=!0},isDisposed:n}},Rh=class extends Uu{lastMark=0;mark(){this.lastMark>0&&this.seen(window.performance.now()-this.lastMark),this.lastMark=window.performance.now()}},sD=e=>new Rh(e),gi=e=>(typeof e=="function"&&(e=e()),Y(e,"percentage","v"),1-e),Bh=(e,r=0,n=360)=>(Ee(e,void 0,"v"),Ee(r,void 0,"min"),Ee(n,void 0,"max"),e===r||e===n?r:(e>0&&e<r&&(e+=r),e-=r,n-=r,e=e%n,e<0&&(e=n-Math.abs(e)+r),e+r)),Li=(e,r=0,n=1)=>{if(Y(e,"","min"),Y(r,"","min"),Y(n,"","max"),e===r||e===n)return r;for(;(e<=r||e>=n)&&!(e===n||e===r);)e>n?e=r+(e-n):e<r&&(e=n-(r-e));return e},cD=(e,r,n,i,a)=>{let u=0;const o=Math.abs(a-i),s=Math.abs(r-i+a),c=Math.abs(i+(360-a)),l=Math.min(o,s,c);return l===c?u=i-n(l):l===s?u=i+n(l):i>a?u=i-n(l):u=i+n(l),Bh(u,e,r)},Nh={};Z(Nh,{align:()=>zh,alignById:()=>fD});var lD=(e,r)=>e.score>r.score?-1:e.score<r.score?1:0,zh=(e,r,n,i={})=>{const a=i.matchThreshold??0,u=i.debug??!1,o=new Map,s=[],c=new Map;r?.forEach((l,f)=>{if(l===void 0)throw new Error(`'lastData' contains undefined (index: ${f})`);c.set(l.id,l)});for(let l=0;l<n.length;l++){const f=n[l];if(!r||r.length===0){u&&console.debug(`Correlate.align() new id: ${f.id}`),s.push(f);continue}const h=Array.from(c.values()).map(D=>({id:D.id,score:D===null?-1:e(D,f),last:D}));if(h.length===0){u&&console.debug(`Correlate.align() no valid last values id: ${f.id}`),s.push(f);continue}h.sort(lD);const y=h[0];if(y.score<a){u&&console.debug(`Correlate.align() new item does not reach threshold. Top score: ${y.score} id: ${f.id}`),s.push(f);continue}u&&y.id!==f.id&&console.log(`Correlate.align() Remapped ${f.id} -> ${y.id} (score: ${y.score})`),o.set(y.id,{...f,id:y.id}),c.delete(y.id)}return s.forEach(l=>o.set(l.id,l)),Array.from(o.values())},fD=(e,r={})=>{let n=[];return a=>(n=zh(e,n,a,r),[...n])},Wh={};Z(Wh,{Pool:()=>Lh,PoolUser:()=>kh,Resource:()=>Oh,create:()=>hD});var kh=class extends tr{constructor(e,r){super();this.key=e,this.resource=r,this._lastUpdate=performance.now(),this._pool=r.pool,this._userExpireAfterMs=this._pool.userExpireAfterMs,this._state="idle",this._pool.log.log(`PoolUser ctor key: ${this.key}`)}_lastUpdate;_pool;_state;_userExpireAfterMs;toString(){return this.isDisposed?"PoolUser. State: disposed":`PoolUser. State: ${this._state} Elapsed: ${performance.now()-this._lastUpdate} Data: ${JSON.stringify(this.resource.data)}`}keepAlive(){if(this._state==="disposed")throw new Error("PoolItem disposed");this._lastUpdate=performance.now()}_dispose(e){if(this._state==="disposed")return;const r=this.resource,n=r.data;this._state="disposed",r._release(this),this._pool.log.log(`PoolUser dispose key: ${this.key} reason: ${e}`),this.fireEvent("disposed",{data:n,reason:e}),super.clearEventListeners()}release(e){if(this.isDisposed)throw new Error("User disposed");const n=this.resource.data;this._pool.log.log(`PoolUser release key: ${this.key} reason: ${e}`),this.fireEvent("released",{data:n,reason:e}),this._dispose(`release-${e}`)}get data(){if(this.isDisposed)throw new Error("User disposed");return this.resource.data}get isExpired(){return this._userExpireAfterMs>0?performance.now()>this._lastUpdate+this._userExpireAfterMs:!1}get elapsed(){return performance.now()-this._lastUpdate}get isDisposed(){return this._state==="disposed"}get isValid(){return!(this.isDisposed||this.isExpired||this.resource.isDisposed)}},Oh=class{constructor(e,r){this.pool=e,this._data=r,this.lastUsersChange=0,this.resourcesWithoutUserExpireAfterMs=e.resourcesWithoutUserExpireAfterMs,this.capacityPerResource=e.capacityPerResource,this.users=[],this.state="idle"}state;_data;users;capacityPerResource;resourcesWithoutUserExpireAfterMs;lastUsersChange;get data(){if(this.state==="disposed")throw new Error("Resource disposed");return this._data}toString(){return`Resource (expired: ${this.isExpiredFromUsers} users: ${this.users.length}, state: ${this.state}) data: ${JSON.stringify(this.data)}`}_assign(e){if(this.users.find(n=>n===e||n.key===e.key))throw new Error("User instance already assigned to resource");this.users.push(e),this.lastUsersChange=performance.now()}_release(e){this.users=this.users.filter(r=>r!==e),this.pool._release(e),this.lastUsersChange=performance.now()}get hasUserCapacity(){return this.usersCount<this.capacityPerResource}get usersCount(){return this.users.length}get isExpiredFromUsers(){return this.resourcesWithoutUserExpireAfterMs<=0||this.users.length>0?!1:performance.now()>this.resourcesWithoutUserExpireAfterMs+this.lastUsersChange}get isDisposed(){return this.state==="disposed"}dispose(e){if(this.state==="disposed")return;const r=this._data;this.state="disposed",this.pool.log.log(`Resource disposed (${e})`);for(const n of this.users)n._dispose(`resource-${e}`);this.users=[],this.lastUsersChange=performance.now(),this.pool._releaseResource(this,e),this.pool.freeResource&&this.pool.freeResource(r)}},Lh=class{_resources;_users;capacity;userExpireAfterMs;resourcesWithoutUserExpireAfterMs;capacityPerResource;fullPolicy;generateResource;freeResource;log;constructor(e={}){this.capacity=e.capacity??-1,this.fullPolicy=e.fullPolicy??"error",this.capacityPerResource=e.capacityPerResource??1,this.userExpireAfterMs=e.userExpireAfterMs??-1,this.resourcesWithoutUserExpireAfterMs=e.resourcesWithoutUserExpireAfterMs??-1,this.generateResource=e.generate,this.freeResource=e.free,this._users=new Map,this._resources=[],this.log=f0("Pool",e.debug??!1);const r=Math.max(this.userExpireAfterMs,this.resourcesWithoutUserExpireAfterMs);r>0&&setInterval(()=>{this.maintain()},r*1.1)}dumpToString(){let e=`Pool
    capacity: ${this.capacity} userExpireAfterMs: ${this.userExpireAfterMs} capacityPerResource: ${this.capacityPerResource}
    resources count: ${this._resources.length}`;const r=this._resources.map(n=>n.toString()).join(`\r
	`);e+=`\r
Resources:\r
	`+r,e+=`\r
Users: \r
`;for(const[n,i]of this._users.entries())e+=`	k: ${n} v: ${i.toString()}\r
`;return e}getUsersByLongestElapsed(){return[...this._users.values()].sort((e,r)=>{const n=e.elapsed,i=r.elapsed;return n===i?0:n<i?1:-1})}getResourcesSortedByUse(){return[...this._resources].sort((e,r)=>e.usersCount===r.usersCount?0:e.usersCount<r.usersCount?-1:1)}addResource(e){if(e===void 0)throw new Error("Cannot add undefined resource");if(e===null)throw new Error("Cannot add null resource");if(this.capacity>0&&this._resources.length===this.capacity)throw new Error(`Capacity limit (${this.capacity}) reached. Cannot add more.`);this.log.log(`Adding resource: ${JSON.stringify(e)}`);const r=new Oh(this,e);return this._resources.push(r),r}maintain(){let e=!1;const r=[];for(const i of this._resources)i.isDisposed?(this.log.log(`Maintain, disposed resource: ${JSON.stringify(i.data)}`),r.push(i)):i.isExpiredFromUsers&&(this.log.log(`Maintain, expired resource: ${JSON.stringify(i.data)}`),r.push(i));if(r.length>0){for(const i of r)i.dispose("diposed/expired");e=!0}const n=[];for(const[i,a]of this._users.entries())a.isValid||(this.log.log(`Maintain. Invalid user: ${a.key} (Disposed: ${a.isDisposed} Expired: ${a.isExpired} Resource disposed: ${a.resource.isDisposed})`),n.push(i),a._dispose("invalid"));for(const i of n)this._users.delete(i),e=!0;e&&this.log.log(`End: resource len: ${this._resources.length} users: ${this.usersLength}`)}*resources(){const e=[...this._resources];for(const r of e)yield r}*values(){const e=[...this._resources];for(const r of e)yield r.data}release(e,r){const n=this._users.get(e);!n||n.release(r??"Pool.release")}_release(e){this._users.delete(e.key)}_releaseResource(e,r){this._resources=this._resources.filter(n=>n!==e)}hasResource(e){return this._resources.find(n=>n.data===e)!==void 0}hasUser(e){return this._users.has(e)}_assign(e,r){const n=new kh(e,r);return this._users.set(e,n),r._assign(n),n}_findUser(e){const r=this.getResourcesSortedByUse();if(r.length>0&&r[0].hasUserCapacity)return this.log.log(`resource has capacity: ${r[0].data}`),this._assign(e,r[0]);if(this.generateResource&&(this.capacity<0||this._resources.length<this.capacity)){this.log.log(`capacity: ${this.capacity} resources: ${this._resources.length}`);const n=this.addResource(this.generateResource());return this._assign(e,n)}}get usersLength(){return[...this._users.values()].length}useValue(e){return this.use(e).resource.data}use(e){const r=this._users.get(e);if(r)return r.keepAlive(),r;this.maintain();const n=this._findUser(e);if(n)return n;if(this.fullPolicy==="error")throw console.log(this.dumpToString()),new Error(`Pool is fully used (fullPolicy: ${this.fullPolicy}, capacity: ${this.capacity})`);if(this.fullPolicy==="evictOldestUser"){const i=this.getUsersByLongestElapsed();if(i.length>0){this.release(i[0].key,"evictedOldestUser");const a=this._findUser(e);if(a)return a}}throw new Error(`Pool is fully used (${this.fullPolicy})`)}},hD=(e={})=>new Lh(e),Au=Math.PI*2,$o=(e,r,n)=>(1-e)*r+e*n,$h=(e,r,n)=>{const i=Li(n-r,0,Au);return $o(e,r,r+(i>Math.PI?i-Au:i))},zn=Math.sqrt,Ne=Math.pow,Ts=Math.cos,Or=Math.PI,Nn=Math.sin,dD=function(e,r){return Th(e,r,rr)},vD=function(e,r){return Th(e,r,Ki)},Th=function(e,r,n){let i;if(typeof e=="function"?i=e:i=ga(e),i===void 0)throw new Error(`Easing function not found: ${e}`);const a=Gr(r,n(),!0);return{get isDone(){return a.isDone},compute:()=>{const u=a.elapsed;return i(u)},reset:()=>{a.reset()}}},yD=(e,r)=>n=>{const i=1-n,a=i*i,u=n*n,o=u*n;return 3*e*a*n+3*r*i*u+o},qh=(e,r,n,i)=>$o(r,n(e),i(e)),mD=(e,r,n)=>qh(e,e,r,n),ga=function(e){if(e===null)throw new Error("easingName is null");if(e===void 0)throw new Error("easingName is undefined");const r=e.toLocaleLowerCase(),n=Object.entries(To).find(([i,a])=>i.toLocaleLowerCase()===r);return n===void 0?n:n[1]},gD=function(){return Array.from(Object.keys(To))},jh=(e=.4)=>{const r=1/zn(2*Or),n=.5;return i=>{const a=r/e;let u=-2.5,o=(i-n)/e;o*=o,u*=o;const s=a*Ne(Math.E,u);return s>1?1:s<0?0:s}},di=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},pD=e=>e*e*e*e*e,wD=e=>1-Ne(1-e,5),ED=e=>e*(1-e)*4,To={arch:ED,bell:jh(),sineIn:e=>1-Ts(e*Or/2),sineOut:e=>Nn(e*Or/2),quadIn:e=>e*e,quadOut:e=>1-(1-e)*(1-e),sineInOut:e=>-(Ts(Or*e)-1)/2,quadInOut:e=>e<.5?2*e*e:1-Ne(-2*e+2,2)/2,cubicIn:e=>e*e*e,cubicOut:e=>1-Ne(1-e,3),quartIn:e=>e*e*e*e,quartOut:e=>1-Ne(1-e,4),quintIn:pD,quintOut:wD,expoIn:e=>e===0?0:Ne(2,10*e-10),expoOut:e=>e===1?1:1-Ne(2,-10*e),quintInOut:e=>e<.5?16*e*e*e*e*e:1-Ne(-2*e+2,5)/2,expoInOut:e=>e===0?0:e===1?1:e<.5?Ne(2,20*e-10)/2:(2-Ne(2,-20*e+10))/2,circIn:e=>1-zn(1-Ne(e,2)),circOut:e=>zn(1-Ne(e-1,2)),backIn:e=>2.70158*e*e*e-1.70158*e*e,backOut:e=>1+2.70158*Ne(e-1,3)+1.70158*Ne(e-1,2),circInOut:e=>e<.5?(1-zn(1-Ne(2*e,2)))/2:(zn(1-Ne(-2*e+2,2))+1)/2,backInOut:e=>{const n=2.5949095;return e<.5?Ne(2*e,2)*((n+1)*2*e-n)/2:(Ne(2*e-2,2)*((n+1)*(e*2-2)+n)+2)/2},elasticIn:e=>{const r=2*Or/3;return e===0?0:e===1?1:-Ne(2,10*e-10)*Nn((e*10-10.75)*r)},elasticOut:e=>{const r=2*Or/3;return e===0?0:e===1?1:Ne(2,-10*e)*Nn((e*10-.75)*r)+1},bounceIn:e=>1-di(1-e),bounceOut:di,elasticInOut:e=>{const r=2*Or/4.5;return e===0?0:e===1?1:e<.5?-(Ne(2,20*e-10)*Nn((20*e-11.125)*r))/2:Ne(2,-20*e+10)*Nn((20*e-11.125)*r)/2+1},bounceInOut:e=>e<.5?(1-di(1-2*e))/2:(1+di(2*e-1))/2},qo=(e,r)=>{typeof r=="function"&&(r=Uh(e,r));const n=p0(e,r),[i,a]=n.reduce((u,o)=>[u[0]+o[0]*o[1],u[1]+o[1]],[0,0]);return i/a},Uh=(e,r)=>{const n=r===void 0?i=>i:r;return mn(e).map((i,a)=>i*n(a/(mn.length-1)))},mn=e=>e.filter(r=>typeof r=="number"&&!Number.isNaN(r)),DD=e=>{let r=0;const n=e[0].length;for(let i=0;i<n;i++){let a=0;for(let u=0;u<e.length;u++)u===0?a=e[u][i]:a*=e[u][i];r+=a}return r},jo=e=>{if(e===void 0)throw new Error("data parameter is undefined");const r=mn(e);return r.reduce((i,a)=>i+a,0)/r.length},Vh=e=>Math.min(...mn(e)),bD=e=>e.reduce((r,n,i,a)=>n>a[r]?i:r,0),xh=(...e)=>e.reduce((r,n,i,a)=>n<a[r]?i:r,0),Hh=e=>Math.max(...mn(e)),Kh=e=>e.reduce((r,n)=>typeof n!="number"||Number.isNaN(n)||Number.isFinite(n)?r:r+n,0),Jh=e=>{let r=Number.MIN_SAFE_INTEGER;for(let n=0;n<e.length;n++)r=Math.max(r,e[n]);return r},Gh=e=>{let r=0;for(let n=0;n<e.length;n++)r+=e[n];return r},Uo=e=>{let r=Number.MIN_SAFE_INTEGER;for(let n=0;n<e.length;n++)r=Math.min(r,e[n]);return r},pa=(e,r,n)=>{if(e===void 0)throw new Error("'data' is undefined");if(!Array.isArray(e))throw new Error("'data' parameter is not an array");if(e.length===0)return{total:0,min:0,max:0,avg:0};r===void 0&&(r=0),n===void 0&&(n=e.length-1);const i=w0(e,u=>typeof u=="number"&&!Number.isNaN(u),r,n),a=i.reduce((u,o)=>u+o,0);return{total:a,max:Math.max(...i),min:Math.min(...i),avg:a/i.length}},AD=Object.freeze({a:Object.freeze({x:0,y:0}),b:Object.freeze({x:0,y:0})}),CD=Object.freeze({a:Object.freeze({x:NaN,y:NaN}),b:Object.freeze({x:NaN,y:NaN})}),FD=e=>O.isEmpty(e.a)&&O.isEmpty(e.b),SD=e=>O.isPlaceholder(e.a)&&O.isPlaceholder(e.b),Br=e=>!(e===void 0||e.a===void 0||e.b===void 0||!O.isPoint(e.a)||!O.isPoint(e.b)),Yh=e=>Array.isArray(e)?!e.some(n=>!Br(n)):!1,Xh=(e,r)=>O.isEqual(e.a,r.a)&&O.isEqual(e.b,r.b),Zh=(e,r)=>Object.freeze({...e,a:r(e.a),b:r(e.b)}),wa=(e,r="line")=>{if(e===void 0)throw new Error(`${r} undefined`);if(e.a===void 0)throw new Error(`${r}.a undefined. Expected {a:Point, b:Point}. Got: ${JSON.stringify(e)}`);if(e.b===void 0)throw new Error(`${r}.b undefined. Expected {a:Point, b:Point} Got: ${JSON.stringify(e)}`)},MD=(e,r)=>{let n;if(Br(e))n=e.a,r=e.b;else if(n=e,r===void 0)throw new Error("b point must be provided");return Math.atan2(r.y-n.y,r.x-n.x)},Qh=(e,r)=>Object.freeze({...e,a:O.multiply(e.a,r),b:O.multiply(e.b,r)}),ed=(e,r)=>Object.freeze({...e,a:O.divide(e.a,r),b:O.divide(e.b,r)}),td=(e,r)=>Object.freeze({...e,a:O.sum(e.a,r),b:O.sum(e.b,r)}),rd=(e,r)=>Object.freeze({...e,a:O.subtract(e.a,r),b:O.subtract(e.b,r)}),ID=(e,r,n)=>Object.freeze({...e,a:O.normaliseByRect(e.a,r,n),b:O.normaliseByRect(e.b,r,n)}),nd=(e,r,n)=>cd(e,r)<=n;function yr(e,r){if(Yh(e))return e.reduce((s,c)=>yr(c)+s,0);const[n,i]=Ea(e,r),a=i.x-n.x,u=i.y-n.y;if(n.z!==void 0&&i.z!==void 0){const o=i.z-n.z;return Math.hypot(a,u,o)}else return Math.hypot(a,u)}var id=(e,r)=>{const[n,i]=Ea(e,r);return Sr(.5,n,i)},Ea=(e,r)=>{let n;if(Br(e))r=e.b,n=e.a;else if(n=e,r===void 0)throw new Error(`Since first parameter is not a line, two points are expected. Got a: ${JSON.stringify(n)} b: ${JSON.stringify(r)}`);return pe(n,"a"),pe(n,"b"),[n,r]},Vo=(e,r)=>{const n=i=>{const{a,b:u}=i,o={x:u.x-a.x,y:u.y-a.y},s={x:r.x-a.x,y:r.y-a.y},c=o.x*o.x+o.y*o.y;let l=s.x*o.x+s.y*o.y;const f=Math.min(1,Math.max(0,l/c));return l=(u.x-a.x)*(r.y-a.y)-(u.y-a.y)*(r.x-a.x),{x:a.x+o.x*f,y:a.y+o.y*f}};if(Array.isArray(e)){const i=e.map(u=>n(u)),a=i.map(u=>O.distance(u,r));return Object.freeze(i[Vt.minIndex(...a)])}else return Object.freeze(n(e))},xo=(e,r)=>{let n;if(Br(e))n=e.a,r=e.b;else if(n=e,r===void 0)throw new Error("b parameter required");if(r!==void 0)return(r.y-n.y)/(r.x-n.x);throw Error("Second point missing")},ad=e=>({x:e.b.x-e.a.x,y:e.b.y-e.a.y}),ud=e=>{const r=yr(e),n=ad(e);return{x:n.x/r,y:n.y/r}},od=(e,r,n=0)=>{const i=Sr(n,e),a=ud(e);return{x:i.x-a.y*r,y:i.y+a.x*r}},sd=(e,r)=>{const n=ad(e),i=ud(e),a={x:e.a.x-i.y*r,y:e.a.y+i.x*r};return{a,b:{x:a.x+n.x,y:a.y+n.y}}},_D=(e,r)=>{const n=Sr(r/2,e),i=Sr(.5+r/2,e);return{a:n,b:i}},PD=(e,r)=>{const n=e.a.y+(r-e.a.x)*xo(e);return Object.freeze({x:r,y:n})},RD=(e,r)=>{const n=yr(e);return Object.freeze({...e,a:e.a,b:Object.freeze({x:e.b.x+(e.b.x-e.a.x)/n*r,y:e.b.y+(e.b.y-e.a.y)/n*r})})};function*BD(e){const{a:r,b:n}=e;let i=Math.floor(r.x),a=Math.floor(r.y);const u=Math.floor(n.x),o=Math.floor(n.y),s=Math.abs(u-i),c=-Math.abs(o-a),l=i<u?1:-1,f=a<o?1:-1;let h=s+c;for(;yield{x:i,y:a},!(i===u&&a===o);){const y=2*h;y>=c&&(h+=c,i+=l),y<=s&&(h+=s,a+=f)}}var cd=(e,r)=>{if(Array.isArray(e)){const n=e.map(i=>Cu(i,r));return Uo(n)}else return Cu(e,r)},Cu=(e,r)=>{if(wa(e,"line"),pe(r,"point"),yr(e)===0)return yr(e.a,r);const n=Vo(e,r);return yr(n,r)};function Sr(e,r,n,i){typeof n=="boolean"&&(i=n,n=void 0),i?Y(e,"","amount"):dv(e,"amount");const[a,u]=Ea(r,n),o=yr(a,u),s=o*(1-e);if(o===0&&s===0)return Object.freeze({...u});const c=u.x-s*(u.x-a.x)/o,l=u.y-s*(u.y-a.y)/o;return Object.freeze({...u,x:c,y:l})}function ld(e,r){if(Br(e))wa(e,"a"),r=e.b,e=e.a;else if(r===void 0)throw new Error("Expect second point if first is a point");return O.toString(e)+"-"+O.toString(r)}var $i=(e,r,n,i)=>{if(Number.isNaN(e))throw new Error("x1 is NaN");if(Number.isNaN(n))throw new Error("x2 is NaN");if(Number.isNaN(r))throw new Error("y1 is NaN");if(Number.isNaN(i))throw new Error("y2 is NaN");return Da({x:e,y:r},{x:n,y:i})},fd=(e,r)=>{if(Br(e))return[e.a.x,e.a.y,e.b.x,e.b.y];if(O.isPoint(e)&&O.isPoint(r))return[e.x,e.y,r.x,r.y];throw new Error("Expected single line parameter, or a and b points")};function*ND(e){for(const r of e)yield r.a,yield r.b}var hd=(e,r)=>[`M${e.x} ${e.y} L ${r.x} ${r.y}`],zD=e=>{if(!Array.isArray(e))throw new Error("arr parameter is not an array");if(e.length!==4)throw new Error("array is expected to have length four");return $i(e[0],e[1],e[2],e[3])},Da=(e,r)=>(pe(e,"a"),pe(r,"b"),e=Object.freeze({...e}),r=Object.freeze({...r}),Object.freeze({a:e,b:r})),dd=(...e)=>{const r=[];let n=e[0];for(let i=1;i<e.length;i++)r.push(Da(n,e[i])),n=e[i];return r},WD=(e,r)=>hr(Da(e,r)),vd=e=>O.bbox(e.a,e.b),hr=e=>{const{a:r,b:n}=e;return Object.freeze({...e,length:()=>yr(r,n),interpolate:i=>Sr(i,r,n),bbox:()=>vd(e),toString:()=>ld(r,n),toFlatArray:()=>fd(r,n),toSvgString:()=>hd(r,n),toPoints:()=>[r,n],rotate:(i,a)=>hr(yd(e,i,a)),nearest:i=>Vo(e,i),sum:i=>hr(td(e,i)),divide:i=>hr(ed(e,i)),multiply:i=>hr(Qh(e,i)),subtract:i=>hr(rd(e,i)),midpoint:()=>id(r,n),distance:i=>Cu(e,i),parallel:i=>sd(e,i),perpendicularPoint:(i,a)=>od(e,i,a),slope:()=>xo(e),withinRange:(i,a)=>nd(e,i,a),isEqual:i=>Xh(e,i),apply:i=>hr(Zh(e,i)),kind:"line"})},yd=(e,r,n)=>r===void 0||r===0?e:(n===void 0&&(n=.5),typeof n=="number"&&(n=Sr(n,e.a,e.b)),Object.freeze({...e,a:O.rotate(e.a,r,n),b:O.rotate(e.b,r,n)}));function ut(e,r,n){if(e===void 0)return{x:0,y:0};if(Array.isArray(e)){if(e.length===0)return Object.freeze({x:0,y:0});if(e.length===1)return Object.freeze({x:e[0],y:0});if(e.length===2)return Object.freeze({x:e[0],y:e[1]});if(e.length===3)return Object.freeze({x:e[0],y:e[1],z:e[2]});throw new Error(`Expected array to be 1-3 elements in length. Got ${e.length}.`)}if(O.isPoint(e))return e;if(typeof e!="number"||typeof r!="number")throw new Error(`Expected point or x,y as parameters. Got: a: ${JSON.stringify(e)} b: ${JSON.stringify(r)}`);return Object.freeze(typeof n=="number"?{x:e,y:r,z:n}:{x:e,y:r})}var md=(...e)=>{const r=e.map(O.toArray);return Vt.dotProduct(r)},gn=Object.freeze({x:0,y:0}),gd=Object.freeze({x:NaN,y:NaN}),pi=e=>e.x===0&&e.y===0,wi=e=>Number.isNaN(e.x)&&Number.isNaN(e.y),kD=e=>e.x===null&&e.y===null,OD=e=>Number.isNaN(e.x)||Number.isNaN(e.y),$r=(e,...r)=>{if(r.length===0)throw new Error("No points provided");let n=r[0];return r.forEach(i=>{n=e(n,i)}),n},LD=(...e)=>$r((r,n)=>r.x<=n.x?r:n,...e),$D=(...e)=>$r((r,n)=>r.x>=n.x?r:n,...e);function Bt(e,r,n,i){const a=ut(r,n,i);return pe(a),pn(a)&&pn(e)?Math.hypot(a.x-e.x,a.y-e.y,a.z-e.z):Math.hypot(a.x-e.x,a.y-e.y)}var TD=(e,r)=>{if(ye.isRectPositioned(r))return ye.distanceFromExterior(r,e);if(At.isCirclePositioned(r))return At.distanceFromExterior(r,e);if(Fe(r))return Bt(e,r);throw new Error("Unknown shape")},qD=(e,r)=>{if(ye.isRectPositioned(r))return ye.distanceFromExterior(r,e);if(At.isCirclePositioned(r))return At.distanceFromExterior(r,e);if(Fe(r))return Bt(e,r);throw new Error("Unknown shape")};function pe(e,r="Point"){if(e===void 0)throw new Error(`'${r}' is undefined. Expected {x,y} got ${JSON.stringify(e)}`);if(e===null)throw new Error(`'${r}' is null. Expected {x,y} got ${JSON.stringify(e)}`);if(e.x===void 0)throw new Error(`'${r}.x' is undefined. Expected {x,y} got ${JSON.stringify(e)}`);if(e.y===void 0)throw new Error(`'${r}.y' is undefined. Expected {x,y} got ${JSON.stringify(e)}`);if(typeof e.x!="number")throw new Error(`'${r}.x' must be a number. Got ${e.x}`);if(typeof e.y!="number")throw new Error(`'${r}.y' must be a number. Got ${e.y}`);if(e.x===null)throw new Error(`'${r}.x' is null`);if(e.y===null)throw new Error(`'${r}.y' is null`);if(Number.isNaN(e.x))throw new Error(`'${r}.x' is NaN`);if(Number.isNaN(e.y))throw new Error(`'${r}.y' is NaN`)}var Ho=(e,r="pt")=>(pe(e,r),Y(e.x,"nonZero",`${r}.x`),Y(e.y,"nonZero",`${r}.y`),typeof e.z<"u"&&Y(e.z,"nonZero",`${r}.z`),!0),jD=e=>({...e,x:Math.abs(e.x),y:Math.abs(e.y)}),ln=(e,r,n)=>r===void 0?Math.atan2(e.y,e.x):n!==void 0?Math.atan2(r.y-e.y,r.x-e.x)-Math.atan2(n.y-e.y,n.x-e.x):Math.atan2(r.y-e.y,r.x-e.x),pd=(...e)=>{if(!Array.isArray(e))throw new Error("Expected list of points");const r=e.reduce((n,i)=>{if(i===void 0)return n;if(Array.isArray(i))throw new Error("'points' list contains an array. Did you mean: centroid(...myPoints)?");if(!Fe(i))throw new Error(`'points' contains something which is not a point: ${JSON.stringify(i)}`);return{x:n.x+i.x,y:n.y+i.y}},{x:0,y:0});return Object.freeze({x:r.x/e.length,y:r.y/e.length})},UD=(...e)=>{const r=$r((l,f)=>l.x<f.x?l:f,...e),n=$r((l,f)=>l.x>f.x?l:f,...e),i=$r((l,f)=>l.y<f.y?l:f,...e),a=$r((l,f)=>l.y>f.y?l:f,...e),u={x:r.x,y:i.y},o={x:n.x,y:i.y},s={x:n.x,y:a.y},c={x:r.x,y:a.y};return ye.maxFromCorners(u,o,s,c)};function Fe(e){return!(e===void 0||e===null||e.x===void 0||e.y===void 0)}var pn=e=>!(e===void 0||e===null||e.x===void 0||e.y===void 0||e.z===void 0),VD=e=>[e.x,e.y];function wd(e,r){if(e===void 0)return"(undefined)";if(e===null)return"(null)";const n=r?e.x.toFixed(r):e.x,i=r?e.y.toFixed(r):e.y;if(e.z!==void 0){const a=r?e.z.toFixed(r):e.z;return`(${n},${i},${a})`}else return`(${n},${i})`}var kn=(...e)=>{if(e===void 0)throw new Error("parameter 'p' is undefined");if(e.length<2)return!0;for(let r=1;r<e.length;r++)if(e[r].x!==e[0].x||e[r].y!==e[0].y)return!1;return!0},xD=(e,r,n)=>{typeof n=="number"&&(n={x:n,y:n});const i=Math.abs(r.x-e.x),a=Math.abs(r.y-e.y);return i<=n.x&&a<=n.y},HD=(e,r,n,i=!1)=>Sr(e,r,n,i),KD=(e,r)=>{if(Array.isArray(e)){if(e.length!==2)throw new Error("Expected array of length two, got "+e.length);return Object.freeze({x:e[0],y:e[1]})}else{if(e===void 0)e=0;else if(Number.isNaN(e))throw new Error("x is NaN");if(r===void 0)r=0;else if(Number.isNaN(r))throw new Error("y is NaN");return Object.freeze({x:e,y:r})}},Ed=(...e)=>{const r=[];if(Array.isArray(e[0]))e.forEach(n=>{if(n.length%2!==0)throw new Error("coords array should be even-numbered");r.push(Object.freeze({x:n[0],y:n[1]}))});else{if(e.length%2!==0)throw new Error("Expected even number of elements: [x,y,x,y...]");for(let n=0;n<e.length;n+=2)r.push(Object.freeze({x:e[n],y:e[n+1]}))}return r};function Nr(e,r,n,i){if(Fe(e))return pe(e,"a"),Fe(r)?(pe(r,"b"),Object.freeze({...e,x:e.x-r.x,y:e.y-r.y})):(n===void 0&&(n=r),Object.freeze({...e,x:e.x-r,y:e.y-n}));if(Y(e,"","a"),typeof r!="number")throw new Error("Second parameter is expected to by y value");if(Y(r,"","b"),Number.isNaN(n))throw new Error("Third parameter is NaN");if(Number.isNaN(i))throw new Error("Fourth parameter is NaN");return n===void 0&&(n=0),i===void 0&&(i=0),Object.freeze({x:e-n,y:r-i})}var JD=(e,r)=>Object.freeze({...e,x:r(e.x,"x"),y:r(e.y,"y")}),GD=(e,...r)=>Dd(...r)(e),Dd=(...e)=>r=>e.reduce((n,i)=>i(n),r),bd=(e,r,n={x:0,y:0})=>{let i=n;return e.forEach(a=>{i=r(a,i)}),i},Ad=function(e,r,n,i){if(e===void 0)throw new Error(`a missing. a: ${e}`);let a,u;if(Fe(e))if(a=e,r===void 0&&(r=gn),Fe(r))u=r;else{if(r===void 0)throw new Error("Expects x coordinate");u={x:r,y:n===void 0?r:n}}else if(!Fe(r)){if(r===void 0)throw new Error("Expected number as second param");if(a={x:e,y:r},n===void 0)throw new Error("Expects x coordiante");u={x:n,y:i===void 0?0:i}}if(a===void 0)throw new Error(`ptA missing. a: ${e}`);if(u===void 0)throw new Error(`ptB missing. b: ${r}`);return pe(a,"a"),pe(u,"b"),Object.freeze({x:a.x+u.x,y:a.y+u.y})};function ba(e,r,n){if(pe(e,"a"),typeof r=="number")return typeof n>"u"&&(n=r),Y(n,"","y"),Y(r,"","x"),Object.freeze({x:e.x*r,y:e.y*n});if(Fe(r))return pe(r,"b"),Object.freeze({x:e.x*r.x,y:e.y*r.y});if(ye.isRect(r))return ye.guard(r,"rect"),Object.freeze({x:e.x*r.width,y:e.y*r.height});throw new Error(`Invalid arguments. a: ${JSON.stringify(e)} b: ${JSON.stringify(r)}`)}var YD=(e,r)=>pn(e)?Object.freeze({...e,x:e.x*r,y:e.y*r,z:e.z*r}):Object.freeze({...e,x:e.x*r,y:e.y*r});function Cd(e,r,n,i){if(Fe(e))return pe(e,"a"),Fe(r)?(Ho(r),Object.freeze({x:e.x/r.x,y:e.y/r.y})):ye.isRect(r)?(ye.guard(r,"rect"),Object.freeze({x:e.x/r.width,y:e.y/r.height})):(n===void 0&&(n=r),pe(e),Y(r,"nonZero","x"),Y(n,"nonZero","y"),Object.freeze({x:e.x/r,y:e.y/n}));if(typeof r!="number")throw new Error("expected second parameter to be y1 coord");return Y(e,"positive","x1"),Y(r,"positive","y1"),n===void 0&&(n=1),i===void 0&&(i=n),Y(n,"nonZero","x2"),Y(i,"nonZero","y2"),Object.freeze({x:e/n,y:r/i})}function XD(e,r,n){const i=ut(e,r,n);return Ho(i,"divisor"),(a,u,o)=>{const s=ut(a,u,o);return typeof s.z<"u"?Object.freeze({x:s.x/i.x,y:s.y/i.y,z:s.z/(i.z??1)}):Object.freeze({x:s.x/i.x,y:s.y/i.y})}}var ZD=(e,r,n=!0)=>Object.freeze({x:lu(e.x,r.x,n),y:lu(e.y,r.y,n)}),QD=(...e)=>{const r=[...e].sort(Fd);if(r.length===1)return r;const n=u=>{const o=[];return u.forEach(s=>{for(;o.length>=2;){const c=o[o.length-1],l=o[o.length-2];if((c.x-l.x)*(s.y-l.y)>=(c.y-l.y)*(s.x-l.x))o.pop();else break}o.push(s)}),o.pop(),o},i=n(r),a=n(r.reverse());return i.length===1&&a.length===1&&kn(a[0],i[0])?i:i.concat(a)},eb=(e,r)=>e.x<r.x&&e.y<r.y?-2:e.x>r.x&&e.y>r.y?2:e.x<r.x||e.y<r.y?-1:e.x>r.x||e.y>r.y?1:e.x===r.x&&e.x===r.y?0:NaN,Fd=(e,r)=>e.x-r.x||e.y-r.y,Fu=(e,r,n)=>{const i=Math.cos(n)*r+e.x,a=Math.sin(n)*r+e.y;return{x:i,y:a}};function Vr(e,r,n){n===void 0&&(n={x:0,y:0}),pe(n,"origin"),Y(r,"","amountRadian");const i=Array.isArray(e);if(r===0)return e;i||(e=[e]);const a=e;a.forEach((c,l)=>pe(c,`pt[${l}]`));const s=a.map(c=>Ve.fromCartesian(c,n)).map(c=>Ve.rotate(c,r)).map(c=>Ve.toCartesian(c,n));return i?s:s[0]}var tb=(e,r)=>{const n=[[Math.cos(r),-Math.sin(r)],[Math.sin(r),Math.cos(r)]],i=[];for(let a=0;a<e.length;++a)i[a]=[n[0][0]*e[a][0]+n[0][1]*e[a][1],n[1][0]*e[a][0]+n[1][1]*e[a][1]];return i},rb=(e,r)=>{if(Fe(e)&&(r=e.y,e=e.x),r===void 0)throw new Error("Expected y");return Math.sqrt(e*e+r*r)},Sd=(e,r)=>{const n=ut(e,r),i=rb(n);return i===0?O.Empty:Object.freeze({x:n.x/i,y:n.y/i})};function nb(e,r,n,i){if(Fe(e)){if(typeof r=="number"&&n!==void 0)Y(r,"positive","width"),Y(n,"positive","height");else{if(!ye.isRect(r))throw new Error("Expected second parameter to be a rect");n=r.height,r=r.width}return Object.freeze({x:e.x/r,y:e.y/n})}else{if(Y(e,"positive","x"),typeof r!="number")throw new Error("Expecting second parameter to be a number (width)");if(typeof n!="number")throw new Error("Expecting third parameter to be a number (height)");if(Y(r,"positive","y"),Y(n,"positive","width"),i===void 0)throw new Error("Expected height parameter");return Y(i,"positive","height"),Object.freeze({x:e/n,y:r/i})}}var ib=e=>(e===void 0&&(e=et),Object.freeze({x:e(),y:e()})),ab=(e,r={x:1,y:1},n={x:0,y:0})=>(pe(e,"pt"),pe(r,"ptMax"),pe(n,"ptMin"),Object.freeze({x:Li(e.x,n.x,r.x),y:Li(e.y,n.y,r.y)})),ub=(e,r="both")=>{switch(r){case"both":return pn(e)?Object.freeze({...e,x:e.x*-1,y:e.y*-1,z:e.z*-1}):Object.freeze({...e,x:e.x*-1,y:e.y*-1});case"x":return Object.freeze({...e,x:e.x*-1});case"y":return Object.freeze({...e,y:e.y*-1});case"z":if(pn(e))return Object.freeze({...e,z:e.z*-1});throw new Error("pt parameter is missing z");default:throw new Error("Unknown what parameter. Expecting 'both', 'x' or 'y'")}},ob=(e,r=Math.round)=>(pe(e,"pt"),Object.freeze({x:r(e.x),y:r(e.y)})),Md=(e,r=1,n=0)=>{const i=Bt(e);let a=1;return i>r?a=r/i:i<n&&(a=n/i),a===1?e:ba(e,a,a)};function sb(e,r,n,i){if(Fe(e))return r===void 0&&(r=0),n===void 0&&(n=1),Y(r,"","min"),Y(n,"","max"),Object.freeze({x:Rt(e.x,r,n),y:Rt(e.y,r,n)});if(r===void 0)throw new Error("Expected y coordinate");return n===void 0&&(n=0),i===void 0&&(i=1),Y(e,"","x"),Y(r,"","y"),Y(n,"","min"),Y(i,"","max"),Object.freeze({x:Rt(e,n,i),y:Rt(r,n,i)})}var Su=(e,r)=>{const n=ut(e,r);let i=0,a=0,u=0,o=performance.now(),s=n;return(l,f)=>{const h=ut(l,f);i+=h.x,a+=h.y,u++;const y=Bt(h,n),D=Bt(h,s),P=performance.now(),q=D/(P-o);return o=P,s=h,Object.freeze({angle:ln(h,n),distanceFromStart:y,distanceFromLast:D,speed:q,centroid:pd(h,n),average:{x:i/u,y:a/u}})}},cb=(e,r,n)=>{const i=O.subtract(e,r),a=O.subtract(n,r);return O.isPoint3d(i)&&O.isPoint3d(a)?(i.x*a.x+i.y*a.y+i.z*a.z)/(a.x*a.x+a.y*a.y+a.z*a.z):(i.x*a.x+i.y*a.y)/(a.x*a.x+a.y*a.y)},Id=e=>e.startRadian!==void 0&&e.endRadian!==void 0,vr=e=>e.x!==void 0&&e.y!==void 0,qs=Math.PI*2;function lb(e,r,n,i){const a={radius:e,startRadian:Fr(r),endRadian:Fr(n)};if(Fe(i)){pe(i);const u={...a,x:i.x,y:i.y};return Object.freeze(u)}else return Object.freeze(a)}var _d=e=>Ke.fromPoints(Ti(e,e.startRadian),Ti(e,e.endRadian)),Ti=(e,r,n)=>{if(r>e.endRadian)throw new Error("angleRadian beyond end angle of arc");if(r<e.startRadian)throw new Error("angleRadian beyond start angle of arc");return n===void 0&&(vr(e)?n=e:n={x:0,y:0}),{x:Math.cos(r)*e.radius+n.x,y:Math.sin(r)*e.radius+n.y}},Ko=e=>{if(e===void 0)throw new Error("Arc is undefined");if(vr(e)&&pe(e,"arc"),e.radius===void 0)throw new Error(`Arc radius is undefined (${JSON.stringify(e)})`);if(typeof e.radius!="number")throw new Error("Radius must be a number");if(Number.isNaN(e.radius))throw new Error("Radius is NaN");if(e.radius<=0)throw new Error("Radius must be greater than zero");if(e.startRadian===void 0)throw new Error("Arc is missing 'startRadian' field");if(e.endRadian===void 0)throw new Error("Arc is missing 'startRadian' field");if(Number.isNaN(e.endRadian))throw new Error("Arc endRadian is NaN");if(Number.isNaN(e.startRadian))throw new Error("Arc endRadian is NaN");if(e.startRadian>=e.endRadian)throw new Error("startRadian is expected to be les than endRadian")},Jo=(e,r,n)=>(Ko(r),Ti(r,r.startRadian+(r.endRadian-r.startRadian)*e,n)),fb=e=>(Ko(e),Object.freeze({...e,nearest:r=>{throw new Error("not implemented")},interpolate:r=>Jo(r,e),bbox:()=>Rd(e),length:()=>Pd(e),toSvgString:()=>Bd(e),kind:"arc"})),Pd=e=>qs*e.radius*((e.startRadian-e.endRadian)/qs),Rd=e=>{if(vr(e)){const r=Jo(.5,e),n=_d(e);return O.bbox(r,n.a,n.b)}else return{width:e.radius*2,height:e.radius*2}},Bd=(e,r,n,i,a)=>{if(Id(e))return vr(e)?vi(e,e.radius,e.startRadian,e.endRadian,r):Fe(r)?vi(r,e.radius,e.startRadian,e.endRadian,n):vi({x:0,y:0},e.radius,e.startRadian,e.endRadian);if(n===void 0)throw new Error("startAngle undefined");if(i===void 0)throw new Error("endAngle undefined");if(Fe(e)){if(typeof r=="number"&&typeof n=="number"&&typeof i=="number")return vi(e,r,n,i,a);throw new Error("Expected (point, number, number, number). Missing a number param.")}else throw new Error("Expected (point, number, number, number). Missing first point.")},vi=(e,r,n,i,a)=>{(a===void 0||typeof a!="object")&&(a={});const u=i-n===360,o=Ve.toCartesian(r,i-.01,e),s=Ve.toCartesian(r,n,e),{largeArc:c=!1,sweep:l=!1}=a,f=[`
    M ${o.x} ${o.y}
    A ${r} ${r} 0 ${c?"1":"0"} ${l?"1":"0"} ${s.x} ${s.y},
  `];return u&&f.push("z"),f},hb=(e,r)=>O.distance(e,r),db=(e,r)=>e.radius!==r.radius?!1:vr(e)&&vr(r)?!(e.x!==r.x||e.y!==r.y||e.z!==r.z):!(!(!vr(e)&&!vr(r))||e.endRadian!==r.endRadian||e.startRadian!==r.startRadian),Go={};Z(Go,{bbox:()=>zd,computeDimensions:()=>Yo,fromPaths:()=>Ld,guardContinuous:()=>kd,interpolate:()=>Nd,setSegment:()=>vb,toString:()=>Wd,toSvgString:()=>Od});var vb=(e,r,n)=>{const i=[...e.segments];return i[r]=n,Ld(...i)},Nd=(e,r,n,i)=>{i===void 0&&(i=Yo(e));const a=r*(n?i.totalWidth:i.totalLength);let u=0;const o=n?i.widths:i.lengths;for(let s=0;s<o.length;s++)if(u+o[s]>=a){let l=(a-u)/o[s];return l>1&&(l=1),e[s].interpolate(l)}else u+=o[s];return{x:0,y:0}},Yo=e=>{const r=e.map(u=>u.bbox().width),n=e.map(u=>u.length());let i=0,a=0;for(let u=0;u<n.length;u++)i+=n[u];for(let u=0;u<r.length;u++)a+=r[u];return{totalLength:i,totalWidth:a,widths:r,lengths:n}},zd=e=>{const n=e.map(i=>i.bbox()).map(i=>ye.corners(i)).flat();return O.bbox(...n)},Wd=e=>e.map(r=>r.toString()).join(", "),kd=e=>{let r=nn.getEnd(e[0]);for(let n=1;n<e.length;n++){const i=nn.getStart(e[n]);if(!O.isEqual(i,r))throw new Error("Path index "+n+" does not start at prior path end. Start: "+i.x+","+i.y+" expected: "+r.x+","+r.y);r=nn.getEnd(e[n])}},Od=e=>e.flatMap(r=>r.toSvgString()),Ld=(...e)=>{kd(e);const r=Yo(e);return Object.freeze({segments:e,length:()=>r.totalLength,nearest:n=>{throw new Error("not implemented")},interpolate:(n,i=!1)=>Nd(e,n,i,r),bbox:()=>zd(e),toString:()=>Wd(e),toSvgString:()=>Od(e),kind:"compound"})},Aa={};Z(Aa,{arrow:()=>Wb,center:()=>Nb,isIntersecting:()=>Bb,randomPoint:()=>Td,starburst:()=>zb});var Ve={};Z(Ve,{clampMagnitude:()=>_b,divide:()=>Ib,dotProduct:()=>Eb,fromCartesian:()=>mb,guard:()=>Ct,invert:()=>Db,isAntiParallel:()=>Cb,isCoord:()=>$d,isOpposite:()=>bb,isParallel:()=>Ab,multiply:()=>Mb,normalise:()=>wb,rotate:()=>pb,rotateDegrees:()=>Fb,spiral:()=>gb,spiralRaw:()=>Sb,toCartesian:()=>Ei,toPoint:()=>Rb,toString:()=>Pb});var yb=Object.freeze({x:0,y:0}),$d=e=>!(e.distance===void 0||e.angleRadian===void 0),mb=(e,r)=>{e=Nr(e,r);const n=Math.atan2(e.y,e.x);return Object.freeze({...e,angleRadian:n,distance:Math.sqrt(e.x*e.x+e.y*e.y)})},Ei=(e,r,n)=>{if($d(e)){if(r===void 0&&(r=gn),Fe(r))return js(e.distance,e.angleRadian,r);throw new Error("Expecting (Coord, Point). Second parameter is not a point")}else{if(typeof e=="object")throw new Error(`First param is an object, but not a Coord: ${JSON.stringify(e)}`);if(typeof e=="number"&&typeof r=="number"){if(n===void 0&&(n=gn),!Fe(n))throw new Error("Expecting (number, number, Point). Point param wrong type");return js(e,r,n)}else throw new Error(`Expecting parameters of (number, number). Got: (${typeof e}, ${typeof r}, ${typeof n}). a: ${JSON.stringify(e)}`)}};function*gb(e,r){let n=0;for(;;){const i=e*n++;yield{distance:r*i,angleRadian:i,step:n}}}var pb=(e,r)=>Object.freeze({...e,angleRadian:e.angleRadian+r}),wb=e=>{if(e.distance===0)throw new Error("Cannot normalise vector of length 0");return Object.freeze({...e,distance:1})},Ct=(e,r="Point")=>{if(e===void 0)throw new Error(`'${r}' is undefined. Expected {distance, angleRadian} got ${JSON.stringify(e)}`);if(e===null)throw new Error(`'${r}' is null. Expected {distance, angleRadian} got ${JSON.stringify(e)}`);if(e.angleRadian===void 0)throw new Error(`'${r}.angleRadian' is undefined. Expected {distance, angleRadian} got ${JSON.stringify(e)}`);if(e.distance===void 0)throw new Error(`'${r}.distance' is undefined. Expected {distance, angleRadian} got ${JSON.stringify(e)}`);if(typeof e.angleRadian!="number")throw new Error(`'${r}.angleRadian' must be a number. Got ${e.angleRadian}`);if(typeof e.distance!="number")throw new Error(`'${r}.distance' must be a number. Got ${e.distance}`);if(e.angleRadian===null)throw new Error(`'${r}.angleRadian' is null`);if(e.distance===null)throw new Error(`'${r}.distance' is null`);if(Number.isNaN(e.angleRadian))throw new Error(`'${r}.angleRadian' is NaN`);if(Number.isNaN(e.distance))throw new Error(`'${r}.distance' is NaN`)},Eb=(e,r)=>(Ct(e,"a"),Ct(r,"b"),e.distance*r.distance*Math.cos(r.angleRadian-e.angleRadian)),Db=e=>(Ct(e,"c"),Object.freeze({...e,angleRadian:e.angleRadian-Math.PI})),bb=(e,r)=>(Ct(e,"a"),Ct(r,"b"),e.distance!==r.distance?!1:e.angleRadian===-r.angleRadian),Ab=(e,r)=>(Ct(e,"a"),Ct(r,"b"),e.angleRadian===r.angleRadian),Cb=(e,r)=>(Ct(e,"a"),Ct(r,"b"),e.angleRadian===-r.angleRadian),Fb=(e,r)=>Object.freeze({...e,angleRadian:e.angleRadian+Fr(r)}),Sb=(e,r,n)=>{const i=r*e;return Object.freeze({distance:n*i,angleRadian:i})},Mb=(e,r)=>(Ct(e),Y(r,"","amt"),Object.freeze({...e,distance:e.distance*r})),Ib=(e,r)=>(Ct(e),Y(r,"","amt"),Object.freeze({...e,distance:e.distance/r})),_b=(e,r=1,n=0)=>{let i=e.distance;return i>r&&(i=r),i<n&&(i=n),Object.freeze({...e,distance:i})},js=(e,r,n=gn)=>(pe(n),Object.freeze({x:n.x+e*Math.cos(r),y:n.y+e*Math.sin(r)})),Pb=(e,r)=>{if(e===void 0)return"(undefined)";if(e===null)return"(null)";const n=Ca(e.angleRadian),i=r?e.distance.toFixed(r):e.distance,a=r?n.toFixed(r):n;return`(${i},${a})`},Rb=(e,r=yb)=>(Ct(e,"v"),Object.freeze({x:r.x+e.distance*Math.cos(e.angleRadian),y:r.y+e.distance*Math.sin(e.angleRadian)})),Bb=(e,r)=>{if(At.isCirclePositioned(e))return At.isIntersecting(e,r);if(ye.isRectPositioned(e))return ye.isIntersecting(e,r);throw new Error(`a or b are unknown shapes. a: ${JSON.stringify(e)} b: ${JSON.stringify(r)}`)},Td=(e,r={})=>{if(At.isCirclePositioned(e))return At.randomPoint(e,r);if(ye.isRectPositioned(e))return ye.randomPoint(e,r);throw new Error("Cannot create random point for unknown shape")},Nb=e=>{if(e===void 0)return Object.freeze({x:.5,y:.5});if(ye.isRect(e))return ye.center(e);if(Tr.isTriangle(e))return Tr.centroid(e);if(At.isCircle(e))return At.center(e);throw new Error(`Unknown shape: ${JSON.stringify(e)}`)},zb=(e,r=5,n,i={x:0,y:0},a)=>{Ee(r,"positive","points");const u=Math.PI*2/r,o=u/2,s=a?.initialAngleRadian??-Math.PI/2;n===void 0&&(n=e/2);let c=s;const l=[];for(let f=0;f<r;f++){const h=Ei(e,c,i),y=Ei(n,c-o,i),D=Ei(n,c+o,i);l.push(y,h),f+1<r&&l.push(D),c+=u}return l},Wb=(e,r,n={})=>{const i=n.tailLength??10,a=n.tailThickness??Math.max(i/5,5),u=n.angleRadian??0,o=n.arrowSize??Math.max(i/5,15),s=Math.PI/2;let c,l;if(r==="tip")c=Tr.equilateralFromVertex(e,o,s),l=ye.corners(ye.fromTopLeft({x:c.a.x-i,y:e.y-a/2},i,a));else if(r==="middle"){const h=i+o/2,y=a/2;c=Tr.equilateralFromVertex({x:e.x+o*1.2,y:e.y},o,s),l=ye.corners(ye.fromTopLeft({x:e.x-h,y:e.y-y},i+o,a))}else l=ye.corners(ye.fromTopLeft({x:e.x,y:e.y-a/2},i,a)),c=Tr.equilateralFromVertex({x:e.x+i+o*.7,y:e.y},o,s);return O.rotate([l[0],l[1],c.a,c.b,c.c,l[2],l[3]],u,e)},qi={};Z(qi,{clampMagnitude:()=>Ub,divide:()=>Kb,dotProduct:()=>jb,fromLineCartesian:()=>Ob,fromLinePolar:()=>Lb,fromPointPolar:()=>qd,multiply:()=>Hb,normalise:()=>$b,quadrantOffsetAngle:()=>Tb,subtract:()=>xb,sum:()=>Vb,toCartesian:()=>gr,toPolar:()=>ii,toString:()=>qb});var kb=Object.freeze({x:0,y:0}),Di=Math.PI*2,ji=Math.PI,qd=(e,r="",n=kb)=>{e=Nr(e,n);let i=Math.atan2(e.y,e.x);return r==="unipolar"&&i<0?i+=Di:r==="bipolar"&&(i>ji?i-=Di:i<=-ji&&(i+=Di)),Object.freeze({distance:Bt(e),angleRadian:i})},Ob=e=>Nr(e.b,e.a),Lb=e=>{wa(e,"line");const r=Nr(e.b,e.a);return qd(r)},Ut=e=>!!Ve.isCoord(e),Kr=e=>!!Fe(e),$b=e=>{if(Ut(e))return Ve.normalise(e);if(Kr(e))return Sd(e);throw new Error(`Expected polar/cartesian vector. Got: ${e}`)},Tb=e=>e.x>=0&&e.y>=0?0:e.x<0&&e.y>=0||e.x<0&&e.y<0?ji:Di,ii=(e,r=gn)=>{if(Ut(e))return e;if(Kr(e))return Ve.fromCartesian(e,r);throw new Error(`Expected polar/cartesian vector. Got: ${e}`)},gr=e=>{if(Ut(e))return Ve.toPoint(e);if(Kr(e))return e;throw new Error(`Expected polar/cartesian vector. Got: ${e}`)},qb=(e,r)=>{if(Ut(e))return Ve.toString(e,r);if(Kr(e))return wd(e,r);throw new Error(`Expected polar/cartesian vector. Got: ${e}`)},jb=(e,r)=>{if(Ut(e)&&Ut(r))return Ve.dotProduct(e,r);if(Kr(e)&&Kr(r))return md(e,r);throw new Error("Expected two polar/Cartesian vectors.")},Ub=(e,r=1,n=0)=>{if(Ut(e))return Ve.clampMagnitude(e,r,n);if(Kr(e))return Md(e,r,n);throw new Error("Expected either polar or Cartesian vector")},Vb=(e,r)=>{const n=Ut(e);e=gr(e),r=gr(r);const i=Ad(e,r);return n?ii(i):i},xb=(e,r)=>{const n=Ut(e);e=gr(e),r=gr(r);const i=Nr(e,r);return n?ii(i):i},Hb=(e,r)=>{const n=Ut(e);e=gr(e),r=gr(r);const i=ba(e,r);return n?ii(i):i},Kb=(e,r)=>{const n=Ut(e);e=gr(e),r=gr(r);const i=Cd(e,r);return n?ii(i):i},jd={};Z(jd,{fromPoints:()=>Jb,init:()=>Ud});var Jb=(e,r={})=>{const n=dd(...e);return Ud(n.map(i=>hr(i)),r)},Ud=(e,r={})=>{const n=r.maxDistanceFromLine??.1;return a=>{const o=e.map((c,l)=>{const f=c.nearest(a),h=Bt(a,f);return{path:c,index:l,nearest:f,distance:h}}).filter(c=>c.distance<=n);return Vt.sortByNumericProperty(o,"distance")}},Gb={},Vd={};Z(Vd,{CirclePacking:()=>xd});var xd={};Z(xd,{random:()=>Yb});var Yb=(e,r,n={})=>{const i=n.attempts??2e3,a=E0(e,"radius"),u=[],o=(s,c)=>u.some(l=>il(l,s,c));for(;a.length;){const s=a.pop();if(!s)break;const c={...n,margin:{x:s.radius,y:s.radius}};for(let l=0;l<i;l++){const f=Td(r,c);if(!o(f,s.radius)){u.push(Object.freeze({...s,...f}));break}}}return u},Ui={};Z(Ui,{scaler:()=>Xb});var Xb=(e="both",r)=>{const n=r??Gu;let i=1,a=1,u={x:1,y:1};const o=()=>{switch(e){case"height":return{x:a,y:a};case"width":return{x:i,y:i};case"min":return{x:Math.min(i,a),y:Math.min(i,a)};case"max":return{x:Math.max(i,a),y:Math.max(i,a)};default:return{x:i,y:a}}},s=(h,y,D,P)=>{let q=Number.NaN,N=Number.NaN,b=n.width,M=n.height;if(typeof h=="number")if(q=h,typeof y=="number"){if(N=y,D===void 0)return[q,N,b,M];if(Cr(D))b=D.width,M=D.height;else if(typeof D=="number")if(b=D,typeof P=="number")M=P;else throw new Error("Missing final height value");else throw new Error("Missing valid output range")}else if(Cr(y))b=y.width,M=y.height;else throw new Error("Expected input y or output Rect to follow first number parameter");else if(Fe(h)){if(q=h.x,N=h.y,y===void 0)return[q,N,b,M];if(Cr(y))b=y.width,M=y.height;else if(typeof y=="number")if(b=y,typeof D=="number")M=D;else throw new Error("Expected height as third parameter after Point and output width");else throw new Error("Expected Rect or width as second parameter when first parameter is a Point")}else throw new Error("Expected input Point or x value as first parameter");return[q,N,b,M]},c=(h,y,D,P)=>{const q=s(h,y,D,P);return f(!0,...q)},l=(h,y,D,P)=>{const q=s(h,y,D,P);return f(!1,...q)},f=(h,y,D,P,q)=>{if(Number.isNaN(P))throw new Error("Output width range missing");if(Number.isNaN(q))throw new Error("Output height range missing");return(P!==i||q!==a)&&(i=P,a=q,u=o()),h?{x:y*u.x,y:D*u.y}:{x:y/u.x,y:D/u.y}};return{rel:l,abs:c}},Hd={};Z(Hd,{boxBlurKernel:()=>rA,convolve:()=>Jd,convolveCell:()=>Kd,convolveImage:()=>Zb,edgeDetectionKernel:()=>eA,gaussianBlur3Kernel:()=>nA,gaussianBlur5Kernel:()=>iA,identityKernel:()=>Qb,kernel2dToArray:()=>Gd,multiply:()=>ai,rgbReducer:()=>Yd,sharpenKernel:()=>tA,unsharpMasking5Kernel:()=>aA});var ai=(e,r)=>{const n=e.length,i=e[0].length,a=[];for(let u=0;u<n;u++){a[u]=[];for(let o=0;o<i;o++)a[u][o]=e[u][o]*r}return a};function Kd(e,r,n,i,a){const u=r.map(o=>{const s=An(n,e,o[0],"stop");return s?[o[1],i(s,"undefined")]:[o[1],void 0]});return a(u)}function*Zb(e,r){const n={rows:r.width,cols:r.height},i=ko.accessor(r);yield*Jd(e,n,i,Cn(n),Yd)}function*Jd(e,r,n,i,a,u){if(!u){const s=e.length,c=e[0].length;u={x:Math.floor(s/2),y:Math.floor(c/2)}}const o=Gd(e,u);for(const s of i){const c=Kd(s,o,r,n,a);yield[s,c]}}var Gd=(e,r)=>{const n=[],i=e.length,a=e[0].length;r||(r={x:Math.floor(i/2),y:Math.floor(a/2)});for(let u=0;u<i;u++)for(let o=0;o<a;o++)n.push([{x:u-r.x,y:o-r.y},e[u][o]]);return n},Yd=e=>{let r=0,n=0,i=0;for(let u=0;u<e.length;u++){const o=e[u][1],s=e[u][0];o!==void 0&&o.opacity!==0&&s!==0&&(r+=o.r*s,n+=o.g*s,i+=o.b*s)}return{r,g:n,b:i,opacity:255}},Qb=[[0,0,0],[0,1,0],[0,0,0]],eA=[[0,-1,0],[-1,4,-1],[0,-1,0]],tA=[[0,-1,0],[-1,5,-1],[0,-1,0]],rA=ai([[1,1,1],[1,1,1],[1,1,1]],1/9),nA=ai([[1,2,1],[2,4,2],[1,2,1]],1/16),iA=ai([[1,4,6,4,1],[4,16,24,16,4],[6,24,36,24,6],[4,16,24,16,4],[1,4,6,4,1]],1/256),aA=ai([[1,4,6,4,1],[4,16,24,16,4],[6,24,-476,24,6],[4,16,24,16,4],[1,4,6,4,1]],-1/256),Xd={};Z(Xd,{circleRings:()=>hA,circleVogelSpiral:()=>fA,sphereFibonacci:()=>dA});var Xo=Math.cos,Zo=Math.sin,uA=Math.asin,Qo=Math.sqrt,oA=Math.pow,es=Math.PI,sA=Math.PI*2,cA=es*(3-Qo(5)),lA=(1+Qo(5))/2;function*fA(e,r={}){const n=r.maxPoints??5e3,i=r.density??.95,a=r.rotation??0,u=Ju(e??{radius:1,x:0,y:0}),o=u.radius;let s=u.radius*Qt(i,0,1,.3,.01);r.spacing&&(s=r.spacing);let c=0,l=0,f=0;for(;l<n&&c<o;)c=s*l**.5,f=a+l*2*es/lA,yield Object.freeze({x:u.x+c*Xo(f),y:u.y+c*Zo(f)}),l++}function*hA(e,r={}){const n=r.rings??5,i=Ju(e??{radius:1,x:0,y:0}),a=1/n,u=r.rotation??0;let o=1;yield Object.freeze({x:i.x,y:i.y});for(let s=a;s<=1;s+=a){const c=Math.round(es/uA(1/(2*o)));for(const l of Cl(0,sA,c+1))yield Object.freeze({x:i.x+s*Xo(l+u)*i.radius,y:i.y+s*Zo(l+u)*i.radius});o++}}function*dA(e=100,r=0,n){const i=2/e,a=n??{x:0,y:0,z:0,radius:1};for(let u=0;u<e;u++){const o=u*i-1+i/2,s=Qo(1-oA(o,2)),c=(u+1)%e*cA+r,l=Xo(c)*s,f=Zo(c)*s;yield Object.freeze({x:a.x+l*a.radius,y:a.y+o*a.radius,z:a.z+f*a.radius})}}function Fr(e){return Array.isArray(e)?e.map(r=>r*(Math.PI/180)):e*(Math.PI/180)}function Ca(e){return Array.isArray(e)?e.map(r=>r*180/Math.PI):e*180/Math.PI}var Zd=e=>Math.atan2(e.x,e.y);try{typeof window<"u"&&(window.ixfx={...window.ixfx,Geometry:{Circles:At,Arcs:Lu,Lines:Ke,Rects:ye,Points:O,Paths:nn,Grids:Oo,Beziers:Zn,Compound:Go,Ellipses:fo,Polar:Ve,Shapes:Aa,radiansFromAxisX:Zd,radianToDegree:Ca,degreeToRadian:Fr}})}catch{}var Qd=(e=>(e[e.Nw=0]="Nw",e[e.Ne=1]="Ne",e[e.Sw=2]="Sw",e[e.Se=3]="Se",e))(Qd||{}),vA=class e0{constructor(r,n,i,a){this.boundary=n,this.level=i,this.opts=a,this.#r=r}#e=[];#t=[];#r;getLengthChildren(){return this.#t.length}*parents(){let r=this;for(;r.#r!==void 0;)yield r.#r,r=r.#r}*children(){for(const r of this.#t)yield r}direction(r){return this.#t[r]}add(r){return Aa.isIntersecting(this.boundary,r)?this.#t.length?(this.#t.forEach(n=>n.add(r)),!0):(this.#e.push(r),this.#e.length>this.opts.maxItems&&this.level<this.opts.maxLevels&&(this.#t.length||this.#n(),this.#e.forEach(n=>{this.#t.forEach(i=>i.add(n))}),this.#e=[]),!0):!1}couldHold(r){return ye.intersectsPoint(this.boundary,r)}#n(){const r=this.boundary.width/2,n=this.boundary.height/2,i=this.boundary.x,a=this.boundary.y,o=O.fromNumbers(i+r,a,i,a,i,a+n,i+r,a+n).map(s=>ye.fromTopLeft(s,r,n));this.#t=o.map(s=>new e0(this,s,this.level+1,this.opts))}},t0=class r0{value;label;#e;#t;constructor(r,n){this.value=r,this.label=n,this.#e=[]}getLengthChildren(){return this.#e.length}hasChild=r=>Sa(this,r);hasAnyChild=r=>Vi(this,r);hasParent=r=>rs(this,r);hasAnyParent=r=>u0(this,r);getByPath=(r,n={})=>{const i=i0(r,this,n);if(!!i[1])return i[1]};addValueByPath(r,n,i={}){const a=i.separator??".",u=n.split(a);u.at(-1);let o=this;for(const s of u){const c=o?.findChild(s);if(!c&&o){const l=new r0(void 0,s);o.add(l),o=l}else c&&(o=c)}o&&(o.value=r)}add(r){Mu(this,r),this.#e=[...this.#e,r],r.#t&&r.#t.remove(r),r.#t=this}remove(r){if(r.#t!==this)throw new Error("child.parent doesn't match");const n=ls(this.#e,r);if(n.length===this.#e.length)throw new Error("child not found in descendants");this.#e=n}setDescendants(r){for(const n of this.#e)n.#t=void 0;for(const n of r)Mu(this,n),n.#t=this;this.#e=r}prettyPrint(r=0){const n=`${"  ".repeat(r)} + label: ${this.label} value: ${this.value?JSON.stringify(this.value):"-"}`;return this.#e.length?n+`
`+this.#e.map(i=>i.prettyPrint(r+1)).join(`
`):n}*parents(){let r=this;for(;r.#t!==void 0;)yield r.#t,r=r.#t}*children(){for(const r of this.#e)yield r}findChild(r){if(r===void 0)throw new Error("label param cannot be undefined");for(const n of this.#e)if(n.label===r)return n}get isRoot(){return this.#t===void 0}get isEmpty(){return this.#e.length===0}},yA=(e,r)=>new t0(e,r);function ts(e){return jt(e,"p"),!(typeof e.children>"u"||typeof e.parents>"u")}var mA=e=>ts(e)&&typeof e.getLengthChildren<"u"?e.getLengthChildren():[...Fn(e)].length,n0=(e,r=0,n="root")=>{jt(e,"node");const i=Fa(e,n),a=`${"  ".repeat(r)} + label: ${i[0]} value: ${JSON.stringify(i[1])}`,u=[...Fn(e,n)];return u.length?a+`
`+u.map(o=>n0(o[1],r+1,o[0])).join(`
`):a};function*Fn(e,r){if(jt(e,"node"),Array.isArray(e)){r||(r="array");for(let n=0;n<e.length;n++)yield[r+"["+n.toString()+"]",e[n]]}else if(ts(e))for(const n of e.children())yield Fa(n);else typeof e=="object"&&("entries"in e&&(yield*e.entries()),yield*Object.entries(e))}function Us(e,r){for(const n of Fn(r))if(n[0]===e)return n}function i0(e,r,n={}){const i=ql(a0(e,r,n));if(!i)throw new Error(`Could not trace path: ${e}`);return i}function*a0(e,r,n={}){jt(e,"path"),jt(r,"node");const i=n.separator??".",a=n.allowArrayIndexes??!0,u=e.split(i);for(const o of u){let s=Us(o,r);if(a){const[c,l]=P0(o,"[","]"),f=vv(l,"positive",-1);f>=0&&(s=Us(c,r),s&&Array.isArray(s[1])&&(s=[o,s[1][f]]))}if(!s){yield[o,void 0];return}r=s[1],yield s}}function Fa(e,r=""){return"label"in e?[e.label,e]:[r,e]}function*gA(e){if(!e)return;const r=Ou();r.push(Fa(e,"root"));let n=r.pop();for(;n&&(yield n,n&&r.push(...Fn(n[1],n[0])),!r.isEmpty);)n=r.pop()}function*pA(e){if(!e)return;const r=xr();r.enqueue(Fa(e,"root"));let n=r.dequeue();for(;n&&(yield n,n&&r.enqueue(...Fn(n[1],n[0])),!r.isEmpty);)n=r.dequeue()}var Vi=(e,r,n=xe)=>Sa(e,r,Number.MAX_SAFE_INTEGER,n),Sa=(e,r,n=0,i=xe)=>{if(jt(e,"parent"),jt(r,"possibleChild"),n<0)return!1;for(const a of e.children())if(i(a,r)||Sa(a,r,n-1))return!0;return!1},rs=(e,r,n=0,i=xe)=>{jt(r,"possibleParent"),jt(e,"child");for(const a of e.parents()){if(i(a,r))return!0;if(n--,n<0)break}return!1},u0=(e,r,n=xe)=>rs(e,r,Number.MAX_SAFE_INTEGER,n),Mu=(e,r,n=xe)=>{if(jt(r,"prospectiveChild"),jt(e,"parent"),n(e,r))throw new Error("Child equals parent");if(Vi(e,r,n))throw new Error("Circular. Parent already has child");if(Vi(r,e,n))throw new Error("Prospective child has parent as child relation")},wA=(e,r)=>{const n=new Map(e.entries());return r.forEach(i=>{if(i[0]===void 0)throw new Error("key cannot be undefined");if(i[1]===void 0)throw new Error("value cannot be undefined");n.set(i[0],i[1])}),n},EA=(e,r)=>{const n=new Map(e.entries());return r.forEach(i=>{if(i.key===void 0)throw new Error("key cannot be undefined");if(i.value===void 0)throw new Error("value cannot be undefined");n.set(i.key,i.value)}),n},DA=(e,r)=>e.has(r),On=(e,...r)=>{if(e===void 0)throw new Error("map parameter is undefined");if(r===void 0)throw new Error("data parameter i.s undefined");if(r.length===0)return e;const n=r[0];return typeof n.key<"u"&&typeof n.value<"u"?EA(e,r):wA(e,r)},bA=(e,r,n)=>{const i=new Map(e.entries());return i.set(r,n),i},o0=(e,r)=>{const n=new Map(e.entries());return n.delete(r),n},Zr=e=>{if(e===void 0)return Zr([]);if(Array.isArray(e))return Zr(On(new Map,...e));const r=e;return{add:(...n)=>{const i=On(r,...n);return Zr(i)},get:n=>r.get(n),delete:n=>Zr(o0(r,n)),clear:()=>Zr(),has:n=>r.has(n),entries:()=>r.entries(),isEmpty:()=>r.size===0}},AA=(...e)=>{let r=On(new Map,...e);return{add:(...n)=>{r=On(r,...n)},delete:n=>{r=o0(r,n)},clear:()=>{r=On(new Map)},set:(n,i)=>{r=bA(r,n,i)},get:n=>r.get(n),entries:()=>r.entries(),isEmpty:()=>r.size===0,has:n=>DA(r,n)}},Ma=class extends tr{#e=new Map;groupBy;type;constructor(e,r={}){super();this.type=e,this.groupBy=r.groupBy??xn}get typeName(){return this.type.name}get lengthMax(){let e=0;for(const r of this.#e.values())e=Math.max(e,this.type.count(r));return e}debugString(){const e=Array.from(this.#e.keys());let r=`Keys: ${e.join(", ")}\r
`;return e.forEach(n=>{const i=this.#e.get(n);if(i!==void 0){const a=this.type.toArray(i);a!==void 0&&(r+=` - ${n} (${this.type.count(i)}) = ${JSON.stringify(a)}\r
`)}else r+=` - ${n} (undefined)\r
`}),r}get isEmpty(){return this.#e.size===0}clear(){this.#e.clear(),super.fireEvent("clear",!0)}addKeyedValues(e,...r){const n=this.#e.get(e);n===void 0?(this.#e.set(e,this.type.add(void 0,r)),super.fireEvent("addedKey",{key:e}),super.fireEvent("addedValues",{values:r})):(this.#e.set(e,this.type.add(n,r)),super.fireEvent("addedValues",{values:r}))}set(e,r){return this.addKeyedValues(e,...r),this}addValue(...e){e.forEach(r=>this.addKeyedValues(this.groupBy(r),r))}hasKeyValue(e,r,n){const i=this.#e.get(e);return i===void 0?!1:this.type.has(i,r,n)}has(e){return this.#e.has(e)}deleteKeyValue(e,r){const n=this.#e.get(e);return n===void 0?!1:this.deleteKeyValueFromMap(n,e,r)}deleteKeyValueFromMap(e,r,n){const i=this.type.count(e),a=this.type.without(e,n),u=a.length;return this.#e.set(r,this.type.add(void 0,a)),i>u}deleteByValue(e){let r=!1;return Array.from(this.#e.keys()).filter(n=>{const i=this.#e.get(n);if(!i)throw Error("Bug: map could not be accessed");this.deleteKeyValueFromMap(i,n,e)&&(r=!0,this.count(n)===0&&this.delete(n))}),r}delete(e){return this.#e.get(e)===void 0?!1:(this.#e.delete(e),this.fireEvent("deleteKey",{key:e}),!0)}firstKeyByValue(e,r=xe){return Array.from(this.#e.keys()).find(a=>{const u=this.#e.get(a);if(u===void 0)throw Error("Bug: map could not be accessed");return this.type.has(u,e,r)})}count(e){const r=this.#e.get(e);return r===void 0?0:this.type.count(r)}get(e){const r=this.#e.get(e);return r===void 0?[]:this.type.toArray(r)}*values(e){const r=this.#e.get(e);r!==void 0&&(yield*this.type.iterable(r))}*valuesFor(e){const r=this.#e.get(e);r!==void 0&&(yield*this.type.iterable(r))}getSource(e){return this.#e.get(e)}*keys(){yield*this.#e.keys()}*entriesFlat(){for(const e of this.#e.entries())for(const r of this.type.iterable(e[1]))yield[e[0],r]}*entries(){for(const[e,r]of this.#e.entries()){const n=[...this.type.iterable(r)];yield[e,n]}}*keysAndCounts(){for(const e of this.keys())yield[e,this.count(e)]}merge(e){for(const r of e.keys()){const n=e.values(r);this.addKeyedValues(r,...n)}}get size(){return this.#e.size}forEach(e,r){this.#e.forEach(e)}get[Symbol.toStringTag](){return this.#e[Symbol.toStringTag]}},CA=e=>{const r=e?.hash??xn,n=(u,o)=>r(u)===r(o),i={get name(){return"set"},iterable:u=>u.values(),add:(u,o)=>Ac(u,r,...o),count:u=>u.size,find:(u,o)=>Mc(u,o),filter:(u,o)=>Sc(u,o),toArray:u=>eu(u),has:(u,o)=>Fc(u,o,n),without:(u,o)=>ls(eu(u),o,n)};return new Ma(i,e)},s0=e=>{const r=xe,n={get name(){return"circular"},add:(i,a)=>{i===void 0&&(i=Pc(e.capacity));for(const u of a)i=i.add(u);return i},count:i=>i.length,find:(i,a)=>i.find(a),filter:(i,a)=>i.filter(a),toArray:i=>i,iterable:i=>i.values(),has:(i,a)=>i.find(u=>r(u,a))!==void 0,without:(i,a)=>i.filter(u=>!r(u,a))};return new Ma(n,e)},c0=(e={})=>{const r=e.comparer===void 0?e.toString===void 0?(a,u)=>e.toString(a)===e.toString(u):xe:e.comparer,n={get name(){return"array"},add:(a,u)=>a===void 0?[...u]:[...a,...u],iterable:a=>a.values(),count:a=>a.length,find:(a,u)=>a.find(u),filter:(a,u)=>a.filter(u),toArray:a=>a,has:(a,u)=>a.find(o=>r(o,u))!==void 0,without:(a,u)=>a.filter(o=>!r(o,u))};return new Ma(n,e)},l0=e=>typeof e>"u"?r=>{}:typeof e=="boolean"?r=>{const n=r.kind??"info";let i=r.msg;switch(r.category&&(i=`[${r.category}] ${i}`),n){case"error":console.error(i);break;case"warn":console.warn(i);break;case"info":console.info(i);break;default:console.log(i)}}:e,FA=0,SA=bc(new Map,()=>mf(++FA)),f0=(e,r=!0,n)=>r?{log:Qr(e,"log",n),warn:Qr(e,"warn",n),error:Qr(e,"error",n)}:{log:i=>{},warn:Qr(e,"warn",n),error:Qr(e,"error",n)},Qr=(e,r="log",n)=>i=>{i===void 0?i="(undefined)":typeof i=="object"&&(i=JSON.stringify(i));const a=n??e;switch(r){case"log":console.log(`%c${e} ${i}`,`color: ${SA(a)}`);break;case"warn":console.warn(e,i);break;case"error":console.error(e,i);break}},ns=async(e,r)=>{const n=r.abort,i=l0(r.log),a=r.power??1.1,u=r.predelayMs??0,o=bi();let s=r.startMs;const c=r.count;let l=0;if(u>0&&await Zt({millis:u,signal:n}),n?.aborted)return{success:!1,attempts:l,elapsed:o(),message:"Aborted during predelay"};for(;l<=c;){if(l++,await e())return{success:!0,attempts:l,elapsed:o()};i({msg:`retryWithBackOff attempts: ${l} t: ${sc(s)}`});try{await Zt({millis:s,signal:n})}catch{return{success:!1,attempts:l,message:"Sleep failed, possibly due to abort signal",elapsed:o()}}s=Math.floor(Math.pow(s,a))}return{success:!1,attempts:l,elapsed:o()}},MA=class h0{static instance=new h0;_timer=0;_queue;_startDelayMs;_intervalMs;constructor(r={}){this._startDelayMs=r.startDelayMs??500,this._intervalMs=r.intervalMs??100,this._queue=xr()}add(r){this._queue.enqueue(r),this._timer===0&&this.schedule(this._startDelayMs)}schedule(r){if(this._queue.length===0){this._timer=0;return}this._timer===0&&(this._timer=setTimeout(()=>{this.processQueue()},r))}async processQueue(){const r=this._queue.dequeue();if(this._timer=0,r!==void 0)try{await r(),this._timer=0,this.schedule(this._intervalMs)}catch(n){console.error(n)}}},d0=(e,r)=>{for(const n of e){const i=r(n);if(typeof i=="boolean"&&!i)break}},v0=async function(e,r,n){if(Array.isArray(e))for(const i of e){const a=await r(i);if(n&&await Zt(n),typeof a=="boolean"&&!a)break}else for await(const i of e){const a=await r(i);if(n&&await Zt(n),typeof a=="boolean"&&!a)break}},is=(e,r)=>{let n,i;n=i=0;const a=[];if(typeof e=="number")for(Y(e,"positive","countOrPredicate");e-- >0;){n++;const u=r();u!==void 0&&(a.push(u),i++)}else for(;e(n,i);){n++;const u=r();u!==void 0&&(a.push(u),i++)}return a},IA=(e,r,n,i)=>{if(typeof e=="number")for(Y(e,"positive","countOrPredicate");e-- >0;){const a=r();a!==void 0&&(n=i(n,a))}else{let a,u;for(a=u=0;e(a,u);){a++;const o=r();o!==void 0&&(n=i(n,o),u++)}}return n};try{typeof window<"u"&&(window.ixfx={...window.ixfx,Flow:{StateMachine:Bu,Timer:fc,forEach:d0,forEachAsync:v0,repeat:is}})}catch{}var Iu=(e,r)=>Number.isNaN(e)?r:e,_A=(e,r)=>{const n=Object.entries(e).map(([i,a],u)=>[i,r(a,i,u)]);return Object.fromEntries(n)},y0=e=>Math.log2(e)%1===0,PA=e=>r=>r/e,Ia=(e,r="")=>{if(r.length===0)return e;if(r in e)return e[r];{const n=B0(r,".");return n in e?Ia(e[n],r.substring(n.length+1)):void 0}},as=e=>{const r=[],n=(i,a="")=>{if(typeof i=="object"){const u=Object.keys(i);a.length>0&&(a+="."),u.forEach(o=>n(i[o],a+o))}else r.push(a)};return n(e),r},m0=(e,r)=>(Y(e,"nonZero","v"),Y(r,"nonZero","muliple"),Math.ceil(e/r)*r),xe=(e,r)=>e===r,g0=(e,r)=>e===r?!0:xn(e)===xn(r),xn=e=>typeof e=="string"?e:JSON.stringify(e),RA=()=>["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,us=(e,r)=>{if(e===void 0&&r===void 0)return 0;if(e===void 0)return 1;if(r===void 0)return-1;const n=Vs(e),i=Vs(r);return n<i?-1:n>i?1:0},ui=e=>typeof e=="string"?e:JSON.stringify(e),Vs=e=>{if(e===null)return"null";if(typeof e=="boolean"||typeof e=="number")return e.toString();if(typeof e=="string")return e;if(typeof e=="symbol")throw new TypeError;return e.toString()};try{typeof window<"u"&&(window.ixfx={...window.ixfx,getFieldByPath:Ia,getFieldPaths:as})}catch{}var Sn=(e,r="?")=>{if(e===void 0)throw new Error(`Param '${r}' is undefined. Expected array.`);if(e===null)throw new Error(`Param '${r}' is null. Expected array.`);if(!Array.isArray(e))throw new Error(`Param '${r}' not an array as expected`)},xi=(e,r,n="index")=>{if(Sn(e),Ee(r,"positive",n),r>e.length-1)throw new Error(`'${n}' ${r} beyond array max of ${e.length-1}`)},os=(e,r)=>{if(!Array.isArray(e))throw new Error("Param 'array' is not an array.");if(e.length===0)return!0;const n=r===void 0?g0:r,i=e[0];return!e.some(u=>!n(i,u))},BA=(e,r,n=xe)=>e.filter(i=>r.some(a=>n(i,a))),NA=e=>Array.prototype.concat.apply([],[...e]),p0=(...e)=>{if(e.some(a=>!Array.isArray(a)))throw new Error("All parameters must be an array");const r=e.map(a=>a.length);if(!os(r))throw new Error("Arrays must be of same length");const n=[],i=r[0];for(let a=0;a<i;a++)n.push(e.map(u=>u[a]));return n},zA=(...e)=>{if(e.some(a=>!Array.isArray(a)))throw new Error("All parameters must be an array");const r=e.map(a=>a.length);if(!os(r))throw new Error("Arrays must be of same length");const n=[],i=r[0];for(let a=0;a<i;a++)for(let u=0;u<e.length;u++)n.push(e[u][a]);return n},WA=(e,r,n="undefined")=>{if(e===void 0)throw new Error("Data undefined");if(!Array.isArray(e))throw new Error("data is not an array");if(e.length===r)return[...e];if(e.length>r)return e.slice(0,r);const i=[...e],a=r-i.length;for(let u=0;u<a;u++)n==="undefined"?i.push(void 0):n==="repeat"?i.push(e[u%e.length]):n==="first"?i.push(e[0]):n==="last"&&i.push(e[e.length-1]);return i},w0=(e,r,n,i)=>{Sn(e),typeof n>"u"&&(n=0),typeof i>"u"&&(i=e.length-1),xi(e,n,"startIndex"),xi(e,i,"endIndex");const a=[];for(let u=n;u<=i;u++)r(e[u],u,e)&&a.push(e[u]);return a},ss=(e,r=et)=>Math.floor(r()*e.length),cs=(e,r=et)=>(Sn(e,"array"),e[Math.floor(r()*e.length)]),kA=(e,r=!1,n=et)=>{if(e===void 0)throw new Error("array is undefined");if(!Array.isArray(e))throw new Error("'array' param is not an array");if(e.length===0)return{value:void 0,array:[]};const i=ss(e,n);if(r)return{value:e[i],array:e.splice(i,1)};{const a=[...e];return a.splice(i,1),{value:e[i],array:a}}},_u=(e,r=et)=>{const n=[...e];for(let i=n.length-1;i>0;i--){const a=Math.floor(r()*(i+1));[n[i],n[a]]=[n[a],n[i]]}return n},E0=(e,r)=>[...e].sort((n,i)=>{Sn(e,"data");const a=n[r],u=i[r];return a<u?-1:a>u?1:0}),ls=(e,r,n=xe)=>e.filter(i=>!n(i,r)),OA=(e,r,n)=>{const i=[];let a=n;for(let u=0;u<e.length;u++){const[o,s]=r(e[u],a);if(o)break;a=s,i.push(e[u])}return i},LA=(e,r)=>{if(!Array.isArray(e))throw new Error("'data' parameter should be an array");return xi(e,r,"index"),[...e.slice(0,r),...e.slice(r+1)]},$A=(e,r)=>e.reduce((n,i)=>{const a=r(i),u=n.get(a);return u===void 0?n.set(a,[i]):u.push(i),n},new Map),TA=(e,r)=>{let n=1;if(r<=1){const a=e.length*r;n=Math.round(e.length/a)}else n=r;if(Ee(n,"positive","amount"),n>e.length-1)throw new Error("Subsample steps exceeds array length");const i=[];for(let a=n-1;a<e.length;a+=n)i.push(e[a]);return i};function qA(e,r){const n=[];for(let i=0;i<e.length;i+=r)n.push(e.slice(i,i+r));return n}var jA=(e,r,...n)=>{const i=new Map;for(const a of n)for(const u of a){if(u===void 0)continue;const o=e(u);let s=i.get(o);s?s=r(s,u):s=u,i.set(o,s)}return[...i.values()]},UA=(e,r,n)=>{if(Sn(e,"arr"),e.length<2)return n;for(let i=0;i<e.length-1;i++)n=r(n,e[i],e[i+1]);return n},D0=(e,r,n)=>{const i=n??xe,a=[...e];for(const u of r)a.find(s=>i(s,u))||a.push(u);return a},VA=(e,r)=>{const n=[],i=[];for(let a=0;a<e.length;a++)r(e[a])?n.push(e[a]):i.push(e[a]);return[n,i]},xA=(e,r=xe)=>{let n=[];return e.forEach(i=>{n=D0(n,i,r)}),n},et=Math.random,b0=(e="quadIn")=>{const r=typeof e=="string"?{easing:e}:e,n=r.source??et,i=r.easing??"quadIn",a=ga(i);if(a===void 0)throw new Error(`Easing function '${i}' not found.`);return()=>{const o=n();return a(o)}},HA=(e="quadIn")=>b0(e)(),A0=e=>{const r=typeof e=="number"?{max:e}:e,n=r.source??et,i=r.max,a=r.min??0,u=r.easing??"quadIn";if(i===void 0)throw new Error("max field is undefined");if(typeof u!="string")throw new Error("easing field expected to be string");Y(i);const o=ga(u);if(o===void 0)throw new Error(`Easing '${u}' not found`);if(Y(a),i<=a)throw new Error("Max should be greater than min");return()=>{const c=Rt(o(n()));return Math.floor(c*(i-a))+a}},KA=e=>A0(e)(),JA=(e=1)=>C0(e)(),C0=(e=1)=>{const i=()=>{let a=0,u=0;for(;a===0;)a=Math.random();for(;u===0;)u=Math.random();let o=Math.sqrt(-2*Math.log(a))*Math.cos(2*Math.PI*u);return o=o/10+.5,o>1||o<0?o=i():(o=Math.pow(o,e),o*=1,o+=0),o};return i},fs=e=>{if(typeof e>"u")throw new Error("maxOrOpts is undefined");const r=typeof e=="number"?{max:e}:e;let n=Math.floor(r.max),i=Math.floor(r.min??0);!r.min&&n<0&&(n=1,i=r.max);const a=r.source??et;if(i>n)throw new Error(`Min value is greater than max (min: ${i} max: ${n})`);if(Y(i,"","min"),Y(n,"","max"),n===i)throw new Error(`Max and min values cannot be the same (${n})`);const u=Math.abs(n-i);return()=>Math.floor(a()*u)+i},F0=e=>fs(e)(),hs=(e=1)=>{const r=typeof e=="number"?{max:e}:e;let n=r.max,i=r.min??0;const a=r.source??et;if(Y(i,"","min"),Y(n,"","max"),!r.min&&n<0&&(i=n,n=0),i>n)throw new Error(`Min is greater than max. Min: ${i} max: ${n}`);return()=>a()*(n-i)+i},S0=(e=1)=>hs(e)(),ds=(e=5)=>{((typeof e=="number"?{length:e}:e).source??et)().toString(36).substring(2,length+2)},GA=(e={})=>{const r=e.source??et,n=r()*46656|0,i=r()*46656|0,a=`000${n.toString(36)}`.slice(-3),u=`000${i.toString(36)}`.slice(-3);return a+u},M0=e=>{const r=typeof e=="number"?{max:e}:e,n=(r.min??0)*60*1e3,i=r.max*60*1e3;return fs({...r,max:i,min:n})},YA=e=>M0(e)(),I0=e=>{const r=typeof e=="number"?{max:e}:e,n=(r.min??0)*1e3,i=r.max*1e3;return()=>F0({...r,max:i,min:n})},XA=e=>I0(e)();function*_0(e){const r=typeof e=="number"?{max:e}:e,n=r.min??0,i=r.max,a=r.source??et,u=r.loop??!1;if(Ee(n,"","min"),Ee(i,"","max"),n>i)throw new Error(`Min value is greater than max. Min: ${n} Max: ${i}`);const o=[...jl(n,i-n)];let s=_u(o),c=0;for(;;){if(c===s.length)if(u)s=_u(o,a);else return;yield s[c++]}}var ZA=(e,r,n,i=!0)=>{const a=e.indexOf(r);if(a<0)return;n===void 0&&(n=r);const u=i?e.lastIndexOf(n):e.indexOf(n,a+1);if(!(u<0))return e.substring(a+1,u)},P0=(e,r,n,i=!0)=>{const a=e.indexOf(r);if(a<0)return[e,void 0];n===void 0&&(n=r);const u=i?e.lastIndexOf(n):e.indexOf(n,a+1);if(u<0)return[e,void 0];const o=e.substring(a+1,u);return[e.substring(0,a)+e.substring(u+1),o]},Hn=(e,r,n=0,i=e.length-1)=>{for(let a=n;a<=i;a++)if(e.charCodeAt(a)===r)return a;return-1},Kn=(e,r,n)=>e.substring(0,r)+e.substring(r+n),R0=(e,r)=>{if(Ee(r,"aboveZero","length"),e===null)throw new Error("source parameter null");if(typeof e!="string")throw new Error("source parameter not a string");const n=Math.ceil(e.length/r),i=[];let a=0;for(let u=0;u<n;u++)i.push(e.substring(a,a+r)),a+=r;return i},B0=(e,r,n={})=>{const i=n.startPos??void 0,u=n.fromEnd??!1?e.lastIndexOf(r,i):e.indexOf(r,i);return u<0?e:e.substring(i??0,u)},QA=(e,r,n={})=>{const i=n.startPos??void 0,u=n.fromEnd??!1?e.lastIndexOf(r,i):e.indexOf(r,i);return u<0?e:e.substring(u+r.length)},eC=(e,...r)=>{let n=!1;do{n=!1;for(const i of r)e.startsWith(i)&&e.endsWith(i)&&(e=e.substring(i.length,e.length-i.length*2+1),n=!0)}while(n);return e},tC=(e,r,n)=>{let i=-1,a=-1;for(let u=0;u<e.length;u++){const o=e[u];if(i=u,o.text.length!==0&&r<o.end)break}for(let u=i;u<e.length;u++){const o=e[u];if(a=u,n===o.end){a=u+1;break}if(n<o.end)break}return{length:a-i,start:i,end:a}},rC=(e,r)=>{let n=0,i="";const a=[];let u=0;for(let o=0;o<e.length;o++)if(e.indexOf(r,o)===o){const s=o;a.push({text:i,start:n,end:s,index:u}),n=s+1,i="",u++}else i+=e.charAt(o);return n<e.length&&a.push({text:i,start:n,index:u,end:e.length}),a},nC=(e,...r)=>{let n=0;for(let i=0;i<e.length&&r.includes(e.charAt(i));i++)n++;return n},iC=(e,r,n=r)=>e.startsWith(r)&&e.endsWith(n),aC=e=>e.replace(/[\u00A0-\u9999<>\&]/g,r=>`&#${r.charCodeAt(0)};`);/*! Bundled license information:

tslib/tslib.es6.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)
*/export{Jr as $,Vt as A,Zn as B,ti as C,ta as D,$u as E,Fh as F,Qm as G,At as H,dh as I,Fr as J,W1 as K,Ke as L,k1 as M,Lc as N,Qu as O,Ro as P,Ks as Q,Rc as R,ki as S,uC as T,qc as U,qi as V,aD as W,gv as X,QE as Y,ZE as Z,oC as _,xu as a,Wo as b,q1 as c,Gc as d,Rv as e,pr as f,Nu as g,wv as h,HA as i,Dl as j,JA as k,KE as l,is as m,fo as n,Oo as o,iE as p,O as q,Le as r,Ca as s,T1 as t,B0 as u,Ih as v,KA as w,Ve as x,Lu as y,Io as z};
