<!DOCTYPE html><html class="astro-EACUI2QC"><head><link rel="stylesheet" href="../../assets/demos.33272ba6.css"><link rel="stylesheet" href="../../assets/GridDataPlay.77a08dc2.css">
<script type="module" src="../../assets/GridEditor.f75bc602.js"></script>
<!-- <script type="module" src={Astro.resolve('./grid.ts')}></script> -->


<script type="module">
import {resolveEl,Forms} from 'ixfx/lib/dom';
import {Arrays} from 'ixfx/lib/collections';
import {Grids} from 'ixfx/lib/geometry';
import {DictionaryOfColourCombinations} from 'ixfx/lib/visual';
const dataGrid = resolveEl(`#dataGrid`);
const dataGridRead = resolveEl(`#dataGridRead`);
const dataGridStore = new Map();
const palette = DictionaryOfColourCombinations.randomPalette();

Forms.button(`#btnDataRandom`, () => randomGrid());
dataGrid.cellRenderer = (cell, rect, ctx) => {
  const d = dataGridStore.get(Grids.cellKeyString(cell));
  if (d === undefined) return;
  const [r, g, b] = d.colour;
  ctx.fillStyle = `rgba(${r}, ${g}, ${b}, ${d.funk})`;
  ctx.fillRect(rect.x, rect.y, rect.width, rect.height);
  return true;
};
dataGrid.addEventListener(`cellPointerMove`, (ev) => {
  const cell = ev.detail;
  if (cell === undefined) return;
  const d = dataGridStore.get(Grids.cellKeyString(cell));

  dataGridRead.innerText = `Cell ${cell.x}, ${cell.y} has data ${JSON.stringify(d)}`;
});

const randomGrid = () => {
  const shape = dataGrid.getGrid();

  const randomColour = () => Arrays.randomElement(palette).rgb;
  for (let cell of Grids.cells(shape)) {
    dataGridStore.set(Grids.cellKeyString(cell), {colour: randomColour(), funk: Math.random()});
  }
  dataGrid.draw();
}
randomGrid();
</script>
</head><body><section id="dataGridSection" class="astro-EACUI2QC">
  <grid-editor rows="15" cols="15" pixelsize="20" id="dataGrid" class="astro-EACUI2QC">undefined</grid-editor>
  <button id="btnDataRandom" class="astro-EACUI2QC">Randomise</button>
  <div id="dataGridRead" class="astro-EACUI2QC">&nbsp;</div>
</section>
</body></html>