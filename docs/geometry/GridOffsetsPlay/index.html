<!DOCTYPE html><html class="astro-IXHMJMIF"><head><link rel="stylesheet" href="../../assets/demos.33272ba6.css"><link rel="stylesheet" href="../../assets/GridOffsetsPlay.b5ab084a.css">
<script type="module" src="../../assets/GridEditor.dc6ba050.js"></script>
<!-- <script type="module" src={Astro.resolve('./grid.ts')}></script> -->

<script type="module">

import {resolveEl} from 'ixfx/lib/dom';
import {Forms} from 'ixfx/lib/dom';
import {Grids} from 'ixfx/lib/geometry';
import {Palette} from 'ixfx/lib/visual';
const offsetsGrid = resolveEl(`#offsetsGrid`);
offsetsGrid.selectedCell = {x: 0, y: 0};

const offsets = () => {
  const grid = offsetsGrid.getGrid();
  const distance = offsetsDistance.value;
  const selected = offsetsGrid.selectedCell;

  const offsets = Grids.offsetCardinals(grid, selected, distance, offsetsWrapSel.value);
  offsetsGrid.cellRenderer = (cell, rect, ctx) => {
    const kv = Object.entries(offsets).find(t => Grids.cellEquals(t[1], cell));
    if (kv === undefined) return false;

    //if (kv[0] === `s`) console.log(kv[0] + ' ' + JSON.stringify(kv[1]));
    ctx.fillStyle = Palette.getCssVariable(`theme-bg-hover`, `yellow`);
    //ctx.fillRect(rect.x, rect.y, rect.width, rect.height);
    ctx.fillStyle = `white`;
    ctx.textBaseline = `top`;

    const yOffset = kv[0].startsWith(`n`) ? 20 : 5;
    ctx.fillText(kv[0], rect.x + 5, rect.y + yOffset);

    return true;
  }
}
offsetsGrid.addEventListener(`cellPointerMove`, (ev) => {
  const cell = ev.detail;
  if (cell === undefined) return;
  offsetsGrid.selectedCell = cell;
  offsets();
});
const offsetsDistance = Forms.numeric(`#rangeOffsetsDistance`, offsets);
const offsetsWrapSel = Forms.select(`#selOffsetsWrap`, offsets);

offsets();
</script>
</head><body><div class="toolbar astro-IXHMJMIF">
  <section class="astro-IXHMJMIF">
    <label class="astro-IXHMJMIF">Bounds:</label>
    <select id="selOffsetsWrap" title="How should coordinate wrapping behave?" class="astro-IXHMJMIF">
      <option class="astro-IXHMJMIF">stop</option>
      <option class="astro-IXHMJMIF">wrap</option>
      <option class="astro-IXHMJMIF">undefined</option>
    </select>
  </section>
  <section class="astro-IXHMJMIF">
    <label class="astro-IXHMJMIF">Distance:</label>
    <input title="Coordinate distance" type="range" id="rangeOffsetsDistance" value="2" min="1" max="4" class="astro-IXHMJMIF">
  </section>
</div>
<div class="astro-IXHMJMIF">
  <grid-editor rows="5" cols="5" pixelsize="30" id="offsetsGrid" class="astro-IXHMJMIF">undefined</grid-editor>
</div></body></html>