import{d as h,a as g}from"./chunk-NT44FLGP.251679ab.js";import"./chunk-KYWIDCWW.4c25be89.js";import"./chunk-VN6BZR7Y.59fd31c7.js";import{l as v,F as a,a as w}from"./chunk-4WJCK6OW.7396b794.js";import{P as m,a as k}from"./chunk-G44UTPJC.92d22f4f.js";import"./chunk-SG7ZQ2JY.9cef9652.js";import{f as D,m as j,d as x}from"./vendor.d00e998c.js";const r=v("#envDataStream",{minIntervalMs:20,capacity:150}),f=m.create();f.add("series-",m.getCssVariable("accent-bold","yellow"));const n=k.plot2("#envData",{capacity:300,showYAxis:!0,palette:f,lineWidth:3});let l={...h(),attackBend:1,decayBend:-1,releaseBend:1},c=!1,t=g({...l,shouldLoop:c});t.addEventListener("change",e=>{a.button("#btnRelease").disabled=e.newState!=="sustain"});a.button("#btnTriggerHold",()=>{r.clear(),t.trigger(!0),o()});a.button("#btnRelease",()=>{t.release()});a.button("#btnTrigger",()=>{r.clear(),t.trigger(),o()});const E=a.select("#selectShow",e=>{n.clear(),r.log(),o()});D(w("#envEditor"),"change").pipe(j(e=>e.detail),x(1e3)).subscribe(e=>{l=e,i()});const i=()=>{try{t=g({...l,shouldLoop:c}),t.trigger(),r.clear(),n.clear(),o()}catch(e){r.error(e)}};a.checkbox("#chkLooping",e=>{c=e,i()});let s=!1;const o=()=>{if(s)return;const e=function(){let[d,b,u]=t.compute();if(u<0)debugger;if(d===void 0){s=!1;return}const p=E.value==="raw"?u:b;n.add(p),r.log(`${d} ${p.toFixed(3)}`),t.isDone?(console.log("Envelope done"),s=!1):(s=!0,window.requestAnimationFrame(e))};window.requestAnimationFrame(e)};i();
