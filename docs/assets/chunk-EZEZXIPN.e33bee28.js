import{i as w,S as N}from"./chunk-HCHJFXUB.99dbbc1f.js";import{l as Q,n as D,q as b,o as I}from"./chunk-OW53XONI.6c7bafde.js";import{_ as T,c as o,b as m,d as h,e as i}from"./chunk-X3ZGK7G7.0ec20d2d.js";import{S as j}from"./chunk-6TOA6ITG.8d1de678.js";var W={};T(W,{continuously:()=>Z,delay:()=>G,msElapsedTimer:()=>E,relativeTimer:()=>A,sleep:()=>_,ticksElapsedTimer:()=>S,timeout:()=>q});var q=(e,t)=>{if(e===void 0)throw new Error("callback parameter is undefined");w(t,"aboveZero","timeoutMs");let s=0;return{start:(v=t)=>{w(v,"aboveZero","altTimeoutMs"),s!==0&&stop(),s=window.setTimeout(()=>{e(),s=0},v)},cancel:()=>{s!==0&&window.clearTimeout(s)},get isDone(){return s!==0}}},Z=(e,t,s)=>{t!==void 0&&w(t,"aboveZero","intervalMs");let a=!1,n=0;const v=t===void 0?u=>window.requestAnimationFrame(u):u=>window.setTimeout(u,t),O=()=>{!a||(a=!1,n=0)},B=()=>{if(!a)return;const u=e(n++);if(u!==void 0&&!u){O();return}v(B)};return{start:()=>{if(a&&s!==void 0){const u=s(n);if(u!==void 0&&!u){O();return}}else if(a)return;a=!0,v(B)},get isDone(){return a},get ticks(){return n},cancel:O}},_=e=>new Promise(t=>setTimeout(t,e)),G=async(e,t)=>(w(t,"aboveZero","timeoutMs"),await _(t),Promise.resolve(await e())),A=(e,t,s=!0)=>{let a=!1;return{get isDone(){return a},reset:()=>{a=!1,t.reset()},get elapsed(){let n=t.elapsed/e;return s&&(n=Q(n)),n>=1&&(a=!0),n}}},E=()=>{let e=window.performance.now();return{reset:()=>{e=window.performance.now()},get elapsed(){return window.performance.now()-e}}},S=()=>{let e=0;return{reset:()=>{e=0},get elapsed(){return e++}}},$={};T($,{adsr:()=>z,defaultAdsrOpts:()=>U,easeOverTicks:()=>H,easeOverTime:()=>F,getEasings:()=>X});var g=Math.sqrt,r=Math.pow,P=Math.cos,f=Math.PI,k=Math.sin,F=function(e,t){return M(e,t,E)},H=function(e,t){return M(e,t,S)},M=function(e,t,s){const a=R(e),n=A(t,s(),!0);return{get isDone(){return n.isDone},compute:()=>{const v=n.elapsed;return a(v)},reset:()=>{n.reset()}}},R=function(e){e=e.toLocaleLowerCase();const t=Object.entries(C).find(([s,a])=>s.toLocaleLowerCase()===e);if(t===void 0)throw new Error(`Easing '${e}' not found.`);return t[1]},X=function(){return Array.from(Object.keys(C))},L=function(e){const t=7.5625,s=2.75;return e<1/s?t*e*e:e<2/s?t*(e-=1.5/s)*e+.75:e<2.5/s?t*(e-=2.25/s)*e+.9375:t*(e-=2.625/s)*e+.984375},C={easeInSine:e=>1-P(e*f/2),easeOutSine:e=>k(e*f/2),easeInQuad:e=>e*e,easeOutQuad:e=>1-(1-e)*(1-e),easeInOutSine:e=>-(P(f*e)-1)/2,easeInOutQuad:e=>e<.5?2*e*e:1-r(-2*e+2,2)/2,easeInCubic:e=>e*e*e,easeOutCubic:e=>1-r(1-e,3),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1-r(1-e,4),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1-r(1-e,5),easeInExpo:e=>e===0?0:r(2,10*e-10),easeOutExpo:e=>e===1?1:1-r(2,-10*e),easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1-r(-2*e+2,5)/2,easeInOutExpo:e=>e===0?0:e===1?1:e<.5?r(2,20*e-10)/2:(2-r(2,-20*e+10))/2,easeInCirc:e=>1-g(1-r(e,2)),easeOutCirc:e=>g(1-r(e-1,2)),easeInBack:e=>{const t=1.70158;return(t+1)*e*e*e-t*e*e},easeOutBack:e=>{const t=1.70158,s=t+1;return 1+s*r(e-1,3)+t*r(e-1,2)},easeInOutCirc:e=>e<.5?(1-g(1-r(2*e,2)))/2:(g(1-r(-2*e+2,2))+1)/2,easeInOutBack:e=>{const s=1.70158*1.525;return e<.5?r(2*e,2)*((s+1)*2*e-s)/2:(r(2*e-2,2)*((s+1)*(e*2-2)+s)+2)/2},easeInElastic:e=>{const t=2*f/3;return e===0?0:e===1?1:-r(2,10*e-10)*k((e*10-10.75)*t)},easeOutElastic:e=>{const t=2*f/3;return e===0?0:e===1?1:r(2,-10*e)*k((e*10-.75)*t)+1},easeInBounce:e=>1-L(1-e),easeOutBounce:L,easeInOutElastic:e=>{const t=2*f/4.5;return e===0?0:e===1?1:e<.5?-(r(2,20*e-10)*k((20*e-11.125)*t))/2:r(2,-20*e+10)*k((20*e-11.125)*t)/2+1},easeInOutBounce:e=>e<.5?(1-L(1-2*e))/2:(1+L(2*e-1))/2},U=()=>({attackBend:-1,decayBend:-.3,releaseBend:-.3,peakLevel:1,initialLevel:0,sustainLevel:.6,releaseLevel:0,attackDuration:600,decayDuration:200,releaseDuration:800,shouldLoop:!1}),c,y,l,p,d,J=class extends N{constructor(e){super();m(this,c,void 0),m(this,y,void 0),m(this,l,void 0),m(this,p,void 0),m(this,d,void 0),o(this,"attackDuration"),o(this,"decayDuration"),o(this,"releaseDuration"),o(this,"decayDurationTotal"),o(this,"shouldLoop"),this.attackDuration=e.attackDuration??300,this.decayDuration=e.decayDuration??500,this.releaseDuration=e.releaseDuration??1e3,this.shouldLoop=e.shouldLoop??!1;const t={attack:["decay","release"],decay:["sustain","release"],sustain:["release"],release:["complete"],complete:null};h(this,c,new j("attack",t)),i(this,c).addEventListener("change",s=>{s.newState==="release"&&i(this,d)&&i(this,l)?.reset(),super.fireEvent("change",s)}),i(this,c).addEventListener("stop",s=>{super.fireEvent("complete",s)}),h(this,y,E),h(this,p,h(this,d,!1)),this.decayDurationTotal=this.attackDuration+this.decayDuration}switchState(){if(i(this,l)===void 0)return!1;let e=i(this,l).elapsed;const t=i(this,d)&&!i(this,p);let s=!1;do switch(s=!1,i(this,c).state){case"attack":(e>this.attackDuration||t)&&(i(this,c).next(),s=!0);break;case"decay":(e>this.decayDurationTotal||t)&&(i(this,c).next(),s=!0);break;case"sustain":(!i(this,p)||t)&&(e=0,i(this,c).next(),i(this,l)?.reset(),s=!0);break;case"release":e>this.releaseDuration&&(i(this,c).next(),s=!0);break;case"complete":this.shouldLoop&&this.trigger(i(this,d))}while(s);return s}computeRaw(e=!0){if(i(this,l)===void 0)return[void 0,0,i(this,c).state];e&&this.switchState();const t=i(this,c).state,s=i(this,l).elapsed;let a=0;const n=i(this,c).state;switch(n){case"attack":a=s/this.attackDuration;break;case"decay":a=(s-this.attackDuration)/this.decayDuration;break;case"sustain":a=1;break;case"release":a=Math.min(s/this.releaseDuration,1);break;case"complete":return[void 0,1,t];default:throw new Error(`State machine in unknown state: ${n}`)}return[n,a,t]}get isDone(){return i(this,c).isDone}onTrigger(){}trigger(e=!1){this.onTrigger(),i(this,c).reset(),h(this,l,i(this,y).call(this)),h(this,p,e),h(this,d,e)}compute(){}release(){this.isDone||!i(this,d)||(h(this,p,!1),this.compute())}};c=new WeakMap;y=new WeakMap;l=new WeakMap;p=new WeakMap;d=new WeakMap;var K=class extends J{constructor(e){super(e);o(this,"attackPath"),o(this,"decayPath"),o(this,"releasePath"),o(this,"initialLevel"),o(this,"peakLevel"),o(this,"releaseLevel"),o(this,"sustainLevel"),o(this,"attackBend"),o(this,"decayBend"),o(this,"releaseBend"),o(this,"initialLevelOverride"),o(this,"retrigger"),o(this,"releasedAt"),this.initialLevel=e.initialLevel??0,this.peakLevel=e.peakLevel??1,this.releaseLevel=e.releaseLevel??0,this.sustainLevel=e.sustainLevel??.75,this.retrigger=e.retrigger??!0,this.attackBend=e.attackBend??0,this.releaseBend=e.releaseBend??0,this.decayBend=e.decayBend??0;const t=1;this.attackPath=D(b({x:0,y:this.initialLevel},{x:t,y:this.peakLevel},-this.attackBend)),this.decayPath=D(b({x:0,y:this.peakLevel},{x:t,y:this.sustainLevel},-this.decayBend)),this.releasePath=D(b({x:0,y:this.sustainLevel},{x:t,y:this.releaseLevel},-this.releaseBend))}onTrigger(){if(this.initialLevelOverride=void 0,!this.retrigger){const[e,t,s]=this.compute();!Number.isNaN(t)&&t>0&&(console.log(`Retrigger. Last value was: ${t}`),this.initialLevelOverride=t)}}compute(e=!0){const[t,s]=super.computeRaw(e);if(t===void 0)return[void 0,NaN,NaN];let a;switch(t){case"attack":a=this.attackPath.compute(s).y,this.initialLevelOverride!==void 0&&(a=I(a,0,this.initialLevel,this.initialLevelOverride,this.initialLevel)),this.releasedAt=a;break;case"decay":a=this.decayPath.compute(s).y,this.releasedAt=a;break;case"sustain":a=this.sustainLevel,this.releasedAt=a;break;case"release":a=this.releasePath.compute(s).y,this.releasedAt!==void 0&&(a=I(a,0,this.sustainLevel,0,this.releasedAt));break;case"complete":a=this.releaseLevel,this.releasedAt=void 0;break;default:throw new Error(`Unknown state: ${t}`)}return[t,a,s]}},z=e=>new K(e);export{z as a,U as d,_ as s};
