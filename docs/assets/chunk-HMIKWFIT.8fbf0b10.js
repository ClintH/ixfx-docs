import{n as Q,o as O,q as _,p as A}from"./chunk-UWLZSNHO.60128285.js";import{i as b,S as $}from"./chunk-6JTGCZJL.ec4f5d4b.js";import{S as W}from"./chunk-YFNN25WV.35b6f5f2.js";import{_ as S,b as l,a as y,d,e as r}from"./chunk-25RM45LF.6197efee.js";var le=(e,t)=>{const a=Z(e,t);return(...s)=>a.start(void 0,s)},ce=(e,t)=>{let a=0;return(...s)=>{const i=performance.now()-a;i>=t&&(e(i,...s),a=performance.now())}},ue=async function*(e,t){let a=!1;try{for(;!a;){if(await P(t),a)return;yield await e()}}finally{a=!0}},Z=(e,t)=>{if(e===void 0)throw new Error("callback parameter is undefined");b(t,"aboveZero","timeoutMs");let a=0,s=0;const i=(m=t,...k)=>{s=performance.now(),b(m,"aboveZero","altTimeoutMs"),a!==0&&n(),a=window.setTimeout(async()=>{e(performance.now()-s,...k),a=0},m)},n=()=>{a!==0&&(s=0,window.clearTimeout(a))};return{start:i,cancel:n,get isDone(){return a!==0}}},he=(e,t,a)=>{t!==void 0&&b(t,"positive","intervalMs");let s=!1,i=0,n=performance.now();const m=t===void 0||t===0?u=>window.requestAnimationFrame(u):u=>window.setTimeout(u,t),k=()=>{!s||(s=!1,i=0)},T=async()=>{if(!s)return;const u=e(i++,performance.now()-n);let L;if(typeof u=="object"?L=await u:L=u,L!==void 0&&!L){k();return}m(T)};return{start:()=>{if(s&&a!==void 0){const u=a(i,performance.now()-n);if(n=performance.now(),u!==void 0&&!u){k();return}}else if(s)return;s=!0,m(T)},get isDone(){return s},get ticks(){return i},get elapsedMs(){return performance.now()-n},cancel:k}},P=e=>new Promise(t=>setTimeout(t,e)),de=async(e,t)=>(b(t,"aboveZero","timeoutMs"),await P(t),Promise.resolve(await e())),R=(e,t,a=!0)=>{let s=!1,i=1;return{mod(n){i=n},get isDone(){return s},reset:()=>{s=!1,t.reset()},get elapsed(){let n=t.elapsed/(e*i);return a&&(n=Q(n)),n>=1&&(s=!0),n}}},ve=e=>()=>p(e,D()),p=(e,t=D())=>{const a=e/1e3;let s=1;return{mod:i=>{s=i},reset:()=>{t.reset()},get elapsed(){const i=t.elapsed*(a*s),n=i-Math.floor(i);if(n<0)throw new Error(`Unexpected cycle fraction less than 0. Elapsed: ${i} f: ${n}`);if(n>1)throw new Error(`Unexpected cycle fraction more than 1. Elapsed: ${i} f: ${n}`);return n}}},D=()=>{let e=performance.now();return{reset:()=>{e=performance.now()},get elapsed(){return performance.now()-e}}},U=()=>{let e=0;return{reset:()=>{e=0},get elapsed(){return e++}}},G={};S(G,{Oscillators:()=>C,adsr:()=>q,defaultAdsrOpts:()=>z,easeOverTicks:()=>J,easeOverTime:()=>H,getEasings:()=>Y});var E=Math.sqrt,o=Math.pow,M=Math.cos,w=Math.PI,g=Math.sin,H=function(e,t){return N(e,t,D)},J=function(e,t){return N(e,t,U)},N=function(e,t,a){const s=V(e),i=R(t,a(),!0);return{get isDone(){return i.isDone},compute:()=>{const n=i.elapsed;return s(n)},reset:()=>{i.reset()}}},V=function(e){e=e.toLocaleLowerCase();const t=Object.entries(j).find(([a,s])=>a.toLocaleLowerCase()===e);if(t===void 0)throw new Error(`Easing '${e}' not found.`);return t[1]},Y=function(){return Array.from(Object.keys(j))},B=function(e){const t=7.5625,a=2.75;return e<1/a?t*e*e:e<2/a?t*(e-=1.5/a)*e+.75:e<2.5/a?t*(e-=2.25/a)*e+.9375:t*(e-=2.625/a)*e+.984375},j={easeInSine:e=>1-M(e*w/2),easeOutSine:e=>g(e*w/2),easeInQuad:e=>e*e,easeOutQuad:e=>1-(1-e)*(1-e),easeInOutSine:e=>-(M(w*e)-1)/2,easeInOutQuad:e=>e<.5?2*e*e:1-o(-2*e+2,2)/2,easeInCubic:e=>e*e*e,easeOutCubic:e=>1-o(1-e,3),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1-o(1-e,4),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1-o(1-e,5),easeInExpo:e=>e===0?0:o(2,10*e-10),easeOutExpo:e=>e===1?1:1-o(2,-10*e),easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1-o(-2*e+2,5)/2,easeInOutExpo:e=>e===0?0:e===1?1:e<.5?o(2,20*e-10)/2:(2-o(2,-20*e+10))/2,easeInCirc:e=>1-E(1-o(e,2)),easeOutCirc:e=>E(1-o(e-1,2)),easeInBack:e=>{const t=1.70158;return(t+1)*e*e*e-t*e*e},easeOutBack:e=>{const t=1.70158,a=t+1;return 1+a*o(e-1,3)+t*o(e-1,2)},easeInOutCirc:e=>e<.5?(1-E(1-o(2*e,2)))/2:(E(1-o(-2*e+2,2))+1)/2,easeInOutBack:e=>{const a=1.70158*1.525;return e<.5?o(2*e,2)*((a+1)*2*e-a)/2:(o(2*e-2,2)*((a+1)*(e*2-2)+a)+2)/2},easeInElastic:e=>{const t=2*w/3;return e===0?0:e===1?1:-o(2,10*e-10)*g((e*10-10.75)*t)},easeOutElastic:e=>{const t=2*w/3;return e===0?0:e===1?1:o(2,-10*e)*g((e*10-.75)*t)+1},easeInBounce:e=>1-B(1-e),easeOutBounce:B,easeInOutElastic:e=>{const t=2*w/4.5;return e===0?0:e===1?1:e<.5?-(o(2,20*e-10)*g((20*e-11.125)*t))/2:o(2,-20*e+10)*g((20*e-11.125)*t)/2+1},easeInOutBounce:e=>e<.5?(1-B(1-2*e))/2:(1+B(2*e-1))/2},z=()=>({attackBend:-1,decayBend:-.3,releaseBend:-.3,peakLevel:1,initialLevel:0,sustainLevel:.6,releaseLevel:0,attackDuration:600,decayDuration:200,releaseDuration:800,shouldLoop:!1}),c,I,h,f,v,K=class extends ${constructor(e){super();y(this,c,void 0),y(this,I,void 0),y(this,h,void 0),y(this,f,void 0),y(this,v,void 0),l(this,"attackDuration"),l(this,"decayDuration"),l(this,"releaseDuration"),l(this,"decayDurationTotal"),l(this,"shouldLoop"),this.attackDuration=e.attackDuration??300,this.decayDuration=e.decayDuration??500,this.releaseDuration=e.releaseDuration??1e3,this.shouldLoop=e.shouldLoop??!1;const t={attack:["decay","release"],decay:["sustain","release"],sustain:["release"],release:["complete"],complete:null};d(this,c,new W("attack",t)),r(this,c).addEventListener("change",a=>{a.newState==="release"&&r(this,v)&&r(this,h)?.reset(),super.fireEvent("change",a)}),r(this,c).addEventListener("stop",a=>{super.fireEvent("complete",a)}),d(this,I,D),d(this,f,d(this,v,!1)),this.decayDurationTotal=this.attackDuration+this.decayDuration}switchState(){if(r(this,h)===void 0)return!1;let e=r(this,h).elapsed;const t=r(this,v)&&!r(this,f);let a=!1;do switch(a=!1,r(this,c).state){case"attack":(e>this.attackDuration||t)&&(r(this,c).next(),a=!0);break;case"decay":(e>this.decayDurationTotal||t)&&(r(this,c).next(),a=!0);break;case"sustain":(!r(this,f)||t)&&(e=0,r(this,c).next(),r(this,h)?.reset(),a=!0);break;case"release":e>this.releaseDuration&&(r(this,c).next(),a=!0);break;case"complete":this.shouldLoop&&this.trigger(r(this,v))}while(a);return a}computeRaw(e=!0){if(r(this,h)===void 0)return[void 0,0,r(this,c).state];e&&this.switchState();const t=r(this,c).state,a=r(this,h).elapsed;let s=0;const i=r(this,c).state;switch(i){case"attack":s=a/this.attackDuration;break;case"decay":s=(a-this.attackDuration)/this.decayDuration;break;case"sustain":s=1;break;case"release":s=Math.min(a/this.releaseDuration,1);break;case"complete":return[void 0,1,t];default:throw new Error(`State machine in unknown state: ${i}`)}return[i,s,t]}get isDone(){return r(this,c).isDone}onTrigger(){}trigger(e=!1){this.onTrigger(),r(this,c).reset(),d(this,h,r(this,I).call(this)),d(this,f,e),d(this,v,e)}compute(){}release(){this.isDone||!r(this,v)||(d(this,f,!1),this.compute())}};c=new WeakMap;I=new WeakMap;h=new WeakMap;f=new WeakMap;v=new WeakMap;var X=class extends K{constructor(e){super(e);l(this,"attackPath"),l(this,"decayPath"),l(this,"releasePath"),l(this,"initialLevel"),l(this,"peakLevel"),l(this,"releaseLevel"),l(this,"sustainLevel"),l(this,"attackBend"),l(this,"decayBend"),l(this,"releaseBend"),l(this,"initialLevelOverride"),l(this,"retrigger"),l(this,"releasedAt"),this.initialLevel=e.initialLevel??0,this.peakLevel=e.peakLevel??1,this.releaseLevel=e.releaseLevel??0,this.sustainLevel=e.sustainLevel??.75,this.retrigger=e.retrigger??!0,this.attackBend=e.attackBend??0,this.releaseBend=e.releaseBend??0,this.decayBend=e.decayBend??0;const t=1;this.attackPath=O(_({x:0,y:this.initialLevel},{x:t,y:this.peakLevel},-this.attackBend)),this.decayPath=O(_({x:0,y:this.peakLevel},{x:t,y:this.sustainLevel},-this.decayBend)),this.releasePath=O(_({x:0,y:this.sustainLevel},{x:t,y:this.releaseLevel},-this.releaseBend))}onTrigger(){if(this.initialLevelOverride=void 0,!this.retrigger){const[e,t,a]=this.compute();!Number.isNaN(t)&&t>0&&(console.log(`Retrigger. Last value was: ${t}`),this.initialLevelOverride=t)}}get value(){return this.compute(!0)[1]}compute(e=!0){const[t,a]=super.computeRaw(e);if(t===void 0)return[void 0,NaN,NaN];let s;switch(t){case"attack":s=this.attackPath.interpolate(a).y,this.initialLevelOverride!==void 0&&(s=A(s,0,this.initialLevel,this.initialLevelOverride,this.initialLevel)),this.releasedAt=s;break;case"decay":s=this.decayPath.interpolate(a).y,this.releasedAt=s;break;case"sustain":s=this.sustainLevel,this.releasedAt=s;break;case"release":s=this.releasePath.interpolate(a).y,this.releasedAt!==void 0&&(s=A(s,0,this.sustainLevel,0,this.releasedAt));break;case"complete":s=this.releaseLevel,this.releasedAt=void 0;break;default:throw new Error(`Unknown state: ${t}`)}return[t,s,a]}},q=e=>new X(e),C={};S(C,{saw:()=>te,sine:()=>F,sineBipolar:()=>x,square:()=>ae,triangle:()=>ee});function*F(e){for(typeof e=="number"&&(e=p(e));;)yield(Math.sin(e.elapsed*Math.PI*2)+1)/2}function*x(e){for(typeof e=="number"&&(e=p(e));;)yield Math.sin(e.elapsed*Math.PI*2)}function*ee(e){for(typeof e=="number"&&(e=p(e));;){let t=e.elapsed;t<.5?t*=2:t=2-t*2,yield t}}function*te(e){for(typeof e=="number"&&(e=p(e));;)yield e.elapsed}function*ae(e){for(typeof e=="number"&&(e=p(e));;)yield e.elapsed<.5?0:1}export{C as O,q as a,le as b,he as c,z as d,de as e,p as f,ve as g,U as h,ue as i,Z as j,D as m,R as r,P as s,ce as t};
