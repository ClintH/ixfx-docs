import{d as b,a as p}from"./chunk-63GPL4EQ.94292053.js";import"./chunk-KYWIDCWW.7a3a5fae.js";import"./chunk-RGWQELNS.82f84363.js";import{l as v,F as a,a as w}from"./chunk-4WJCK6OW.dc07580d.js";import{P as m,a as k}from"./chunk-5VE7K3W4.abc39e5b.js";import"./chunk-TD4SHBHU.a3ff9292.js";import{h as D,m as E,i as W}from"./vendor.ae2f83e2.js";const s=v("#envDataStream",{minIntervalMs:20,capacity:150}),g=m.create();g.add("series-",m.getCssVariable("accent-bold","yellow"));const n=k.plot2("#envData",{capacity:300,showYAxis:!0,palette:g,lineWidth:3});let l={...b(),attackBend:1,decayBend:-1,releaseBend:1},c=!1,t=p({...l,shouldLoop:c});t.addEventListener("change",e=>{a.button("#btnRelease").disabled=e.newState!=="sustain"});a.button("#btnTriggerHold",()=>{s.clear(),t.trigger(!0),r()});a.button("#btnRelease",()=>{t.release()});a.button("#btnTrigger",()=>{s.clear(),t.trigger(),r()});const j=a.select("#selectShow",e=>{n.clear(),s.log(),r()});D(w("#envEditor"),"change").pipe(E(e=>e.detail),W(1e3)).subscribe(e=>{l=e,i()});const i=()=>{try{t=p({...l,shouldLoop:c}),t.trigger(),s.clear(),n.clear(),r()}catch(e){s.error(e)}};a.checkbox("#chkLooping",e=>{c=e,i()});let o=!1;const r=()=>{if(o)return;const e=function(){let[d,f,h]=t.compute();if(d===void 0){o=!1;return}const u=j.value==="raw"?h:f;n.add(u),s.log(`${d} ${u.toFixed(3)}`),t.isDone?(console.log("Envelope done"),o=!1):(o=!0,window.requestAnimationFrame(e))};window.requestAnimationFrame(e)};i();
