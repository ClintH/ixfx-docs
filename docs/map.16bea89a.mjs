import { c as createMetadata, a as createAstro, b as createComponent, r as render, d as renderComponent } from './chunks/index.7bfc2e7e.mjs';
import { $ as $$module1$1, a as $$MainLayout } from './chunks/MainLayout.fae6d6b7.mjs';
import { $ as $$module1 } from './chunks/index.edd3906c.mjs';
import 'shorthash';
import 'serialize-javascript';
import 'preact/hooks';
import 'preact/jsx-runtime';
import 'lit';
import 'shiki';
import 'prismjs';
import 'prismjs/components/index.js';

const metadata = { "headers": [{ "depth": 2, "slug": "basic-operations", "text": "Basic operations" }, { "depth": 2, "slug": "alternatives-and-limitations", "text": "Alternatives and limitations" }, { "depth": 2, "slug": "helper-functions", "text": "Helper functions" }, { "depth": 3, "slug": "has", "text": "Has" }, { "depth": 3, "slug": "iterating", "text": "Iterating" }, { "depth": 3, "slug": "deleting", "text": "Deleting" }, { "depth": 2, "slug": "conversions", "text": "Conversions" }, { "depth": 2, "slug": "get-or-generate", "text": "Get or generate" }, { "depth": 2, "slug": "adding", "text": "Adding" }, { "depth": 2, "slug": "transformations", "text": "Transformations" }, { "depth": 2, "slug": "expiring-map", "text": "Expiring Map" }, { "depth": 2, "slug": "more-functions-for-working-with-maps", "text": "More functions for working with maps" }], "source": "\n<div class=\"tip\">\n<ul>\n<li>API Reference <a href=\"https://clinth.github.io/ixfx/modules/Collections.Maps.html\">Collections.Maps module</a></li>\n<li>Parent <a href=\"https://clinth.github.io/ixfx/modules/Collections.html\">Collections module</a></li>\n</div>\n\nJavascript has an in-built [Map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map) object which is used for tracking key-value pairs. In other words, it maps a given _key_ to a given _value_. The basic operations of a map are `set()`,`get()`, `delete()` and `has()`.\n\nMaps can be useful when there is a meaningful and unique way of referring to values, where we want the possibilty to get _just that one thing_ efficiently. \n\nYou can think of a map like a dictionary. If you want to look up a definition (a _value_), you need the word (the _key_). We could say that the dictionary is _keyed_ by words. If a new definition is to be added to the dictionary (ie a new value), we have to add it with its word (ie its key), we can't just throw it in without.\n\n[Arrays](../arrays/) can also let you efficiently get an item, but only by its numerical _index_. In some cases, using an index makes perfect sense - getting the _first_ item in a sorted array, for example. But thinking again of the dictionary, it doesn't seem useful to want to get the 300th word. We'd much rather store and get items by some kind of unique identifier.\n\n## Basic operations\n\nWhen storing objects in a map, keys are often a particular property that we expect to be unique. For example, maybe we have Fruit type, and we expect the _name_ of the fruit to be unique, but not its colour, or flavour values.\n\n```js\nconst a1 = { name: `granny-smith`, colour: `green`, flavour: 4 }\nconst a2 = { name: `golden-delicious`, colour: `yellow`, flavour: 2 }\nconst map = new Map();\nmap.set(a1.name, a1);\nmap.set(a2.name, a2);\n\nmap.has(`granny-smith`); // True\nconst apple = map.get(`granny-smith`);\napple.flavour; // 4\n```\n\nIn the above example, you can see `set()` being used to add an object by its key (in this case its _name_ property), and `get()` being used to retrieve an item by its key. If nothing is stored under a key, _undefined_ is returned. `has()` returns true/false if a key exists too.\n\nItems are deleted by key:\n\n```js\nmap.delete(`golden-delicious`);\n```\n\nThe contents of a map can be iterated over. You can iterate over keys and values separately:\n```js\n// Iterate by key\nfor (const key of map.keys()) {\n  const value = map.get(key); // Get value for key\n}\n\n// Iterate over values\nfor (const value of map.values()) {\n\n}\n```\n\nOr you can iterate over _entries_, which is an array of both key and value\n\n```js\nfor (const [key,value] of map.entries()) {\n  // Use key and value as needed...\n}\n```\n\n## Alternatives and limitations\n\nOne side effect of a map is that only unique keys are stored. If you `set()` a second item with an existing key, the earlier value is overriden. If the desired outcome is simply to have unique values, consider using the [Set](./set/).\n\nMaps only store a single item per key. There are occasions where we'd rather group items by a key. For that, see [Map Multiple](./mapMultiple).\n\n## Helper functions\n\nixfx has a few helper functions for working with maps. To import these functions:\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\n```\n\n### Has\n\nJS has `Map.has()`, returning a boolean if a key is present. We can't check if a value is present. [`Maps.hasAnyValue()`](https://clinth.github.io/ixfx/functions/Collections.Maps.hasAnyValue.html) takes the map to look over, a value, and a comparison function that returns true or false if two values match.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\n\n// Compare fruits based on their colour property\nconst colourComparer = (a, b) => a.colour === b.colour;\n\n// Returns true if any fruit has the colour red\nMaps.hasAnyValue(map, { colour: `red` }, colourComparer);\n```\n\n[`hasKeyValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.hasKeyValue.html) returns true if a given key exists _and_ the value matches as well.\n\n```js\n// Returns true if the stored apple is also red\nMaps.hasKeyValue(map, `apple`, { colour: `red` }, colourComparer);\n```\n\n### Iterating\n\nTo get all the values of a map as an array, the syntax for that is:\n\n```js\nconst values = [...map.values()];\n```\n\nOr alternatively using ixfx's `Maps.toArray`:\n```js\nconst values = Maps.toArray(map);\n```\n\n`Maps.filter` iterates over all values of a map that match a given predicate:\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\nconst p = value => value.colour === `red`;\nfor (const value of Maps.filter(map, p)) {\n  // Iterates all the values with .colour = `red`\n}\n```\n\nTo iterate over sorted values, use [`Maps.sortByValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValue.html):\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\nconst m = new Map();\nm.set(`1`, `zebra`);\nm.set(`2`, `ant`);\n\nconst values = Maps.sortByValue(map);\n// Yields:\n// [`ant`, `zebra`]\n```\n\nIf the map contains objects, you will want to provide a custom comparer function. An alternative is to use [`Maps.sortByValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValueProperty.html), which sorts by the property of a value.\n\n```js\ncosnt m = new Map();\nm.set(`4491`, { name: `Bob` });\nm.set(`2319`, { name: `Alice` });\nconst sorted = Maps.sortByValue(m, `name`);\n// Yields:\n// [ { name: `Alice` }, { name: `Bob` }]\n```\n\n### Deleting\n\nDeleting from a map is usually by key (`map.delete(key)`), but if you want to delete a particular value, regardless of its key, consider ixfx's [`Maps.deleteByValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.deleteByValue.html):\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\n\n// Compare fruits based on their colour property\nconst colourComparer = (a, b) => a.colour === b.colour;\n\n// Deletes all values where .colour = `red`\nMaps.deleteByValue(map, { colour: `red` }, colourComparer);\n```\n\n## Conversions\n\nIf you already have something iterable (eg an array or other collection), you can make a map from it with ixfx's [`Maps.fromIterable`](https://clinth.github.io/ixfx/functions/Collections.Maps.fromIterable.html). It needs a function that generates a key for a given value. An optional third parameter allows keys to be overwritten (false by default)\n\n```js\nconst data = [ \n  { fruit: `granny-smith`, family: `apple`, colour: `green` }\n  { fruit: `mango`, family: `stone-fruit`, colour: `orange` }\n];\nconst map = Maps.fromIterable(data, v => v.fruit);\n```\n\n[`Maps.fromObject`] converts a plain object into a map, using its top-level properties as keys.\n\n```js\nconst data = {\n Sally: { name: `Sally`, colour: `red` },\n Bob:   { name: `Bob`,   colour: `pink` }\n};\nconst map = Maps.fromObject(data);\nmap.get(`Sally`); // { name: `Sally`, colour: `red` }\n```\n\n## Get or generate\n\nA common pattern working with maps to retrieve something by a given key, and if it doesn't exist to create an object for that key.\n\nFor example, if we are processing multi-touch input, each pointer event has a `pointerId`, and we may want to track that over time. Since it's a unique identifier, a map makes perfect sense. We either want to get the existing tracker for _that_ pointer, or create a new tracker if it's an id that we haven't encountered yet.\n\n[`Maps.getOrGenerate`](https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerate-1.html) can assist.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\n// Set up\nconst trackers = Maps.getOrGenerate(new Map(), key => {\n  // This runs whenever there is a new key stored,\n  // adding the returned value to the map\n  return new MagicalPointerTracker(key);\n})\n\ndocument.addEventListener(`pointermove`, async evt => {\n  // Get a MagicalPointerTracker instance for this pointerId,\n  // creating it if it doesn't exist\n  const tracker = await trackers(evt.pointerId);\n})\n```\n\nNote the use of `await`. This means that we can use asynchronous functions to generate new values on demand. Alternatively, use [`getOrGenerateSync`](https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerateSync.html) which has the same signature, but doesn't need `await` when accessing.\n\n## Adding\n\nBy default, adding a key-value pair to a map will overwrite an existing entry with same key. Sometimes this 'last write wins' logic is not wanted, and instead we want to throw away values if they would overwrite something older. [`Maps.addKeepingExisting`](https://clinth.github.io/ixfx/functions/Collections.Maps.addKeepingExisting.html) to the rescue.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\";\n// Function that generates a key for a value\nconst keyFn = v => v.name;\n\n// Values to add\nconst values = [\n  { name: `Sally`, colour: `red` },\n  { name: `Bob`, colour: `pink` },\n  { name: `Sally`, colour: `green` } /* this one will get ignored */\n]\nconst map = new Map();\n\n// Add values\nMaps.addKeepingExisting(map, keyFn, ...values);\nmap.get(`Sally`).colour; // `red`\n```\n\nIn the above example, we can see that the older value for 'Sally' is kept.\n\n## Transformations\n\n[`Maps.mapToArray`](https://clinth.github.io/ixfx/functions/Collections.Maps.mapToArray.html) allows an array of values to be generated from a map. This can be useful if you want to pluck out a particular property from each value, or transform values.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\";\n// Where map contains things like:\n//  Sally -> { name: `Sally`, colour: `red` }\n//  Bob   -> { name: `Bob`, colour: `pink` }\nconst altered = Maps.mapToArray(map, (key, person) => {\n  ...person,\n  name: person.name.toUpperCase();\n  rand: Math.random();\n});\n// Yields an array: [\n//  { name: `SALLY`, colour: `red`, rand: 0.351 },\n//  { name: `BOB`, colour: `pink`, rand: 0.912 }\n// ]\n```\n\n[`Maps.toObject`](https://clinth.github.io/ixfx/functions/Collections.Maps.toObject.html) converts a map to a plain object, this is useful for turning into a JSON string representation.\n\nGiven the same example map from above:\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\";\nconst objects = Maps.toObject(map);\n// Yields: {\n//  Sally: { name: `Sally`, colour: `red` },\n//  Bob: { name: `Bob`, colour: `pink` }\n// }\n```\n\nUse [`Maps.fromObject`](https://clinth.github.io/ixfx/functions/Collections.Maps.fromObject.html) to convert back from a plain object.\n\n_Mapping_ over a collection of values is common when dealing with arrays. It allows you to transform each element of an array, returning a new array with the transformed values. There is no in built `map()` for Maps, but you can use ixfx's [`Maps.transformMap`](https://clinth.github.io/ixfx/functions/Collections.Maps.transformMap.html) for a similar outcome.\n\nLike a regular map, it takes a map function which must return a transformed version of its input value.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\";\nconst map = new Map();\nmap.set(`a`, `Ant`);\nmap.set(`b`, `Bee`);\nmap.set(`c`, `Cat`);\n\nconst transformer = (value, key) => {\n  return { animal: value };\n};\n\nconst newMap = Maps.transformMap(map, transformer);\n\nmap.get(`b`);    // Yields: `Bee`\nnewMap.get(`b`); // Yields: { animal: `Bee` }\n```\n\nThe above example could be expressed more succinctly:\n\n```js\nconst newMap = Maps.transformMap(map, (value, key) => { animal: value });\n```\n\n_Zippering_ is combining two aligned arrays together. In the case of a map, we might want to combine an array of keys with an array of values using \n[`Maps.zipKeyValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.zipKeyValue.html). The length of both arrays must be the same.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\";\nconst keys = [`a`, `b`, `c`];\nconst values = [`ant`, `bee`, `cat`];\nconst map = Maps.zipKeyValue(keys, values);\nmap.get(`b`); // Yields: `bee`\n```\n\n## Expiring Map\n\nThe [`ExpiringMap`](https://clinth.github.io/ixfx/classes/Collections.Maps.ExpiringMap.html) is a class where values expire after some period. This is useful for caches or cases where there's not a good logic for when to remove things.\n\n```js\nconst map = new ExpiringMap();\nmap.set(`fruit`, `apple`);\n\n// Delete all entries set more than 100ms ago\nmap.deleteWithElapsed(100, `set`);\n\n// Delete all entries that have not been accessed for more than 100ms\nmap.deleteWithElapsed(100, `get`);\n\n// Get the time since the key 'fruit' was last accessed\nmap.elapsedGet(`fruit`);\n\n// Get the time since the key `fruit` was last set\nmap.elapsedSet(`fruit`);\n```\n\nWhen creating the map, you can opt to have it automatically delete items:\n```js\n// Delete any entry not accessed for over one second\nconst map = new ExpiringMap({\n  autoDeleteElapsed: 1000,\n  autoDeletePolicy: `get`\n});\n```\n\nSee the API docs for more on the options.\n\nThere are also some events to listen for automatic expiry: 'expired', 'removed' and 'newKey'.\n```js\nmap.addEventListener(`expired`, event => {\n  const { key, value } = event;\n});\n```\n\n## More functions for working with maps\n\nFinding\n* [`find`](https://clinth.github.io/ixfx/functions/Collections.Maps.find.html) - Finds first value that matches a predicate\n* [`firstEntryByIterableValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.firstEntryByIterableValue.html) - Finds first entry that matches value\n* [`firstEntryByIterablePredicate`](https://clinth.github.io/ixfx/functions/Collections.Maps.firstEntryByIterableValue.html) - Finds first entry that matches predicate (same as `find`)\n* [`getClosestIntegerKey`](https://clinth.github.io/ixfx/functions/Collections.Maps.getClosestIntegerKey.html) - assumes all keys are integers, gets the closest present key\n* [`getFromKeys`](https://clinth.github.io/ixfx/functions/Collections.Maps.getFromKeys.html) - given a set of keys, returns the value for the first one that is present\n* [`hasAnyValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.hasAnyValue.html) - returns true if value is in the map\n* [`hasAnyKeyValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.hasKeyValue.html)- returns true if value is present under key\n\nIterating\n* [`filter`](https://clinth.github.io/ixfx/functions/Collections.Maps.filter.html) - iterate over values where predicate returns true\n* [`sortByValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValue.html) - returns values, sorted\n* [`sortByValueProperty`](https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValueProperty.html) - returns entries, sorted by a chosen property\n\nAdding values\n* [`addKeepExisting`](https://clinth.github.io/ixfx/functions/Collections.Maps.addKeepingExisting.html)\n* [`addObject`](https://clinth.github.io/ixfx/functions/Collections.Maps.addObject.html)\n* [`getOrGenerate`](https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerate-1.html) - get by key or create & add new item\n* [`mergeByKey`](https://clinth.github.io/ixfx/functions/Collections.Maps.mergeByKey.html) - merge two maps, with a reconcile function to merge values that use same key\n  \nRemoving/changing values\n* [`deleteByValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.deleteByValue.html) - remove by value rather than key\n* [`transformMap`](https://clinth.github.io/ixfx/functions/Collections.Maps.transformMap.html) - for each entry, runs it through a function and into a new map\n\nCreating maps\n* [`fromIterable`](https://clinth.github.io/ixfx/functions/Collections.Maps.fromIterable.html)\n* [`fromObject`](https://clinth.github.io/ixfx/functions/Collections.Maps.fromObject.html)\n* [`immutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.immutable.html) - creates an immutable map\n* [`mutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.mutable.html) - creates a mutable map\n* [`zipKeyValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.zipKeyValue.html) - combine an array of keys and an array of values into an object\n\nMultiple values per key maps\n* [`mapOfSimpleMutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.mapOfSimpleMutable-1.html) - map that can store many values per key, less functions than the others below\n* [`ofArrayMutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.ofArrayMutable.html) - Uses an array to store values\n* [`ofCircularMutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.ofCircularMutable.html) - Uses a circular array of limited capacity\n* [`ofSetMutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.ofSetMutable.html) - Uses a set to store unique values\n  \nConverting maps\n* [`mapToArray`](https://clinth.github.io/ixfx/functions/Collections.Maps.mapToArray.html)\n* [`mapToObjectTransform`](https://clinth.github.io/ixfx/functions/Collections.Maps.mapToObjectTransform.html)\n* [`toObject`](https://clinth.github.io/ixfx/functions/Collections.Maps.toObject.html)\n\n\n\n\n", "html": '<div class="tip">\n<ul>\n<li>API Reference <a href="https://clinth.github.io/ixfx/modules/Collections.Maps.html">Collections.Maps module</a></li>\n<li>Parent <a href="https://clinth.github.io/ixfx/modules/Collections.html">Collections module</a></li>\n</div>\n<p>Javascript has an in-built <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map">Map</a> object which is used for tracking key-value pairs. In other words, it maps a given <em>key</em> to a given <em>value</em>. The basic operations of a map are <code is:raw>set()</code>,<code is:raw>get()</code>, <code is:raw>delete()</code> and <code is:raw>has()</code>.</p>\n<p>Maps can be useful when there is a meaningful and unique way of referring to values, where we want the possibilty to get <em>just that one thing</em> efficiently.</p>\n<p>You can think of a map like a dictionary. If you want to look up a definition (a <em>value</em>), you need the word (the <em>key</em>). We could say that the dictionary is <em>keyed</em> by words. If a new definition is to be added to the dictionary (ie a new value), we have to add it with its word (ie its key), we can\'t just throw it in without.</p>\n<p><a href="../arrays/">Arrays</a> can also let you efficiently get an item, but only by its numerical <em>index</em>. In some cases, using an index makes perfect sense - getting the <em>first</em> item in a sorted array, for example. But thinking again of the dictionary, it doesn\'t seem useful to want to get the 300th word. We\'d much rather store and get items by some kind of unique identifier.</p>\n<h2 id="basic-operations">Basic operations</h2>\n<p>When storing objects in a map, keys are often a particular property that we expect to be unique. For example, maybe we have Fruit type, and we expect the <em>name</em> of the fruit to be unique, but not its colour, or flavour values.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> a1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">granny-smith</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">green</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">flavour</span><span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span>\n<span class="token keyword">const</span> a2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">golden-delicious</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">yellow</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">flavour</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>a1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> a1<span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>a2<span class="token punctuation">.</span>name<span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmap<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">granny-smith</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// True</span>\n<span class="token keyword">const</span> apple <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">granny-smith</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\napple<span class="token punctuation">.</span>flavour<span class="token punctuation">;</span> <span class="token comment">// 4</span></code></pre>\n<p>In the above example, you can see <code is:raw>set()</code> being used to add an object by its key (in this case its <em>name</em> property), and <code is:raw>get()</code> being used to retrieve an item by its key. If nothing is stored under a key, <em>undefined</em> is returned. <code is:raw>has()</code> returns true/false if a key exists too.</p>\n<p>Items are deleted by key:</p>\n<pre class="language-js"><code is:raw class="language-js">map<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">golden-delicious</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p>The contents of a map can be iterated over. You can iterate over keys and values separately:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token comment">// Iterate by key</span>\n<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> value <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Get value for key</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// Iterate over values</span>\n<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> value <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\n<span class="token punctuation">}</span></code></pre>\n<p>Or you can iterate over <em>entries</em>, which is an array of both key and value</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span>value<span class="token punctuation">]</span> <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// Use key and value as needed...</span>\n<span class="token punctuation">}</span></code></pre>\n<h2 id="alternatives-and-limitations">Alternatives and limitations</h2>\n<p>One side effect of a map is that only unique keys are stored. If you <code is:raw>set()</code> a second item with an existing key, the earlier value is overriden. If the desired outcome is simply to have unique values, consider using the <a href="./set/">Set</a>.</p>\n<p>Maps only store a single item per key. There are occasions where we\'d rather group items by a key. For that, see <a href="./mapMultiple">Map Multiple</a>.</p>\n<h2 id="helper-functions">Helper functions</h2>\n<p>ixfx has a few helper functions for working with maps. To import these functions:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span></code></pre>\n<h3 id="has">Has</h3>\n<p>JS has <code is:raw>Map.has()</code>, returning a boolean if a key is present. We can\'t check if a value is present. <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.hasAnyValue.html"><code is:raw>Maps.hasAnyValue()</code></a> takes the map to look over, a value, and a comparison function that returns true or false if two values match.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>\n\n<span class="token comment">// Compare fruits based on their colour property</span>\n<span class="token keyword">const</span> <span class="token function-variable function">colourComparer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>colour <span class="token operator">===</span> b<span class="token punctuation">.</span>colour<span class="token punctuation">;</span>\n\n<span class="token comment">// Returns true if any fruit has the colour red</span>\nMaps<span class="token punctuation">.</span><span class="token function">hasAnyValue</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span> colourComparer<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.hasKeyValue.html"><code is:raw>hasKeyValue</code></a> returns true if a given key exists <em>and</em> the value matches as well.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token comment">// Returns true if the stored apple is also red</span>\nMaps<span class="token punctuation">.</span><span class="token function">hasKeyValue</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">apple</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span> colourComparer<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<h3 id="iterating">Iterating</h3>\n<p>To get all the values of a map as an array, the syntax for that is:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>map<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>\n<p>Or alternatively using ixfx\'s <code is:raw>Maps.toArray</code>:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> values <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p><code is:raw>Maps.filter</code> iterates over all values of a map that match a given predicate:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>\n<span class="token keyword">const</span> <span class="token function-variable function">p</span> <span class="token operator">=</span> <span class="token parameter">value</span> <span class="token operator">=></span> value<span class="token punctuation">.</span>colour <span class="token operator">===</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>\n<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> value <span class="token keyword">of</span> Maps<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// Iterates all the values with .colour = `red`</span>\n<span class="token punctuation">}</span></code></pre>\n<p>To iterate over sorted values, use <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValue.html"><code is:raw>Maps.sortByValue</code></a>:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>\n<span class="token keyword">const</span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nm<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">1</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">zebra</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nm<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">2</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ant</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> values <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">sortByValue</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// Yields:</span>\n<span class="token comment">// [`ant`, `zebra`]</span></code></pre>\n<p>If the map contains objects, you will want to provide a custom comparer function. An alternative is to use <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValueProperty.html"><code is:raw>Maps.sortByValue</code></a>, which sorts by the property of a value.</p>\n<pre class="language-js"><code is:raw class="language-js">cosnt m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nm<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">4491</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bob</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nm<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">2319</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Alice</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> sorted <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">sortByValue</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">name</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// Yields:</span>\n<span class="token comment">// [ { name: `Alice` }, { name: `Bob` }]</span></code></pre>\n<h3 id="deleting">Deleting</h3>\n<p>Deleting from a map is usually by key (<code is:raw>map.delete(key)</code>), but if you want to delete a particular value, regardless of its key, consider ixfx\'s <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.deleteByValue.html"><code is:raw>Maps.deleteByValue</code></a>:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>\n\n<span class="token comment">// Compare fruits based on their colour property</span>\n<span class="token keyword">const</span> <span class="token function-variable function">colourComparer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>colour <span class="token operator">===</span> b<span class="token punctuation">.</span>colour<span class="token punctuation">;</span>\n\n<span class="token comment">// Deletes all values where .colour = `red`</span>\nMaps<span class="token punctuation">.</span><span class="token function">deleteByValue</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span> colourComparer<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<h2 id="conversions">Conversions</h2>\n<p>If you already have something iterable (eg an array or other collection), you can make a map from it with ixfx\'s <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.fromIterable.html"><code is:raw>Maps.fromIterable</code></a>. It needs a function that generates a key for a given value. An optional third parameter allows keys to be overwritten (false by default)</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span> \n  <span class="token punctuation">{</span> <span class="token literal-property property">fruit</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">granny-smith</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">family</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">apple</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">green</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span>\n  <span class="token punctuation">{</span> <span class="token literal-property property">fruit</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mango</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">family</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">stone-fruit</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">orange</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span>\n<span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">fromIterable</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token parameter">v</span> <span class="token operator">=></span> v<span class="token punctuation">.</span>fruit<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p>[<code is:raw>Maps.fromObject</code>] converts a plain object into a map, using its top-level properties as keys.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>\n <span class="token literal-property property">Sally</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sally</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n <span class="token literal-property property">Bob</span><span class="token operator">:</span>   <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bob</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>   <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">pink</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">fromObject</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sally</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { name: `Sally`, colour: `red` }</span></code></pre>\n<h2 id="get-or-generate">Get or generate</h2>\n<p>A common pattern working with maps to retrieve something by a given key, and if it doesn\'t exist to create an object for that key.</p>\n<p>For example, if we are processing multi-touch input, each pointer event has a <code is:raw>pointerId</code>, and we may want to track that over time. Since it\'s a unique identifier, a map makes perfect sense. We either want to get the existing tracker for <em>that</em> pointer, or create a new tracker if it\'s an id that we haven\'t encountered yet.</p>\n<p><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerate-1.html"><code is:raw>Maps.getOrGenerate</code></a> can assist.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>\n<span class="token comment">// Set up</span>\n<span class="token keyword">const</span> trackers <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">getOrGenerate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token parameter">key</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// This runs whenever there is a new key stored,</span>\n  <span class="token comment">// adding the returned value to the map</span>\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MagicalPointerTracker</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\ndocument<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">pointermove</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">evt</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// Get a MagicalPointerTracker instance for this pointerId,</span>\n  <span class="token comment">// creating it if it doesn\'t exist</span>\n  <span class="token keyword">const</span> tracker <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">trackers</span><span class="token punctuation">(</span>evt<span class="token punctuation">.</span>pointerId<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>\n<p>Note the use of <code is:raw>await</code>. This means that we can use asynchronous functions to generate new values on demand. Alternatively, use <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerateSync.html"><code is:raw>getOrGenerateSync</code></a> which has the same signature, but doesn\'t need <code is:raw>await</code> when accessing.</p>\n<h2 id="adding">Adding</h2>\n<p>By default, adding a key-value pair to a map will overwrite an existing entry with same key. Sometimes this \'last write wins\' logic is not wanted, and instead we want to throw away values if they would overwrite something older. <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.addKeepingExisting.html"><code is:raw>Maps.addKeepingExisting</code></a> to the rescue.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>\n<span class="token comment">// Function that generates a key for a value</span>\n<span class="token keyword">const</span> <span class="token function-variable function">keyFn</span> <span class="token operator">=</span> <span class="token parameter">v</span> <span class="token operator">=></span> v<span class="token punctuation">.</span>name<span class="token punctuation">;</span>\n\n<span class="token comment">// Values to add</span>\n<span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">[</span>\n  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sally</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bob</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">pink</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sally</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">green</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span> <span class="token comment">/* this one will get ignored */</span>\n<span class="token punctuation">]</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Add values</span>\nMaps<span class="token punctuation">.</span><span class="token function">addKeepingExisting</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> keyFn<span class="token punctuation">,</span> <span class="token operator">...</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sally</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>colour<span class="token punctuation">;</span> <span class="token comment">// `red`</span></code></pre>\n<p>In the above example, we can see that the older value for \'Sally\' is kept.</p>\n<h2 id="transformations">Transformations</h2>\n<p><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mapToArray.html"><code is:raw>Maps.mapToArray</code></a> allows an array of values to be generated from a map. This can be useful if you want to pluck out a particular property from each value, or transform values.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>\n<span class="token comment">// Where map contains things like:</span>\n<span class="token comment">//  Sally -> { name: `Sally`, colour: `red` }</span>\n<span class="token comment">//  Bob   -> { name: `Bob`, colour: `pink` }</span>\n<span class="token keyword">const</span> altered <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">mapToArray</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> person</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token operator">...</span>person<span class="token punctuation">,</span>\n  <span class="token literal-property property">name</span><span class="token operator">:</span> person<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token literal-property property">rand</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// Yields an array: [</span>\n<span class="token comment">//  { name: `SALLY`, colour: `red`, rand: 0.351 },</span>\n<span class="token comment">//  { name: `BOB`, colour: `pink`, rand: 0.912 }</span>\n<span class="token comment">// ]</span></code></pre>\n<p><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.toObject.html"><code is:raw>Maps.toObject</code></a> converts a map to a plain object, this is useful for turning into a JSON string representation.</p>\n<p>Given the same example map from above:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> objects <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">toObject</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// Yields: {</span>\n<span class="token comment">//  Sally: { name: `Sally`, colour: `red` },</span>\n<span class="token comment">//  Bob: { name: `Bob`, colour: `pink` }</span>\n<span class="token comment">// }</span></code></pre>\n<p>Use <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.fromObject.html"><code is:raw>Maps.fromObject</code></a> to convert back from a plain object.</p>\n<p><em>Mapping</em> over a collection of values is common when dealing with arrays. It allows you to transform each element of an array, returning a new array with the transformed values. There is no in built <code is:raw>map()</code> for Maps, but you can use ixfx\'s <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.transformMap.html"><code is:raw>Maps.transformMap</code></a> for a similar outcome.</p>\n<p>Like a regular map, it takes a map function which must return a transformed version of its input value.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Ant</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bee</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">c</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Cat</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">transformer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">animal</span><span class="token operator">:</span> value <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> newMap <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">transformMap</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> transformer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// Yields: `Bee`</span>\nnewMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Yields: { animal: `Bee` }</span></code></pre>\n<p>The above example could be expressed more succinctly:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> newMap <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">transformMap</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token literal-property property">animal</span><span class="token operator">:</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p><em>Zippering</em> is combining two aligned arrays together. In the case of a map, we might want to combine an array of keys with an array of values using\n<a href="https://clinth.github.io/ixfx/functions/Collections.Maps.zipKeyValue.html"><code is:raw>Maps.zipKeyValue</code></a>. The length of both arrays must be the same.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">c</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ant</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">bee</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">cat</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">zipKeyValue</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Yields: `bee`</span></code></pre>\n<h2 id="expiring-map">Expiring Map</h2>\n<p>The <a href="https://clinth.github.io/ixfx/classes/Collections.Maps.ExpiringMap.html"><code is:raw>ExpiringMap</code></a> is a class where values expire after some period. This is useful for caches or cases where there\'s not a good logic for when to remove things.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExpiringMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">fruit</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">apple</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Delete all entries set more than 100ms ago</span>\nmap<span class="token punctuation">.</span><span class="token function">deleteWithElapsed</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">set</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Delete all entries that have not been accessed for more than 100ms</span>\nmap<span class="token punctuation">.</span><span class="token function">deleteWithElapsed</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">get</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Get the time since the key \'fruit\' was last accessed</span>\nmap<span class="token punctuation">.</span><span class="token function">elapsedGet</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">fruit</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Get the time since the key `fruit` was last set</span>\nmap<span class="token punctuation">.</span><span class="token function">elapsedSet</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">fruit</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p>When creating the map, you can opt to have it automatically delete items:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token comment">// Delete any entry not accessed for over one second</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExpiringMap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token literal-property property">autoDeleteElapsed</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">autoDeletePolicy</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">get</span><span class="token template-punctuation string">`</span></span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p>See the API docs for more on the options.</p>\n<p>There are also some events to listen for automatic expiry: \'expired\', \'removed\' and \'newKey\'.</p>\n<pre class="language-js"><code is:raw class="language-js">map<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">expired</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> key<span class="token punctuation">,</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> event<span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<h2 id="more-functions-for-working-with-maps">More functions for working with maps</h2>\n<p>Finding</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.find.html"><code is:raw>find</code></a> - Finds first value that matches a predicate</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.firstEntryByIterableValue.html"><code is:raw>firstEntryByIterableValue</code></a> - Finds first entry that matches value</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.firstEntryByIterableValue.html"><code is:raw>firstEntryByIterablePredicate</code></a> - Finds first entry that matches predicate (same as <code is:raw>find</code>)</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getClosestIntegerKey.html"><code is:raw>getClosestIntegerKey</code></a> - assumes all keys are integers, gets the closest present key</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getFromKeys.html"><code is:raw>getFromKeys</code></a> - given a set of keys, returns the value for the first one that is present</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.hasAnyValue.html"><code is:raw>hasAnyValue</code></a> - returns true if value is in the map</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.hasKeyValue.html"><code is:raw>hasAnyKeyValue</code></a>- returns true if value is present under key</li>\n</ul>\n<p>Iterating</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.filter.html"><code is:raw>filter</code></a> - iterate over values where predicate returns true</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValue.html"><code is:raw>sortByValue</code></a> - returns values, sorted</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValueProperty.html"><code is:raw>sortByValueProperty</code></a> - returns entries, sorted by a chosen property</li>\n</ul>\n<p>Adding values</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.addKeepingExisting.html"><code is:raw>addKeepExisting</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.addObject.html"><code is:raw>addObject</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerate-1.html"><code is:raw>getOrGenerate</code></a> - get by key or create &#x26; add new item</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mergeByKey.html"><code is:raw>mergeByKey</code></a> - merge two maps, with a reconcile function to merge values that use same key</li>\n</ul>\n<p>Removing/changing values</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.deleteByValue.html"><code is:raw>deleteByValue</code></a> - remove by value rather than key</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.transformMap.html"><code is:raw>transformMap</code></a> - for each entry, runs it through a function and into a new map</li>\n</ul>\n<p>Creating maps</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.fromIterable.html"><code is:raw>fromIterable</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.fromObject.html"><code is:raw>fromObject</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.immutable.html"><code is:raw>immutable</code></a> - creates an immutable map</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mutable.html"><code is:raw>mutable</code></a> - creates a mutable map</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.zipKeyValue.html"><code is:raw>zipKeyValue</code></a> - combine an array of keys and an array of values into an object</li>\n</ul>\n<p>Multiple values per key maps</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mapOfSimpleMutable-1.html"><code is:raw>mapOfSimpleMutable</code></a> - map that can store many values per key, less functions than the others below</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.ofArrayMutable.html"><code is:raw>ofArrayMutable</code></a> - Uses an array to store values</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.ofCircularMutable.html"><code is:raw>ofCircularMutable</code></a> - Uses a circular array of limited capacity</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.ofSetMutable.html"><code is:raw>ofSetMutable</code></a> - Uses a set to store unique values</li>\n</ul>\n<p>Converting maps</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mapToArray.html"><code is:raw>mapToArray</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mapToObjectTransform.html"><code is:raw>mapToObjectTransform</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.toObject.html"><code is:raw>toObject</code></a></li>\n</ul>' };
const frontmatter = { "title": "Map", "astro": { "headers": [{ "depth": 2, "slug": "basic-operations", "text": "Basic operations" }, { "depth": 2, "slug": "alternatives-and-limitations", "text": "Alternatives and limitations" }, { "depth": 2, "slug": "helper-functions", "text": "Helper functions" }, { "depth": 3, "slug": "has", "text": "Has" }, { "depth": 3, "slug": "iterating", "text": "Iterating" }, { "depth": 3, "slug": "deleting", "text": "Deleting" }, { "depth": 2, "slug": "conversions", "text": "Conversions" }, { "depth": 2, "slug": "get-or-generate", "text": "Get or generate" }, { "depth": 2, "slug": "adding", "text": "Adding" }, { "depth": 2, "slug": "transformations", "text": "Transformations" }, { "depth": 2, "slug": "expiring-map", "text": "Expiring Map" }, { "depth": 2, "slug": "more-functions-for-working-with-maps", "text": "More functions for working with maps" }], "source": "\n<div class=\"tip\">\n<ul>\n<li>API Reference <a href=\"https://clinth.github.io/ixfx/modules/Collections.Maps.html\">Collections.Maps module</a></li>\n<li>Parent <a href=\"https://clinth.github.io/ixfx/modules/Collections.html\">Collections module</a></li>\n</div>\n\nJavascript has an in-built [Map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map) object which is used for tracking key-value pairs. In other words, it maps a given _key_ to a given _value_. The basic operations of a map are `set()`,`get()`, `delete()` and `has()`.\n\nMaps can be useful when there is a meaningful and unique way of referring to values, where we want the possibilty to get _just that one thing_ efficiently. \n\nYou can think of a map like a dictionary. If you want to look up a definition (a _value_), you need the word (the _key_). We could say that the dictionary is _keyed_ by words. If a new definition is to be added to the dictionary (ie a new value), we have to add it with its word (ie its key), we can't just throw it in without.\n\n[Arrays](../arrays/) can also let you efficiently get an item, but only by its numerical _index_. In some cases, using an index makes perfect sense - getting the _first_ item in a sorted array, for example. But thinking again of the dictionary, it doesn't seem useful to want to get the 300th word. We'd much rather store and get items by some kind of unique identifier.\n\n## Basic operations\n\nWhen storing objects in a map, keys are often a particular property that we expect to be unique. For example, maybe we have Fruit type, and we expect the _name_ of the fruit to be unique, but not its colour, or flavour values.\n\n```js\nconst a1 = { name: `granny-smith`, colour: `green`, flavour: 4 }\nconst a2 = { name: `golden-delicious`, colour: `yellow`, flavour: 2 }\nconst map = new Map();\nmap.set(a1.name, a1);\nmap.set(a2.name, a2);\n\nmap.has(`granny-smith`); // True\nconst apple = map.get(`granny-smith`);\napple.flavour; // 4\n```\n\nIn the above example, you can see `set()` being used to add an object by its key (in this case its _name_ property), and `get()` being used to retrieve an item by its key. If nothing is stored under a key, _undefined_ is returned. `has()` returns true/false if a key exists too.\n\nItems are deleted by key:\n\n```js\nmap.delete(`golden-delicious`);\n```\n\nThe contents of a map can be iterated over. You can iterate over keys and values separately:\n```js\n// Iterate by key\nfor (const key of map.keys()) {\n  const value = map.get(key); // Get value for key\n}\n\n// Iterate over values\nfor (const value of map.values()) {\n\n}\n```\n\nOr you can iterate over _entries_, which is an array of both key and value\n\n```js\nfor (const [key,value] of map.entries()) {\n  // Use key and value as needed...\n}\n```\n\n## Alternatives and limitations\n\nOne side effect of a map is that only unique keys are stored. If you `set()` a second item with an existing key, the earlier value is overriden. If the desired outcome is simply to have unique values, consider using the [Set](./set/).\n\nMaps only store a single item per key. There are occasions where we'd rather group items by a key. For that, see [Map Multiple](./mapMultiple).\n\n## Helper functions\n\nixfx has a few helper functions for working with maps. To import these functions:\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\n```\n\n### Has\n\nJS has `Map.has()`, returning a boolean if a key is present. We can't check if a value is present. [`Maps.hasAnyValue()`](https://clinth.github.io/ixfx/functions/Collections.Maps.hasAnyValue.html) takes the map to look over, a value, and a comparison function that returns true or false if two values match.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\n\n// Compare fruits based on their colour property\nconst colourComparer = (a, b) => a.colour === b.colour;\n\n// Returns true if any fruit has the colour red\nMaps.hasAnyValue(map, { colour: `red` }, colourComparer);\n```\n\n[`hasKeyValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.hasKeyValue.html) returns true if a given key exists _and_ the value matches as well.\n\n```js\n// Returns true if the stored apple is also red\nMaps.hasKeyValue(map, `apple`, { colour: `red` }, colourComparer);\n```\n\n### Iterating\n\nTo get all the values of a map as an array, the syntax for that is:\n\n```js\nconst values = [...map.values()];\n```\n\nOr alternatively using ixfx's `Maps.toArray`:\n```js\nconst values = Maps.toArray(map);\n```\n\n`Maps.filter` iterates over all values of a map that match a given predicate:\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\nconst p = value => value.colour === `red`;\nfor (const value of Maps.filter(map, p)) {\n  // Iterates all the values with .colour = `red`\n}\n```\n\nTo iterate over sorted values, use [`Maps.sortByValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValue.html):\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\nconst m = new Map();\nm.set(`1`, `zebra`);\nm.set(`2`, `ant`);\n\nconst values = Maps.sortByValue(map);\n// Yields:\n// [`ant`, `zebra`]\n```\n\nIf the map contains objects, you will want to provide a custom comparer function. An alternative is to use [`Maps.sortByValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValueProperty.html), which sorts by the property of a value.\n\n```js\ncosnt m = new Map();\nm.set(`4491`, { name: `Bob` });\nm.set(`2319`, { name: `Alice` });\nconst sorted = Maps.sortByValue(m, `name`);\n// Yields:\n// [ { name: `Alice` }, { name: `Bob` }]\n```\n\n### Deleting\n\nDeleting from a map is usually by key (`map.delete(key)`), but if you want to delete a particular value, regardless of its key, consider ixfx's [`Maps.deleteByValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.deleteByValue.html):\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\n\n// Compare fruits based on their colour property\nconst colourComparer = (a, b) => a.colour === b.colour;\n\n// Deletes all values where .colour = `red`\nMaps.deleteByValue(map, { colour: `red` }, colourComparer);\n```\n\n## Conversions\n\nIf you already have something iterable (eg an array or other collection), you can make a map from it with ixfx's [`Maps.fromIterable`](https://clinth.github.io/ixfx/functions/Collections.Maps.fromIterable.html). It needs a function that generates a key for a given value. An optional third parameter allows keys to be overwritten (false by default)\n\n```js\nconst data = [ \n  { fruit: `granny-smith`, family: `apple`, colour: `green` }\n  { fruit: `mango`, family: `stone-fruit`, colour: `orange` }\n];\nconst map = Maps.fromIterable(data, v => v.fruit);\n```\n\n[`Maps.fromObject`] converts a plain object into a map, using its top-level properties as keys.\n\n```js\nconst data = {\n Sally: { name: `Sally`, colour: `red` },\n Bob:   { name: `Bob`,   colour: `pink` }\n};\nconst map = Maps.fromObject(data);\nmap.get(`Sally`); // { name: `Sally`, colour: `red` }\n```\n\n## Get or generate\n\nA common pattern working with maps to retrieve something by a given key, and if it doesn't exist to create an object for that key.\n\nFor example, if we are processing multi-touch input, each pointer event has a `pointerId`, and we may want to track that over time. Since it's a unique identifier, a map makes perfect sense. We either want to get the existing tracker for _that_ pointer, or create a new tracker if it's an id that we haven't encountered yet.\n\n[`Maps.getOrGenerate`](https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerate-1.html) can assist.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\n// Set up\nconst trackers = Maps.getOrGenerate(new Map(), key => {\n  // This runs whenever there is a new key stored,\n  // adding the returned value to the map\n  return new MagicalPointerTracker(key);\n})\n\ndocument.addEventListener(`pointermove`, async evt => {\n  // Get a MagicalPointerTracker instance for this pointerId,\n  // creating it if it doesn't exist\n  const tracker = await trackers(evt.pointerId);\n})\n```\n\nNote the use of `await`. This means that we can use asynchronous functions to generate new values on demand. Alternatively, use [`getOrGenerateSync`](https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerateSync.html) which has the same signature, but doesn't need `await` when accessing.\n\n## Adding\n\nBy default, adding a key-value pair to a map will overwrite an existing entry with same key. Sometimes this 'last write wins' logic is not wanted, and instead we want to throw away values if they would overwrite something older. [`Maps.addKeepingExisting`](https://clinth.github.io/ixfx/functions/Collections.Maps.addKeepingExisting.html) to the rescue.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\";\n// Function that generates a key for a value\nconst keyFn = v => v.name;\n\n// Values to add\nconst values = [\n  { name: `Sally`, colour: `red` },\n  { name: `Bob`, colour: `pink` },\n  { name: `Sally`, colour: `green` } /* this one will get ignored */\n]\nconst map = new Map();\n\n// Add values\nMaps.addKeepingExisting(map, keyFn, ...values);\nmap.get(`Sally`).colour; // `red`\n```\n\nIn the above example, we can see that the older value for 'Sally' is kept.\n\n## Transformations\n\n[`Maps.mapToArray`](https://clinth.github.io/ixfx/functions/Collections.Maps.mapToArray.html) allows an array of values to be generated from a map. This can be useful if you want to pluck out a particular property from each value, or transform values.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\";\n// Where map contains things like:\n//  Sally -> { name: `Sally`, colour: `red` }\n//  Bob   -> { name: `Bob`, colour: `pink` }\nconst altered = Maps.mapToArray(map, (key, person) => {\n  ...person,\n  name: person.name.toUpperCase();\n  rand: Math.random();\n});\n// Yields an array: [\n//  { name: `SALLY`, colour: `red`, rand: 0.351 },\n//  { name: `BOB`, colour: `pink`, rand: 0.912 }\n// ]\n```\n\n[`Maps.toObject`](https://clinth.github.io/ixfx/functions/Collections.Maps.toObject.html) converts a map to a plain object, this is useful for turning into a JSON string representation.\n\nGiven the same example map from above:\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\";\nconst objects = Maps.toObject(map);\n// Yields: {\n//  Sally: { name: `Sally`, colour: `red` },\n//  Bob: { name: `Bob`, colour: `pink` }\n// }\n```\n\nUse [`Maps.fromObject`](https://clinth.github.io/ixfx/functions/Collections.Maps.fromObject.html) to convert back from a plain object.\n\n_Mapping_ over a collection of values is common when dealing with arrays. It allows you to transform each element of an array, returning a new array with the transformed values. There is no in built `map()` for Maps, but you can use ixfx's [`Maps.transformMap`](https://clinth.github.io/ixfx/functions/Collections.Maps.transformMap.html) for a similar outcome.\n\nLike a regular map, it takes a map function which must return a transformed version of its input value.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\";\nconst map = new Map();\nmap.set(`a`, `Ant`);\nmap.set(`b`, `Bee`);\nmap.set(`c`, `Cat`);\n\nconst transformer = (value, key) => {\n  return { animal: value };\n};\n\nconst newMap = Maps.transformMap(map, transformer);\n\nmap.get(`b`);    // Yields: `Bee`\nnewMap.get(`b`); // Yields: { animal: `Bee` }\n```\n\nThe above example could be expressed more succinctly:\n\n```js\nconst newMap = Maps.transformMap(map, (value, key) => { animal: value });\n```\n\n_Zippering_ is combining two aligned arrays together. In the case of a map, we might want to combine an array of keys with an array of values using \n[`Maps.zipKeyValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.zipKeyValue.html). The length of both arrays must be the same.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\";\nconst keys = [`a`, `b`, `c`];\nconst values = [`ant`, `bee`, `cat`];\nconst map = Maps.zipKeyValue(keys, values);\nmap.get(`b`); // Yields: `bee`\n```\n\n## Expiring Map\n\nThe [`ExpiringMap`](https://clinth.github.io/ixfx/classes/Collections.Maps.ExpiringMap.html) is a class where values expire after some period. This is useful for caches or cases where there's not a good logic for when to remove things.\n\n```js\nconst map = new ExpiringMap();\nmap.set(`fruit`, `apple`);\n\n// Delete all entries set more than 100ms ago\nmap.deleteWithElapsed(100, `set`);\n\n// Delete all entries that have not been accessed for more than 100ms\nmap.deleteWithElapsed(100, `get`);\n\n// Get the time since the key 'fruit' was last accessed\nmap.elapsedGet(`fruit`);\n\n// Get the time since the key `fruit` was last set\nmap.elapsedSet(`fruit`);\n```\n\nWhen creating the map, you can opt to have it automatically delete items:\n```js\n// Delete any entry not accessed for over one second\nconst map = new ExpiringMap({\n  autoDeleteElapsed: 1000,\n  autoDeletePolicy: `get`\n});\n```\n\nSee the API docs for more on the options.\n\nThere are also some events to listen for automatic expiry: 'expired', 'removed' and 'newKey'.\n```js\nmap.addEventListener(`expired`, event => {\n  const { key, value } = event;\n});\n```\n\n## More functions for working with maps\n\nFinding\n* [`find`](https://clinth.github.io/ixfx/functions/Collections.Maps.find.html) - Finds first value that matches a predicate\n* [`firstEntryByIterableValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.firstEntryByIterableValue.html) - Finds first entry that matches value\n* [`firstEntryByIterablePredicate`](https://clinth.github.io/ixfx/functions/Collections.Maps.firstEntryByIterableValue.html) - Finds first entry that matches predicate (same as `find`)\n* [`getClosestIntegerKey`](https://clinth.github.io/ixfx/functions/Collections.Maps.getClosestIntegerKey.html) - assumes all keys are integers, gets the closest present key\n* [`getFromKeys`](https://clinth.github.io/ixfx/functions/Collections.Maps.getFromKeys.html) - given a set of keys, returns the value for the first one that is present\n* [`hasAnyValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.hasAnyValue.html) - returns true if value is in the map\n* [`hasAnyKeyValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.hasKeyValue.html)- returns true if value is present under key\n\nIterating\n* [`filter`](https://clinth.github.io/ixfx/functions/Collections.Maps.filter.html) - iterate over values where predicate returns true\n* [`sortByValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValue.html) - returns values, sorted\n* [`sortByValueProperty`](https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValueProperty.html) - returns entries, sorted by a chosen property\n\nAdding values\n* [`addKeepExisting`](https://clinth.github.io/ixfx/functions/Collections.Maps.addKeepingExisting.html)\n* [`addObject`](https://clinth.github.io/ixfx/functions/Collections.Maps.addObject.html)\n* [`getOrGenerate`](https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerate-1.html) - get by key or create & add new item\n* [`mergeByKey`](https://clinth.github.io/ixfx/functions/Collections.Maps.mergeByKey.html) - merge two maps, with a reconcile function to merge values that use same key\n  \nRemoving/changing values\n* [`deleteByValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.deleteByValue.html) - remove by value rather than key\n* [`transformMap`](https://clinth.github.io/ixfx/functions/Collections.Maps.transformMap.html) - for each entry, runs it through a function and into a new map\n\nCreating maps\n* [`fromIterable`](https://clinth.github.io/ixfx/functions/Collections.Maps.fromIterable.html)\n* [`fromObject`](https://clinth.github.io/ixfx/functions/Collections.Maps.fromObject.html)\n* [`immutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.immutable.html) - creates an immutable map\n* [`mutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.mutable.html) - creates a mutable map\n* [`zipKeyValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.zipKeyValue.html) - combine an array of keys and an array of values into an object\n\nMultiple values per key maps\n* [`mapOfSimpleMutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.mapOfSimpleMutable-1.html) - map that can store many values per key, less functions than the others below\n* [`ofArrayMutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.ofArrayMutable.html) - Uses an array to store values\n* [`ofCircularMutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.ofCircularMutable.html) - Uses a circular array of limited capacity\n* [`ofSetMutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.ofSetMutable.html) - Uses a set to store unique values\n  \nConverting maps\n* [`mapToArray`](https://clinth.github.io/ixfx/functions/Collections.Maps.mapToArray.html)\n* [`mapToObjectTransform`](https://clinth.github.io/ixfx/functions/Collections.Maps.mapToObjectTransform.html)\n* [`toObject`](https://clinth.github.io/ixfx/functions/Collections.Maps.toObject.html)\n\n\n\n\n", "html": '<div class="tip">\n<ul>\n<li>API Reference <a href="https://clinth.github.io/ixfx/modules/Collections.Maps.html">Collections.Maps module</a></li>\n<li>Parent <a href="https://clinth.github.io/ixfx/modules/Collections.html">Collections module</a></li>\n</div>\n<p>Javascript has an in-built <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map">Map</a> object which is used for tracking key-value pairs. In other words, it maps a given <em>key</em> to a given <em>value</em>. The basic operations of a map are <code is:raw>set()</code>,<code is:raw>get()</code>, <code is:raw>delete()</code> and <code is:raw>has()</code>.</p>\n<p>Maps can be useful when there is a meaningful and unique way of referring to values, where we want the possibilty to get <em>just that one thing</em> efficiently.</p>\n<p>You can think of a map like a dictionary. If you want to look up a definition (a <em>value</em>), you need the word (the <em>key</em>). We could say that the dictionary is <em>keyed</em> by words. If a new definition is to be added to the dictionary (ie a new value), we have to add it with its word (ie its key), we can\'t just throw it in without.</p>\n<p><a href="../arrays/">Arrays</a> can also let you efficiently get an item, but only by its numerical <em>index</em>. In some cases, using an index makes perfect sense - getting the <em>first</em> item in a sorted array, for example. But thinking again of the dictionary, it doesn\'t seem useful to want to get the 300th word. We\'d much rather store and get items by some kind of unique identifier.</p>\n<h2 id="basic-operations">Basic operations</h2>\n<p>When storing objects in a map, keys are often a particular property that we expect to be unique. For example, maybe we have Fruit type, and we expect the <em>name</em> of the fruit to be unique, but not its colour, or flavour values.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> a1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">granny-smith</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">green</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">flavour</span><span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span>\n<span class="token keyword">const</span> a2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">golden-delicious</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">yellow</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">flavour</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>a1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> a1<span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>a2<span class="token punctuation">.</span>name<span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmap<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">granny-smith</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// True</span>\n<span class="token keyword">const</span> apple <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">granny-smith</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\napple<span class="token punctuation">.</span>flavour<span class="token punctuation">;</span> <span class="token comment">// 4</span></code></pre>\n<p>In the above example, you can see <code is:raw>set()</code> being used to add an object by its key (in this case its <em>name</em> property), and <code is:raw>get()</code> being used to retrieve an item by its key. If nothing is stored under a key, <em>undefined</em> is returned. <code is:raw>has()</code> returns true/false if a key exists too.</p>\n<p>Items are deleted by key:</p>\n<pre class="language-js"><code is:raw class="language-js">map<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">golden-delicious</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p>The contents of a map can be iterated over. You can iterate over keys and values separately:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token comment">// Iterate by key</span>\n<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> value <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Get value for key</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// Iterate over values</span>\n<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> value <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\n<span class="token punctuation">}</span></code></pre>\n<p>Or you can iterate over <em>entries</em>, which is an array of both key and value</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span>value<span class="token punctuation">]</span> <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// Use key and value as needed...</span>\n<span class="token punctuation">}</span></code></pre>\n<h2 id="alternatives-and-limitations">Alternatives and limitations</h2>\n<p>One side effect of a map is that only unique keys are stored. If you <code is:raw>set()</code> a second item with an existing key, the earlier value is overriden. If the desired outcome is simply to have unique values, consider using the <a href="./set/">Set</a>.</p>\n<p>Maps only store a single item per key. There are occasions where we\'d rather group items by a key. For that, see <a href="./mapMultiple">Map Multiple</a>.</p>\n<h2 id="helper-functions">Helper functions</h2>\n<p>ixfx has a few helper functions for working with maps. To import these functions:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span></code></pre>\n<h3 id="has">Has</h3>\n<p>JS has <code is:raw>Map.has()</code>, returning a boolean if a key is present. We can\'t check if a value is present. <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.hasAnyValue.html"><code is:raw>Maps.hasAnyValue()</code></a> takes the map to look over, a value, and a comparison function that returns true or false if two values match.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>\n\n<span class="token comment">// Compare fruits based on their colour property</span>\n<span class="token keyword">const</span> <span class="token function-variable function">colourComparer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>colour <span class="token operator">===</span> b<span class="token punctuation">.</span>colour<span class="token punctuation">;</span>\n\n<span class="token comment">// Returns true if any fruit has the colour red</span>\nMaps<span class="token punctuation">.</span><span class="token function">hasAnyValue</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span> colourComparer<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.hasKeyValue.html"><code is:raw>hasKeyValue</code></a> returns true if a given key exists <em>and</em> the value matches as well.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token comment">// Returns true if the stored apple is also red</span>\nMaps<span class="token punctuation">.</span><span class="token function">hasKeyValue</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">apple</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span> colourComparer<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<h3 id="iterating">Iterating</h3>\n<p>To get all the values of a map as an array, the syntax for that is:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>map<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>\n<p>Or alternatively using ixfx\'s <code is:raw>Maps.toArray</code>:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> values <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p><code is:raw>Maps.filter</code> iterates over all values of a map that match a given predicate:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>\n<span class="token keyword">const</span> <span class="token function-variable function">p</span> <span class="token operator">=</span> <span class="token parameter">value</span> <span class="token operator">=></span> value<span class="token punctuation">.</span>colour <span class="token operator">===</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>\n<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> value <span class="token keyword">of</span> Maps<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// Iterates all the values with .colour = `red`</span>\n<span class="token punctuation">}</span></code></pre>\n<p>To iterate over sorted values, use <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValue.html"><code is:raw>Maps.sortByValue</code></a>:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>\n<span class="token keyword">const</span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nm<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">1</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">zebra</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nm<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">2</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ant</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> values <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">sortByValue</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// Yields:</span>\n<span class="token comment">// [`ant`, `zebra`]</span></code></pre>\n<p>If the map contains objects, you will want to provide a custom comparer function. An alternative is to use <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValueProperty.html"><code is:raw>Maps.sortByValue</code></a>, which sorts by the property of a value.</p>\n<pre class="language-js"><code is:raw class="language-js">cosnt m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nm<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">4491</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bob</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nm<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">2319</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Alice</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> sorted <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">sortByValue</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">name</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// Yields:</span>\n<span class="token comment">// [ { name: `Alice` }, { name: `Bob` }]</span></code></pre>\n<h3 id="deleting">Deleting</h3>\n<p>Deleting from a map is usually by key (<code is:raw>map.delete(key)</code>), but if you want to delete a particular value, regardless of its key, consider ixfx\'s <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.deleteByValue.html"><code is:raw>Maps.deleteByValue</code></a>:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>\n\n<span class="token comment">// Compare fruits based on their colour property</span>\n<span class="token keyword">const</span> <span class="token function-variable function">colourComparer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>colour <span class="token operator">===</span> b<span class="token punctuation">.</span>colour<span class="token punctuation">;</span>\n\n<span class="token comment">// Deletes all values where .colour = `red`</span>\nMaps<span class="token punctuation">.</span><span class="token function">deleteByValue</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span> colourComparer<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<h2 id="conversions">Conversions</h2>\n<p>If you already have something iterable (eg an array or other collection), you can make a map from it with ixfx\'s <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.fromIterable.html"><code is:raw>Maps.fromIterable</code></a>. It needs a function that generates a key for a given value. An optional third parameter allows keys to be overwritten (false by default)</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span> \n  <span class="token punctuation">{</span> <span class="token literal-property property">fruit</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">granny-smith</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">family</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">apple</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">green</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span>\n  <span class="token punctuation">{</span> <span class="token literal-property property">fruit</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mango</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">family</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">stone-fruit</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">orange</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span>\n<span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">fromIterable</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token parameter">v</span> <span class="token operator">=></span> v<span class="token punctuation">.</span>fruit<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p>[<code is:raw>Maps.fromObject</code>] converts a plain object into a map, using its top-level properties as keys.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>\n <span class="token literal-property property">Sally</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sally</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n <span class="token literal-property property">Bob</span><span class="token operator">:</span>   <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bob</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>   <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">pink</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">fromObject</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sally</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { name: `Sally`, colour: `red` }</span></code></pre>\n<h2 id="get-or-generate">Get or generate</h2>\n<p>A common pattern working with maps to retrieve something by a given key, and if it doesn\'t exist to create an object for that key.</p>\n<p>For example, if we are processing multi-touch input, each pointer event has a <code is:raw>pointerId</code>, and we may want to track that over time. Since it\'s a unique identifier, a map makes perfect sense. We either want to get the existing tracker for <em>that</em> pointer, or create a new tracker if it\'s an id that we haven\'t encountered yet.</p>\n<p><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerate-1.html"><code is:raw>Maps.getOrGenerate</code></a> can assist.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>\n<span class="token comment">// Set up</span>\n<span class="token keyword">const</span> trackers <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">getOrGenerate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token parameter">key</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// This runs whenever there is a new key stored,</span>\n  <span class="token comment">// adding the returned value to the map</span>\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MagicalPointerTracker</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\ndocument<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">pointermove</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">evt</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// Get a MagicalPointerTracker instance for this pointerId,</span>\n  <span class="token comment">// creating it if it doesn\'t exist</span>\n  <span class="token keyword">const</span> tracker <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">trackers</span><span class="token punctuation">(</span>evt<span class="token punctuation">.</span>pointerId<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>\n<p>Note the use of <code is:raw>await</code>. This means that we can use asynchronous functions to generate new values on demand. Alternatively, use <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerateSync.html"><code is:raw>getOrGenerateSync</code></a> which has the same signature, but doesn\'t need <code is:raw>await</code> when accessing.</p>\n<h2 id="adding">Adding</h2>\n<p>By default, adding a key-value pair to a map will overwrite an existing entry with same key. Sometimes this \'last write wins\' logic is not wanted, and instead we want to throw away values if they would overwrite something older. <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.addKeepingExisting.html"><code is:raw>Maps.addKeepingExisting</code></a> to the rescue.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>\n<span class="token comment">// Function that generates a key for a value</span>\n<span class="token keyword">const</span> <span class="token function-variable function">keyFn</span> <span class="token operator">=</span> <span class="token parameter">v</span> <span class="token operator">=></span> v<span class="token punctuation">.</span>name<span class="token punctuation">;</span>\n\n<span class="token comment">// Values to add</span>\n<span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">[</span>\n  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sally</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bob</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">pink</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sally</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">green</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span> <span class="token comment">/* this one will get ignored */</span>\n<span class="token punctuation">]</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Add values</span>\nMaps<span class="token punctuation">.</span><span class="token function">addKeepingExisting</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> keyFn<span class="token punctuation">,</span> <span class="token operator">...</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sally</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>colour<span class="token punctuation">;</span> <span class="token comment">// `red`</span></code></pre>\n<p>In the above example, we can see that the older value for \'Sally\' is kept.</p>\n<h2 id="transformations">Transformations</h2>\n<p><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mapToArray.html"><code is:raw>Maps.mapToArray</code></a> allows an array of values to be generated from a map. This can be useful if you want to pluck out a particular property from each value, or transform values.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>\n<span class="token comment">// Where map contains things like:</span>\n<span class="token comment">//  Sally -> { name: `Sally`, colour: `red` }</span>\n<span class="token comment">//  Bob   -> { name: `Bob`, colour: `pink` }</span>\n<span class="token keyword">const</span> altered <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">mapToArray</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> person</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token operator">...</span>person<span class="token punctuation">,</span>\n  <span class="token literal-property property">name</span><span class="token operator">:</span> person<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token literal-property property">rand</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// Yields an array: [</span>\n<span class="token comment">//  { name: `SALLY`, colour: `red`, rand: 0.351 },</span>\n<span class="token comment">//  { name: `BOB`, colour: `pink`, rand: 0.912 }</span>\n<span class="token comment">// ]</span></code></pre>\n<p><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.toObject.html"><code is:raw>Maps.toObject</code></a> converts a map to a plain object, this is useful for turning into a JSON string representation.</p>\n<p>Given the same example map from above:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> objects <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">toObject</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// Yields: {</span>\n<span class="token comment">//  Sally: { name: `Sally`, colour: `red` },</span>\n<span class="token comment">//  Bob: { name: `Bob`, colour: `pink` }</span>\n<span class="token comment">// }</span></code></pre>\n<p>Use <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.fromObject.html"><code is:raw>Maps.fromObject</code></a> to convert back from a plain object.</p>\n<p><em>Mapping</em> over a collection of values is common when dealing with arrays. It allows you to transform each element of an array, returning a new array with the transformed values. There is no in built <code is:raw>map()</code> for Maps, but you can use ixfx\'s <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.transformMap.html"><code is:raw>Maps.transformMap</code></a> for a similar outcome.</p>\n<p>Like a regular map, it takes a map function which must return a transformed version of its input value.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Ant</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bee</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">c</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Cat</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">transformer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">animal</span><span class="token operator">:</span> value <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> newMap <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">transformMap</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> transformer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// Yields: `Bee`</span>\nnewMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Yields: { animal: `Bee` }</span></code></pre>\n<p>The above example could be expressed more succinctly:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> newMap <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">transformMap</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token literal-property property">animal</span><span class="token operator">:</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p><em>Zippering</em> is combining two aligned arrays together. In the case of a map, we might want to combine an array of keys with an array of values using\n<a href="https://clinth.github.io/ixfx/functions/Collections.Maps.zipKeyValue.html"><code is:raw>Maps.zipKeyValue</code></a>. The length of both arrays must be the same.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">c</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ant</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">bee</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">cat</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">zipKeyValue</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Yields: `bee`</span></code></pre>\n<h2 id="expiring-map">Expiring Map</h2>\n<p>The <a href="https://clinth.github.io/ixfx/classes/Collections.Maps.ExpiringMap.html"><code is:raw>ExpiringMap</code></a> is a class where values expire after some period. This is useful for caches or cases where there\'s not a good logic for when to remove things.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExpiringMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">fruit</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">apple</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Delete all entries set more than 100ms ago</span>\nmap<span class="token punctuation">.</span><span class="token function">deleteWithElapsed</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">set</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Delete all entries that have not been accessed for more than 100ms</span>\nmap<span class="token punctuation">.</span><span class="token function">deleteWithElapsed</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">get</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Get the time since the key \'fruit\' was last accessed</span>\nmap<span class="token punctuation">.</span><span class="token function">elapsedGet</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">fruit</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Get the time since the key `fruit` was last set</span>\nmap<span class="token punctuation">.</span><span class="token function">elapsedSet</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">fruit</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p>When creating the map, you can opt to have it automatically delete items:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token comment">// Delete any entry not accessed for over one second</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExpiringMap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token literal-property property">autoDeleteElapsed</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">autoDeletePolicy</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">get</span><span class="token template-punctuation string">`</span></span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p>See the API docs for more on the options.</p>\n<p>There are also some events to listen for automatic expiry: \'expired\', \'removed\' and \'newKey\'.</p>\n<pre class="language-js"><code is:raw class="language-js">map<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">expired</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> key<span class="token punctuation">,</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> event<span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<h2 id="more-functions-for-working-with-maps">More functions for working with maps</h2>\n<p>Finding</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.find.html"><code is:raw>find</code></a> - Finds first value that matches a predicate</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.firstEntryByIterableValue.html"><code is:raw>firstEntryByIterableValue</code></a> - Finds first entry that matches value</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.firstEntryByIterableValue.html"><code is:raw>firstEntryByIterablePredicate</code></a> - Finds first entry that matches predicate (same as <code is:raw>find</code>)</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getClosestIntegerKey.html"><code is:raw>getClosestIntegerKey</code></a> - assumes all keys are integers, gets the closest present key</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getFromKeys.html"><code is:raw>getFromKeys</code></a> - given a set of keys, returns the value for the first one that is present</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.hasAnyValue.html"><code is:raw>hasAnyValue</code></a> - returns true if value is in the map</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.hasKeyValue.html"><code is:raw>hasAnyKeyValue</code></a>- returns true if value is present under key</li>\n</ul>\n<p>Iterating</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.filter.html"><code is:raw>filter</code></a> - iterate over values where predicate returns true</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValue.html"><code is:raw>sortByValue</code></a> - returns values, sorted</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValueProperty.html"><code is:raw>sortByValueProperty</code></a> - returns entries, sorted by a chosen property</li>\n</ul>\n<p>Adding values</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.addKeepingExisting.html"><code is:raw>addKeepExisting</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.addObject.html"><code is:raw>addObject</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerate-1.html"><code is:raw>getOrGenerate</code></a> - get by key or create &#x26; add new item</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mergeByKey.html"><code is:raw>mergeByKey</code></a> - merge two maps, with a reconcile function to merge values that use same key</li>\n</ul>\n<p>Removing/changing values</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.deleteByValue.html"><code is:raw>deleteByValue</code></a> - remove by value rather than key</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.transformMap.html"><code is:raw>transformMap</code></a> - for each entry, runs it through a function and into a new map</li>\n</ul>\n<p>Creating maps</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.fromIterable.html"><code is:raw>fromIterable</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.fromObject.html"><code is:raw>fromObject</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.immutable.html"><code is:raw>immutable</code></a> - creates an immutable map</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mutable.html"><code is:raw>mutable</code></a> - creates a mutable map</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.zipKeyValue.html"><code is:raw>zipKeyValue</code></a> - combine an array of keys and an array of values into an object</li>\n</ul>\n<p>Multiple values per key maps</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mapOfSimpleMutable-1.html"><code is:raw>mapOfSimpleMutable</code></a> - map that can store many values per key, less functions than the others below</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.ofArrayMutable.html"><code is:raw>ofArrayMutable</code></a> - Uses an array to store values</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.ofCircularMutable.html"><code is:raw>ofCircularMutable</code></a> - Uses a circular array of limited capacity</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.ofSetMutable.html"><code is:raw>ofSetMutable</code></a> - Uses a set to store unique values</li>\n</ul>\n<p>Converting maps</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mapToArray.html"><code is:raw>mapToArray</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mapToObjectTransform.html"><code is:raw>mapToObjectTransform</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.toObject.html"><code is:raw>toObject</code></a></li>\n</ul>' } };
const $$metadata = createMetadata("/src/pages/data/collections/map.md", { modules: [{ module: $$module1, specifier: "astro/components", assert: {} }, { module: $$module1$1, specifier: "../../../layouts/MainLayout.astro", assert: {} }], hydratedComponents: [], clientOnlyComponents: [], hydrationDirectives: /* @__PURE__ */ new Set([]), hoisted: [] });
const $$Astro = createAstro("/src/pages/data/collections/map.md", "https://clinth.github.io/ixfx-docs/", "file:///Users/af4766/repos/ixfx-docs/");
const $$Map = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro, $$props, $$slots);
  Astro2.self = $$Map;
  const $$content = { "title": "Map", "astro": { "headers": [{ "depth": 2, "slug": "basic-operations", "text": "Basic operations" }, { "depth": 2, "slug": "alternatives-and-limitations", "text": "Alternatives and limitations" }, { "depth": 2, "slug": "helper-functions", "text": "Helper functions" }, { "depth": 3, "slug": "has", "text": "Has" }, { "depth": 3, "slug": "iterating", "text": "Iterating" }, { "depth": 3, "slug": "deleting", "text": "Deleting" }, { "depth": 2, "slug": "conversions", "text": "Conversions" }, { "depth": 2, "slug": "get-or-generate", "text": "Get or generate" }, { "depth": 2, "slug": "adding", "text": "Adding" }, { "depth": 2, "slug": "transformations", "text": "Transformations" }, { "depth": 2, "slug": "expiring-map", "text": "Expiring Map" }, { "depth": 2, "slug": "more-functions-for-working-with-maps", "text": "More functions for working with maps" }], "source": "\n<div class=\"tip\">\n<ul>\n<li>API Reference <a href=\"https://clinth.github.io/ixfx/modules/Collections.Maps.html\">Collections.Maps module</a></li>\n<li>Parent <a href=\"https://clinth.github.io/ixfx/modules/Collections.html\">Collections module</a></li>\n</div>\n\nJavascript has an in-built [Map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map) object which is used for tracking key-value pairs. In other words, it maps a given _key_ to a given _value_. The basic operations of a map are `set()`,`get()`, `delete()` and `has()`.\n\nMaps can be useful when there is a meaningful and unique way of referring to values, where we want the possibilty to get _just that one thing_ efficiently. \n\nYou can think of a map like a dictionary. If you want to look up a definition (a _value_), you need the word (the _key_). We could say that the dictionary is _keyed_ by words. If a new definition is to be added to the dictionary (ie a new value), we have to add it with its word (ie its key), we can't just throw it in without.\n\n[Arrays](../arrays/) can also let you efficiently get an item, but only by its numerical _index_. In some cases, using an index makes perfect sense - getting the _first_ item in a sorted array, for example. But thinking again of the dictionary, it doesn't seem useful to want to get the 300th word. We'd much rather store and get items by some kind of unique identifier.\n\n## Basic operations\n\nWhen storing objects in a map, keys are often a particular property that we expect to be unique. For example, maybe we have Fruit type, and we expect the _name_ of the fruit to be unique, but not its colour, or flavour values.\n\n```js\nconst a1 = { name: `granny-smith`, colour: `green`, flavour: 4 }\nconst a2 = { name: `golden-delicious`, colour: `yellow`, flavour: 2 }\nconst map = new Map();\nmap.set(a1.name, a1);\nmap.set(a2.name, a2);\n\nmap.has(`granny-smith`); // True\nconst apple = map.get(`granny-smith`);\napple.flavour; // 4\n```\n\nIn the above example, you can see `set()` being used to add an object by its key (in this case its _name_ property), and `get()` being used to retrieve an item by its key. If nothing is stored under a key, _undefined_ is returned. `has()` returns true/false if a key exists too.\n\nItems are deleted by key:\n\n```js\nmap.delete(`golden-delicious`);\n```\n\nThe contents of a map can be iterated over. You can iterate over keys and values separately:\n```js\n// Iterate by key\nfor (const key of map.keys()) {\n  const value = map.get(key); // Get value for key\n}\n\n// Iterate over values\nfor (const value of map.values()) {\n\n}\n```\n\nOr you can iterate over _entries_, which is an array of both key and value\n\n```js\nfor (const [key,value] of map.entries()) {\n  // Use key and value as needed...\n}\n```\n\n## Alternatives and limitations\n\nOne side effect of a map is that only unique keys are stored. If you `set()` a second item with an existing key, the earlier value is overriden. If the desired outcome is simply to have unique values, consider using the [Set](./set/).\n\nMaps only store a single item per key. There are occasions where we'd rather group items by a key. For that, see [Map Multiple](./mapMultiple).\n\n## Helper functions\n\nixfx has a few helper functions for working with maps. To import these functions:\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\n```\n\n### Has\n\nJS has `Map.has()`, returning a boolean if a key is present. We can't check if a value is present. [`Maps.hasAnyValue()`](https://clinth.github.io/ixfx/functions/Collections.Maps.hasAnyValue.html) takes the map to look over, a value, and a comparison function that returns true or false if two values match.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\n\n// Compare fruits based on their colour property\nconst colourComparer = (a, b) => a.colour === b.colour;\n\n// Returns true if any fruit has the colour red\nMaps.hasAnyValue(map, { colour: `red` }, colourComparer);\n```\n\n[`hasKeyValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.hasKeyValue.html) returns true if a given key exists _and_ the value matches as well.\n\n```js\n// Returns true if the stored apple is also red\nMaps.hasKeyValue(map, `apple`, { colour: `red` }, colourComparer);\n```\n\n### Iterating\n\nTo get all the values of a map as an array, the syntax for that is:\n\n```js\nconst values = [...map.values()];\n```\n\nOr alternatively using ixfx's `Maps.toArray`:\n```js\nconst values = Maps.toArray(map);\n```\n\n`Maps.filter` iterates over all values of a map that match a given predicate:\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\nconst p = value => value.colour === `red`;\nfor (const value of Maps.filter(map, p)) {\n  // Iterates all the values with .colour = `red`\n}\n```\n\nTo iterate over sorted values, use [`Maps.sortByValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValue.html):\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\nconst m = new Map();\nm.set(`1`, `zebra`);\nm.set(`2`, `ant`);\n\nconst values = Maps.sortByValue(map);\n// Yields:\n// [`ant`, `zebra`]\n```\n\nIf the map contains objects, you will want to provide a custom comparer function. An alternative is to use [`Maps.sortByValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValueProperty.html), which sorts by the property of a value.\n\n```js\ncosnt m = new Map();\nm.set(`4491`, { name: `Bob` });\nm.set(`2319`, { name: `Alice` });\nconst sorted = Maps.sortByValue(m, `name`);\n// Yields:\n// [ { name: `Alice` }, { name: `Bob` }]\n```\n\n### Deleting\n\nDeleting from a map is usually by key (`map.delete(key)`), but if you want to delete a particular value, regardless of its key, consider ixfx's [`Maps.deleteByValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.deleteByValue.html):\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\n\n// Compare fruits based on their colour property\nconst colourComparer = (a, b) => a.colour === b.colour;\n\n// Deletes all values where .colour = `red`\nMaps.deleteByValue(map, { colour: `red` }, colourComparer);\n```\n\n## Conversions\n\nIf you already have something iterable (eg an array or other collection), you can make a map from it with ixfx's [`Maps.fromIterable`](https://clinth.github.io/ixfx/functions/Collections.Maps.fromIterable.html). It needs a function that generates a key for a given value. An optional third parameter allows keys to be overwritten (false by default)\n\n```js\nconst data = [ \n  { fruit: `granny-smith`, family: `apple`, colour: `green` }\n  { fruit: `mango`, family: `stone-fruit`, colour: `orange` }\n];\nconst map = Maps.fromIterable(data, v => v.fruit);\n```\n\n[`Maps.fromObject`] converts a plain object into a map, using its top-level properties as keys.\n\n```js\nconst data = {\n Sally: { name: `Sally`, colour: `red` },\n Bob:   { name: `Bob`,   colour: `pink` }\n};\nconst map = Maps.fromObject(data);\nmap.get(`Sally`); // { name: `Sally`, colour: `red` }\n```\n\n## Get or generate\n\nA common pattern working with maps to retrieve something by a given key, and if it doesn't exist to create an object for that key.\n\nFor example, if we are processing multi-touch input, each pointer event has a `pointerId`, and we may want to track that over time. Since it's a unique identifier, a map makes perfect sense. We either want to get the existing tracker for _that_ pointer, or create a new tracker if it's an id that we haven't encountered yet.\n\n[`Maps.getOrGenerate`](https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerate-1.html) can assist.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\n// Set up\nconst trackers = Maps.getOrGenerate(new Map(), key => {\n  // This runs whenever there is a new key stored,\n  // adding the returned value to the map\n  return new MagicalPointerTracker(key);\n})\n\ndocument.addEventListener(`pointermove`, async evt => {\n  // Get a MagicalPointerTracker instance for this pointerId,\n  // creating it if it doesn't exist\n  const tracker = await trackers(evt.pointerId);\n})\n```\n\nNote the use of `await`. This means that we can use asynchronous functions to generate new values on demand. Alternatively, use [`getOrGenerateSync`](https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerateSync.html) which has the same signature, but doesn't need `await` when accessing.\n\n## Adding\n\nBy default, adding a key-value pair to a map will overwrite an existing entry with same key. Sometimes this 'last write wins' logic is not wanted, and instead we want to throw away values if they would overwrite something older. [`Maps.addKeepingExisting`](https://clinth.github.io/ixfx/functions/Collections.Maps.addKeepingExisting.html) to the rescue.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\";\n// Function that generates a key for a value\nconst keyFn = v => v.name;\n\n// Values to add\nconst values = [\n  { name: `Sally`, colour: `red` },\n  { name: `Bob`, colour: `pink` },\n  { name: `Sally`, colour: `green` } /* this one will get ignored */\n]\nconst map = new Map();\n\n// Add values\nMaps.addKeepingExisting(map, keyFn, ...values);\nmap.get(`Sally`).colour; // `red`\n```\n\nIn the above example, we can see that the older value for 'Sally' is kept.\n\n## Transformations\n\n[`Maps.mapToArray`](https://clinth.github.io/ixfx/functions/Collections.Maps.mapToArray.html) allows an array of values to be generated from a map. This can be useful if you want to pluck out a particular property from each value, or transform values.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\";\n// Where map contains things like:\n//  Sally -> { name: `Sally`, colour: `red` }\n//  Bob   -> { name: `Bob`, colour: `pink` }\nconst altered = Maps.mapToArray(map, (key, person) => {\n  ...person,\n  name: person.name.toUpperCase();\n  rand: Math.random();\n});\n// Yields an array: [\n//  { name: `SALLY`, colour: `red`, rand: 0.351 },\n//  { name: `BOB`, colour: `pink`, rand: 0.912 }\n// ]\n```\n\n[`Maps.toObject`](https://clinth.github.io/ixfx/functions/Collections.Maps.toObject.html) converts a map to a plain object, this is useful for turning into a JSON string representation.\n\nGiven the same example map from above:\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\";\nconst objects = Maps.toObject(map);\n// Yields: {\n//  Sally: { name: `Sally`, colour: `red` },\n//  Bob: { name: `Bob`, colour: `pink` }\n// }\n```\n\nUse [`Maps.fromObject`](https://clinth.github.io/ixfx/functions/Collections.Maps.fromObject.html) to convert back from a plain object.\n\n_Mapping_ over a collection of values is common when dealing with arrays. It allows you to transform each element of an array, returning a new array with the transformed values. There is no in built `map()` for Maps, but you can use ixfx's [`Maps.transformMap`](https://clinth.github.io/ixfx/functions/Collections.Maps.transformMap.html) for a similar outcome.\n\nLike a regular map, it takes a map function which must return a transformed version of its input value.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\";\nconst map = new Map();\nmap.set(`a`, `Ant`);\nmap.set(`b`, `Bee`);\nmap.set(`c`, `Cat`);\n\nconst transformer = (value, key) => {\n  return { animal: value };\n};\n\nconst newMap = Maps.transformMap(map, transformer);\n\nmap.get(`b`);    // Yields: `Bee`\nnewMap.get(`b`); // Yields: { animal: `Bee` }\n```\n\nThe above example could be expressed more succinctly:\n\n```js\nconst newMap = Maps.transformMap(map, (value, key) => { animal: value });\n```\n\n_Zippering_ is combining two aligned arrays together. In the case of a map, we might want to combine an array of keys with an array of values using \n[`Maps.zipKeyValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.zipKeyValue.html). The length of both arrays must be the same.\n\n```js\nimport { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\";\nconst keys = [`a`, `b`, `c`];\nconst values = [`ant`, `bee`, `cat`];\nconst map = Maps.zipKeyValue(keys, values);\nmap.get(`b`); // Yields: `bee`\n```\n\n## Expiring Map\n\nThe [`ExpiringMap`](https://clinth.github.io/ixfx/classes/Collections.Maps.ExpiringMap.html) is a class where values expire after some period. This is useful for caches or cases where there's not a good logic for when to remove things.\n\n```js\nconst map = new ExpiringMap();\nmap.set(`fruit`, `apple`);\n\n// Delete all entries set more than 100ms ago\nmap.deleteWithElapsed(100, `set`);\n\n// Delete all entries that have not been accessed for more than 100ms\nmap.deleteWithElapsed(100, `get`);\n\n// Get the time since the key 'fruit' was last accessed\nmap.elapsedGet(`fruit`);\n\n// Get the time since the key `fruit` was last set\nmap.elapsedSet(`fruit`);\n```\n\nWhen creating the map, you can opt to have it automatically delete items:\n```js\n// Delete any entry not accessed for over one second\nconst map = new ExpiringMap({\n  autoDeleteElapsed: 1000,\n  autoDeletePolicy: `get`\n});\n```\n\nSee the API docs for more on the options.\n\nThere are also some events to listen for automatic expiry: 'expired', 'removed' and 'newKey'.\n```js\nmap.addEventListener(`expired`, event => {\n  const { key, value } = event;\n});\n```\n\n## More functions for working with maps\n\nFinding\n* [`find`](https://clinth.github.io/ixfx/functions/Collections.Maps.find.html) - Finds first value that matches a predicate\n* [`firstEntryByIterableValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.firstEntryByIterableValue.html) - Finds first entry that matches value\n* [`firstEntryByIterablePredicate`](https://clinth.github.io/ixfx/functions/Collections.Maps.firstEntryByIterableValue.html) - Finds first entry that matches predicate (same as `find`)\n* [`getClosestIntegerKey`](https://clinth.github.io/ixfx/functions/Collections.Maps.getClosestIntegerKey.html) - assumes all keys are integers, gets the closest present key\n* [`getFromKeys`](https://clinth.github.io/ixfx/functions/Collections.Maps.getFromKeys.html) - given a set of keys, returns the value for the first one that is present\n* [`hasAnyValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.hasAnyValue.html) - returns true if value is in the map\n* [`hasAnyKeyValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.hasKeyValue.html)- returns true if value is present under key\n\nIterating\n* [`filter`](https://clinth.github.io/ixfx/functions/Collections.Maps.filter.html) - iterate over values where predicate returns true\n* [`sortByValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValue.html) - returns values, sorted\n* [`sortByValueProperty`](https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValueProperty.html) - returns entries, sorted by a chosen property\n\nAdding values\n* [`addKeepExisting`](https://clinth.github.io/ixfx/functions/Collections.Maps.addKeepingExisting.html)\n* [`addObject`](https://clinth.github.io/ixfx/functions/Collections.Maps.addObject.html)\n* [`getOrGenerate`](https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerate-1.html) - get by key or create & add new item\n* [`mergeByKey`](https://clinth.github.io/ixfx/functions/Collections.Maps.mergeByKey.html) - merge two maps, with a reconcile function to merge values that use same key\n  \nRemoving/changing values\n* [`deleteByValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.deleteByValue.html) - remove by value rather than key\n* [`transformMap`](https://clinth.github.io/ixfx/functions/Collections.Maps.transformMap.html) - for each entry, runs it through a function and into a new map\n\nCreating maps\n* [`fromIterable`](https://clinth.github.io/ixfx/functions/Collections.Maps.fromIterable.html)\n* [`fromObject`](https://clinth.github.io/ixfx/functions/Collections.Maps.fromObject.html)\n* [`immutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.immutable.html) - creates an immutable map\n* [`mutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.mutable.html) - creates a mutable map\n* [`zipKeyValue`](https://clinth.github.io/ixfx/functions/Collections.Maps.zipKeyValue.html) - combine an array of keys and an array of values into an object\n\nMultiple values per key maps\n* [`mapOfSimpleMutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.mapOfSimpleMutable-1.html) - map that can store many values per key, less functions than the others below\n* [`ofArrayMutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.ofArrayMutable.html) - Uses an array to store values\n* [`ofCircularMutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.ofCircularMutable.html) - Uses a circular array of limited capacity\n* [`ofSetMutable`](https://clinth.github.io/ixfx/functions/Collections.Maps.ofSetMutable.html) - Uses a set to store unique values\n  \nConverting maps\n* [`mapToArray`](https://clinth.github.io/ixfx/functions/Collections.Maps.mapToArray.html)\n* [`mapToObjectTransform`](https://clinth.github.io/ixfx/functions/Collections.Maps.mapToObjectTransform.html)\n* [`toObject`](https://clinth.github.io/ixfx/functions/Collections.Maps.toObject.html)\n\n\n\n\n", "html": '<div class="tip">\n<ul>\n<li>API Reference <a href="https://clinth.github.io/ixfx/modules/Collections.Maps.html">Collections.Maps module</a></li>\n<li>Parent <a href="https://clinth.github.io/ixfx/modules/Collections.html">Collections module</a></li>\n</div>\n<p>Javascript has an in-built <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map">Map</a> object which is used for tracking key-value pairs. In other words, it maps a given <em>key</em> to a given <em>value</em>. The basic operations of a map are <code is:raw>set()</code>,<code is:raw>get()</code>, <code is:raw>delete()</code> and <code is:raw>has()</code>.</p>\n<p>Maps can be useful when there is a meaningful and unique way of referring to values, where we want the possibilty to get <em>just that one thing</em> efficiently.</p>\n<p>You can think of a map like a dictionary. If you want to look up a definition (a <em>value</em>), you need the word (the <em>key</em>). We could say that the dictionary is <em>keyed</em> by words. If a new definition is to be added to the dictionary (ie a new value), we have to add it with its word (ie its key), we can\'t just throw it in without.</p>\n<p><a href="../arrays/">Arrays</a> can also let you efficiently get an item, but only by its numerical <em>index</em>. In some cases, using an index makes perfect sense - getting the <em>first</em> item in a sorted array, for example. But thinking again of the dictionary, it doesn\'t seem useful to want to get the 300th word. We\'d much rather store and get items by some kind of unique identifier.</p>\n<h2 id="basic-operations">Basic operations</h2>\n<p>When storing objects in a map, keys are often a particular property that we expect to be unique. For example, maybe we have Fruit type, and we expect the <em>name</em> of the fruit to be unique, but not its colour, or flavour values.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> a1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">granny-smith</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">green</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">flavour</span><span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span>\n<span class="token keyword">const</span> a2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">golden-delicious</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">yellow</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">flavour</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>a1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> a1<span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>a2<span class="token punctuation">.</span>name<span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmap<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">granny-smith</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// True</span>\n<span class="token keyword">const</span> apple <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">granny-smith</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\napple<span class="token punctuation">.</span>flavour<span class="token punctuation">;</span> <span class="token comment">// 4</span></code></pre>\n<p>In the above example, you can see <code is:raw>set()</code> being used to add an object by its key (in this case its <em>name</em> property), and <code is:raw>get()</code> being used to retrieve an item by its key. If nothing is stored under a key, <em>undefined</em> is returned. <code is:raw>has()</code> returns true/false if a key exists too.</p>\n<p>Items are deleted by key:</p>\n<pre class="language-js"><code is:raw class="language-js">map<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">golden-delicious</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p>The contents of a map can be iterated over. You can iterate over keys and values separately:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token comment">// Iterate by key</span>\n<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> value <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Get value for key</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// Iterate over values</span>\n<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> value <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\n<span class="token punctuation">}</span></code></pre>\n<p>Or you can iterate over <em>entries</em>, which is an array of both key and value</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span>value<span class="token punctuation">]</span> <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// Use key and value as needed...</span>\n<span class="token punctuation">}</span></code></pre>\n<h2 id="alternatives-and-limitations">Alternatives and limitations</h2>\n<p>One side effect of a map is that only unique keys are stored. If you <code is:raw>set()</code> a second item with an existing key, the earlier value is overriden. If the desired outcome is simply to have unique values, consider using the <a href="./set/">Set</a>.</p>\n<p>Maps only store a single item per key. There are occasions where we\'d rather group items by a key. For that, see <a href="./mapMultiple">Map Multiple</a>.</p>\n<h2 id="helper-functions">Helper functions</h2>\n<p>ixfx has a few helper functions for working with maps. To import these functions:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span></code></pre>\n<h3 id="has">Has</h3>\n<p>JS has <code is:raw>Map.has()</code>, returning a boolean if a key is present. We can\'t check if a value is present. <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.hasAnyValue.html"><code is:raw>Maps.hasAnyValue()</code></a> takes the map to look over, a value, and a comparison function that returns true or false if two values match.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>\n\n<span class="token comment">// Compare fruits based on their colour property</span>\n<span class="token keyword">const</span> <span class="token function-variable function">colourComparer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>colour <span class="token operator">===</span> b<span class="token punctuation">.</span>colour<span class="token punctuation">;</span>\n\n<span class="token comment">// Returns true if any fruit has the colour red</span>\nMaps<span class="token punctuation">.</span><span class="token function">hasAnyValue</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span> colourComparer<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.hasKeyValue.html"><code is:raw>hasKeyValue</code></a> returns true if a given key exists <em>and</em> the value matches as well.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token comment">// Returns true if the stored apple is also red</span>\nMaps<span class="token punctuation">.</span><span class="token function">hasKeyValue</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">apple</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span> colourComparer<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<h3 id="iterating">Iterating</h3>\n<p>To get all the values of a map as an array, the syntax for that is:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>map<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>\n<p>Or alternatively using ixfx\'s <code is:raw>Maps.toArray</code>:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> values <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p><code is:raw>Maps.filter</code> iterates over all values of a map that match a given predicate:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>\n<span class="token keyword">const</span> <span class="token function-variable function">p</span> <span class="token operator">=</span> <span class="token parameter">value</span> <span class="token operator">=></span> value<span class="token punctuation">.</span>colour <span class="token operator">===</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>\n<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> value <span class="token keyword">of</span> Maps<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// Iterates all the values with .colour = `red`</span>\n<span class="token punctuation">}</span></code></pre>\n<p>To iterate over sorted values, use <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValue.html"><code is:raw>Maps.sortByValue</code></a>:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>\n<span class="token keyword">const</span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nm<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">1</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">zebra</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nm<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">2</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ant</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> values <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">sortByValue</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// Yields:</span>\n<span class="token comment">// [`ant`, `zebra`]</span></code></pre>\n<p>If the map contains objects, you will want to provide a custom comparer function. An alternative is to use <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValueProperty.html"><code is:raw>Maps.sortByValue</code></a>, which sorts by the property of a value.</p>\n<pre class="language-js"><code is:raw class="language-js">cosnt m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nm<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">4491</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bob</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nm<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">2319</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Alice</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> sorted <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">sortByValue</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">name</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// Yields:</span>\n<span class="token comment">// [ { name: `Alice` }, { name: `Bob` }]</span></code></pre>\n<h3 id="deleting">Deleting</h3>\n<p>Deleting from a map is usually by key (<code is:raw>map.delete(key)</code>), but if you want to delete a particular value, regardless of its key, consider ixfx\'s <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.deleteByValue.html"><code is:raw>Maps.deleteByValue</code></a>:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>\n\n<span class="token comment">// Compare fruits based on their colour property</span>\n<span class="token keyword">const</span> <span class="token function-variable function">colourComparer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>colour <span class="token operator">===</span> b<span class="token punctuation">.</span>colour<span class="token punctuation">;</span>\n\n<span class="token comment">// Deletes all values where .colour = `red`</span>\nMaps<span class="token punctuation">.</span><span class="token function">deleteByValue</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span> colourComparer<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<h2 id="conversions">Conversions</h2>\n<p>If you already have something iterable (eg an array or other collection), you can make a map from it with ixfx\'s <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.fromIterable.html"><code is:raw>Maps.fromIterable</code></a>. It needs a function that generates a key for a given value. An optional third parameter allows keys to be overwritten (false by default)</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span> \n  <span class="token punctuation">{</span> <span class="token literal-property property">fruit</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">granny-smith</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">family</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">apple</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">green</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span>\n  <span class="token punctuation">{</span> <span class="token literal-property property">fruit</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mango</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">family</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">stone-fruit</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">orange</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span>\n<span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">fromIterable</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token parameter">v</span> <span class="token operator">=></span> v<span class="token punctuation">.</span>fruit<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p>[<code is:raw>Maps.fromObject</code>] converts a plain object into a map, using its top-level properties as keys.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>\n <span class="token literal-property property">Sally</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sally</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n <span class="token literal-property property">Bob</span><span class="token operator">:</span>   <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bob</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>   <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">pink</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">fromObject</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sally</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { name: `Sally`, colour: `red` }</span></code></pre>\n<h2 id="get-or-generate">Get or generate</h2>\n<p>A common pattern working with maps to retrieve something by a given key, and if it doesn\'t exist to create an object for that key.</p>\n<p>For example, if we are processing multi-touch input, each pointer event has a <code is:raw>pointerId</code>, and we may want to track that over time. Since it\'s a unique identifier, a map makes perfect sense. We either want to get the existing tracker for <em>that</em> pointer, or create a new tracker if it\'s an id that we haven\'t encountered yet.</p>\n<p><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerate-1.html"><code is:raw>Maps.getOrGenerate</code></a> can assist.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>\n<span class="token comment">// Set up</span>\n<span class="token keyword">const</span> trackers <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">getOrGenerate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token parameter">key</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// This runs whenever there is a new key stored,</span>\n  <span class="token comment">// adding the returned value to the map</span>\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MagicalPointerTracker</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\ndocument<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">pointermove</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">evt</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// Get a MagicalPointerTracker instance for this pointerId,</span>\n  <span class="token comment">// creating it if it doesn\'t exist</span>\n  <span class="token keyword">const</span> tracker <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">trackers</span><span class="token punctuation">(</span>evt<span class="token punctuation">.</span>pointerId<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>\n<p>Note the use of <code is:raw>await</code>. This means that we can use asynchronous functions to generate new values on demand. Alternatively, use <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerateSync.html"><code is:raw>getOrGenerateSync</code></a> which has the same signature, but doesn\'t need <code is:raw>await</code> when accessing.</p>\n<h2 id="adding">Adding</h2>\n<p>By default, adding a key-value pair to a map will overwrite an existing entry with same key. Sometimes this \'last write wins\' logic is not wanted, and instead we want to throw away values if they would overwrite something older. <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.addKeepingExisting.html"><code is:raw>Maps.addKeepingExisting</code></a> to the rescue.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>\n<span class="token comment">// Function that generates a key for a value</span>\n<span class="token keyword">const</span> <span class="token function-variable function">keyFn</span> <span class="token operator">=</span> <span class="token parameter">v</span> <span class="token operator">=></span> v<span class="token punctuation">.</span>name<span class="token punctuation">;</span>\n\n<span class="token comment">// Values to add</span>\n<span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">[</span>\n  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sally</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">red</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bob</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">pink</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sally</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">green</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span> <span class="token comment">/* this one will get ignored */</span>\n<span class="token punctuation">]</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Add values</span>\nMaps<span class="token punctuation">.</span><span class="token function">addKeepingExisting</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> keyFn<span class="token punctuation">,</span> <span class="token operator">...</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sally</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>colour<span class="token punctuation">;</span> <span class="token comment">// `red`</span></code></pre>\n<p>In the above example, we can see that the older value for \'Sally\' is kept.</p>\n<h2 id="transformations">Transformations</h2>\n<p><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mapToArray.html"><code is:raw>Maps.mapToArray</code></a> allows an array of values to be generated from a map. This can be useful if you want to pluck out a particular property from each value, or transform values.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>\n<span class="token comment">// Where map contains things like:</span>\n<span class="token comment">//  Sally -> { name: `Sally`, colour: `red` }</span>\n<span class="token comment">//  Bob   -> { name: `Bob`, colour: `pink` }</span>\n<span class="token keyword">const</span> altered <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">mapToArray</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> person</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token operator">...</span>person<span class="token punctuation">,</span>\n  <span class="token literal-property property">name</span><span class="token operator">:</span> person<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token literal-property property">rand</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// Yields an array: [</span>\n<span class="token comment">//  { name: `SALLY`, colour: `red`, rand: 0.351 },</span>\n<span class="token comment">//  { name: `BOB`, colour: `pink`, rand: 0.912 }</span>\n<span class="token comment">// ]</span></code></pre>\n<p><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.toObject.html"><code is:raw>Maps.toObject</code></a> converts a map to a plain object, this is useful for turning into a JSON string representation.</p>\n<p>Given the same example map from above:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> objects <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">toObject</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// Yields: {</span>\n<span class="token comment">//  Sally: { name: `Sally`, colour: `red` },</span>\n<span class="token comment">//  Bob: { name: `Bob`, colour: `pink` }</span>\n<span class="token comment">// }</span></code></pre>\n<p>Use <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.fromObject.html"><code is:raw>Maps.fromObject</code></a> to convert back from a plain object.</p>\n<p><em>Mapping</em> over a collection of values is common when dealing with arrays. It allows you to transform each element of an array, returning a new array with the transformed values. There is no in built <code is:raw>map()</code> for Maps, but you can use ixfx\'s <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.transformMap.html"><code is:raw>Maps.transformMap</code></a> for a similar outcome.</p>\n<p>Like a regular map, it takes a map function which must return a transformed version of its input value.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Ant</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bee</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">c</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Cat</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">transformer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">animal</span><span class="token operator">:</span> value <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> newMap <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">transformMap</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> transformer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// Yields: `Bee`</span>\nnewMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Yields: { animal: `Bee` }</span></code></pre>\n<p>The above example could be expressed more succinctly:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> newMap <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">transformMap</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token literal-property property">animal</span><span class="token operator">:</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p><em>Zippering</em> is combining two aligned arrays together. In the case of a map, we might want to combine an array of keys with an array of values using\n<a href="https://clinth.github.io/ixfx/functions/Collections.Maps.zipKeyValue.html"><code is:raw>Maps.zipKeyValue</code></a>. The length of both arrays must be the same.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">c</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ant</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">bee</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">cat</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">zipKeyValue</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Yields: `bee`</span></code></pre>\n<h2 id="expiring-map">Expiring Map</h2>\n<p>The <a href="https://clinth.github.io/ixfx/classes/Collections.Maps.ExpiringMap.html"><code is:raw>ExpiringMap</code></a> is a class where values expire after some period. This is useful for caches or cases where there\'s not a good logic for when to remove things.</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExpiringMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">fruit</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">apple</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Delete all entries set more than 100ms ago</span>\nmap<span class="token punctuation">.</span><span class="token function">deleteWithElapsed</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">set</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Delete all entries that have not been accessed for more than 100ms</span>\nmap<span class="token punctuation">.</span><span class="token function">deleteWithElapsed</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">get</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Get the time since the key \'fruit\' was last accessed</span>\nmap<span class="token punctuation">.</span><span class="token function">elapsedGet</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">fruit</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Get the time since the key `fruit` was last set</span>\nmap<span class="token punctuation">.</span><span class="token function">elapsedSet</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">fruit</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p>When creating the map, you can opt to have it automatically delete items:</p>\n<pre class="language-js"><code is:raw class="language-js"><span class="token comment">// Delete any entry not accessed for over one second</span>\n<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExpiringMap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token literal-property property">autoDeleteElapsed</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">autoDeletePolicy</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">get</span><span class="token template-punctuation string">`</span></span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p>See the API docs for more on the options.</p>\n<p>There are also some events to listen for automatic expiry: \'expired\', \'removed\' and \'newKey\'.</p>\n<pre class="language-js"><code is:raw class="language-js">map<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">expired</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> key<span class="token punctuation">,</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> event<span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<h2 id="more-functions-for-working-with-maps">More functions for working with maps</h2>\n<p>Finding</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.find.html"><code is:raw>find</code></a> - Finds first value that matches a predicate</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.firstEntryByIterableValue.html"><code is:raw>firstEntryByIterableValue</code></a> - Finds first entry that matches value</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.firstEntryByIterableValue.html"><code is:raw>firstEntryByIterablePredicate</code></a> - Finds first entry that matches predicate (same as <code is:raw>find</code>)</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getClosestIntegerKey.html"><code is:raw>getClosestIntegerKey</code></a> - assumes all keys are integers, gets the closest present key</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getFromKeys.html"><code is:raw>getFromKeys</code></a> - given a set of keys, returns the value for the first one that is present</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.hasAnyValue.html"><code is:raw>hasAnyValue</code></a> - returns true if value is in the map</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.hasKeyValue.html"><code is:raw>hasAnyKeyValue</code></a>- returns true if value is present under key</li>\n</ul>\n<p>Iterating</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.filter.html"><code is:raw>filter</code></a> - iterate over values where predicate returns true</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValue.html"><code is:raw>sortByValue</code></a> - returns values, sorted</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValueProperty.html"><code is:raw>sortByValueProperty</code></a> - returns entries, sorted by a chosen property</li>\n</ul>\n<p>Adding values</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.addKeepingExisting.html"><code is:raw>addKeepExisting</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.addObject.html"><code is:raw>addObject</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerate-1.html"><code is:raw>getOrGenerate</code></a> - get by key or create &#x26; add new item</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mergeByKey.html"><code is:raw>mergeByKey</code></a> - merge two maps, with a reconcile function to merge values that use same key</li>\n</ul>\n<p>Removing/changing values</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.deleteByValue.html"><code is:raw>deleteByValue</code></a> - remove by value rather than key</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.transformMap.html"><code is:raw>transformMap</code></a> - for each entry, runs it through a function and into a new map</li>\n</ul>\n<p>Creating maps</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.fromIterable.html"><code is:raw>fromIterable</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.fromObject.html"><code is:raw>fromObject</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.immutable.html"><code is:raw>immutable</code></a> - creates an immutable map</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mutable.html"><code is:raw>mutable</code></a> - creates a mutable map</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.zipKeyValue.html"><code is:raw>zipKeyValue</code></a> - combine an array of keys and an array of values into an object</li>\n</ul>\n<p>Multiple values per key maps</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mapOfSimpleMutable-1.html"><code is:raw>mapOfSimpleMutable</code></a> - map that can store many values per key, less functions than the others below</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.ofArrayMutable.html"><code is:raw>ofArrayMutable</code></a> - Uses an array to store values</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.ofCircularMutable.html"><code is:raw>ofCircularMutable</code></a> - Uses a circular array of limited capacity</li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.ofSetMutable.html"><code is:raw>ofSetMutable</code></a> - Uses a set to store unique values</li>\n</ul>\n<p>Converting maps</p>\n<ul>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mapToArray.html"><code is:raw>mapToArray</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mapToObjectTransform.html"><code is:raw>mapToObjectTransform</code></a></li>\n<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.toObject.html"><code is:raw>toObject</code></a></li>\n</ul>' } };
  return render`${renderComponent($$result, "Layout", $$MainLayout, { "content": $$content }, { "default": () => render`<div class="tip">
<ul>
<li>API Reference <a href="https://clinth.github.io/ixfx/modules/Collections.Maps.html">Collections.Maps module</a></li>
<li>Parent <a href="https://clinth.github.io/ixfx/modules/Collections.html">Collections module</a></li>
</ul></div><p>Javascript has an in-built <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map">Map</a> object which is used for tracking key-value pairs. In other words, it maps a given <em>key</em> to a given <em>value</em>. The basic operations of a map are <code>set()</code>,<code>get()</code>, <code>delete()</code> and <code>has()</code>.</p><p>Maps can be useful when there is a meaningful and unique way of referring to values, where we want the possibilty to get <em>just that one thing</em> efficiently.</p><p>You can think of a map like a dictionary. If you want to look up a definition (a <em>value</em>), you need the word (the <em>key</em>). We could say that the dictionary is <em>keyed</em> by words. If a new definition is to be added to the dictionary (ie a new value), we have to add it with its word (ie its key), we can't just throw it in without.</p><p><a href="../arrays/">Arrays</a> can also let you efficiently get an item, but only by its numerical <em>index</em>. In some cases, using an index makes perfect sense - getting the <em>first</em> item in a sorted array, for example. But thinking again of the dictionary, it doesn't seem useful to want to get the 300th word. We'd much rather store and get items by some kind of unique identifier.</p><h2 id="basic-operations">Basic operations</h2><p>When storing objects in a map, keys are often a particular property that we expect to be unique. For example, maybe we have Fruit type, and we expect the <em>name</em> of the fruit to be unique, but not its colour, or flavour values.</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> a1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">granny-smith</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">green</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">flavour</span><span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> a2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">golden-delicious</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">yellow</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">flavour</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>a1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> a1<span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>a2<span class="token punctuation">.</span>name<span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span>

map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">granny-smith</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// True</span>
<span class="token keyword">const</span> apple <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">granny-smith</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
apple<span class="token punctuation">.</span>flavour<span class="token punctuation">;</span> <span class="token comment">// 4</span></code></pre><p>In the above example, you can see <code>set()</code> being used to add an object by its key (in this case its <em>name</em> property), and <code>get()</code> being used to retrieve an item by its key. If nothing is stored under a key, <em>undefined</em> is returned. <code>has()</code> returns true/false if a key exists too.</p><p>Items are deleted by key:</p><pre class="language-js"><code class="language-js">map<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">golden-delicious</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>The contents of a map can be iterated over. You can iterate over keys and values separately:</p><pre class="language-js"><code class="language-js"><span class="token comment">// Iterate by key</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> value <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Get value for key</span>
<span class="token punctuation">}</span>

<span class="token comment">// Iterate over values</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> value <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span></code></pre><p>Or you can iterate over <em>entries</em>, which is an array of both key and value</p><pre class="language-js"><code class="language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span>value<span class="token punctuation">]</span> <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Use key and value as needed...</span>
<span class="token punctuation">}</span></code></pre><h2 id="alternatives-and-limitations">Alternatives and limitations</h2><p>One side effect of a map is that only unique keys are stored. If you <code>set()</code> a second item with an existing key, the earlier value is overriden. If the desired outcome is simply to have unique values, consider using the <a href="./set/">Set</a>.</p><p>Maps only store a single item per key. There are occasions where we'd rather group items by a key. For that, see <a href="./mapMultiple">Map Multiple</a>.</p><h2 id="helper-functions">Helper functions</h2><p>ixfx has a few helper functions for working with maps. To import these functions:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span></code></pre><h3 id="has">Has</h3><p>JS has <code>Map.has()</code>, returning a boolean if a key is present. We can't check if a value is present. <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.hasAnyValue.html"><code>Maps.hasAnyValue()</code></a> takes the map to look over, a value, and a comparison function that returns true or false if two values match.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>

<span class="token comment">// Compare fruits based on their colour property</span>
<span class="token keyword">const</span> <span class="token function-variable function">colourComparer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>colour <span class="token operator">===</span> b<span class="token punctuation">.</span>colour<span class="token punctuation">;</span>

<span class="token comment">// Returns true if any fruit has the colour red</span>
Maps<span class="token punctuation">.</span><span class="token function">hasAnyValue</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">red</span><span class="token template-punctuation string">\`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span> colourComparer<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.hasKeyValue.html"><code>hasKeyValue</code></a> returns true if a given key exists <em>and</em> the value matches as well.</p><pre class="language-js"><code class="language-js"><span class="token comment">// Returns true if the stored apple is also red</span>
Maps<span class="token punctuation">.</span><span class="token function">hasKeyValue</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">apple</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">red</span><span class="token template-punctuation string">\`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span> colourComparer<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="iterating">Iterating</h3><p>To get all the values of a map as an array, the syntax for that is:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>map<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre><p>Or alternatively using ixfx's <code>Maps.toArray</code>:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> values <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>Maps.filter</code> iterates over all values of a map that match a given predicate:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>
<span class="token keyword">const</span> <span class="token function-variable function">p</span> <span class="token operator">=</span> <span class="token parameter">value</span> <span class="token operator">=></span> value<span class="token punctuation">.</span>colour <span class="token operator">===</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">red</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> value <span class="token keyword">of</span> Maps<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Iterates all the values with .colour = \`red\`</span>
<span class="token punctuation">}</span></code></pre><p>To iterate over sorted values, use <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValue.html"><code>Maps.sortByValue</code></a>:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>
<span class="token keyword">const</span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
m<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">1</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">zebra</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
m<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">2</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">ant</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> values <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">sortByValue</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Yields:</span>
<span class="token comment">// [\`ant\`, \`zebra\`]</span></code></pre><p>If the map contains objects, you will want to provide a custom comparer function. An alternative is to use <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValueProperty.html"><code>Maps.sortByValue</code></a>, which sorts by the property of a value.</p><pre class="language-js"><code class="language-js">cosnt m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
m<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">4491</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Bob</span><span class="token template-punctuation string">\`</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
m<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">2319</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Alice</span><span class="token template-punctuation string">\`</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sorted <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">sortByValue</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">name</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Yields:</span>
<span class="token comment">// [ { name: \`Alice\` }, { name: \`Bob\` }]</span></code></pre><h3 id="deleting">Deleting</h3><p>Deleting from a map is usually by key (<code>map.delete(key)</code>), but if you want to delete a particular value, regardless of its key, consider ixfx's <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.deleteByValue.html"><code>Maps.deleteByValue</code></a>:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>

<span class="token comment">// Compare fruits based on their colour property</span>
<span class="token keyword">const</span> <span class="token function-variable function">colourComparer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>colour <span class="token operator">===</span> b<span class="token punctuation">.</span>colour<span class="token punctuation">;</span>

<span class="token comment">// Deletes all values where .colour = \`red\`</span>
Maps<span class="token punctuation">.</span><span class="token function">deleteByValue</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">red</span><span class="token template-punctuation string">\`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span> colourComparer<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="conversions">Conversions</h2><p>If you already have something iterable (eg an array or other collection), you can make a map from it with ixfx's <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.fromIterable.html"><code>Maps.fromIterable</code></a>. It needs a function that generates a key for a given value. An optional third parameter allows keys to be overwritten (false by default)</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span> 
  <span class="token punctuation">{</span> <span class="token literal-property property">fruit</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">granny-smith</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">family</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">apple</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">green</span><span class="token template-punctuation string">\`</span></span> <span class="token punctuation">}</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">fruit</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">mango</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">family</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">stone-fruit</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">orange</span><span class="token template-punctuation string">\`</span></span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> map <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">fromIterable</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token parameter">v</span> <span class="token operator">=></span> v<span class="token punctuation">.</span>fruit<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>[<code>Maps.fromObject</code>] converts a plain object into a map, using its top-level properties as keys.</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
 <span class="token literal-property property">Sally</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Sally</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">red</span><span class="token template-punctuation string">\`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token literal-property property">Bob</span><span class="token operator">:</span>   <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Bob</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>   <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">pink</span><span class="token template-punctuation string">\`</span></span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> map <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">fromObject</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Sally</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { name: \`Sally\`, colour: \`red\` }</span></code></pre><h2 id="get-or-generate">Get or generate</h2><p>A common pattern working with maps to retrieve something by a given key, and if it doesn't exist to create an object for that key.</p><p>For example, if we are processing multi-touch input, each pointer event has a <code>pointerId</code>, and we may want to track that over time. Since it's a unique identifier, a map makes perfect sense. We either want to get the existing tracker for <em>that</em> pointer, or create a new tracker if it's an id that we haven't encountered yet.</p><p><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerate-1.html"><code>Maps.getOrGenerate</code></a> can assist.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span>
<span class="token comment">// Set up</span>
<span class="token keyword">const</span> trackers <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">getOrGenerate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token parameter">key</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// This runs whenever there is a new key stored,</span>
  <span class="token comment">// adding the returned value to the map</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MagicalPointerTracker</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">pointermove</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">evt</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// Get a MagicalPointerTracker instance for this pointerId,</span>
  <span class="token comment">// creating it if it doesn't exist</span>
  <span class="token keyword">const</span> tracker <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">trackers</span><span class="token punctuation">(</span>evt<span class="token punctuation">.</span>pointerId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>Note the use of <code>await</code>. This means that we can use asynchronous functions to generate new values on demand. Alternatively, use <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerateSync.html"><code>getOrGenerateSync</code></a> which has the same signature, but doesn't need <code>await</code> when accessing.</p><h2 id="adding">Adding</h2><p>By default, adding a key-value pair to a map will overwrite an existing entry with same key. Sometimes this 'last write wins' logic is not wanted, and instead we want to throw away values if they would overwrite something older. <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.addKeepingExisting.html"><code>Maps.addKeepingExisting</code></a> to the rescue.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>
<span class="token comment">// Function that generates a key for a value</span>
<span class="token keyword">const</span> <span class="token function-variable function">keyFn</span> <span class="token operator">=</span> <span class="token parameter">v</span> <span class="token operator">=></span> v<span class="token punctuation">.</span>name<span class="token punctuation">;</span>

<span class="token comment">// Values to add</span>
<span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Sally</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">red</span><span class="token template-punctuation string">\`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Bob</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">pink</span><span class="token template-punctuation string">\`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Sally</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">green</span><span class="token template-punctuation string">\`</span></span> <span class="token punctuation">}</span> <span class="token comment">/* this one will get ignored */</span>
<span class="token punctuation">]</span>
<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add values</span>
Maps<span class="token punctuation">.</span><span class="token function">addKeepingExisting</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> keyFn<span class="token punctuation">,</span> <span class="token operator">...</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Sally</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>colour<span class="token punctuation">;</span> <span class="token comment">// \`red\`</span></code></pre><p>In the above example, we can see that the older value for 'Sally' is kept.</p><h2 id="transformations">Transformations</h2><p><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mapToArray.html"><code>Maps.mapToArray</code></a> allows an array of values to be generated from a map. This can be useful if you want to pluck out a particular property from each value, or transform values.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>
<span class="token comment">// Where map contains things like:</span>
<span class="token comment">//  Sally -> { name: \`Sally\`, colour: \`red\` }</span>
<span class="token comment">//  Bob   -> { name: \`Bob\`, colour: \`pink\` }</span>
<span class="token keyword">const</span> altered <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">mapToArray</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> person</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>person<span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> person<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token literal-property property">rand</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Yields an array: [</span>
<span class="token comment">//  { name: \`SALLY\`, colour: \`red\`, rand: 0.351 },</span>
<span class="token comment">//  { name: \`BOB\`, colour: \`pink\`, rand: 0.912 }</span>
<span class="token comment">// ]</span></code></pre><p><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.toObject.html"><code>Maps.toObject</code></a> converts a map to a plain object, this is useful for turning into a JSON string representation.</p><p>Given the same example map from above:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> objects <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">toObject</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Yields: {</span>
<span class="token comment">//  Sally: { name: \`Sally\`, colour: \`red\` },</span>
<span class="token comment">//  Bob: { name: \`Bob\`, colour: \`pink\` }</span>
<span class="token comment">// }</span></code></pre><p>Use <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.fromObject.html"><code>Maps.fromObject</code></a> to convert back from a plain object.</p><p><em>Mapping</em> over a collection of values is common when dealing with arrays. It allows you to transform each element of an array, returning a new array with the transformed values. There is no in built <code>map()</code> for Maps, but you can use ixfx's <a href="https://clinth.github.io/ixfx/functions/Collections.Maps.transformMap.html"><code>Maps.transformMap</code></a> for a similar outcome.</p><p>Like a regular map, it takes a map function which must return a transformed version of its input value.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">a</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Ant</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">b</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Bee</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">c</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Cat</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">transformer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">animal</span><span class="token operator">:</span> value <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> newMap <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">transformMap</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> transformer<span class="token punctuation">)</span><span class="token punctuation">;</span>

map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">b</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// Yields: \`Bee\`</span>
newMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">b</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Yields: { animal: \`Bee\` }</span></code></pre><p>The above example could be expressed more succinctly:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> newMap <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">transformMap</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token literal-property property">animal</span><span class="token operator">:</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><em>Zippering</em> is combining two aligned arrays together. In the case of a map, we might want to combine an array of keys with an array of values using
<a href="https://clinth.github.io/ixfx/functions/Collections.Maps.zipKeyValue.html"><code>Maps.zipKeyValue</code></a>. The length of both arrays must be the same.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Maps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"https://unpkg.com/ixfx/dist/collections.js"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">a</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">b</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">c</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">ant</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">bee</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">cat</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> map <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">zipKeyValue</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">b</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Yields: \`bee\`</span></code></pre><h2 id="expiring-map">Expiring Map</h2><p>The <a href="https://clinth.github.io/ixfx/classes/Collections.Maps.ExpiringMap.html"><code>ExpiringMap</code></a> is a class where values expire after some period. This is useful for caches or cases where there's not a good logic for when to remove things.</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExpiringMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">fruit</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">apple</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Delete all entries set more than 100ms ago</span>
map<span class="token punctuation">.</span><span class="token function">deleteWithElapsed</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">set</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Delete all entries that have not been accessed for more than 100ms</span>
map<span class="token punctuation">.</span><span class="token function">deleteWithElapsed</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">get</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Get the time since the key 'fruit' was last accessed</span>
map<span class="token punctuation">.</span><span class="token function">elapsedGet</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">fruit</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Get the time since the key \`fruit\` was last set</span>
map<span class="token punctuation">.</span><span class="token function">elapsedSet</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">fruit</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>When creating the map, you can opt to have it automatically delete items:</p><pre class="language-js"><code class="language-js"><span class="token comment">// Delete any entry not accessed for over one second</span>
<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExpiringMap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">autoDeleteElapsed</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
  <span class="token literal-property property">autoDeletePolicy</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">get</span><span class="token template-punctuation string">\`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>See the API docs for more on the options.</p><p>There are also some events to listen for automatic expiry: 'expired', 'removed' and 'newKey'.</p><pre class="language-js"><code class="language-js">map<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">expired</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> key<span class="token punctuation">,</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> event<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="more-functions-for-working-with-maps">More functions for working with maps</h2><p>Finding</p><ul>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.find.html"><code>find</code></a> - Finds first value that matches a predicate</li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.firstEntryByIterableValue.html"><code>firstEntryByIterableValue</code></a> - Finds first entry that matches value</li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.firstEntryByIterableValue.html"><code>firstEntryByIterablePredicate</code></a> - Finds first entry that matches predicate (same as <code>find</code>)</li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getClosestIntegerKey.html"><code>getClosestIntegerKey</code></a> - assumes all keys are integers, gets the closest present key</li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getFromKeys.html"><code>getFromKeys</code></a> - given a set of keys, returns the value for the first one that is present</li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.hasAnyValue.html"><code>hasAnyValue</code></a> - returns true if value is in the map</li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.hasKeyValue.html"><code>hasAnyKeyValue</code></a>- returns true if value is present under key</li>
</ul><p>Iterating</p><ul>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.filter.html"><code>filter</code></a> - iterate over values where predicate returns true</li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValue.html"><code>sortByValue</code></a> - returns values, sorted</li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.sortByValueProperty.html"><code>sortByValueProperty</code></a> - returns entries, sorted by a chosen property</li>
</ul><p>Adding values</p><ul>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.addKeepingExisting.html"><code>addKeepExisting</code></a></li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.addObject.html"><code>addObject</code></a></li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.getOrGenerate-1.html"><code>getOrGenerate</code></a> - get by key or create &#x26; add new item</li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mergeByKey.html"><code>mergeByKey</code></a> - merge two maps, with a reconcile function to merge values that use same key</li>
</ul><p>Removing/changing values</p><ul>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.deleteByValue.html"><code>deleteByValue</code></a> - remove by value rather than key</li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.transformMap.html"><code>transformMap</code></a> - for each entry, runs it through a function and into a new map</li>
</ul><p>Creating maps</p><ul>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.fromIterable.html"><code>fromIterable</code></a></li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.fromObject.html"><code>fromObject</code></a></li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.immutable.html"><code>immutable</code></a> - creates an immutable map</li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mutable.html"><code>mutable</code></a> - creates a mutable map</li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.zipKeyValue.html"><code>zipKeyValue</code></a> - combine an array of keys and an array of values into an object</li>
</ul><p>Multiple values per key maps</p><ul>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mapOfSimpleMutable-1.html"><code>mapOfSimpleMutable</code></a> - map that can store many values per key, less functions than the others below</li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.ofArrayMutable.html"><code>ofArrayMutable</code></a> - Uses an array to store values</li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.ofCircularMutable.html"><code>ofCircularMutable</code></a> - Uses a circular array of limited capacity</li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.ofSetMutable.html"><code>ofSetMutable</code></a> - Uses a set to store unique values</li>
</ul><p>Converting maps</p><ul>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mapToArray.html"><code>mapToArray</code></a></li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.mapToObjectTransform.html"><code>mapToObjectTransform</code></a></li>
<li><a href="https://clinth.github.io/ixfx/functions/Collections.Maps.toObject.html"><code>toObject</code></a></li>
</ul>` })}`;
});

export { $$metadata, $$Map as default, frontmatter, metadata };
