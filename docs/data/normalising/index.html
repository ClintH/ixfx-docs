<!DOCTYPE html>
<html dir="ltr" lang="en-us" class="initial astro-VOYEGVQR">
	<head>
		<!-- Global Metadata --><meta charset="utf-8">
<meta name="viewport" content="width=device-width">

<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="alternate icon" type="image/x-icon" href="/favicon.ico">

<link rel="sitemap" href="/sitemap.xml">

<!-- Preload Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital@0;1&display=swap" rel="stylesheet">

<!-- Scrollable a11y code helper -->
<script type="module" src="/make-scrollable-code-focusable.js"></script>

<!-- This is intentionally inlined to avoid FOUC -->
<script>
	const root = document.documentElement;
	const theme = localStorage.getItem('theme');
	if (theme === 'dark' || (!theme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
		root.classList.add('theme-dark');
	} else {
		root.classList.remove('theme-dark');
	}
</script>

		<!-- Page Metadata --><link rel="canonical" href="https://clinth.github.io/ixfx-docs/data/normalising/">

<!-- OpenGraph Tags -->
<meta property="og:title" content="Normalising - ixfx docs">
<meta property="og:type" content="article">
<meta property="og:url" content="https://clinth.github.io/ixfx-docs/data/normalising/">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://github.com/clinth/ixfx/blob/main/assets/social/banner.jpg?raw=true">
<meta property="og:image:alt" content="ixfx">
<meta name="description" property="og:description" content="ixfx documentation">
<meta property="og:site_name" content="ixfx docs">

<!-- Twitter Tags -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site">
<meta name="twitter:title" content="Normalising - ixfx docs">
<meta name="twitter:description" content="ixfx documentation">
<meta name="twitter:image" content="https://github.com/clinth/ixfx/blob/main/assets/social/banner.jpg?raw=true">
<meta name="twitter:image:alt" content="ixfx">

<!--
  TODO: Add json+ld data, maybe https://schema.org/APIReference makes sense?
  Docs: https://developers.google.com/search/docs/advanced/structured-data/intro-structured-data
  https://www.npmjs.com/package/schema-dts seems like a great resource for implementing this.
  Even better, there's a React component that integrates with `schema-dts`: https://github.com/google/react-schemaorg
-->

		<title>Normalising - ixfx docs</title>
		
	<link rel="stylesheet" href="/ixfx-docs/assets/MainLayout.46c7210e.css"></link><style astro-style="true">astro-root, astro-fragment { display: contents; }</style><script type="module" src="/ixfx-docs/hoisted.b2a3e94c8.js" astro-script="/data/normalising/script-0"></script>
<script type="module" hoist="true" astro-script="/data/normalising/script-1">import '/src/components/ReplPad';</script>
<script type="module" data-astro-component-hydration astro-script="/data/normalising/script-2">import setup from '../../idle.04f12634.js';
setup("Z12Vj7s", {name:"SidebarToggle",value: true}, async () => {
  const [{ default: Component }, { default: hydrate }] = await Promise.all([import("../../SidebarToggle.c1936d68.js"), import("../../client.a7c2389a.js")]);
  return (el, children) => hydrate(el)(Component, {"class":"astro-MOSAUK67"}, children);

});
</script>
<script type="module" data-astro-component-hydration astro-script="/data/normalising/script-3">import setup from '../../media.57d8586c.js';
setup("2pAkWt", {name:"TableOfContents",value: "(min-width: 50em)"}, async () => {
  const [{ default: Component }, { default: hydrate }] = await Promise.all([import("../../TableOfContents.237e654c.js"), import("../../client.a7c2389a.js")]);
  return (el, children) => hydrate(el)(Component, {"headers":[{"depth":2,"slug":"arrays","text":"Arrays"},{"depth":2,"slug":"individual-values","text":"Individual values"},{"depth":3,"slug":"stream","text":"Stream"},{"depth":3,"slug":"scale","text":"Scale"},{"depth":2,"slug":"geometry","text":"Geometry"}],"class":"astro-XPZS3NBI"}, children);

});
</script>
<script type="module" data-astro-component-hydration astro-script="/data/normalising/script-4">import setup from '../../visible.e1f6ae0f.js';
setup("1Gmxo9", {name:"ThemeToggleButton",value: true}, async () => {
  const [{ default: Component }, { default: hydrate }] = await Promise.all([import("../../ThemeToggleButton.2e9e674b.js"), import("../../client.a7c2389a.js")]);
  return (el, children) => hydrate(el)(Component, {"class":"astro-WOEIVG5E"}, children);

});
</script>
<script type="module" data-astro-component-hydration astro-script="/data/normalising/script-5">import setup from '../../media.57d8586c.js';
setup("2pAkWt", {name:"TableOfContents",value: "(max-width: 50em)"}, async () => {
  const [{ default: Component }, { default: hydrate }] = await Promise.all([import("../../TableOfContents.237e654c.js"), import("../../client.a7c2389a.js")]);
  return (el, children) => hydrate(el)(Component, {"headers":[{"depth":2,"slug":"arrays","text":"Arrays"},{"depth":2,"slug":"individual-values","text":"Individual values"},{"depth":3,"slug":"stream","text":"Stream"},{"depth":3,"slug":"scale","text":"Scale"},{"depth":2,"slug":"geometry","text":"Geometry"}],"class":"astro-AMOJLK4X"}, children);

});
</script>
</head>

	<body>
		<header class="astro-MOSAUK67">
	<a href="#article" class="sr-only skiplink astro-RC6GWYXJ"><span class="astro-RC6GWYXJ">Skip to Content</span></a>



	<nav class="nav-wrapper astro-MOSAUK67" title="Top Navigation">
		<div class="menu-toggle astro-MOSAUK67">
			<astro-root uid="Z12Vj7s"><button type="button" aria-pressed="false" id="menu-toggle"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg><span class="sr-only">Toggle sidebar</span></button></astro-root>
		</div>
		<div class="logo flex astro-MOSAUK67">
			<!-- <AstroLogo size={40} /> -->
			<a href="/ixfx-docs/" class="astro-MOSAUK67">
				<h1 class="astro-MOSAUK67">ixfx docs</h1>
			</a>
		</div>
		<div style="flex-grow: 1;" class="astro-MOSAUK67"></div>
		<!-- {KNOWN_LANGUAGE_CODES.length > 1 && <LanguageSelect lang={lang} client:idle />} -->
		<!-- {CONFIG.ALGOLIA && (
			<div class="search-item">
				<Search client:idle />
			</div>
		)} -->
	</nav>
</header>



		<main class="layout astro-VOYEGVQR">
			<aside id="grid-left" class="grid-sidebar astro-VOYEGVQR" title="Site Navigation">
				<nav aria-labelledby="grid-left" class="astro-TIHETVVV">
	<ul class="nav-groups astro-TIHETVVV">
		<li class="astro-TIHETVVV">
				<div class="nav-group astro-TIHETVVV">
					<h2 class="nav-group-title astro-TIHETVVV"></h2>
					<ul class="astro-TIHETVVV">
						
					</ul>
				</div>
			</li><li class="astro-TIHETVVV">
				<div class="nav-group astro-TIHETVVV">
					<h2 class="nav-group-title astro-TIHETVVV">Getting Started</h2>
					<ul class="astro-TIHETVVV">
						<li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/./" aria-current="false" class="astro-TIHETVVV">
									Introduction
								</a>
							</li><li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/./importing/" aria-current="false" class="astro-TIHETVVV">
									Importing
								</a>
							</li>
					</ul>
				</div>
			</li><li class="astro-TIHETVVV">
				<div class="nav-group astro-TIHETVVV">
					<h2 class="nav-group-title astro-TIHETVVV">Flow and Logic</h2>
					<ul class="astro-TIHETVVV">
						<li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/flow/stateMachine/" aria-current="false" class="astro-TIHETVVV">
									State Machine
								</a>
							</li><li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/flow/loops/" aria-current="false" class="astro-TIHETVVV">
									Loops and Intervals
								</a>
							</li><li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/flow/delay/" aria-current="false" class="astro-TIHETVVV">
									Delay
								</a>
							</li>
					</ul>
				</div>
			</li><li class="astro-TIHETVVV">
				<div class="nav-group astro-TIHETVVV">
					<h2 class="nav-group-title astro-TIHETVVV">Modulation</h2>
					<ul class="astro-TIHETVVV">
						<li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/modulation/easing/" aria-current="false" class="astro-TIHETVVV">
									Easing
								</a>
							</li><li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/modulation/envelope/" aria-current="false" class="astro-TIHETVVV">
									Envelope
								</a>
							</li><li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/modulation/forces/" aria-current="false" class="astro-TIHETVVV">
									Forces
								</a>
							</li><li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/modulation/jitter/" aria-current="false" class="astro-TIHETVVV">
									Jitter
								</a>
							</li><li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/modulation/interpolate/" aria-current="false" class="astro-TIHETVVV">
									Interpolate
								</a>
							</li><li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/modulation/oscillator/" aria-current="false" class="astro-TIHETVVV">
									Oscillator
								</a>
							</li>
					</ul>
				</div>
			</li><li class="astro-TIHETVVV">
				<div class="nav-group astro-TIHETVVV">
					<h2 class="nav-group-title astro-TIHETVVV">Generation</h2>
					<ul class="astro-TIHETVVV">
						<li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/gen/random/" aria-current="false" class="astro-TIHETVVV">
									Random
								</a>
							</li><li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/gen/generator/" aria-current="false" class="astro-TIHETVVV">
									Generators
								</a>
							</li>
					</ul>
				</div>
			</li><li class="astro-TIHETVVV">
				<div class="nav-group astro-TIHETVVV">
					<h2 class="nav-group-title astro-TIHETVVV">Data</h2>
					<ul class="astro-TIHETVVV">
						<li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/data/cleanup/" aria-current="false" class="astro-TIHETVVV">
									Clean up
								</a>
							</li><li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/data/normalising/" aria-current="false" class="astro-TIHETVVV">
									Normalising
								</a>
							</li><li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/data/arrays/" aria-current="false" class="astro-TIHETVVV">
									Arrays
								</a>
							</li><li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/data/collections/" aria-current="false" class="astro-TIHETVVV">
									Collections
								</a>
							</li><li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/data/averaging/" aria-current="false" class="astro-TIHETVVV">
									Averaging
								</a>
							</li><li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/data/frequency/" aria-current="false" class="astro-TIHETVVV">
									Frequency
								</a>
							</li><li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/data/trackers/" aria-current="false" class="astro-TIHETVVV">
									Trackers
								</a>
							</li>
					</ul>
				</div>
			</li><li class="astro-TIHETVVV">
				<div class="nav-group astro-TIHETVVV">
					<h2 class="nav-group-title astro-TIHETVVV">Types</h2>
					<ul class="astro-TIHETVVV">
						<li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/types/geometry/" aria-current="false" class="astro-TIHETVVV">
									Geometry
								</a>
							</li><li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/types/colour/" aria-current="false" class="astro-TIHETVVV">
									Colour
								</a>
							</li>
					</ul>
				</div>
			</li><li class="astro-TIHETVVV">
				<div class="nav-group astro-TIHETVVV">
					<h2 class="nav-group-title astro-TIHETVVV">IO</h2>
					<ul class="astro-TIHETVVV">
						<li class="nav-link astro-TIHETVVV">
								<a href="/ixfx-docs/io/espruino/" aria-current="false" class="astro-TIHETVVV">
									Espruino
								</a>
							</li>
					</ul>
				</div>
			</li>
	</ul>
</nav>

<script>
	window.addEventListener('DOMContentLoaded', (event) => {
		var target = document.querySelector('[aria-current="page"]');
		if (target && target.offsetTop > window.innerHeight - 100) {
			document.querySelector('.nav-groups').scrollTop = target.offsetTop;
		}
	});
</script>



			</aside>
			<div id="grid-main" class="astro-VOYEGVQR">
				<article id="article" class="content astro-AMOJLK4X">
	<section class="main-section astro-AMOJLK4X">
		<h1 class="content-title astro-AMOJLK4X" id="overview">Normalising</h1>
		<nav class="block sm:hidden astro-AMOJLK4X">
				<astro-root uid="2pAkWt"><h2 class="heading">On this page</h2><ul><li class="header-link depth-2"><a href="#overview">Overview</a></li><li class="header-link depth-2"><a href="#arrays">Arrays</a></li><li class="header-link depth-2"><a href="#individual-values">Individual values</a></li><li class="header-link depth-3"><a href="#stream">Stream</a></li><li class="header-link depth-3"><a href="#scale">Scale</a></li><li class="header-link depth-2"><a href="#geometry">Geometry</a></li></ul></astro-root>
			</nav>
		<p>Data coming in from events, sensors etc. can have radically different scales or units. Rather than having to juggle these differences throughout your code, a strategy is to try to <em>normalise</em> it as soon as you can, getting it on a relative percentage scale of 0..1 (0% .. 100%).</p><p>Normalisation allows values to be compared more readily: 0.5 (ie. 50%) can represent half volume level, or half of the screen width. That's easier to manage than having to work with the equivalent absolute values of -12dB and 800, and much less of your code has to change if different scaling is needed later on.</p><p>It's easy to apply modulation factors and eventually to map the relative value to some absolute value in the output domain. For example:</p><pre class="language-js"><code class="language-js"><span class="token comment">// Normalised value</span>
<span class="token keyword">const</span> v <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">;</span>

<span class="token comment">// Get x coordinate at 50%</span>
<span class="token keyword">const</span> x <span class="token operator">=</span> v <span class="token operator">*</span> window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">;</span>

<span class="token comment">// Get a hue at 50%</span>
<span class="token keyword">const</span> hue <span class="token operator">=</span> v <span class="token operator">*</span> <span class="token number">360</span><span class="token punctuation">;</span></code></pre><p>The basic steps then are:</p><ol>
<li>Receive data from an event, sensor, stream etc</li>
<li>Normalise on 0..1 scale, discarding original value</li>
<li>Do additional processing on normalised value as needed, applying to state</li>
<li>Map relative state values to output domains, eg pixels, sound level, pulse-width modulation... (see also <a href="https://clinth.github.io/ixfx/functions/Data.scalePercent.html"><code>scalePercent</code></a>)</li>
</ol><p>For simple normalisation, some sense of the <em>input</em> range of values is needed: a minimum and maximum. For example, although an analog input value might theoretically be in the range of 0..1023, perhaps we've empirically discovered that the usable range is actually 0..400. This would constitute the range of the value.</p><p>See also</p><ul>
<li><a href="../../data/cleanup/">Data clean up</a></li>
</ul><h2 id="arrays">Arrays</h2><p>If you have all the data in advance, it's easy enough to 'perfectly' normalise, because the smallest and largest value can be determined. <a href="https://clinth.github.io/ixfx/functions/Data.Normalise.array.html"><code>Normalise.array(source)</code></a> returns a normalised copy of <code>source</code>, such that the smallest value becomes 0 and the largest value 1. A range can be forced by passing in a min and max: <code>Normalise.array(source, min, max)</code>.</p><pre class="language-js"><code class="language-js"><span class="token comment">// repl-pad</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Normalise <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'https://unpkg.com/ixfx/dist/data.js'</span><span class="token punctuation">;</span>

<span class="token comment">// Normalise with the largest value being 100%, the smallest 0%</span>
<span class="token comment">// Yields: [1, 0.2, 0, 0.5]</span>
Normalise<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Normalise with a forced min/max range</span>
<span class="token comment">// Values outside of range will be clipped</span>
<span class="token comment">// Yields: [1, 0.4, 0, 1]</span>
Normalise<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Range 0-50</span></code></pre><p><a href="https://clinth.github.io/ixfx/functions/Collections.Arrays.minMaxAvg.html"><code>minMaxAvg</code></a> might also be a useful when working with arrays. It returns the minimum, maximum, average and total.</p><pre class="language-js"><code class="language-js"><span class="token comment">// repl-pad</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Arrays<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'https://unpkg.com/ixfx/dist/collections.js'</span><span class="token punctuation">;</span>

<span class="token comment">// Yields: {total:170, max:100, min:0, avg:42.5}</span>
<span class="token keyword">const</span> mma <span class="token operator">=</span> Arrays<span class="token punctuation">.</span><span class="token function">minMaxAvg</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="individual-values">Individual values</h2><p>It's not always feasible to normalise knowing in advance all the possible values, or even knowing the range. <code>Normalise.stream</code> remembers the range of values, producing an adaptive normalisation. <code>scale</code> can also be used for normalisation, but you must provide the expected min and max value.</p><h3 id="stream">Stream</h3><p><a href="https://clinth.github.io/ixfx/functions/Data.Normalise.stream.html"><code>Normalise.stream</code></a> creates a normalise function which automatically adapts as values are processed.</p><pre class="language-js"><code class="language-js"><span class="token comment">// repl-pad</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Normalise <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'https://unpkg.com/ixfx/dist/data.js'</span><span class="token punctuation">;</span>

<span class="token comment">// Initialise a streaming normaliser</span>
<span class="token keyword">const</span> n <span class="token operator">=</span> Normalise<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Yields 1, because 5 is the highest seen</span>
<span class="token function">n</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Yields 1, because now 10 is the highest seen</span>
<span class="token function">n</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Yields 0, because it's so far the lowest seen</span>
<span class="token function">n</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Yields 0.5, becaause it's in the middle of the range seen thus far</span>
<span class="token function">n</span><span class="token punctuation">(</span><span class="token number">7.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Yields 1, because now it's the largest seen</span>
<span class="token function">n</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>It should be clear from the examples that different input values may produce the same output value, depending on what has been seen before. For example, an input of 5 yields 1 if 5 is the highest value, but 5 yields 0.05 if 100 is the highest value. It's good to remember then that normalised values aren't necessarily comparable to each other.</p><p>It's possible to 'prime' the normalisation if you know in advance what range of values to expect. If a value exceeds the range, the range is updated to encompass the new minimum or maximum.</p><pre class="language-js"><code class="language-js"><span class="token comment">// repl-pad</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Normalise<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'https://unpkg.com/ixfx/dist/data.js'</span><span class="token punctuation">;</span>

<span class="token comment">// Initialise normaliser, assuming range of 0-10 </span>
<span class="token keyword">const</span> n <span class="token operator">=</span> Normalise<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Yields 0.5, because it's in the middle of the primed range</span>
<span class="token function">n</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Yields 1, with 11 now treated as the max</span>
<span class="token function">n</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="scale">Scale</h3><p>In contrast to <code>stream</code>, <a href="https://clinth.github.io/ixfx/functions/Data.scale.html"><code>scale</code></a> keeps no record of the current minimum or maximum, but normalises based on the provided range. Use this when you know what the range will be.</p><p>A basic scale function looks like this:</p><pre class="language-js"><code class="language-js"><span class="token comment">// repl-pad</span>
<span class="token keyword">const</span> <span class="token function-variable function">scale</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">v<span class="token punctuation">,</span> inMin<span class="token punctuation">,</span> inMax<span class="token punctuation">,</span> outMin<span class="token punctuation">,</span> outMax</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>v <span class="token operator">-</span> inMin<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>inMax <span class="token operator">-</span> inMin<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>outMax <span class="token operator">-</span> outMin<span class="token punctuation">)</span> <span class="token operator">+</span> outMin<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Example, scale the value of 50, with an </span>
<span class="token comment">// input range of 0..100 and</span>
<span class="token comment">// output range of 0..1:</span>
<span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Yields: 0.5</span></code></pre><p>The ixfx scale function optionally allows the scaling to be <em>eased</em> (for non-linear scaling), and if <code>outMin</code>/<code>outMax</code> are not specified, a 0..1 range is presumed.</p><p>It's function signature looks like this:</p><pre class="language-js"><code class="language-js"><span class="token function">scale</span><span class="token punctuation">(</span>v<span class="token operator">:</span>number<span class="token punctuation">,</span> 
      <span class="token literal-property property">inMin</span><span class="token operator">:</span>number<span class="token punctuation">,</span> <span class="token literal-property property">inMax</span><span class="token operator">:</span>number<span class="token punctuation">,</span> 
      outMin<span class="token operator">?</span><span class="token operator">:</span>number<span class="token punctuation">,</span> outMax<span class="token operator">?</span><span class="token operator">:</span>number<span class="token punctuation">,</span> easing<span class="token operator">?</span><span class="token operator">:</span>EasingFn<span class="token punctuation">)</span><span class="token operator">:</span>number</code></pre><p>In action it looks like this:</p><pre class="language-js"><code class="language-js"><span class="token comment">// repl-pad#1</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> scale <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'https://unpkg.com/ixfx/dist/data.js'</span>

<span class="token comment">// Scales 10 on the range of 0-100, </span>
<span class="token comment">// with an output range of 0-1.</span>
<span class="token comment">// Yields 0.10</span>
<span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0.1</span>

<span class="token comment">// Scales 20 on a range of 20-40</span>
<span class="token comment">// Yields 0</span>
<span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span></code></pre><p><code>scale</code> can also map to an output range other than the default of 0..1:</p><pre class="language-js"><code class="language-js"><span class="token comment">// repl-pad#1</span>
<span class="token comment">// Maps the value 30 from an input range of 20-40 (thus 30 = 0.5 or 50%)</span>
<span class="token comment">// to an output range of 100-200, yielding 150 (50% of the range 100-200)</span>
<span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 150</span></code></pre><p>If the input value is outside of the specified input range, the output value will likewise be outside of the output range. Use <a href="../data/cleanup/#clamping"><code>clamp</code></a> to ensure the output range is respected:</p><pre class="language-js"><code class="language-js"><span class="token comment">// repl-pad</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> scale<span class="token punctuation">,</span> clamp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'https://unpkg.com/ixfx/dist/data.js'</span>
<span class="token comment">// 11 is beyond input range of 0-10, so we get</span>
<span class="token comment">// an output beyond expected range of 0..1:</span>
<span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1.1</span>

<span class="token comment">// Clamp solves that:</span>
<span class="token function">clamp</span><span class="token punctuation">(</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span></code></pre><p>If the input range is a percentage, <a href="https://clinth.github.io/ixfx/functions/Data.scalePercentages.html"><code>scalePercentages</code></a> adapts to a new output percentage range. While <code>scale</code> can be used for this, it's useful because it sanity-checks values to make sure everything stays within the percentage range.</p><pre class="language-js"><code class="language-js"><span class="token comment">// repl-pad</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> scalePercentages <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'https://unpkg.com/ixfx/dist/data.js'</span>
<span class="token comment">// Scale 0.5 to be on a 0.0-0.10 range</span>
<span class="token function">scalePercentages</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.10</span><span class="token punctuation">)</span> <span class="token comment">// 0.05 (5%)</span></code></pre><h2 id="geometry">Geometry</h2><p>Working with normalised geometric references can be useful for the same reason as normalised plain numbers. For example, perhaps you have a stream of <a href="../../types/geometry/point/">points</a> from a computer vision library for the location of a detected nose. This position might be in <em>camera coordinates</em>, meaning that 0,0 represents the top-left corner of a frame from the camera. The max width and height will be determined by the resolution setting of the camera/library.</p><p>You don't want to have to think about the scale of camera coordinates throughout the code, and importantly, it may change if you opt for a different camera resolution. Normalising to 0,0 - 1,1 may be the answer:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> cameraBounds <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">768</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> pt <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">x</span><span class="token operator">:</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> normalised <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">x</span><span class="token operator">:</span> pt<span class="token punctuation">.</span>x <span class="token operator">/</span> cameraBounds<span class="token punctuation">.</span>width<span class="token punctuation">,</span>
  <span class="token literal-property property">y</span><span class="token operator">:</span> pt<span class="token punctuation">.</span>y <span class="token operator">/</span> cameraBounds<span class="token punctuation">.</span>height
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>You might also want to verify the points don't exceed 0..1.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> clamp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'https://unpkg.com/ixfx/dist/data.js'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> normalisedClamped <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token function">clamp</span><span class="token punctuation">(</span>pt<span class="token punctuation">.</span>x <span class="token operator">/</span> cameraBounds<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token function">clamp</span><span class="token punctuation">(</span>pt<span class="token punctuation">.</span>y <span class="token operator">/</span> cameraBounds<span class="token punctuation">.</span>height
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>With ixfx, normalising points is possible using <a href="https://clinth.github.io/ixfx/functions/Geometry.Points.normaliseByRect.html"><code>Points.normaliseByRect</code></a></p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Points <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'https://unpkg.com/ixfx/dist/geometry.js'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cameraBounds <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">768</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> pt <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">300</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Convert point to 0..1 scale, based on camera frame</span>
<span class="token keyword">const</span> normalised <span class="token operator">=</span> Points<span class="token punctuation">.</span><span class="token function">normaliseByRect</span><span class="token punctuation">(</span>pt<span class="token punctuation">,</span> cameraBounds<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><a href="https://clinth.github.io/ixfx/functions/Geometry.Points.clamp.html"><code>Points.clamp</code></a> will clamp both <em>x</em> and <em>y</em>:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> normalised <span class="token operator">=</span> Points<span class="token punctuation">.</span><span class="token function">clamp</span><span class="token punctuation">(</span>Points<span class="token punctuation">.</span><span class="token function">normaliseByRect</span><span class="token punctuation">(</span>pt<span class="token punctuation">,</span> cameraBounds<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>If you have a normalised point, at some point you may need to map it to some coordinate space. Eg to the viewport. <a href="https://clinth.github.io/ixfx/functions/Geometry.Points.multiply.html"><code>Points.multiply</code></a> can be used for this:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Point <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'https://unpkg.com/ixfx/dist/geometry.js'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bounds <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">height</span><span class="token operator">:</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> window<span class="token punctuation">.</span>innerWidth <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 1,1 is normalised, meaning {x:100%, y:100%}</span>
<span class="token keyword">const</span> pt <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span><span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Now it's in absolute screen coordinates</span>
<span class="token keyword">const</span> screenPt <span class="token operator">=</span> Points<span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>pt<span class="token punctuation">,</span> bounds<span class="token punctuation">.</span>width<span class="token punctuation">,</span> bounds<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
	</section>
	<nav class="block sm:hidden astro-AMOJLK4X">
		
<ul class="astro-WOEIVG5E">
</ul>
<div style="margin: 2rem 0; text-align: center;" class="astro-WOEIVG5E">
	<astro-root uid="1Gmxo9"><div class="theme-toggle"><label class><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clipRule="evenodd"></path></svg><input type="radio" name="theme-toggle" value="light" title="Use light theme" aria-label="Use light theme" /></label><label class><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="currentColor"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg><input type="radio" name="theme-toggle" value="dark" title="Use dark theme" aria-label="Use dark theme" /></label></div></astro-root>
</div>



	</nav>
</article>



			</div>
			<aside id="grid-right" class="grid-sidebar astro-VOYEGVQR" title="Table of Contents">
				<nav class="sidebar-nav astro-XPZS3NBI" aria-labelledby="grid-right">
	<div class="sidebar-nav-inner astro-XPZS3NBI">
		<astro-root uid="2pAkWt"><h2 class="heading">On this page</h2><ul><li class="header-link depth-2"><a href="#overview">Overview</a></li><li class="header-link depth-2"><a href="#arrays">Arrays</a></li><li class="header-link depth-2"><a href="#individual-values">Individual values</a></li><li class="header-link depth-3"><a href="#stream">Stream</a></li><li class="header-link depth-3"><a href="#scale">Scale</a></li><li class="header-link depth-2"><a href="#geometry">Geometry</a></li></ul></astro-root>
		
<ul class="astro-WOEIVG5E">
</ul>
<div style="margin: 2rem 0; text-align: center;" class="astro-WOEIVG5E">
	<astro-root uid="1Gmxo9"><div class="theme-toggle"><label class><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clipRule="evenodd"></path></svg><input type="radio" name="theme-toggle" value="light" title="Use light theme" aria-label="Use light theme" /></label><label class><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="currentColor"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg><input type="radio" name="theme-toggle" value="dark" title="Use dark theme" aria-label="Use dark theme" /></label></div></astro-root>
</div>



	</div>
</nav>



			</aside>
		</main>
	</body>
</html>
